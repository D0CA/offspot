(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cf(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function TT(i){if(i.__esModule)return i;var t=i.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var s=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:function(){return i[r]}})}),e}var $g={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fa=Symbol.for("react.element"),AT=Symbol.for("react.portal"),ET=Symbol.for("react.fragment"),ST=Symbol.for("react.strict_mode"),wT=Symbol.for("react.profiler"),bT=Symbol.for("react.provider"),CT=Symbol.for("react.context"),IT=Symbol.for("react.forward_ref"),DT=Symbol.for("react.suspense"),RT=Symbol.for("react.memo"),MT=Symbol.for("react.lazy"),Pp=Symbol.iterator;function PT(i){return i===null||typeof i!="object"?null:(i=Pp&&i[Pp]||i["@@iterator"],typeof i=="function"?i:null)}var Wg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yg=Object.assign,jg={};function _n(i,t,e){this.props=i,this.context=t,this.refs=jg,this.updater=e||Wg}_n.prototype.isReactComponent={};_n.prototype.setState=function(i,t){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,t,"setState")};_n.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function qg(){}qg.prototype=_n.prototype;function df(i,t,e){this.props=i,this.context=t,this.refs=jg,this.updater=e||Wg}var ff=df.prototype=new qg;ff.constructor=df;Yg(ff,_n.prototype);ff.isPureReactComponent=!0;var Fp=Array.isArray,Kg=Object.prototype.hasOwnProperty,pf={current:null},Zg={key:!0,ref:!0,__self:!0,__source:!0};function Qg(i,t,e){var r,s={},n=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(n=""+t.key),t)Kg.call(t,r)&&!Zg.hasOwnProperty(r)&&(s[r]=t[r]);var o=arguments.length-2;if(o===1)s.children=e;else if(1<o){for(var l=Array(o),h=0;h<o;h++)l[h]=arguments[h+2];s.children=l}if(i&&i.defaultProps)for(r in o=i.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:Fa,type:i,key:n,ref:a,props:s,_owner:pf.current}}function FT(i,t){return{$$typeof:Fa,type:i.type,key:t,ref:i.ref,props:i.props,_owner:i._owner}}function mf(i){return typeof i=="object"&&i!==null&&i.$$typeof===Fa}function OT(i){var t={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(e){return t[e]})}var Op=/\/+/g;function Gh(i,t){return typeof i=="object"&&i!==null&&i.key!=null?OT(""+i.key):t.toString(36)}function Lo(i,t,e,r,s){var n=typeof i;(n==="undefined"||n==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(n){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case Fa:case AT:a=!0}}if(a)return a=i,s=s(a),i=r===""?"."+Gh(a,0):r,Fp(s)?(e="",i!=null&&(e=i.replace(Op,"$&/")+"/"),Lo(s,t,e,"",function(h){return h})):s!=null&&(mf(s)&&(s=FT(s,e+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Op,"$&/")+"/")+i)),t.push(s)),1;if(a=0,r=r===""?".":r+":",Fp(i))for(var o=0;o<i.length;o++){n=i[o];var l=r+Gh(n,o);a+=Lo(n,t,e,l,s)}else if(l=PT(i),typeof l=="function")for(i=l.call(i),o=0;!(n=i.next()).done;)n=n.value,l=r+Gh(n,o++),a+=Lo(n,t,e,l,s);else if(n==="object")throw t=String(i),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function qa(i,t,e){if(i==null)return i;var r=[],s=0;return Lo(i,r,"","",function(n){return t.call(e,n,s++)}),r}function BT(i){if(i._status===-1){var t=i._result;t=t(),t.then(function(e){(i._status===0||i._status===-1)&&(i._status=1,i._result=e)},function(e){(i._status===0||i._status===-1)&&(i._status=2,i._result=e)}),i._status===-1&&(i._status=0,i._result=t)}if(i._status===1)return i._result.default;throw i._result}var pe={current:null},Uo={transition:null},kT={ReactCurrentDispatcher:pe,ReactCurrentBatchConfig:Uo,ReactCurrentOwner:pf};function Jg(){throw Error("act(...) is not supported in production builds of React.")}ut.Children={map:qa,forEach:function(i,t,e){qa(i,function(){t.apply(this,arguments)},e)},count:function(i){var t=0;return qa(i,function(){t++}),t},toArray:function(i){return qa(i,function(t){return t})||[]},only:function(i){if(!mf(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};ut.Component=_n;ut.Fragment=ET;ut.Profiler=wT;ut.PureComponent=df;ut.StrictMode=ST;ut.Suspense=DT;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kT;ut.act=Jg;ut.cloneElement=function(i,t,e){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=Yg({},i.props),s=i.key,n=i.ref,a=i._owner;if(t!=null){if(t.ref!==void 0&&(n=t.ref,a=pf.current),t.key!==void 0&&(s=""+t.key),i.type&&i.type.defaultProps)var o=i.type.defaultProps;for(l in t)Kg.call(t,l)&&!Zg.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=e;else if(1<l){o=Array(l);for(var h=0;h<l;h++)o[h]=arguments[h+2];r.children=o}return{$$typeof:Fa,type:i.type,key:s,ref:n,props:r,_owner:a}};ut.createContext=function(i){return i={$$typeof:CT,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:bT,_context:i},i.Consumer=i};ut.createElement=Qg;ut.createFactory=function(i){var t=Qg.bind(null,i);return t.type=i,t};ut.createRef=function(){return{current:null}};ut.forwardRef=function(i){return{$$typeof:IT,render:i}};ut.isValidElement=mf;ut.lazy=function(i){return{$$typeof:MT,_payload:{_status:-1,_result:i},_init:BT}};ut.memo=function(i,t){return{$$typeof:RT,type:i,compare:t===void 0?null:t}};ut.startTransition=function(i){var t=Uo.transition;Uo.transition={};try{i()}finally{Uo.transition=t}};ut.unstable_act=Jg;ut.useCallback=function(i,t){return pe.current.useCallback(i,t)};ut.useContext=function(i){return pe.current.useContext(i)};ut.useDebugValue=function(){};ut.useDeferredValue=function(i){return pe.current.useDeferredValue(i)};ut.useEffect=function(i,t){return pe.current.useEffect(i,t)};ut.useId=function(){return pe.current.useId()};ut.useImperativeHandle=function(i,t,e){return pe.current.useImperativeHandle(i,t,e)};ut.useInsertionEffect=function(i,t){return pe.current.useInsertionEffect(i,t)};ut.useLayoutEffect=function(i,t){return pe.current.useLayoutEffect(i,t)};ut.useMemo=function(i,t){return pe.current.useMemo(i,t)};ut.useReducer=function(i,t,e){return pe.current.useReducer(i,t,e)};ut.useRef=function(i){return pe.current.useRef(i)};ut.useState=function(i){return pe.current.useState(i)};ut.useSyncExternalStore=function(i,t,e){return pe.current.useSyncExternalStore(i,t,e)};ut.useTransition=function(){return pe.current.useTransition()};ut.version="18.3.1";$g.exports=ut;var nt=$g.exports;const Q=cf(nt);var dc={},ty={exports:{}},De={},ey={exports:{}},iy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function t(R,V){var M=R.length;R.push(V);t:for(;0<M;){var B=M-1>>>1,z=R[B];if(0<s(z,V))R[B]=V,R[M]=z,M=B;else break t}}function e(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var V=R[0],M=R.pop();if(M!==V){R[0]=M;t:for(var B=0,z=R.length,st=z>>>1;B<st;){var tt=2*(B+1)-1,gt=R[tt],et=tt+1,it=R[et];if(0>s(gt,M))et<z&&0>s(it,gt)?(R[B]=it,R[et]=M,B=et):(R[B]=gt,R[tt]=M,B=tt);else if(et<z&&0>s(it,M))R[B]=it,R[et]=M,B=et;else break t}}return V}function s(R,V){var M=R.sortIndex-V.sortIndex;return M!==0?M:R.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;i.unstable_now=function(){return n.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],h=[],u=1,d=null,c=3,f=!1,p=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(R){for(var V=e(h);V!==null;){if(V.callback===null)r(h);else if(V.startTime<=R)r(h),V.sortIndex=V.expirationTime,t(l,V);else break;V=e(h)}}function T(R){if(y=!1,g(R),!p)if(e(l)!==null)p=!0,H(A);else{var V=e(h);V!==null&&U(T,V.startTime-R)}}function A(R,V){p=!1,y&&(y=!1,m(E),E=-1),f=!0;var M=c;try{for(g(V),d=e(l);d!==null&&(!(d.expirationTime>V)||R&&!k());){var B=d.callback;if(typeof B=="function"){d.callback=null,c=d.priorityLevel;var z=B(d.expirationTime<=V);V=i.unstable_now(),typeof z=="function"?d.callback=z:d===e(l)&&r(l),g(V)}else r(l);d=e(l)}if(d!==null)var st=!0;else{var tt=e(h);tt!==null&&U(T,tt.startTime-V),st=!1}return st}finally{d=null,c=M,f=!1}}var S=!1,w=null,E=-1,C=5,D=-1;function k(){return!(i.unstable_now()-D<C)}function F(){if(w!==null){var R=i.unstable_now();D=R;var V=!0;try{V=w(!0,R)}finally{V?b():(S=!1,w=null)}}else S=!1}var b;if(typeof _=="function")b=function(){_(F)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,N=P.port2;P.port1.onmessage=F,b=function(){N.postMessage(null)}}else b=function(){x(F,0)};function H(R){w=R,S||(S=!0,b())}function U(R,V){E=x(function(){R(i.unstable_now())},V)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(R){R.callback=null},i.unstable_continueExecution=function(){p||f||(p=!0,H(A))},i.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<R?Math.floor(1e3/R):5},i.unstable_getCurrentPriorityLevel=function(){return c},i.unstable_getFirstCallbackNode=function(){return e(l)},i.unstable_next=function(R){switch(c){case 1:case 2:case 3:var V=3;break;default:V=c}var M=c;c=V;try{return R()}finally{c=M}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(R,V){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var M=c;c=R;try{return V()}finally{c=M}},i.unstable_scheduleCallback=function(R,V,M){var B=i.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?B+M:B):M=B,R){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=M+z,R={id:u++,callback:V,priorityLevel:R,startTime:M,expirationTime:z,sortIndex:-1},M>B?(R.sortIndex=M,t(h,R),e(l)===null&&R===e(h)&&(y?(m(E),E=-1):y=!0,U(T,M-B))):(R.sortIndex=z,t(l,R),p||f||(p=!0,H(A))),R},i.unstable_shouldYield=k,i.unstable_wrapCallback=function(R){var V=c;return function(){var M=c;c=V;try{return R.apply(this,arguments)}finally{c=M}}}})(iy);ey.exports=iy;var NT=ey.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LT=nt,Ie=NT;function L(i){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+i,e=1;e<arguments.length;e++)t+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+i+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ry=new Set,ua={};function cs(i,t){nn(i,t),nn(i+"Capture",t)}function nn(i,t){for(ua[i]=t,i=0;i<t.length;i++)ry.add(t[i])}var Hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fc=Object.prototype.hasOwnProperty,UT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bp={},kp={};function GT(i){return fc.call(kp,i)?!0:fc.call(Bp,i)?!1:UT.test(i)?kp[i]=!0:(Bp[i]=!0,!1)}function VT(i,t,e,r){if(e!==null&&e.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:e!==null?!e.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function HT(i,t,e,r){if(t===null||typeof t>"u"||VT(i,t,e,r))return!0;if(r)return!1;if(e!==null)switch(e.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function me(i,t,e,r,s,n,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=e,this.propertyName=i,this.type=t,this.sanitizeURL=n,this.removeEmptyString=a}var ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){ie[i]=new me(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var t=i[0];ie[t]=new me(t,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){ie[i]=new me(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){ie[i]=new me(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){ie[i]=new me(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){ie[i]=new me(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){ie[i]=new me(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){ie[i]=new me(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){ie[i]=new me(i,5,!1,i.toLowerCase(),null,!1,!1)});var _f=/[\-:]([a-z])/g;function gf(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var t=i.replace(_f,gf);ie[t]=new me(t,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var t=i.replace(_f,gf);ie[t]=new me(t,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var t=i.replace(_f,gf);ie[t]=new me(t,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){ie[i]=new me(i,1,!1,i.toLowerCase(),null,!1,!1)});ie.xlinkHref=new me("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){ie[i]=new me(i,1,!1,i.toLowerCase(),null,!0,!0)});function yf(i,t,e,r){var s=ie.hasOwnProperty(t)?ie[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(HT(t,e,s,r)&&(e=null),r||s===null?GT(t)&&(e===null?i.removeAttribute(t):i.setAttribute(t,""+e)):s.mustUseProperty?i[s.propertyName]=e===null?s.type===3?!1:"":e:(t=s.attributeName,r=s.attributeNamespace,e===null?i.removeAttribute(t):(s=s.type,e=s===3||s===4&&e===!0?"":""+e,r?i.setAttributeNS(r,t,e):i.setAttribute(t,e))))}var qi=LT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ka=Symbol.for("react.element"),Rs=Symbol.for("react.portal"),Ms=Symbol.for("react.fragment"),vf=Symbol.for("react.strict_mode"),pc=Symbol.for("react.profiler"),sy=Symbol.for("react.provider"),ny=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),mc=Symbol.for("react.suspense"),_c=Symbol.for("react.suspense_list"),Tf=Symbol.for("react.memo"),tr=Symbol.for("react.lazy"),ay=Symbol.for("react.offscreen"),Np=Symbol.iterator;function En(i){return i===null||typeof i!="object"?null:(i=Np&&i[Np]||i["@@iterator"],typeof i=="function"?i:null)}var Dt=Object.assign,Vh;function Nn(i){if(Vh===void 0)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);Vh=t&&t[1]||""}return`
`+Vh+i}var Hh=!1;function zh(i,t){if(!i||Hh)return"";Hh=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(i,[],t)}else{try{t.call()}catch(h){r=h}i.call(t.prototype)}else{try{throw Error()}catch(h){r=h}i()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),n=r.stack.split(`
`),a=s.length-1,o=n.length-1;1<=a&&0<=o&&s[a]!==n[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==n[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==n[o]){var l=`
`+s[a].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=a&&0<=o);break}}}finally{Hh=!1,Error.prepareStackTrace=e}return(i=i?i.displayName||i.name:"")?Nn(i):""}function zT(i){switch(i.tag){case 5:return Nn(i.type);case 16:return Nn("Lazy");case 13:return Nn("Suspense");case 19:return Nn("SuspenseList");case 0:case 2:case 15:return i=zh(i.type,!1),i;case 11:return i=zh(i.type.render,!1),i;case 1:return i=zh(i.type,!0),i;default:return""}}function gc(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Ms:return"Fragment";case Rs:return"Portal";case pc:return"Profiler";case vf:return"StrictMode";case mc:return"Suspense";case _c:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ny:return(i.displayName||"Context")+".Consumer";case sy:return(i._context.displayName||"Context")+".Provider";case xf:var t=i.render;return i=i.displayName,i||(i=t.displayName||t.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Tf:return t=i.displayName||null,t!==null?t:gc(i.type)||"Memo";case tr:t=i._payload,i=i._init;try{return gc(i(t))}catch{}}return null}function XT(i){var t=i.type;switch(i.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=t.render,i=i.displayName||i.name||"",t.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gc(t);case 8:return t===vf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Er(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function oy(i){var t=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $T(i){var t=oy(i)?"checked":"value",e=Object.getOwnPropertyDescriptor(i.constructor.prototype,t),r=""+i[t];if(!i.hasOwnProperty(t)&&typeof e<"u"&&typeof e.get=="function"&&typeof e.set=="function"){var s=e.get,n=e.set;return Object.defineProperty(i,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,n.call(this,a)}}),Object.defineProperty(i,t,{enumerable:e.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){i._valueTracker=null,delete i[t]}}}}function Za(i){i._valueTracker||(i._valueTracker=$T(i))}function ly(i){if(!i)return!1;var t=i._valueTracker;if(!t)return!0;var e=t.getValue(),r="";return i&&(r=oy(i)?i.checked?"true":"false":i.value),i=r,i!==e?(t.setValue(i),!0):!1}function fl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function yc(i,t){var e=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:e??i._wrapperState.initialChecked})}function Lp(i,t){var e=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;e=Er(t.value!=null?t.value:e),i._wrapperState={initialChecked:r,initialValue:e,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hy(i,t){t=t.checked,t!=null&&yf(i,"checked",t,!1)}function vc(i,t){hy(i,t);var e=Er(t.value),r=t.type;if(e!=null)r==="number"?(e===0&&i.value===""||i.value!=e)&&(i.value=""+e):i.value!==""+e&&(i.value=""+e);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}t.hasOwnProperty("value")?xc(i,t.type,e):t.hasOwnProperty("defaultValue")&&xc(i,t.type,Er(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(i.defaultChecked=!!t.defaultChecked)}function Up(i,t,e){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+i._wrapperState.initialValue,e||t===i.value||(i.value=t),i.defaultValue=t}e=i.name,e!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,e!==""&&(i.name=e)}function xc(i,t,e){(t!=="number"||fl(i.ownerDocument)!==i)&&(e==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+e&&(i.defaultValue=""+e))}var Ln=Array.isArray;function Xs(i,t,e,r){if(i=i.options,t){t={};for(var s=0;s<e.length;s++)t["$"+e[s]]=!0;for(e=0;e<i.length;e++)s=t.hasOwnProperty("$"+i[e].value),i[e].selected!==s&&(i[e].selected=s),s&&r&&(i[e].defaultSelected=!0)}else{for(e=""+Er(e),t=null,s=0;s<i.length;s++){if(i[s].value===e){i[s].selected=!0,r&&(i[s].defaultSelected=!0);return}t!==null||i[s].disabled||(t=i[s])}t!==null&&(t.selected=!0)}}function Tc(i,t){if(t.dangerouslySetInnerHTML!=null)throw Error(L(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Gp(i,t){var e=t.value;if(e==null){if(e=t.children,t=t.defaultValue,e!=null){if(t!=null)throw Error(L(92));if(Ln(e)){if(1<e.length)throw Error(L(93));e=e[0]}t=e}t==null&&(t=""),e=t}i._wrapperState={initialValue:Er(e)}}function uy(i,t){var e=Er(t.value),r=Er(t.defaultValue);e!=null&&(e=""+e,e!==i.value&&(i.value=e),t.defaultValue==null&&i.defaultValue!==e&&(i.defaultValue=e)),r!=null&&(i.defaultValue=""+r)}function Vp(i){var t=i.textContent;t===i._wrapperState.initialValue&&t!==""&&t!==null&&(i.value=t)}function cy(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ac(i,t){return i==null||i==="http://www.w3.org/1999/xhtml"?cy(t):i==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Qa,dy=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,e,r,s){MSApp.execUnsafeLocalFunction(function(){return i(t,e,r,s)})}:i}(function(i,t){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=t;else{for(Qa=Qa||document.createElement("div"),Qa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qa.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;t.firstChild;)i.appendChild(t.firstChild)}});function ca(i,t){if(t){var e=i.firstChild;if(e&&e===i.lastChild&&e.nodeType===3){e.nodeValue=t;return}}i.textContent=t}var Kn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WT=["Webkit","ms","Moz","O"];Object.keys(Kn).forEach(function(i){WT.forEach(function(t){t=t+i.charAt(0).toUpperCase()+i.substring(1),Kn[t]=Kn[i]})});function fy(i,t,e){return t==null||typeof t=="boolean"||t===""?"":e||typeof t!="number"||t===0||Kn.hasOwnProperty(i)&&Kn[i]?(""+t).trim():t+"px"}function py(i,t){i=i.style;for(var e in t)if(t.hasOwnProperty(e)){var r=e.indexOf("--")===0,s=fy(e,t[e],r);e==="float"&&(e="cssFloat"),r?i.setProperty(e,s):i[e]=s}}var YT=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ec(i,t){if(t){if(YT[i]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(L(137,i));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(L(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(L(61))}if(t.style!=null&&typeof t.style!="object")throw Error(L(62))}}function Sc(i,t){if(i.indexOf("-")===-1)return typeof t.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wc=null;function Af(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var bc=null,$s=null,Ws=null;function Hp(i){if(i=ka(i)){if(typeof bc!="function")throw Error(L(280));var t=i.stateNode;t&&(t=oh(t),bc(i.stateNode,i.type,t))}}function my(i){$s?Ws?Ws.push(i):Ws=[i]:$s=i}function _y(){if($s){var i=$s,t=Ws;if(Ws=$s=null,Hp(i),t)for(i=0;i<t.length;i++)Hp(t[i])}}function gy(i,t){return i(t)}function yy(){}var Xh=!1;function vy(i,t,e){if(Xh)return i(t,e);Xh=!0;try{return gy(i,t,e)}finally{Xh=!1,($s!==null||Ws!==null)&&(yy(),_y())}}function da(i,t){var e=i.stateNode;if(e===null)return null;var r=oh(e);if(r===null)return null;e=r[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break t;default:i=!1}if(i)return null;if(e&&typeof e!="function")throw Error(L(231,t,typeof e));return e}var Cc=!1;if(Hi)try{var Sn={};Object.defineProperty(Sn,"passive",{get:function(){Cc=!0}}),window.addEventListener("test",Sn,Sn),window.removeEventListener("test",Sn,Sn)}catch{Cc=!1}function jT(i,t,e,r,s,n,a,o,l){var h=Array.prototype.slice.call(arguments,3);try{t.apply(e,h)}catch(u){this.onError(u)}}var Zn=!1,pl=null,ml=!1,Ic=null,qT={onError:function(i){Zn=!0,pl=i}};function KT(i,t,e,r,s,n,a,o,l){Zn=!1,pl=null,jT.apply(qT,arguments)}function ZT(i,t,e,r,s,n,a,o,l){if(KT.apply(this,arguments),Zn){if(Zn){var h=pl;Zn=!1,pl=null}else throw Error(L(198));ml||(ml=!0,Ic=h)}}function ds(i){var t=i,e=i;if(i.alternate)for(;t.return;)t=t.return;else{i=t;do t=i,t.flags&4098&&(e=t.return),i=t.return;while(i)}return t.tag===3?e:null}function xy(i){if(i.tag===13){var t=i.memoizedState;if(t===null&&(i=i.alternate,i!==null&&(t=i.memoizedState)),t!==null)return t.dehydrated}return null}function zp(i){if(ds(i)!==i)throw Error(L(188))}function QT(i){var t=i.alternate;if(!t){if(t=ds(i),t===null)throw Error(L(188));return t!==i?null:i}for(var e=i,r=t;;){var s=e.return;if(s===null)break;var n=s.alternate;if(n===null){if(r=s.return,r!==null){e=r;continue}break}if(s.child===n.child){for(n=s.child;n;){if(n===e)return zp(s),i;if(n===r)return zp(s),t;n=n.sibling}throw Error(L(188))}if(e.return!==r.return)e=s,r=n;else{for(var a=!1,o=s.child;o;){if(o===e){a=!0,e=s,r=n;break}if(o===r){a=!0,r=s,e=n;break}o=o.sibling}if(!a){for(o=n.child;o;){if(o===e){a=!0,e=n,r=s;break}if(o===r){a=!0,r=n,e=s;break}o=o.sibling}if(!a)throw Error(L(189))}}if(e.alternate!==r)throw Error(L(190))}if(e.tag!==3)throw Error(L(188));return e.stateNode.current===e?i:t}function Ty(i){return i=QT(i),i!==null?Ay(i):null}function Ay(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var t=Ay(i);if(t!==null)return t;i=i.sibling}return null}var Ey=Ie.unstable_scheduleCallback,Xp=Ie.unstable_cancelCallback,JT=Ie.unstable_shouldYield,t1=Ie.unstable_requestPaint,Bt=Ie.unstable_now,e1=Ie.unstable_getCurrentPriorityLevel,Ef=Ie.unstable_ImmediatePriority,Sy=Ie.unstable_UserBlockingPriority,_l=Ie.unstable_NormalPriority,i1=Ie.unstable_LowPriority,wy=Ie.unstable_IdlePriority,rh=null,Ti=null;function r1(i){if(Ti&&typeof Ti.onCommitFiberRoot=="function")try{Ti.onCommitFiberRoot(rh,i,void 0,(i.current.flags&128)===128)}catch{}}var Qe=Math.clz32?Math.clz32:a1,s1=Math.log,n1=Math.LN2;function a1(i){return i>>>=0,i===0?32:31-(s1(i)/n1|0)|0}var Ja=64,to=4194304;function Un(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function gl(i,t){var e=i.pendingLanes;if(e===0)return 0;var r=0,s=i.suspendedLanes,n=i.pingedLanes,a=e&268435455;if(a!==0){var o=a&~s;o!==0?r=Un(o):(n&=a,n!==0&&(r=Un(n)))}else a=e&~s,a!==0?r=Un(a):n!==0&&(r=Un(n));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,n=t&-t,s>=n||s===16&&(n&4194240)!==0))return t;if(r&4&&(r|=e&16),t=i.entangledLanes,t!==0)for(i=i.entanglements,t&=r;0<t;)e=31-Qe(t),s=1<<e,r|=i[e],t&=~s;return r}function o1(i,t){switch(i){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l1(i,t){for(var e=i.suspendedLanes,r=i.pingedLanes,s=i.expirationTimes,n=i.pendingLanes;0<n;){var a=31-Qe(n),o=1<<a,l=s[a];l===-1?(!(o&e)||o&r)&&(s[a]=o1(o,t)):l<=t&&(i.expiredLanes|=o),n&=~o}}function Dc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function by(){var i=Ja;return Ja<<=1,!(Ja&4194240)&&(Ja=64),i}function $h(i){for(var t=[],e=0;31>e;e++)t.push(i);return t}function Oa(i,t,e){i.pendingLanes|=t,t!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,t=31-Qe(t),i[t]=e}function h1(i,t){var e=i.pendingLanes&~t;i.pendingLanes=t,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=t,i.mutableReadLanes&=t,i.entangledLanes&=t,t=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<e;){var s=31-Qe(e),n=1<<s;t[s]=0,r[s]=-1,i[s]=-1,e&=~n}}function Sf(i,t){var e=i.entangledLanes|=t;for(i=i.entanglements;e;){var r=31-Qe(e),s=1<<r;s&t|i[r]&t&&(i[r]|=t),e&=~s}}var _t=0;function Cy(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Iy,wf,Dy,Ry,My,Rc=!1,eo=[],fr=null,pr=null,mr=null,fa=new Map,pa=new Map,rr=[],u1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $p(i,t){switch(i){case"focusin":case"focusout":fr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":mr=null;break;case"pointerover":case"pointerout":fa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":pa.delete(t.pointerId)}}function wn(i,t,e,r,s,n){return i===null||i.nativeEvent!==n?(i={blockedOn:t,domEventName:e,eventSystemFlags:r,nativeEvent:n,targetContainers:[s]},t!==null&&(t=ka(t),t!==null&&wf(t)),i):(i.eventSystemFlags|=r,t=i.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),i)}function c1(i,t,e,r,s){switch(t){case"focusin":return fr=wn(fr,i,t,e,r,s),!0;case"dragenter":return pr=wn(pr,i,t,e,r,s),!0;case"mouseover":return mr=wn(mr,i,t,e,r,s),!0;case"pointerover":var n=s.pointerId;return fa.set(n,wn(fa.get(n)||null,i,t,e,r,s)),!0;case"gotpointercapture":return n=s.pointerId,pa.set(n,wn(pa.get(n)||null,i,t,e,r,s)),!0}return!1}function Py(i){var t=zr(i.target);if(t!==null){var e=ds(t);if(e!==null){if(t=e.tag,t===13){if(t=xy(e),t!==null){i.blockedOn=t,My(i.priority,function(){Dy(e)});return}}else if(t===3&&e.stateNode.current.memoizedState.isDehydrated){i.blockedOn=e.tag===3?e.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Go(i){if(i.blockedOn!==null)return!1;for(var t=i.targetContainers;0<t.length;){var e=Mc(i.domEventName,i.eventSystemFlags,t[0],i.nativeEvent);if(e===null){e=i.nativeEvent;var r=new e.constructor(e.type,e);wc=r,e.target.dispatchEvent(r),wc=null}else return t=ka(e),t!==null&&wf(t),i.blockedOn=e,!1;t.shift()}return!0}function Wp(i,t,e){Go(i)&&e.delete(t)}function d1(){Rc=!1,fr!==null&&Go(fr)&&(fr=null),pr!==null&&Go(pr)&&(pr=null),mr!==null&&Go(mr)&&(mr=null),fa.forEach(Wp),pa.forEach(Wp)}function bn(i,t){i.blockedOn===t&&(i.blockedOn=null,Rc||(Rc=!0,Ie.unstable_scheduleCallback(Ie.unstable_NormalPriority,d1)))}function ma(i){function t(s){return bn(s,i)}if(0<eo.length){bn(eo[0],i);for(var e=1;e<eo.length;e++){var r=eo[e];r.blockedOn===i&&(r.blockedOn=null)}}for(fr!==null&&bn(fr,i),pr!==null&&bn(pr,i),mr!==null&&bn(mr,i),fa.forEach(t),pa.forEach(t),e=0;e<rr.length;e++)r=rr[e],r.blockedOn===i&&(r.blockedOn=null);for(;0<rr.length&&(e=rr[0],e.blockedOn===null);)Py(e),e.blockedOn===null&&rr.shift()}var Ys=qi.ReactCurrentBatchConfig,yl=!0;function f1(i,t,e,r){var s=_t,n=Ys.transition;Ys.transition=null;try{_t=1,bf(i,t,e,r)}finally{_t=s,Ys.transition=n}}function p1(i,t,e,r){var s=_t,n=Ys.transition;Ys.transition=null;try{_t=4,bf(i,t,e,r)}finally{_t=s,Ys.transition=n}}function bf(i,t,e,r){if(yl){var s=Mc(i,t,e,r);if(s===null)eu(i,t,r,vl,e),$p(i,r);else if(c1(s,i,t,e,r))r.stopPropagation();else if($p(i,r),t&4&&-1<u1.indexOf(i)){for(;s!==null;){var n=ka(s);if(n!==null&&Iy(n),n=Mc(i,t,e,r),n===null&&eu(i,t,r,vl,e),n===s)break;s=n}s!==null&&r.stopPropagation()}else eu(i,t,r,null,e)}}var vl=null;function Mc(i,t,e,r){if(vl=null,i=Af(r),i=zr(i),i!==null)if(t=ds(i),t===null)i=null;else if(e=t.tag,e===13){if(i=xy(t),i!==null)return i;i=null}else if(e===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;i=null}else t!==i&&(i=null);return vl=i,null}function Fy(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(e1()){case Ef:return 1;case Sy:return 4;case _l:case i1:return 16;case wy:return 536870912;default:return 16}default:return 16}}var or=null,Cf=null,Vo=null;function Oy(){if(Vo)return Vo;var i,t=Cf,e=t.length,r,s="value"in or?or.value:or.textContent,n=s.length;for(i=0;i<e&&t[i]===s[i];i++);var a=e-i;for(r=1;r<=a&&t[e-r]===s[n-r];r++);return Vo=s.slice(i,1<r?1-r:void 0)}function Ho(i){var t=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&t===13&&(i=13)):i=t,i===10&&(i=13),32<=i||i===13?i:0}function io(){return!0}function Yp(){return!1}function Re(i){function t(e,r,s,n,a){this._reactName=e,this._targetInst=s,this.type=r,this.nativeEvent=n,this.target=a,this.currentTarget=null;for(var o in i)i.hasOwnProperty(o)&&(e=i[o],this[o]=e?e(n):n[o]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?io:Yp,this.isPropagationStopped=Yp,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!="unknown"&&(e.returnValue=!1),this.isDefaultPrevented=io)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!="unknown"&&(e.cancelBubble=!0),this.isPropagationStopped=io)},persist:function(){},isPersistent:io}),t}var gn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},If=Re(gn),Ba=Dt({},gn,{view:0,detail:0}),m1=Re(Ba),Wh,Yh,Cn,sh=Dt({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Df,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Cn&&(Cn&&i.type==="mousemove"?(Wh=i.screenX-Cn.screenX,Yh=i.screenY-Cn.screenY):Yh=Wh=0,Cn=i),Wh)},movementY:function(i){return"movementY"in i?i.movementY:Yh}}),jp=Re(sh),_1=Dt({},sh,{dataTransfer:0}),g1=Re(_1),y1=Dt({},Ba,{relatedTarget:0}),jh=Re(y1),v1=Dt({},gn,{animationName:0,elapsedTime:0,pseudoElement:0}),x1=Re(v1),T1=Dt({},gn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),A1=Re(T1),E1=Dt({},gn,{data:0}),qp=Re(E1),S1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C1(i){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(i):(i=b1[i])?!!t[i]:!1}function Df(){return C1}var I1=Dt({},Ba,{key:function(i){if(i.key){var t=S1[i.key]||i.key;if(t!=="Unidentified")return t}return i.type==="keypress"?(i=Ho(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?w1[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Df,charCode:function(i){return i.type==="keypress"?Ho(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ho(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),D1=Re(I1),R1=Dt({},sh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kp=Re(R1),M1=Dt({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Df}),P1=Re(M1),F1=Dt({},gn,{propertyName:0,elapsedTime:0,pseudoElement:0}),O1=Re(F1),B1=Dt({},sh,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),k1=Re(B1),N1=[9,13,27,32],Rf=Hi&&"CompositionEvent"in window,Qn=null;Hi&&"documentMode"in document&&(Qn=document.documentMode);var L1=Hi&&"TextEvent"in window&&!Qn,By=Hi&&(!Rf||Qn&&8<Qn&&11>=Qn),Zp=" ",Qp=!1;function ky(i,t){switch(i){case"keyup":return N1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ny(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ps=!1;function U1(i,t){switch(i){case"compositionend":return Ny(t);case"keypress":return t.which!==32?null:(Qp=!0,Zp);case"textInput":return i=t.data,i===Zp&&Qp?null:i;default:return null}}function G1(i,t){if(Ps)return i==="compositionend"||!Rf&&ky(i,t)?(i=Oy(),Vo=Cf=or=null,Ps=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return By&&t.locale!=="ko"?null:t.data;default:return null}}var V1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jp(i){var t=i&&i.nodeName&&i.nodeName.toLowerCase();return t==="input"?!!V1[i.type]:t==="textarea"}function Ly(i,t,e,r){my(r),t=xl(t,"onChange"),0<t.length&&(e=new If("onChange","change",null,e,r),i.push({event:e,listeners:t}))}var Jn=null,_a=null;function H1(i){qy(i,0)}function nh(i){var t=Bs(i);if(ly(t))return i}function z1(i,t){if(i==="change")return t}var Uy=!1;if(Hi){var qh;if(Hi){var Kh="oninput"in document;if(!Kh){var tm=document.createElement("div");tm.setAttribute("oninput","return;"),Kh=typeof tm.oninput=="function"}qh=Kh}else qh=!1;Uy=qh&&(!document.documentMode||9<document.documentMode)}function em(){Jn&&(Jn.detachEvent("onpropertychange",Gy),_a=Jn=null)}function Gy(i){if(i.propertyName==="value"&&nh(_a)){var t=[];Ly(t,_a,i,Af(i)),vy(H1,t)}}function X1(i,t,e){i==="focusin"?(em(),Jn=t,_a=e,Jn.attachEvent("onpropertychange",Gy)):i==="focusout"&&em()}function $1(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return nh(_a)}function W1(i,t){if(i==="click")return nh(t)}function Y1(i,t){if(i==="input"||i==="change")return nh(t)}function j1(i,t){return i===t&&(i!==0||1/i===1/t)||i!==i&&t!==t}var ii=typeof Object.is=="function"?Object.is:j1;function ga(i,t){if(ii(i,t))return!0;if(typeof i!="object"||i===null||typeof t!="object"||t===null)return!1;var e=Object.keys(i),r=Object.keys(t);if(e.length!==r.length)return!1;for(r=0;r<e.length;r++){var s=e[r];if(!fc.call(t,s)||!ii(i[s],t[s]))return!1}return!0}function im(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function rm(i,t){var e=im(i);i=0;for(var r;e;){if(e.nodeType===3){if(r=i+e.textContent.length,i<=t&&r>=t)return{node:e,offset:t-i};i=r}t:{for(;e;){if(e.nextSibling){e=e.nextSibling;break t}e=e.parentNode}e=void 0}e=im(e)}}function Vy(i,t){return i&&t?i===t?!0:i&&i.nodeType===3?!1:t&&t.nodeType===3?Vy(i,t.parentNode):"contains"in i?i.contains(t):i.compareDocumentPosition?!!(i.compareDocumentPosition(t)&16):!1:!1}function Hy(){for(var i=window,t=fl();t instanceof i.HTMLIFrameElement;){try{var e=typeof t.contentWindow.location.href=="string"}catch{e=!1}if(e)i=t.contentWindow;else break;t=fl(i.document)}return t}function Mf(i){var t=i&&i.nodeName&&i.nodeName.toLowerCase();return t&&(t==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||t==="textarea"||i.contentEditable==="true")}function q1(i){var t=Hy(),e=i.focusedElem,r=i.selectionRange;if(t!==e&&e&&e.ownerDocument&&Vy(e.ownerDocument.documentElement,e)){if(r!==null&&Mf(e)){if(t=r.start,i=r.end,i===void 0&&(i=t),"selectionStart"in e)e.selectionStart=t,e.selectionEnd=Math.min(i,e.value.length);else if(i=(t=e.ownerDocument||document)&&t.defaultView||window,i.getSelection){i=i.getSelection();var s=e.textContent.length,n=Math.min(r.start,s);r=r.end===void 0?n:Math.min(r.end,s),!i.extend&&n>r&&(s=r,r=n,n=s),s=rm(e,n);var a=rm(e,r);s&&a&&(i.rangeCount!==1||i.anchorNode!==s.node||i.anchorOffset!==s.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),i.removeAllRanges(),n>r?(i.addRange(t),i.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),i.addRange(t)))}}for(t=[],i=e;i=i.parentNode;)i.nodeType===1&&t.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof e.focus=="function"&&e.focus(),e=0;e<t.length;e++)i=t[e],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var K1=Hi&&"documentMode"in document&&11>=document.documentMode,Fs=null,Pc=null,ta=null,Fc=!1;function sm(i,t,e){var r=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;Fc||Fs==null||Fs!==fl(r)||(r=Fs,"selectionStart"in r&&Mf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ta&&ga(ta,r)||(ta=r,r=xl(Pc,"onSelect"),0<r.length&&(t=new If("onSelect","select",null,t,e),i.push({event:t,listeners:r}),t.target=Fs)))}function ro(i,t){var e={};return e[i.toLowerCase()]=t.toLowerCase(),e["Webkit"+i]="webkit"+t,e["Moz"+i]="moz"+t,e}var Os={animationend:ro("Animation","AnimationEnd"),animationiteration:ro("Animation","AnimationIteration"),animationstart:ro("Animation","AnimationStart"),transitionend:ro("Transition","TransitionEnd")},Zh={},zy={};Hi&&(zy=document.createElement("div").style,"AnimationEvent"in window||(delete Os.animationend.animation,delete Os.animationiteration.animation,delete Os.animationstart.animation),"TransitionEvent"in window||delete Os.transitionend.transition);function ah(i){if(Zh[i])return Zh[i];if(!Os[i])return i;var t=Os[i],e;for(e in t)if(t.hasOwnProperty(e)&&e in zy)return Zh[i]=t[e];return i}var Xy=ah("animationend"),$y=ah("animationiteration"),Wy=ah("animationstart"),Yy=ah("transitionend"),jy=new Map,nm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function br(i,t){jy.set(i,t),cs(t,[i])}for(var Qh=0;Qh<nm.length;Qh++){var Jh=nm[Qh],Z1=Jh.toLowerCase(),Q1=Jh[0].toUpperCase()+Jh.slice(1);br(Z1,"on"+Q1)}br(Xy,"onAnimationEnd");br($y,"onAnimationIteration");br(Wy,"onAnimationStart");br("dblclick","onDoubleClick");br("focusin","onFocus");br("focusout","onBlur");br(Yy,"onTransitionEnd");nn("onMouseEnter",["mouseout","mouseover"]);nn("onMouseLeave",["mouseout","mouseover"]);nn("onPointerEnter",["pointerout","pointerover"]);nn("onPointerLeave",["pointerout","pointerover"]);cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cs("onBeforeInput",["compositionend","keypress","textInput","paste"]);cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),J1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gn));function am(i,t,e){var r=i.type||"unknown-event";i.currentTarget=e,ZT(r,t,void 0,i),i.currentTarget=null}function qy(i,t){t=(t&4)!==0;for(var e=0;e<i.length;e++){var r=i[e],s=r.event;r=r.listeners;t:{var n=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,h=o.currentTarget;if(o=o.listener,l!==n&&s.isPropagationStopped())break t;am(s,o,h),n=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,h=o.currentTarget,o=o.listener,l!==n&&s.isPropagationStopped())break t;am(s,o,h),n=l}}}if(ml)throw i=Ic,ml=!1,Ic=null,i}function xt(i,t){var e=t[Lc];e===void 0&&(e=t[Lc]=new Set);var r=i+"__bubble";e.has(r)||(Ky(t,i,2,!1),e.add(r))}function tu(i,t,e){var r=0;t&&(r|=4),Ky(e,i,r,t)}var so="_reactListening"+Math.random().toString(36).slice(2);function ya(i){if(!i[so]){i[so]=!0,ry.forEach(function(e){e!=="selectionchange"&&(J1.has(e)||tu(e,!1,i),tu(e,!0,i))});var t=i.nodeType===9?i:i.ownerDocument;t===null||t[so]||(t[so]=!0,tu("selectionchange",!1,t))}}function Ky(i,t,e,r){switch(Fy(t)){case 1:var s=f1;break;case 4:s=p1;break;default:s=bf}e=s.bind(null,t,e,i),s=void 0,!Cc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?i.addEventListener(t,e,{capture:!0,passive:s}):i.addEventListener(t,e,!0):s!==void 0?i.addEventListener(t,e,{passive:s}):i.addEventListener(t,e,!1)}function eu(i,t,e,r,s){var n=r;if(!(t&1)&&!(t&2)&&r!==null)t:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=zr(o),a===null)return;if(l=a.tag,l===5||l===6){r=n=a;continue t}o=o.parentNode}}r=r.return}vy(function(){var h=n,u=Af(e),d=[];t:{var c=jy.get(i);if(c!==void 0){var f=If,p=i;switch(i){case"keypress":if(Ho(e)===0)break t;case"keydown":case"keyup":f=D1;break;case"focusin":p="focus",f=jh;break;case"focusout":p="blur",f=jh;break;case"beforeblur":case"afterblur":f=jh;break;case"click":if(e.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=jp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=g1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=P1;break;case Xy:case $y:case Wy:f=x1;break;case Yy:f=O1;break;case"scroll":f=m1;break;case"wheel":f=k1;break;case"copy":case"cut":case"paste":f=A1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Kp}var y=(t&4)!==0,x=!y&&i==="scroll",m=y?c!==null?c+"Capture":null:c;y=[];for(var _=h,g;_!==null;){g=_;var T=g.stateNode;if(g.tag===5&&T!==null&&(g=T,m!==null&&(T=da(_,m),T!=null&&y.push(va(_,T,g)))),x)break;_=_.return}0<y.length&&(c=new f(c,p,null,e,u),d.push({event:c,listeners:y}))}}if(!(t&7)){t:{if(c=i==="mouseover"||i==="pointerover",f=i==="mouseout"||i==="pointerout",c&&e!==wc&&(p=e.relatedTarget||e.fromElement)&&(zr(p)||p[zi]))break t;if((f||c)&&(c=u.window===u?u:(c=u.ownerDocument)?c.defaultView||c.parentWindow:window,f?(p=e.relatedTarget||e.toElement,f=h,p=p?zr(p):null,p!==null&&(x=ds(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=h),f!==p)){if(y=jp,T="onMouseLeave",m="onMouseEnter",_="mouse",(i==="pointerout"||i==="pointerover")&&(y=Kp,T="onPointerLeave",m="onPointerEnter",_="pointer"),x=f==null?c:Bs(f),g=p==null?c:Bs(p),c=new y(T,_+"leave",f,e,u),c.target=x,c.relatedTarget=g,T=null,zr(u)===h&&(y=new y(m,_+"enter",p,e,u),y.target=g,y.relatedTarget=x,T=y),x=T,f&&p)e:{for(y=f,m=p,_=0,g=y;g;g=_s(g))_++;for(g=0,T=m;T;T=_s(T))g++;for(;0<_-g;)y=_s(y),_--;for(;0<g-_;)m=_s(m),g--;for(;_--;){if(y===m||m!==null&&y===m.alternate)break e;y=_s(y),m=_s(m)}y=null}else y=null;f!==null&&om(d,c,f,y,!1),p!==null&&x!==null&&om(d,x,p,y,!0)}}t:{if(c=h?Bs(h):window,f=c.nodeName&&c.nodeName.toLowerCase(),f==="select"||f==="input"&&c.type==="file")var A=z1;else if(Jp(c))if(Uy)A=Y1;else{A=$1;var S=X1}else(f=c.nodeName)&&f.toLowerCase()==="input"&&(c.type==="checkbox"||c.type==="radio")&&(A=W1);if(A&&(A=A(i,h))){Ly(d,A,e,u);break t}S&&S(i,c,h),i==="focusout"&&(S=c._wrapperState)&&S.controlled&&c.type==="number"&&xc(c,"number",c.value)}switch(S=h?Bs(h):window,i){case"focusin":(Jp(S)||S.contentEditable==="true")&&(Fs=S,Pc=h,ta=null);break;case"focusout":ta=Pc=Fs=null;break;case"mousedown":Fc=!0;break;case"contextmenu":case"mouseup":case"dragend":Fc=!1,sm(d,e,u);break;case"selectionchange":if(K1)break;case"keydown":case"keyup":sm(d,e,u)}var w;if(Rf)t:{switch(i){case"compositionstart":var E="onCompositionStart";break t;case"compositionend":E="onCompositionEnd";break t;case"compositionupdate":E="onCompositionUpdate";break t}E=void 0}else Ps?ky(i,e)&&(E="onCompositionEnd"):i==="keydown"&&e.keyCode===229&&(E="onCompositionStart");E&&(By&&e.locale!=="ko"&&(Ps||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ps&&(w=Oy()):(or=u,Cf="value"in or?or.value:or.textContent,Ps=!0)),S=xl(h,E),0<S.length&&(E=new qp(E,i,null,e,u),d.push({event:E,listeners:S}),w?E.data=w:(w=Ny(e),w!==null&&(E.data=w)))),(w=L1?U1(i,e):G1(i,e))&&(h=xl(h,"onBeforeInput"),0<h.length&&(u=new qp("onBeforeInput","beforeinput",null,e,u),d.push({event:u,listeners:h}),u.data=w))}qy(d,t)})}function va(i,t,e){return{instance:i,listener:t,currentTarget:e}}function xl(i,t){for(var e=t+"Capture",r=[];i!==null;){var s=i,n=s.stateNode;s.tag===5&&n!==null&&(s=n,n=da(i,e),n!=null&&r.unshift(va(i,n,s)),n=da(i,t),n!=null&&r.push(va(i,n,s))),i=i.return}return r}function _s(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function om(i,t,e,r,s){for(var n=t._reactName,a=[];e!==null&&e!==r;){var o=e,l=o.alternate,h=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&h!==null&&(o=h,s?(l=da(e,n),l!=null&&a.unshift(va(e,l,o))):s||(l=da(e,n),l!=null&&a.push(va(e,l,o)))),e=e.return}a.length!==0&&i.push({event:t,listeners:a})}var tA=/\r\n?/g,eA=/\u0000|\uFFFD/g;function lm(i){return(typeof i=="string"?i:""+i).replace(tA,`
`).replace(eA,"")}function no(i,t,e){if(t=lm(t),lm(i)!==t&&e)throw Error(L(425))}function Tl(){}var Oc=null,Bc=null;function kc(i,t){return i==="textarea"||i==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Nc=typeof setTimeout=="function"?setTimeout:void 0,iA=typeof clearTimeout=="function"?clearTimeout:void 0,hm=typeof Promise=="function"?Promise:void 0,rA=typeof queueMicrotask=="function"?queueMicrotask:typeof hm<"u"?function(i){return hm.resolve(null).then(i).catch(sA)}:Nc;function sA(i){setTimeout(function(){throw i})}function iu(i,t){var e=t,r=0;do{var s=e.nextSibling;if(i.removeChild(e),s&&s.nodeType===8)if(e=s.data,e==="/$"){if(r===0){i.removeChild(s),ma(t);return}r--}else e!=="$"&&e!=="$?"&&e!=="$!"||r++;e=s}while(e);ma(t)}function _r(i){for(;i!=null;i=i.nextSibling){var t=i.nodeType;if(t===1||t===3)break;if(t===8){if(t=i.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return i}function um(i){i=i.previousSibling;for(var t=0;i;){if(i.nodeType===8){var e=i.data;if(e==="$"||e==="$!"||e==="$?"){if(t===0)return i;t--}else e==="/$"&&t++}i=i.previousSibling}return null}var yn=Math.random().toString(36).slice(2),vi="__reactFiber$"+yn,xa="__reactProps$"+yn,zi="__reactContainer$"+yn,Lc="__reactEvents$"+yn,nA="__reactListeners$"+yn,aA="__reactHandles$"+yn;function zr(i){var t=i[vi];if(t)return t;for(var e=i.parentNode;e;){if(t=e[zi]||e[vi]){if(e=t.alternate,t.child!==null||e!==null&&e.child!==null)for(i=um(i);i!==null;){if(e=i[vi])return e;i=um(i)}return t}i=e,e=i.parentNode}return null}function ka(i){return i=i[vi]||i[zi],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Bs(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(L(33))}function oh(i){return i[xa]||null}var Uc=[],ks=-1;function Cr(i){return{current:i}}function At(i){0>ks||(i.current=Uc[ks],Uc[ks]=null,ks--)}function yt(i,t){ks++,Uc[ks]=i.current,i.current=t}var Sr={},ae=Cr(Sr),xe=Cr(!1),es=Sr;function an(i,t){var e=i.type.contextTypes;if(!e)return Sr;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},n;for(n in e)s[n]=t[n];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=t,i.__reactInternalMemoizedMaskedChildContext=s),s}function Te(i){return i=i.childContextTypes,i!=null}function Al(){At(xe),At(ae)}function cm(i,t,e){if(ae.current!==Sr)throw Error(L(168));yt(ae,t),yt(xe,e)}function Zy(i,t,e){var r=i.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return e;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(L(108,XT(i)||"Unknown",s));return Dt({},e,r)}function El(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Sr,es=ae.current,yt(ae,i),yt(xe,xe.current),!0}function dm(i,t,e){var r=i.stateNode;if(!r)throw Error(L(169));e?(i=Zy(i,t,es),r.__reactInternalMemoizedMergedChildContext=i,At(xe),At(ae),yt(ae,i)):At(xe),yt(xe,e)}var Fi=null,lh=!1,ru=!1;function Qy(i){Fi===null?Fi=[i]:Fi.push(i)}function oA(i){lh=!0,Qy(i)}function Ir(){if(!ru&&Fi!==null){ru=!0;var i=0,t=_t;try{var e=Fi;for(_t=1;i<e.length;i++){var r=e[i];do r=r(!0);while(r!==null)}Fi=null,lh=!1}catch(s){throw Fi!==null&&(Fi=Fi.slice(i+1)),Ey(Ef,Ir),s}finally{_t=t,ru=!1}}return null}var Ns=[],Ls=0,Sl=null,wl=0,Pe=[],Fe=0,is=null,Oi=1,Bi="";function Fr(i,t){Ns[Ls++]=wl,Ns[Ls++]=Sl,Sl=i,wl=t}function Jy(i,t,e){Pe[Fe++]=Oi,Pe[Fe++]=Bi,Pe[Fe++]=is,is=i;var r=Oi;i=Bi;var s=32-Qe(r)-1;r&=~(1<<s),e+=1;var n=32-Qe(t)+s;if(30<n){var a=s-s%5;n=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Oi=1<<32-Qe(t)+s|e<<s|r,Bi=n+i}else Oi=1<<n|e<<s|r,Bi=i}function Pf(i){i.return!==null&&(Fr(i,1),Jy(i,1,0))}function Ff(i){for(;i===Sl;)Sl=Ns[--Ls],Ns[Ls]=null,wl=Ns[--Ls],Ns[Ls]=null;for(;i===is;)is=Pe[--Fe],Pe[Fe]=null,Bi=Pe[--Fe],Pe[Fe]=null,Oi=Pe[--Fe],Pe[Fe]=null}var Ce=null,be=null,wt=!1,Ke=null;function t0(i,t){var e=ke(5,null,null,0);e.elementType="DELETED",e.stateNode=t,e.return=i,t=i.deletions,t===null?(i.deletions=[e],i.flags|=16):t.push(e)}function fm(i,t){switch(i.tag){case 5:var e=i.type;return t=t.nodeType!==1||e.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(i.stateNode=t,Ce=i,be=_r(t.firstChild),!0):!1;case 6:return t=i.pendingProps===""||t.nodeType!==3?null:t,t!==null?(i.stateNode=t,Ce=i,be=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(e=is!==null?{id:Oi,overflow:Bi}:null,i.memoizedState={dehydrated:t,treeContext:e,retryLane:1073741824},e=ke(18,null,null,0),e.stateNode=t,e.return=i,i.child=e,Ce=i,be=null,!0):!1;default:return!1}}function Gc(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Vc(i){if(wt){var t=be;if(t){var e=t;if(!fm(i,t)){if(Gc(i))throw Error(L(418));t=_r(e.nextSibling);var r=Ce;t&&fm(i,t)?t0(r,e):(i.flags=i.flags&-4097|2,wt=!1,Ce=i)}}else{if(Gc(i))throw Error(L(418));i.flags=i.flags&-4097|2,wt=!1,Ce=i}}}function pm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ce=i}function ao(i){if(i!==Ce)return!1;if(!wt)return pm(i),wt=!0,!1;var t;if((t=i.tag!==3)&&!(t=i.tag!==5)&&(t=i.type,t=t!=="head"&&t!=="body"&&!kc(i.type,i.memoizedProps)),t&&(t=be)){if(Gc(i))throw e0(),Error(L(418));for(;t;)t0(i,t),t=_r(t.nextSibling)}if(pm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(L(317));t:{for(i=i.nextSibling,t=0;i;){if(i.nodeType===8){var e=i.data;if(e==="/$"){if(t===0){be=_r(i.nextSibling);break t}t--}else e!=="$"&&e!=="$!"&&e!=="$?"||t++}i=i.nextSibling}be=null}}else be=Ce?_r(i.stateNode.nextSibling):null;return!0}function e0(){for(var i=be;i;)i=_r(i.nextSibling)}function on(){be=Ce=null,wt=!1}function Of(i){Ke===null?Ke=[i]:Ke.push(i)}var lA=qi.ReactCurrentBatchConfig;function In(i,t,e){if(i=e.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(e._owner){if(e=e._owner,e){if(e.tag!==1)throw Error(L(309));var r=e.stateNode}if(!r)throw Error(L(147,i));var s=r,n=""+i;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(a){var o=s.refs;a===null?delete o[n]:o[n]=a},t._stringRef=n,t)}if(typeof i!="string")throw Error(L(284));if(!e._owner)throw Error(L(290,i))}return i}function oo(i,t){throw i=Object.prototype.toString.call(t),Error(L(31,i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i))}function mm(i){var t=i._init;return t(i._payload)}function i0(i){function t(m,_){if(i){var g=m.deletions;g===null?(m.deletions=[_],m.flags|=16):g.push(_)}}function e(m,_){if(!i)return null;for(;_!==null;)t(m,_),_=_.sibling;return null}function r(m,_){for(m=new Map;_!==null;)_.key!==null?m.set(_.key,_):m.set(_.index,_),_=_.sibling;return m}function s(m,_){return m=xr(m,_),m.index=0,m.sibling=null,m}function n(m,_,g){return m.index=g,i?(g=m.alternate,g!==null?(g=g.index,g<_?(m.flags|=2,_):g):(m.flags|=2,_)):(m.flags|=1048576,_)}function a(m){return i&&m.alternate===null&&(m.flags|=2),m}function o(m,_,g,T){return _===null||_.tag!==6?(_=uu(g,m.mode,T),_.return=m,_):(_=s(_,g),_.return=m,_)}function l(m,_,g,T){var A=g.type;return A===Ms?u(m,_,g.props.children,T,g.key):_!==null&&(_.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===tr&&mm(A)===_.type)?(T=s(_,g.props),T.ref=In(m,_,g),T.return=m,T):(T=qo(g.type,g.key,g.props,null,m.mode,T),T.ref=In(m,_,g),T.return=m,T)}function h(m,_,g,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==g.containerInfo||_.stateNode.implementation!==g.implementation?(_=cu(g,m.mode,T),_.return=m,_):(_=s(_,g.children||[]),_.return=m,_)}function u(m,_,g,T,A){return _===null||_.tag!==7?(_=qr(g,m.mode,T,A),_.return=m,_):(_=s(_,g),_.return=m,_)}function d(m,_,g){if(typeof _=="string"&&_!==""||typeof _=="number")return _=uu(""+_,m.mode,g),_.return=m,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ka:return g=qo(_.type,_.key,_.props,null,m.mode,g),g.ref=In(m,null,_),g.return=m,g;case Rs:return _=cu(_,m.mode,g),_.return=m,_;case tr:var T=_._init;return d(m,T(_._payload),g)}if(Ln(_)||En(_))return _=qr(_,m.mode,g,null),_.return=m,_;oo(m,_)}return null}function c(m,_,g,T){var A=_!==null?_.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return A!==null?null:o(m,_,""+g,T);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ka:return g.key===A?l(m,_,g,T):null;case Rs:return g.key===A?h(m,_,g,T):null;case tr:return A=g._init,c(m,_,A(g._payload),T)}if(Ln(g)||En(g))return A!==null?null:u(m,_,g,T,null);oo(m,g)}return null}function f(m,_,g,T,A){if(typeof T=="string"&&T!==""||typeof T=="number")return m=m.get(g)||null,o(_,m,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ka:return m=m.get(T.key===null?g:T.key)||null,l(_,m,T,A);case Rs:return m=m.get(T.key===null?g:T.key)||null,h(_,m,T,A);case tr:var S=T._init;return f(m,_,g,S(T._payload),A)}if(Ln(T)||En(T))return m=m.get(g)||null,u(_,m,T,A,null);oo(_,T)}return null}function p(m,_,g,T){for(var A=null,S=null,w=_,E=_=0,C=null;w!==null&&E<g.length;E++){w.index>E?(C=w,w=null):C=w.sibling;var D=c(m,w,g[E],T);if(D===null){w===null&&(w=C);break}i&&w&&D.alternate===null&&t(m,w),_=n(D,_,E),S===null?A=D:S.sibling=D,S=D,w=C}if(E===g.length)return e(m,w),wt&&Fr(m,E),A;if(w===null){for(;E<g.length;E++)w=d(m,g[E],T),w!==null&&(_=n(w,_,E),S===null?A=w:S.sibling=w,S=w);return wt&&Fr(m,E),A}for(w=r(m,w);E<g.length;E++)C=f(w,m,E,g[E],T),C!==null&&(i&&C.alternate!==null&&w.delete(C.key===null?E:C.key),_=n(C,_,E),S===null?A=C:S.sibling=C,S=C);return i&&w.forEach(function(k){return t(m,k)}),wt&&Fr(m,E),A}function y(m,_,g,T){var A=En(g);if(typeof A!="function")throw Error(L(150));if(g=A.call(g),g==null)throw Error(L(151));for(var S=A=null,w=_,E=_=0,C=null,D=g.next();w!==null&&!D.done;E++,D=g.next()){w.index>E?(C=w,w=null):C=w.sibling;var k=c(m,w,D.value,T);if(k===null){w===null&&(w=C);break}i&&w&&k.alternate===null&&t(m,w),_=n(k,_,E),S===null?A=k:S.sibling=k,S=k,w=C}if(D.done)return e(m,w),wt&&Fr(m,E),A;if(w===null){for(;!D.done;E++,D=g.next())D=d(m,D.value,T),D!==null&&(_=n(D,_,E),S===null?A=D:S.sibling=D,S=D);return wt&&Fr(m,E),A}for(w=r(m,w);!D.done;E++,D=g.next())D=f(w,m,E,D.value,T),D!==null&&(i&&D.alternate!==null&&w.delete(D.key===null?E:D.key),_=n(D,_,E),S===null?A=D:S.sibling=D,S=D);return i&&w.forEach(function(F){return t(m,F)}),wt&&Fr(m,E),A}function x(m,_,g,T){if(typeof g=="object"&&g!==null&&g.type===Ms&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ka:t:{for(var A=g.key,S=_;S!==null;){if(S.key===A){if(A=g.type,A===Ms){if(S.tag===7){e(m,S.sibling),_=s(S,g.props.children),_.return=m,m=_;break t}}else if(S.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===tr&&mm(A)===S.type){e(m,S.sibling),_=s(S,g.props),_.ref=In(m,S,g),_.return=m,m=_;break t}e(m,S);break}else t(m,S);S=S.sibling}g.type===Ms?(_=qr(g.props.children,m.mode,T,g.key),_.return=m,m=_):(T=qo(g.type,g.key,g.props,null,m.mode,T),T.ref=In(m,_,g),T.return=m,m=T)}return a(m);case Rs:t:{for(S=g.key;_!==null;){if(_.key===S)if(_.tag===4&&_.stateNode.containerInfo===g.containerInfo&&_.stateNode.implementation===g.implementation){e(m,_.sibling),_=s(_,g.children||[]),_.return=m,m=_;break t}else{e(m,_);break}else t(m,_);_=_.sibling}_=cu(g,m.mode,T),_.return=m,m=_}return a(m);case tr:return S=g._init,x(m,_,S(g._payload),T)}if(Ln(g))return p(m,_,g,T);if(En(g))return y(m,_,g,T);oo(m,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,_!==null&&_.tag===6?(e(m,_.sibling),_=s(_,g),_.return=m,m=_):(e(m,_),_=uu(g,m.mode,T),_.return=m,m=_),a(m)):e(m,_)}return x}var ln=i0(!0),r0=i0(!1),bl=Cr(null),Cl=null,Us=null,Bf=null;function kf(){Bf=Us=Cl=null}function Nf(i){var t=bl.current;At(bl),i._currentValue=t}function Hc(i,t,e){for(;i!==null;){var r=i.alternate;if((i.childLanes&t)!==t?(i.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),i===e)break;i=i.return}}function js(i,t){Cl=i,Bf=Us=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&t&&(ye=!0),i.firstContext=null)}function Ge(i){var t=i._currentValue;if(Bf!==i)if(i={context:i,memoizedValue:t,next:null},Us===null){if(Cl===null)throw Error(L(308));Us=i,Cl.dependencies={lanes:0,firstContext:i}}else Us=Us.next=i;return t}var Xr=null;function Lf(i){Xr===null?Xr=[i]:Xr.push(i)}function s0(i,t,e,r){var s=t.interleaved;return s===null?(e.next=e,Lf(t)):(e.next=s.next,s.next=e),t.interleaved=e,Xi(i,r)}function Xi(i,t){i.lanes|=t;var e=i.alternate;for(e!==null&&(e.lanes|=t),e=i,i=i.return;i!==null;)i.childLanes|=t,e=i.alternate,e!==null&&(e.childLanes|=t),e=i,i=i.return;return e.tag===3?e.stateNode:null}var er=!1;function Uf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n0(i,t){i=i.updateQueue,t.updateQueue===i&&(t.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Gi(i,t){return{eventTime:i,lane:t,tag:0,payload:null,callback:null,next:null}}function gr(i,t,e){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,pt&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Xi(i,e)}return s=r.interleaved,s===null?(t.next=t,Lf(r)):(t.next=s.next,s.next=t),r.interleaved=t,Xi(i,e)}function zo(i,t,e){if(t=t.updateQueue,t!==null&&(t=t.shared,(e&4194240)!==0)){var r=t.lanes;r&=i.pendingLanes,e|=r,t.lanes=e,Sf(i,e)}}function _m(i,t){var e=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,e===r)){var s=null,n=null;if(e=e.firstBaseUpdate,e!==null){do{var a={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};n===null?s=n=a:n=n.next=a,e=e.next}while(e!==null);n===null?s=n=t:n=n.next=t}else s=n=t;e={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:r.shared,effects:r.effects},i.updateQueue=e;return}i=e.lastBaseUpdate,i===null?e.firstBaseUpdate=t:i.next=t,e.lastBaseUpdate=t}function Il(i,t,e,r){var s=i.updateQueue;er=!1;var n=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,h=l.next;l.next=null,a===null?n=h:a.next=h,a=l;var u=i.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=h:o.next=h,u.lastBaseUpdate=l))}if(n!==null){var d=s.baseState;a=0,u=h=l=null,o=n;do{var c=o.lane,f=o.eventTime;if((r&c)===c){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=i,y=o;switch(c=t,f=e,y.tag){case 1:if(p=y.payload,typeof p=="function"){d=p.call(f,d,c);break t}d=p;break t;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,c=typeof p=="function"?p.call(f,d,c):p,c==null)break t;d=Dt({},d,c);break t;case 2:er=!0}}o.callback!==null&&o.lane!==0&&(i.flags|=64,c=s.effects,c===null?s.effects=[o]:c.push(o))}else f={eventTime:f,lane:c,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(h=u=f,l=d):u=u.next=f,a|=c;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;c=o,o=c.next,c.next=null,s.lastBaseUpdate=c,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=h,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else n===null&&(s.shared.lanes=0);ss|=a,i.lanes=a,i.memoizedState=d}}function gm(i,t,e){if(i=t.effects,t.effects=null,i!==null)for(t=0;t<i.length;t++){var r=i[t],s=r.callback;if(s!==null){if(r.callback=null,r=e,typeof s!="function")throw Error(L(191,s));s.call(r)}}}var Na={},Ai=Cr(Na),Ta=Cr(Na),Aa=Cr(Na);function $r(i){if(i===Na)throw Error(L(174));return i}function Gf(i,t){switch(yt(Aa,t),yt(Ta,i),yt(Ai,Na),i=t.nodeType,i){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ac(null,"");break;default:i=i===8?t.parentNode:t,t=i.namespaceURI||null,i=i.tagName,t=Ac(t,i)}At(Ai),yt(Ai,t)}function hn(){At(Ai),At(Ta),At(Aa)}function a0(i){$r(Aa.current);var t=$r(Ai.current),e=Ac(t,i.type);t!==e&&(yt(Ta,i),yt(Ai,e))}function Vf(i){Ta.current===i&&(At(Ai),At(Ta))}var bt=Cr(0);function Dl(i){for(var t=i;t!==null;){if(t.tag===13){var e=t.memoizedState;if(e!==null&&(e=e.dehydrated,e===null||e.data==="$?"||e.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var su=[];function Hf(){for(var i=0;i<su.length;i++)su[i]._workInProgressVersionPrimary=null;su.length=0}var Xo=qi.ReactCurrentDispatcher,nu=qi.ReactCurrentBatchConfig,rs=0,It=null,Xt=null,Yt=null,Rl=!1,ea=!1,Ea=0,hA=0;function re(){throw Error(L(321))}function zf(i,t){if(t===null)return!1;for(var e=0;e<t.length&&e<i.length;e++)if(!ii(i[e],t[e]))return!1;return!0}function Xf(i,t,e,r,s,n){if(rs=n,It=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xo.current=i===null||i.memoizedState===null?fA:pA,i=e(r,s),ea){n=0;do{if(ea=!1,Ea=0,25<=n)throw Error(L(301));n+=1,Yt=Xt=null,t.updateQueue=null,Xo.current=mA,i=e(r,s)}while(ea)}if(Xo.current=Ml,t=Xt!==null&&Xt.next!==null,rs=0,Yt=Xt=It=null,Rl=!1,t)throw Error(L(300));return i}function $f(){var i=Ea!==0;return Ea=0,i}function fi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?It.memoizedState=Yt=i:Yt=Yt.next=i,Yt}function Ve(){if(Xt===null){var i=It.alternate;i=i!==null?i.memoizedState:null}else i=Xt.next;var t=Yt===null?It.memoizedState:Yt.next;if(t!==null)Yt=t,Xt=i;else{if(i===null)throw Error(L(310));Xt=i,i={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},Yt===null?It.memoizedState=Yt=i:Yt=Yt.next=i}return Yt}function Sa(i,t){return typeof t=="function"?t(i):t}function au(i){var t=Ve(),e=t.queue;if(e===null)throw Error(L(311));e.lastRenderedReducer=i;var r=Xt,s=r.baseQueue,n=e.pending;if(n!==null){if(s!==null){var a=s.next;s.next=n.next,n.next=a}r.baseQueue=s=n,e.pending=null}if(s!==null){n=s.next,r=r.baseState;var o=a=null,l=null,h=n;do{var u=h.lane;if((rs&u)===u)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:i(r,h.action);else{var d={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,It.lanes|=u,ss|=u}h=h.next}while(h!==null&&h!==n);l===null?a=r:l.next=o,ii(r,t.memoizedState)||(ye=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,e.lastRenderedState=r}if(i=e.interleaved,i!==null){s=i;do n=s.lane,It.lanes|=n,ss|=n,s=s.next;while(s!==i)}else s===null&&(e.lanes=0);return[t.memoizedState,e.dispatch]}function ou(i){var t=Ve(),e=t.queue;if(e===null)throw Error(L(311));e.lastRenderedReducer=i;var r=e.dispatch,s=e.pending,n=t.memoizedState;if(s!==null){e.pending=null;var a=s=s.next;do n=i(n,a.action),a=a.next;while(a!==s);ii(n,t.memoizedState)||(ye=!0),t.memoizedState=n,t.baseQueue===null&&(t.baseState=n),e.lastRenderedState=n}return[n,r]}function o0(){}function l0(i,t){var e=It,r=Ve(),s=t(),n=!ii(r.memoizedState,s);if(n&&(r.memoizedState=s,ye=!0),r=r.queue,Wf(c0.bind(null,e,r,i),[i]),r.getSnapshot!==t||n||Yt!==null&&Yt.memoizedState.tag&1){if(e.flags|=2048,wa(9,u0.bind(null,e,r,s,t),void 0,null),qt===null)throw Error(L(349));rs&30||h0(e,t,s)}return s}function h0(i,t,e){i.flags|=16384,i={getSnapshot:t,value:e},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.stores=[i]):(e=t.stores,e===null?t.stores=[i]:e.push(i))}function u0(i,t,e,r){t.value=e,t.getSnapshot=r,d0(t)&&f0(i)}function c0(i,t,e){return e(function(){d0(t)&&f0(i)})}function d0(i){var t=i.getSnapshot;i=i.value;try{var e=t();return!ii(i,e)}catch{return!0}}function f0(i){var t=Xi(i,1);t!==null&&Je(t,i,1,-1)}function ym(i){var t=fi();return typeof i=="function"&&(i=i()),t.memoizedState=t.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:i},t.queue=i,i=i.dispatch=dA.bind(null,It,i),[t.memoizedState,i]}function wa(i,t,e,r){return i={tag:i,create:t,destroy:e,deps:r,next:null},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.lastEffect=i.next=i):(e=t.lastEffect,e===null?t.lastEffect=i.next=i:(r=e.next,e.next=i,i.next=r,t.lastEffect=i)),i}function p0(){return Ve().memoizedState}function $o(i,t,e,r){var s=fi();It.flags|=i,s.memoizedState=wa(1|t,e,void 0,r===void 0?null:r)}function hh(i,t,e,r){var s=Ve();r=r===void 0?null:r;var n=void 0;if(Xt!==null){var a=Xt.memoizedState;if(n=a.destroy,r!==null&&zf(r,a.deps)){s.memoizedState=wa(t,e,n,r);return}}It.flags|=i,s.memoizedState=wa(1|t,e,n,r)}function vm(i,t){return $o(8390656,8,i,t)}function Wf(i,t){return hh(2048,8,i,t)}function m0(i,t){return hh(4,2,i,t)}function _0(i,t){return hh(4,4,i,t)}function g0(i,t){if(typeof t=="function")return i=i(),t(i),function(){t(null)};if(t!=null)return i=i(),t.current=i,function(){t.current=null}}function y0(i,t,e){return e=e!=null?e.concat([i]):null,hh(4,4,g0.bind(null,t,i),e)}function Yf(){}function v0(i,t){var e=Ve();t=t===void 0?null:t;var r=e.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(e.memoizedState=[i,t],i)}function x0(i,t){var e=Ve();t=t===void 0?null:t;var r=e.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(i=i(),e.memoizedState=[i,t],i)}function T0(i,t,e){return rs&21?(ii(e,t)||(e=by(),It.lanes|=e,ss|=e,i.baseState=!0),t):(i.baseState&&(i.baseState=!1,ye=!0),i.memoizedState=e)}function uA(i,t){var e=_t;_t=e!==0&&4>e?e:4,i(!0);var r=nu.transition;nu.transition={};try{i(!1),t()}finally{_t=e,nu.transition=r}}function A0(){return Ve().memoizedState}function cA(i,t,e){var r=vr(i);if(e={lane:r,action:e,hasEagerState:!1,eagerState:null,next:null},E0(i))S0(t,e);else if(e=s0(i,t,e,r),e!==null){var s=de();Je(e,i,r,s),w0(e,t,r)}}function dA(i,t,e){var r=vr(i),s={lane:r,action:e,hasEagerState:!1,eagerState:null,next:null};if(E0(i))S0(t,s);else{var n=i.alternate;if(i.lanes===0&&(n===null||n.lanes===0)&&(n=t.lastRenderedReducer,n!==null))try{var a=t.lastRenderedState,o=n(a,e);if(s.hasEagerState=!0,s.eagerState=o,ii(o,a)){var l=t.interleaved;l===null?(s.next=s,Lf(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}e=s0(i,t,s,r),e!==null&&(s=de(),Je(e,i,r,s),w0(e,t,r))}}function E0(i){var t=i.alternate;return i===It||t!==null&&t===It}function S0(i,t){ea=Rl=!0;var e=i.pending;e===null?t.next=t:(t.next=e.next,e.next=t),i.pending=t}function w0(i,t,e){if(e&4194240){var r=t.lanes;r&=i.pendingLanes,e|=r,t.lanes=e,Sf(i,e)}}var Ml={readContext:Ge,useCallback:re,useContext:re,useEffect:re,useImperativeHandle:re,useInsertionEffect:re,useLayoutEffect:re,useMemo:re,useReducer:re,useRef:re,useState:re,useDebugValue:re,useDeferredValue:re,useTransition:re,useMutableSource:re,useSyncExternalStore:re,useId:re,unstable_isNewReconciler:!1},fA={readContext:Ge,useCallback:function(i,t){return fi().memoizedState=[i,t===void 0?null:t],i},useContext:Ge,useEffect:vm,useImperativeHandle:function(i,t,e){return e=e!=null?e.concat([i]):null,$o(4194308,4,g0.bind(null,t,i),e)},useLayoutEffect:function(i,t){return $o(4194308,4,i,t)},useInsertionEffect:function(i,t){return $o(4,2,i,t)},useMemo:function(i,t){var e=fi();return t=t===void 0?null:t,i=i(),e.memoizedState=[i,t],i},useReducer:function(i,t,e){var r=fi();return t=e!==void 0?e(t):t,r.memoizedState=r.baseState=t,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:t},r.queue=i,i=i.dispatch=cA.bind(null,It,i),[r.memoizedState,i]},useRef:function(i){var t=fi();return i={current:i},t.memoizedState=i},useState:ym,useDebugValue:Yf,useDeferredValue:function(i){return fi().memoizedState=i},useTransition:function(){var i=ym(!1),t=i[0];return i=uA.bind(null,i[1]),fi().memoizedState=i,[t,i]},useMutableSource:function(){},useSyncExternalStore:function(i,t,e){var r=It,s=fi();if(wt){if(e===void 0)throw Error(L(407));e=e()}else{if(e=t(),qt===null)throw Error(L(349));rs&30||h0(r,t,e)}s.memoizedState=e;var n={value:e,getSnapshot:t};return s.queue=n,vm(c0.bind(null,r,n,i),[i]),r.flags|=2048,wa(9,u0.bind(null,r,n,e,t),void 0,null),e},useId:function(){var i=fi(),t=qt.identifierPrefix;if(wt){var e=Bi,r=Oi;e=(r&~(1<<32-Qe(r)-1)).toString(32)+e,t=":"+t+"R"+e,e=Ea++,0<e&&(t+="H"+e.toString(32)),t+=":"}else e=hA++,t=":"+t+"r"+e.toString(32)+":";return i.memoizedState=t},unstable_isNewReconciler:!1},pA={readContext:Ge,useCallback:v0,useContext:Ge,useEffect:Wf,useImperativeHandle:y0,useInsertionEffect:m0,useLayoutEffect:_0,useMemo:x0,useReducer:au,useRef:p0,useState:function(){return au(Sa)},useDebugValue:Yf,useDeferredValue:function(i){var t=Ve();return T0(t,Xt.memoizedState,i)},useTransition:function(){var i=au(Sa)[0],t=Ve().memoizedState;return[i,t]},useMutableSource:o0,useSyncExternalStore:l0,useId:A0,unstable_isNewReconciler:!1},mA={readContext:Ge,useCallback:v0,useContext:Ge,useEffect:Wf,useImperativeHandle:y0,useInsertionEffect:m0,useLayoutEffect:_0,useMemo:x0,useReducer:ou,useRef:p0,useState:function(){return ou(Sa)},useDebugValue:Yf,useDeferredValue:function(i){var t=Ve();return Xt===null?t.memoizedState=i:T0(t,Xt.memoizedState,i)},useTransition:function(){var i=ou(Sa)[0],t=Ve().memoizedState;return[i,t]},useMutableSource:o0,useSyncExternalStore:l0,useId:A0,unstable_isNewReconciler:!1};function Ye(i,t){if(i&&i.defaultProps){t=Dt({},t),i=i.defaultProps;for(var e in i)t[e]===void 0&&(t[e]=i[e]);return t}return t}function zc(i,t,e,r){t=i.memoizedState,e=e(r,t),e=e==null?t:Dt({},t,e),i.memoizedState=e,i.lanes===0&&(i.updateQueue.baseState=e)}var uh={isMounted:function(i){return(i=i._reactInternals)?ds(i)===i:!1},enqueueSetState:function(i,t,e){i=i._reactInternals;var r=de(),s=vr(i),n=Gi(r,s);n.payload=t,e!=null&&(n.callback=e),t=gr(i,n,s),t!==null&&(Je(t,i,s,r),zo(t,i,s))},enqueueReplaceState:function(i,t,e){i=i._reactInternals;var r=de(),s=vr(i),n=Gi(r,s);n.tag=1,n.payload=t,e!=null&&(n.callback=e),t=gr(i,n,s),t!==null&&(Je(t,i,s,r),zo(t,i,s))},enqueueForceUpdate:function(i,t){i=i._reactInternals;var e=de(),r=vr(i),s=Gi(e,r);s.tag=2,t!=null&&(s.callback=t),t=gr(i,s,r),t!==null&&(Je(t,i,r,e),zo(t,i,r))}};function xm(i,t,e,r,s,n,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,n,a):t.prototype&&t.prototype.isPureReactComponent?!ga(e,r)||!ga(s,n):!0}function b0(i,t,e){var r=!1,s=Sr,n=t.contextType;return typeof n=="object"&&n!==null?n=Ge(n):(s=Te(t)?es:ae.current,r=t.contextTypes,n=(r=r!=null)?an(i,s):Sr),t=new t(e,n),i.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=uh,i.stateNode=t,t._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=n),t}function Tm(i,t,e,r){i=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(e,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(e,r),t.state!==i&&uh.enqueueReplaceState(t,t.state,null)}function Xc(i,t,e,r){var s=i.stateNode;s.props=e,s.state=i.memoizedState,s.refs={},Uf(i);var n=t.contextType;typeof n=="object"&&n!==null?s.context=Ge(n):(n=Te(t)?es:ae.current,s.context=an(i,n)),s.state=i.memoizedState,n=t.getDerivedStateFromProps,typeof n=="function"&&(zc(i,t,n,e),s.state=i.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&uh.enqueueReplaceState(s,s.state,null),Il(i,e,s,r),s.state=i.memoizedState),typeof s.componentDidMount=="function"&&(i.flags|=4194308)}function un(i,t){try{var e="",r=t;do e+=zT(r),r=r.return;while(r);var s=e}catch(n){s=`
Error generating stack: `+n.message+`
`+n.stack}return{value:i,source:t,stack:s,digest:null}}function lu(i,t,e){return{value:i,source:null,stack:e??null,digest:t??null}}function $c(i,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function C0(i,t,e){e=Gi(-1,e),e.tag=3,e.payload={element:null};var r=t.value;return e.callback=function(){Fl||(Fl=!0,ed=r),$c(i,t)},e}function I0(i,t,e){e=Gi(-1,e),e.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;e.payload=function(){return r(s)},e.callback=function(){$c(i,t)}}var n=i.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(e.callback=function(){$c(i,t),typeof r!="function"&&(yr===null?yr=new Set([this]):yr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),e}function Am(i,t,e){var r=i.pingCache;if(r===null){r=i.pingCache=new _A;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(e)||(s.add(e),i=RA.bind(null,i,t,e),t.then(i,i))}function Em(i){do{var t;if((t=i.tag===13)&&(t=i.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return i;i=i.return}while(i!==null);return null}function Sm(i,t,e,r,s){return i.mode&1?(i.flags|=65536,i.lanes=s,i):(i===t?i.flags|=65536:(i.flags|=128,e.flags|=131072,e.flags&=-52805,e.tag===1&&(e.alternate===null?e.tag=17:(t=Gi(-1,1),t.tag=2,gr(e,t,1))),e.lanes|=1),i)}var gA=qi.ReactCurrentOwner,ye=!1;function le(i,t,e,r){t.child=i===null?r0(t,null,e,r):ln(t,i.child,e,r)}function wm(i,t,e,r,s){e=e.render;var n=t.ref;return js(t,s),r=Xf(i,t,e,r,n,s),e=$f(),i!==null&&!ye?(t.updateQueue=i.updateQueue,t.flags&=-2053,i.lanes&=~s,$i(i,t,s)):(wt&&e&&Pf(t),t.flags|=1,le(i,t,r,s),t.child)}function bm(i,t,e,r,s){if(i===null){var n=e.type;return typeof n=="function"&&!ep(n)&&n.defaultProps===void 0&&e.compare===null&&e.defaultProps===void 0?(t.tag=15,t.type=n,D0(i,t,n,r,s)):(i=qo(e.type,null,r,t,t.mode,s),i.ref=t.ref,i.return=t,t.child=i)}if(n=i.child,!(i.lanes&s)){var a=n.memoizedProps;if(e=e.compare,e=e!==null?e:ga,e(a,r)&&i.ref===t.ref)return $i(i,t,s)}return t.flags|=1,i=xr(n,r),i.ref=t.ref,i.return=t,t.child=i}function D0(i,t,e,r,s){if(i!==null){var n=i.memoizedProps;if(ga(n,r)&&i.ref===t.ref)if(ye=!1,t.pendingProps=r=n,(i.lanes&s)!==0)i.flags&131072&&(ye=!0);else return t.lanes=i.lanes,$i(i,t,s)}return Wc(i,t,e,r,s)}function R0(i,t,e){var r=t.pendingProps,s=r.children,n=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(Vs,we),we|=e;else{if(!(e&1073741824))return i=n!==null?n.baseLanes|e:e,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:i,cachePool:null,transitions:null},t.updateQueue=null,yt(Vs,we),we|=i,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=n!==null?n.baseLanes:e,yt(Vs,we),we|=r}else n!==null?(r=n.baseLanes|e,t.memoizedState=null):r=e,yt(Vs,we),we|=r;return le(i,t,s,e),t.child}function M0(i,t){var e=t.ref;(i===null&&e!==null||i!==null&&i.ref!==e)&&(t.flags|=512,t.flags|=2097152)}function Wc(i,t,e,r,s){var n=Te(e)?es:ae.current;return n=an(t,n),js(t,s),e=Xf(i,t,e,r,n,s),r=$f(),i!==null&&!ye?(t.updateQueue=i.updateQueue,t.flags&=-2053,i.lanes&=~s,$i(i,t,s)):(wt&&r&&Pf(t),t.flags|=1,le(i,t,e,s),t.child)}function Cm(i,t,e,r,s){if(Te(e)){var n=!0;El(t)}else n=!1;if(js(t,s),t.stateNode===null)Wo(i,t),b0(t,e,r),Xc(t,e,r,s),r=!0;else if(i===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,h=e.contextType;typeof h=="object"&&h!==null?h=Ge(h):(h=Te(e)?es:ae.current,h=an(t,h));var u=e.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==h)&&Tm(t,a,r,h),er=!1;var c=t.memoizedState;a.state=c,Il(t,r,a,s),l=t.memoizedState,o!==r||c!==l||xe.current||er?(typeof u=="function"&&(zc(t,e,u,r),l=t.memoizedState),(o=er||xm(t,e,o,r,c,l,h))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=h,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,n0(i,t),o=t.memoizedProps,h=t.type===t.elementType?o:Ye(t.type,o),a.props=h,d=t.pendingProps,c=a.context,l=e.contextType,typeof l=="object"&&l!==null?l=Ge(l):(l=Te(e)?es:ae.current,l=an(t,l));var f=e.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||c!==l)&&Tm(t,a,r,l),er=!1,c=t.memoizedState,a.state=c,Il(t,r,a,s);var p=t.memoizedState;o!==d||c!==p||xe.current||er?(typeof f=="function"&&(zc(t,e,f,r),p=t.memoizedState),(h=er||xm(t,e,h,r,c,p,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&c===i.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&c===i.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=h):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&c===i.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&c===i.memoizedState||(t.flags|=1024),r=!1)}return Yc(i,t,e,r,n,s)}function Yc(i,t,e,r,s,n){M0(i,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&dm(t,e,!1),$i(i,t,n);r=t.stateNode,gA.current=t;var o=a&&typeof e.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,i!==null&&a?(t.child=ln(t,i.child,null,n),t.child=ln(t,null,o,n)):le(i,t,o,n),t.memoizedState=r.state,s&&dm(t,e,!0),t.child}function P0(i){var t=i.stateNode;t.pendingContext?cm(i,t.pendingContext,t.pendingContext!==t.context):t.context&&cm(i,t.context,!1),Gf(i,t.containerInfo)}function Im(i,t,e,r,s){return on(),Of(s),t.flags|=256,le(i,t,e,r),t.child}var jc={dehydrated:null,treeContext:null,retryLane:0};function qc(i){return{baseLanes:i,cachePool:null,transitions:null}}function F0(i,t,e){var r=t.pendingProps,s=bt.current,n=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=i!==null&&i.memoizedState===null?!1:(s&2)!==0),o?(n=!0,t.flags&=-129):(i===null||i.memoizedState!==null)&&(s|=1),yt(bt,s&1),i===null)return Vc(t),i=t.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(t.mode&1?i.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,i=r.fallback,n?(r=t.mode,n=t.child,a={mode:"hidden",children:a},!(r&1)&&n!==null?(n.childLanes=0,n.pendingProps=a):n=fh(a,r,0,null),i=qr(i,r,e,null),n.return=t,i.return=t,n.sibling=i,t.child=n,t.child.memoizedState=qc(e),t.memoizedState=jc,i):jf(t,a));if(s=i.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return yA(i,t,a,r,o,s,e);if(n){n=r.fallback,a=t.mode,s=i.child,o=s.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=xr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),o!==null?n=xr(o,n):(n=qr(n,a,e,null),n.flags|=2),n.return=t,r.return=t,r.sibling=n,t.child=r,r=n,n=t.child,a=i.child.memoizedState,a=a===null?qc(e):{baseLanes:a.baseLanes|e,cachePool:null,transitions:a.transitions},n.memoizedState=a,n.childLanes=i.childLanes&~e,t.memoizedState=jc,r}return n=i.child,i=n.sibling,r=xr(n,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=e),r.return=t,r.sibling=null,i!==null&&(e=t.deletions,e===null?(t.deletions=[i],t.flags|=16):e.push(i)),t.child=r,t.memoizedState=null,r}function jf(i,t){return t=fh({mode:"visible",children:t},i.mode,0,null),t.return=i,i.child=t}function lo(i,t,e,r){return r!==null&&Of(r),ln(t,i.child,null,e),i=jf(t,t.pendingProps.children),i.flags|=2,t.memoizedState=null,i}function yA(i,t,e,r,s,n,a){if(e)return t.flags&256?(t.flags&=-257,r=lu(Error(L(422))),lo(i,t,a,r)):t.memoizedState!==null?(t.child=i.child,t.flags|=128,null):(n=r.fallback,s=t.mode,r=fh({mode:"visible",children:r.children},s,0,null),n=qr(n,s,a,null),n.flags|=2,r.return=t,n.return=t,r.sibling=n,t.child=r,t.mode&1&&ln(t,i.child,null,a),t.child.memoizedState=qc(a),t.memoizedState=jc,n);if(!(t.mode&1))return lo(i,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var o=r.dgst;return r=o,n=Error(L(419)),r=lu(n,r,void 0),lo(i,t,a,r)}if(o=(a&i.childLanes)!==0,ye||o){if(r=qt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==n.retryLane&&(n.retryLane=s,Xi(i,s),Je(r,i,s,-1))}return tp(),r=lu(Error(L(421))),lo(i,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=i.child,t=MA.bind(null,i),s._reactRetry=t,null):(i=n.treeContext,be=_r(s.nextSibling),Ce=t,wt=!0,Ke=null,i!==null&&(Pe[Fe++]=Oi,Pe[Fe++]=Bi,Pe[Fe++]=is,Oi=i.id,Bi=i.overflow,is=t),t=jf(t,r.children),t.flags|=4096,t)}function Dm(i,t,e){i.lanes|=t;var r=i.alternate;r!==null&&(r.lanes|=t),Hc(i.return,t,e)}function hu(i,t,e,r,s){var n=i.memoizedState;n===null?i.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:e,tailMode:s}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=r,n.tail=e,n.tailMode=s)}function O0(i,t,e){var r=t.pendingProps,s=r.revealOrder,n=r.tail;if(le(i,t,r.children,e),r=bt.current,r&2)r=r&1|2,t.flags|=128;else{if(i!==null&&i.flags&128)t:for(i=t.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Dm(i,e,t);else if(i.tag===19)Dm(i,e,t);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break t;for(;i.sibling===null;){if(i.return===null||i.return===t)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(yt(bt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(e=t.child,s=null;e!==null;)i=e.alternate,i!==null&&Dl(i)===null&&(s=e),e=e.sibling;e=s,e===null?(s=t.child,t.child=null):(s=e.sibling,e.sibling=null),hu(t,!1,s,e,n);break;case"backwards":for(e=null,s=t.child,t.child=null;s!==null;){if(i=s.alternate,i!==null&&Dl(i)===null){t.child=s;break}i=s.sibling,s.sibling=e,e=s,s=i}hu(t,!0,e,null,n);break;case"together":hu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(i,t){!(t.mode&1)&&i!==null&&(i.alternate=null,t.alternate=null,t.flags|=2)}function $i(i,t,e){if(i!==null&&(t.dependencies=i.dependencies),ss|=t.lanes,!(e&t.childLanes))return null;if(i!==null&&t.child!==i.child)throw Error(L(153));if(t.child!==null){for(i=t.child,e=xr(i,i.pendingProps),t.child=e,e.return=t;i.sibling!==null;)i=i.sibling,e=e.sibling=xr(i,i.pendingProps),e.return=t;e.sibling=null}return t.child}function vA(i,t,e){switch(t.tag){case 3:P0(t),on();break;case 5:a0(t);break;case 1:Te(t.type)&&El(t);break;case 4:Gf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;yt(bl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(yt(bt,bt.current&1),t.flags|=128,null):e&t.child.childLanes?F0(i,t,e):(yt(bt,bt.current&1),i=$i(i,t,e),i!==null?i.sibling:null);yt(bt,bt.current&1);break;case 19:if(r=(e&t.childLanes)!==0,i.flags&128){if(r)return O0(i,t,e);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),yt(bt,bt.current),r)break;return null;case 22:case 23:return t.lanes=0,R0(i,t,e)}return $i(i,t,e)}var B0,Kc,k0,N0;B0=function(i,t){for(var e=t.child;e!==null;){if(e.tag===5||e.tag===6)i.appendChild(e.stateNode);else if(e.tag!==4&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return;e=e.return}e.sibling.return=e.return,e=e.sibling}};Kc=function(){};k0=function(i,t,e,r){var s=i.memoizedProps;if(s!==r){i=t.stateNode,$r(Ai.current);var n=null;switch(e){case"input":s=yc(i,s),r=yc(i,r),n=[];break;case"select":s=Dt({},s,{value:void 0}),r=Dt({},r,{value:void 0}),n=[];break;case"textarea":s=Tc(i,s),r=Tc(i,r),n=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=Tl)}Ec(e,r);var a;e=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var o=s[h];for(a in o)o.hasOwnProperty(a)&&(e||(e={}),e[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ua.hasOwnProperty(h)?n||(n=[]):(n=n||[]).push(h,null));for(h in r){var l=r[h];if(o=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&l!==o&&(l!=null||o!=null))if(h==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(e||(e={}),e[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(e||(e={}),e[a]=l[a])}else e||(n||(n=[]),n.push(h,e)),e=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(n=n||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(n=n||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ua.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&xt("scroll",i),n||o===l||(n=[])):(n=n||[]).push(h,l))}e&&(n=n||[]).push("style",e);var h=n;(t.updateQueue=h)&&(t.flags|=4)}};N0=function(i,t,e,r){e!==r&&(t.flags|=4)};function Dn(i,t){if(!wt)switch(i.tailMode){case"hidden":t=i.tail;for(var e=null;t!==null;)t.alternate!==null&&(e=t),t=t.sibling;e===null?i.tail=null:e.sibling=null;break;case"collapsed":e=i.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function se(i){var t=i.alternate!==null&&i.alternate.child===i.child,e=0,r=0;if(t)for(var s=i.child;s!==null;)e|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=i,s=s.sibling;else for(s=i.child;s!==null;)e|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=i,s=s.sibling;return i.subtreeFlags|=r,i.childLanes=e,t}function xA(i,t,e){var r=t.pendingProps;switch(Ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return se(t),null;case 1:return Te(t.type)&&Al(),se(t),null;case 3:return r=t.stateNode,hn(),At(xe),At(ae),Hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(ao(t)?t.flags|=4:i===null||i.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ke!==null&&(sd(Ke),Ke=null))),Kc(i,t),se(t),null;case 5:Vf(t);var s=$r(Aa.current);if(e=t.type,i!==null&&t.stateNode!=null)k0(i,t,e,r,s),i.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(L(166));return se(t),null}if(i=$r(Ai.current),ao(t)){r=t.stateNode,e=t.type;var n=t.memoizedProps;switch(r[vi]=t,r[xa]=n,i=(t.mode&1)!==0,e){case"dialog":xt("cancel",r),xt("close",r);break;case"iframe":case"object":case"embed":xt("load",r);break;case"video":case"audio":for(s=0;s<Gn.length;s++)xt(Gn[s],r);break;case"source":xt("error",r);break;case"img":case"image":case"link":xt("error",r),xt("load",r);break;case"details":xt("toggle",r);break;case"input":Lp(r,n),xt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!n.multiple},xt("invalid",r);break;case"textarea":Gp(r,n),xt("invalid",r)}Ec(e,n),s=null;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a];a==="children"?typeof o=="string"?r.textContent!==o&&(n.suppressHydrationWarning!==!0&&no(r.textContent,o,i),s=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(n.suppressHydrationWarning!==!0&&no(r.textContent,o,i),s=["children",""+o]):ua.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&xt("scroll",r)}switch(e){case"input":Za(r),Up(r,n,!0);break;case"textarea":Za(r),Vp(r);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(r.onclick=Tl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=cy(e)),i==="http://www.w3.org/1999/xhtml"?e==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=a.createElement(e,{is:r.is}):(i=a.createElement(e),e==="select"&&(a=i,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):i=a.createElementNS(i,e),i[vi]=t,i[xa]=r,B0(i,t,!1,!1),t.stateNode=i;t:{switch(a=Sc(e,r),e){case"dialog":xt("cancel",i),xt("close",i),s=r;break;case"iframe":case"object":case"embed":xt("load",i),s=r;break;case"video":case"audio":for(s=0;s<Gn.length;s++)xt(Gn[s],i);s=r;break;case"source":xt("error",i),s=r;break;case"img":case"image":case"link":xt("error",i),xt("load",i),s=r;break;case"details":xt("toggle",i),s=r;break;case"input":Lp(i,r),s=yc(i,r),xt("invalid",i);break;case"option":s=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},s=Dt({},r,{value:void 0}),xt("invalid",i);break;case"textarea":Gp(i,r),s=Tc(i,r),xt("invalid",i);break;default:s=r}Ec(e,s),o=s;for(n in o)if(o.hasOwnProperty(n)){var l=o[n];n==="style"?py(i,l):n==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&dy(i,l)):n==="children"?typeof l=="string"?(e!=="textarea"||l!=="")&&ca(i,l):typeof l=="number"&&ca(i,""+l):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(ua.hasOwnProperty(n)?l!=null&&n==="onScroll"&&xt("scroll",i):l!=null&&yf(i,n,l,a))}switch(e){case"input":Za(i),Up(i,r,!1);break;case"textarea":Za(i),Vp(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Er(r.value));break;case"select":i.multiple=!!r.multiple,n=r.value,n!=null?Xs(i,!!r.multiple,n,!1):r.defaultValue!=null&&Xs(i,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(i.onclick=Tl)}switch(e){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return se(t),null;case 6:if(i&&t.stateNode!=null)N0(i,t,i.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(L(166));if(e=$r(Aa.current),$r(Ai.current),ao(t)){if(r=t.stateNode,e=t.memoizedProps,r[vi]=t,(n=r.nodeValue!==e)&&(i=Ce,i!==null))switch(i.tag){case 3:no(r.nodeValue,e,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&no(r.nodeValue,e,(i.mode&1)!==0)}n&&(t.flags|=4)}else r=(e.nodeType===9?e:e.ownerDocument).createTextNode(r),r[vi]=t,t.stateNode=r}return se(t),null;case 13:if(At(bt),r=t.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(wt&&be!==null&&t.mode&1&&!(t.flags&128))e0(),on(),t.flags|=98560,n=!1;else if(n=ao(t),r!==null&&r.dehydrated!==null){if(i===null){if(!n)throw Error(L(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(L(317));n[vi]=t}else on(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;se(t),n=!1}else Ke!==null&&(sd(Ke),Ke=null),n=!0;if(!n)return t.flags&65536?t:null}return t.flags&128?(t.lanes=e,t):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(i===null||bt.current&1?$t===0&&($t=3):tp())),t.updateQueue!==null&&(t.flags|=4),se(t),null);case 4:return hn(),Kc(i,t),i===null&&ya(t.stateNode.containerInfo),se(t),null;case 10:return Nf(t.type._context),se(t),null;case 17:return Te(t.type)&&Al(),se(t),null;case 19:if(At(bt),n=t.memoizedState,n===null)return se(t),null;if(r=(t.flags&128)!==0,a=n.rendering,a===null)if(r)Dn(n,!1);else{if($t!==0||i!==null&&i.flags&128)for(i=t.child;i!==null;){if(a=Dl(i),a!==null){for(t.flags|=128,Dn(n,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=e,e=t.child;e!==null;)n=e,i=r,n.flags&=14680066,a=n.alternate,a===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=a.childLanes,n.lanes=a.lanes,n.child=a.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=a.memoizedProps,n.memoizedState=a.memoizedState,n.updateQueue=a.updateQueue,n.type=a.type,i=a.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),e=e.sibling;return yt(bt,bt.current&1|2),t.child}i=i.sibling}n.tail!==null&&Bt()>cn&&(t.flags|=128,r=!0,Dn(n,!1),t.lanes=4194304)}else{if(!r)if(i=Dl(a),i!==null){if(t.flags|=128,r=!0,e=i.updateQueue,e!==null&&(t.updateQueue=e,t.flags|=4),Dn(n,!0),n.tail===null&&n.tailMode==="hidden"&&!a.alternate&&!wt)return se(t),null}else 2*Bt()-n.renderingStartTime>cn&&e!==1073741824&&(t.flags|=128,r=!0,Dn(n,!1),t.lanes=4194304);n.isBackwards?(a.sibling=t.child,t.child=a):(e=n.last,e!==null?e.sibling=a:t.child=a,n.last=a)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Bt(),t.sibling=null,e=bt.current,yt(bt,r?e&1|2:e&1),t):(se(t),null);case 22:case 23:return Jf(),r=t.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?we&1073741824&&(se(t),t.subtreeFlags&6&&(t.flags|=8192)):se(t),null;case 24:return null;case 25:return null}throw Error(L(156,t.tag))}function TA(i,t){switch(Ff(t),t.tag){case 1:return Te(t.type)&&Al(),i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 3:return hn(),At(xe),At(ae),Hf(),i=t.flags,i&65536&&!(i&128)?(t.flags=i&-65537|128,t):null;case 5:return Vf(t),null;case 13:if(At(bt),i=t.memoizedState,i!==null&&i.dehydrated!==null){if(t.alternate===null)throw Error(L(340));on()}return i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 19:return At(bt),null;case 4:return hn(),null;case 10:return Nf(t.type._context),null;case 22:case 23:return Jf(),null;case 24:return null;default:return null}}var ho=!1,ne=!1,AA=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Gs(i,t){var e=i.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(r){Pt(i,t,r)}else e.current=null}function Zc(i,t,e){try{e()}catch(r){Pt(i,t,r)}}var Rm=!1;function EA(i,t){if(Oc=yl,i=Hy(),Mf(i)){if("selectionStart"in i)var e={start:i.selectionStart,end:i.selectionEnd};else t:{e=(e=i.ownerDocument)&&e.defaultView||window;var r=e.getSelection&&e.getSelection();if(r&&r.rangeCount!==0){e=r.anchorNode;var s=r.anchorOffset,n=r.focusNode;r=r.focusOffset;try{e.nodeType,n.nodeType}catch{e=null;break t}var a=0,o=-1,l=-1,h=0,u=0,d=i,c=null;e:for(;;){for(var f;d!==e||s!==0&&d.nodeType!==3||(o=a+s),d!==n||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)c=d,d=f;for(;;){if(d===i)break e;if(c===e&&++h===s&&(o=a),c===n&&++u===r&&(l=a),(f=d.nextSibling)!==null)break;d=c,c=d.parentNode}d=f}e=o===-1||l===-1?null:{start:o,end:l}}else e=null}e=e||{start:0,end:0}}else e=null;for(Bc={focusedElem:i,selectionRange:e},yl=!1,Y=t;Y!==null;)if(t=Y,i=t.child,(t.subtreeFlags&1028)!==0&&i!==null)i.return=t,Y=i;else for(;Y!==null;){t=Y;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,x=p.memoizedState,m=t.stateNode,_=m.getSnapshotBeforeUpdate(t.elementType===t.type?y:Ye(t.type,y),x);m.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(T){Pt(t,t.return,T)}if(i=t.sibling,i!==null){i.return=t.return,Y=i;break}Y=t.return}return p=Rm,Rm=!1,p}function ia(i,t,e){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&i)===i){var n=s.destroy;s.destroy=void 0,n!==void 0&&Zc(t,e,n)}s=s.next}while(s!==r)}}function ch(i,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var e=t=t.next;do{if((e.tag&i)===i){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}}function Qc(i){var t=i.ref;if(t!==null){var e=i.stateNode;switch(i.tag){case 5:i=e;break;default:i=e}typeof t=="function"?t(i):t.current=i}}function L0(i){var t=i.alternate;t!==null&&(i.alternate=null,L0(t)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(t=i.stateNode,t!==null&&(delete t[vi],delete t[xa],delete t[Lc],delete t[nA],delete t[aA])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function U0(i){return i.tag===5||i.tag===3||i.tag===4}function Mm(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||U0(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Jc(i,t,e){var r=i.tag;if(r===5||r===6)i=i.stateNode,t?e.nodeType===8?e.parentNode.insertBefore(i,t):e.insertBefore(i,t):(e.nodeType===8?(t=e.parentNode,t.insertBefore(i,e)):(t=e,t.appendChild(i)),e=e._reactRootContainer,e!=null||t.onclick!==null||(t.onclick=Tl));else if(r!==4&&(i=i.child,i!==null))for(Jc(i,t,e),i=i.sibling;i!==null;)Jc(i,t,e),i=i.sibling}function td(i,t,e){var r=i.tag;if(r===5||r===6)i=i.stateNode,t?e.insertBefore(i,t):e.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(td(i,t,e),i=i.sibling;i!==null;)td(i,t,e),i=i.sibling}var Jt=null,je=!1;function Ki(i,t,e){for(e=e.child;e!==null;)G0(i,t,e),e=e.sibling}function G0(i,t,e){if(Ti&&typeof Ti.onCommitFiberUnmount=="function")try{Ti.onCommitFiberUnmount(rh,e)}catch{}switch(e.tag){case 5:ne||Gs(e,t);case 6:var r=Jt,s=je;Jt=null,Ki(i,t,e),Jt=r,je=s,Jt!==null&&(je?(i=Jt,e=e.stateNode,i.nodeType===8?i.parentNode.removeChild(e):i.removeChild(e)):Jt.removeChild(e.stateNode));break;case 18:Jt!==null&&(je?(i=Jt,e=e.stateNode,i.nodeType===8?iu(i.parentNode,e):i.nodeType===1&&iu(i,e),ma(i)):iu(Jt,e.stateNode));break;case 4:r=Jt,s=je,Jt=e.stateNode.containerInfo,je=!0,Ki(i,t,e),Jt=r,je=s;break;case 0:case 11:case 14:case 15:if(!ne&&(r=e.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var n=s,a=n.destroy;n=n.tag,a!==void 0&&(n&2||n&4)&&Zc(e,t,a),s=s.next}while(s!==r)}Ki(i,t,e);break;case 1:if(!ne&&(Gs(e,t),r=e.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=e.memoizedProps,r.state=e.memoizedState,r.componentWillUnmount()}catch(o){Pt(e,t,o)}Ki(i,t,e);break;case 21:Ki(i,t,e);break;case 22:e.mode&1?(ne=(r=ne)||e.memoizedState!==null,Ki(i,t,e),ne=r):Ki(i,t,e);break;default:Ki(i,t,e)}}function Pm(i){var t=i.updateQueue;if(t!==null){i.updateQueue=null;var e=i.stateNode;e===null&&(e=i.stateNode=new AA),t.forEach(function(r){var s=PA.bind(null,i,r);e.has(r)||(e.add(r),r.then(s,s))})}}function He(i,t){var e=t.deletions;if(e!==null)for(var r=0;r<e.length;r++){var s=e[r];try{var n=i,a=t,o=a;t:for(;o!==null;){switch(o.tag){case 5:Jt=o.stateNode,je=!1;break t;case 3:Jt=o.stateNode.containerInfo,je=!0;break t;case 4:Jt=o.stateNode.containerInfo,je=!0;break t}o=o.return}if(Jt===null)throw Error(L(160));G0(n,a,s),Jt=null,je=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(h){Pt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)V0(t,i),t=t.sibling}function V0(i,t){var e=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(He(t,i),ai(i),r&4){try{ia(3,i,i.return),ch(3,i)}catch(y){Pt(i,i.return,y)}try{ia(5,i,i.return)}catch(y){Pt(i,i.return,y)}}break;case 1:He(t,i),ai(i),r&512&&e!==null&&Gs(e,e.return);break;case 5:if(He(t,i),ai(i),r&512&&e!==null&&Gs(e,e.return),i.flags&32){var s=i.stateNode;try{ca(s,"")}catch(y){Pt(i,i.return,y)}}if(r&4&&(s=i.stateNode,s!=null)){var n=i.memoizedProps,a=e!==null?e.memoizedProps:n,o=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{o==="input"&&n.type==="radio"&&n.name!=null&&hy(s,n),Sc(o,a);var h=Sc(o,n);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?py(s,d):u==="dangerouslySetInnerHTML"?dy(s,d):u==="children"?ca(s,d):yf(s,u,d,h)}switch(o){case"input":vc(s,n);break;case"textarea":uy(s,n);break;case"select":var c=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!n.multiple;var f=n.value;f!=null?Xs(s,!!n.multiple,f,!1):c!==!!n.multiple&&(n.defaultValue!=null?Xs(s,!!n.multiple,n.defaultValue,!0):Xs(s,!!n.multiple,n.multiple?[]:"",!1))}s[xa]=n}catch(y){Pt(i,i.return,y)}}break;case 6:if(He(t,i),ai(i),r&4){if(i.stateNode===null)throw Error(L(162));s=i.stateNode,n=i.memoizedProps;try{s.nodeValue=n}catch(y){Pt(i,i.return,y)}}break;case 3:if(He(t,i),ai(i),r&4&&e!==null&&e.memoizedState.isDehydrated)try{ma(t.containerInfo)}catch(y){Pt(i,i.return,y)}break;case 4:He(t,i),ai(i);break;case 13:He(t,i),ai(i),s=i.child,s.flags&8192&&(n=s.memoizedState!==null,s.stateNode.isHidden=n,!n||s.alternate!==null&&s.alternate.memoizedState!==null||(Zf=Bt())),r&4&&Pm(i);break;case 22:if(u=e!==null&&e.memoizedState!==null,i.mode&1?(ne=(h=ne)||u,He(t,i),ne=h):He(t,i),ai(i),r&8192){if(h=i.memoizedState!==null,(i.stateNode.isHidden=h)&&!u&&i.mode&1)for(Y=i,u=i.child;u!==null;){for(d=Y=u;Y!==null;){switch(c=Y,f=c.child,c.tag){case 0:case 11:case 14:case 15:ia(4,c,c.return);break;case 1:Gs(c,c.return);var p=c.stateNode;if(typeof p.componentWillUnmount=="function"){r=c,e=c.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(y){Pt(r,e,y)}}break;case 5:Gs(c,c.return);break;case 22:if(c.memoizedState!==null){Om(d);continue}}f!==null?(f.return=c,Y=f):Om(d)}u=u.sibling}t:for(u=null,d=i;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,h?(n=s.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=fy("display",a))}catch(y){Pt(i,i.return,y)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(y){Pt(i,i.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===i)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break t;for(;d.sibling===null;){if(d.return===null||d.return===i)break t;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:He(t,i),ai(i),r&4&&Pm(i);break;case 21:break;default:He(t,i),ai(i)}}function ai(i){var t=i.flags;if(t&2){try{t:{for(var e=i.return;e!==null;){if(U0(e)){var r=e;break t}e=e.return}throw Error(L(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ca(s,""),r.flags&=-33);var n=Mm(i);td(i,n,s);break;case 3:case 4:var a=r.stateNode.containerInfo,o=Mm(i);Jc(i,o,a);break;default:throw Error(L(161))}}catch(l){Pt(i,i.return,l)}i.flags&=-3}t&4096&&(i.flags&=-4097)}function SA(i,t,e){Y=i,H0(i)}function H0(i,t,e){for(var r=(i.mode&1)!==0;Y!==null;){var s=Y,n=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ho;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||ne;o=ho;var h=ne;if(ho=a,(ne=l)&&!h)for(Y=s;Y!==null;)a=Y,l=a.child,a.tag===22&&a.memoizedState!==null?Bm(s):l!==null?(l.return=a,Y=l):Bm(s);for(;n!==null;)Y=n,H0(n),n=n.sibling;Y=s,ho=o,ne=h}Fm(i)}else s.subtreeFlags&8772&&n!==null?(n.return=s,Y=n):Fm(i)}}function Fm(i){for(;Y!==null;){var t=Y;if(t.flags&8772){var e=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ne||ch(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ne)if(e===null)r.componentDidMount();else{var s=t.elementType===t.type?e.memoizedProps:Ye(t.type,e.memoizedProps);r.componentDidUpdate(s,e.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;n!==null&&gm(t,n,r);break;case 3:var a=t.updateQueue;if(a!==null){if(e=null,t.child!==null)switch(t.child.tag){case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}gm(t,a,e)}break;case 5:var o=t.stateNode;if(e===null&&t.flags&4){e=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&e.focus();break;case"img":l.src&&(e.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ma(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}ne||t.flags&512&&Qc(t)}catch(c){Pt(t,t.return,c)}}if(t===i){Y=null;break}if(e=t.sibling,e!==null){e.return=t.return,Y=e;break}Y=t.return}}function Om(i){for(;Y!==null;){var t=Y;if(t===i){Y=null;break}var e=t.sibling;if(e!==null){e.return=t.return,Y=e;break}Y=t.return}}function Bm(i){for(;Y!==null;){var t=Y;try{switch(t.tag){case 0:case 11:case 15:var e=t.return;try{ch(4,t)}catch(l){Pt(t,e,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(l){Pt(t,s,l)}}var n=t.return;try{Qc(t)}catch(l){Pt(t,n,l)}break;case 5:var a=t.return;try{Qc(t)}catch(l){Pt(t,a,l)}}}catch(l){Pt(t,t.return,l)}if(t===i){Y=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Y=o;break}Y=t.return}}var wA=Math.ceil,Pl=qi.ReactCurrentDispatcher,qf=qi.ReactCurrentOwner,Ue=qi.ReactCurrentBatchConfig,pt=0,qt=null,Ut=null,ee=0,we=0,Vs=Cr(0),$t=0,ba=null,ss=0,dh=0,Kf=0,ra=null,ge=null,Zf=0,cn=1/0,Mi=null,Fl=!1,ed=null,yr=null,uo=!1,lr=null,Ol=0,sa=0,id=null,Yo=-1,jo=0;function de(){return pt&6?Bt():Yo!==-1?Yo:Yo=Bt()}function vr(i){return i.mode&1?pt&2&&ee!==0?ee&-ee:lA.transition!==null?(jo===0&&(jo=by()),jo):(i=_t,i!==0||(i=window.event,i=i===void 0?16:Fy(i.type)),i):1}function Je(i,t,e,r){if(50<sa)throw sa=0,id=null,Error(L(185));Oa(i,e,r),(!(pt&2)||i!==qt)&&(i===qt&&(!(pt&2)&&(dh|=e),$t===4&&sr(i,ee)),Ae(i,r),e===1&&pt===0&&!(t.mode&1)&&(cn=Bt()+500,lh&&Ir()))}function Ae(i,t){var e=i.callbackNode;l1(i,t);var r=gl(i,i===qt?ee:0);if(r===0)e!==null&&Xp(e),i.callbackNode=null,i.callbackPriority=0;else if(t=r&-r,i.callbackPriority!==t){if(e!=null&&Xp(e),t===1)i.tag===0?oA(km.bind(null,i)):Qy(km.bind(null,i)),rA(function(){!(pt&6)&&Ir()}),e=null;else{switch(Cy(r)){case 1:e=Ef;break;case 4:e=Sy;break;case 16:e=_l;break;case 536870912:e=wy;break;default:e=_l}e=K0(e,z0.bind(null,i))}i.callbackPriority=t,i.callbackNode=e}}function z0(i,t){if(Yo=-1,jo=0,pt&6)throw Error(L(327));var e=i.callbackNode;if(qs()&&i.callbackNode!==e)return null;var r=gl(i,i===qt?ee:0);if(r===0)return null;if(r&30||r&i.expiredLanes||t)t=Bl(i,r);else{t=r;var s=pt;pt|=2;var n=$0();(qt!==i||ee!==t)&&(Mi=null,cn=Bt()+500,jr(i,t));do try{IA();break}catch(o){X0(i,o)}while(!0);kf(),Pl.current=n,pt=s,Ut!==null?t=0:(qt=null,ee=0,t=$t)}if(t!==0){if(t===2&&(s=Dc(i),s!==0&&(r=s,t=rd(i,s))),t===1)throw e=ba,jr(i,0),sr(i,r),Ae(i,Bt()),e;if(t===6)sr(i,r);else{if(s=i.current.alternate,!(r&30)&&!bA(s)&&(t=Bl(i,r),t===2&&(n=Dc(i),n!==0&&(r=n,t=rd(i,n))),t===1))throw e=ba,jr(i,0),sr(i,r),Ae(i,Bt()),e;switch(i.finishedWork=s,i.finishedLanes=r,t){case 0:case 1:throw Error(L(345));case 2:Or(i,ge,Mi);break;case 3:if(sr(i,r),(r&130023424)===r&&(t=Zf+500-Bt(),10<t)){if(gl(i,0)!==0)break;if(s=i.suspendedLanes,(s&r)!==r){de(),i.pingedLanes|=i.suspendedLanes&s;break}i.timeoutHandle=Nc(Or.bind(null,i,ge,Mi),t);break}Or(i,ge,Mi);break;case 4:if(sr(i,r),(r&4194240)===r)break;for(t=i.eventTimes,s=-1;0<r;){var a=31-Qe(r);n=1<<a,a=t[a],a>s&&(s=a),r&=~n}if(r=s,r=Bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wA(r/1960))-r,10<r){i.timeoutHandle=Nc(Or.bind(null,i,ge,Mi),r);break}Or(i,ge,Mi);break;case 5:Or(i,ge,Mi);break;default:throw Error(L(329))}}}return Ae(i,Bt()),i.callbackNode===e?z0.bind(null,i):null}function rd(i,t){var e=ra;return i.current.memoizedState.isDehydrated&&(jr(i,t).flags|=256),i=Bl(i,t),i!==2&&(t=ge,ge=e,t!==null&&sd(t)),i}function sd(i){ge===null?ge=i:ge.push.apply(ge,i)}function bA(i){for(var t=i;;){if(t.flags&16384){var e=t.updateQueue;if(e!==null&&(e=e.stores,e!==null))for(var r=0;r<e.length;r++){var s=e[r],n=s.getSnapshot;s=s.value;try{if(!ii(n(),s))return!1}catch{return!1}}}if(e=t.child,t.subtreeFlags&16384&&e!==null)e.return=t,t=e;else{if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sr(i,t){for(t&=~Kf,t&=~dh,i.suspendedLanes|=t,i.pingedLanes&=~t,i=i.expirationTimes;0<t;){var e=31-Qe(t),r=1<<e;i[e]=-1,t&=~r}}function km(i){if(pt&6)throw Error(L(327));qs();var t=gl(i,0);if(!(t&1))return Ae(i,Bt()),null;var e=Bl(i,t);if(i.tag!==0&&e===2){var r=Dc(i);r!==0&&(t=r,e=rd(i,r))}if(e===1)throw e=ba,jr(i,0),sr(i,t),Ae(i,Bt()),e;if(e===6)throw Error(L(345));return i.finishedWork=i.current.alternate,i.finishedLanes=t,Or(i,ge,Mi),Ae(i,Bt()),null}function Qf(i,t){var e=pt;pt|=1;try{return i(t)}finally{pt=e,pt===0&&(cn=Bt()+500,lh&&Ir())}}function ns(i){lr!==null&&lr.tag===0&&!(pt&6)&&qs();var t=pt;pt|=1;var e=Ue.transition,r=_t;try{if(Ue.transition=null,_t=1,i)return i()}finally{_t=r,Ue.transition=e,pt=t,!(pt&6)&&Ir()}}function Jf(){we=Vs.current,At(Vs)}function jr(i,t){i.finishedWork=null,i.finishedLanes=0;var e=i.timeoutHandle;if(e!==-1&&(i.timeoutHandle=-1,iA(e)),Ut!==null)for(e=Ut.return;e!==null;){var r=e;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Al();break;case 3:hn(),At(xe),At(ae),Hf();break;case 5:Vf(r);break;case 4:hn();break;case 13:At(bt);break;case 19:At(bt);break;case 10:Nf(r.type._context);break;case 22:case 23:Jf()}e=e.return}if(qt=i,Ut=i=xr(i.current,null),ee=we=t,$t=0,ba=null,Kf=dh=ss=0,ge=ra=null,Xr!==null){for(t=0;t<Xr.length;t++)if(e=Xr[t],r=e.interleaved,r!==null){e.interleaved=null;var s=r.next,n=e.pending;if(n!==null){var a=n.next;n.next=s,r.next=a}e.pending=r}Xr=null}return i}function X0(i,t){do{var e=Ut;try{if(kf(),Xo.current=Ml,Rl){for(var r=It.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Rl=!1}if(rs=0,Yt=Xt=It=null,ea=!1,Ea=0,qf.current=null,e===null||e.return===null){$t=1,ba=t,Ut=null;break}t:{var n=i,a=e.return,o=e,l=t;if(t=ee,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var c=u.alternate;c?(u.updateQueue=c.updateQueue,u.memoizedState=c.memoizedState,u.lanes=c.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Em(a);if(f!==null){f.flags&=-257,Sm(f,a,o,n,t),f.mode&1&&Am(n,h,t),t=f,l=h;var p=t.updateQueue;if(p===null){var y=new Set;y.add(l),t.updateQueue=y}else p.add(l);break t}else{if(!(t&1)){Am(n,h,t),tp();break t}l=Error(L(426))}}else if(wt&&o.mode&1){var x=Em(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Sm(x,a,o,n,t),Of(un(l,o));break t}}n=l=un(l,o),$t!==4&&($t=2),ra===null?ra=[n]:ra.push(n),n=a;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t;var m=C0(n,l,t);_m(n,m);break t;case 1:o=l;var _=n.type,g=n.stateNode;if(!(n.flags&128)&&(typeof _.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(yr===null||!yr.has(g)))){n.flags|=65536,t&=-t,n.lanes|=t;var T=I0(n,o,t);_m(n,T);break t}}n=n.return}while(n!==null)}Y0(e)}catch(A){t=A,Ut===e&&e!==null&&(Ut=e=e.return);continue}break}while(!0)}function $0(){var i=Pl.current;return Pl.current=Ml,i===null?Ml:i}function tp(){($t===0||$t===3||$t===2)&&($t=4),qt===null||!(ss&268435455)&&!(dh&268435455)||sr(qt,ee)}function Bl(i,t){var e=pt;pt|=2;var r=$0();(qt!==i||ee!==t)&&(Mi=null,jr(i,t));do try{CA();break}catch(s){X0(i,s)}while(!0);if(kf(),pt=e,Pl.current=r,Ut!==null)throw Error(L(261));return qt=null,ee=0,$t}function CA(){for(;Ut!==null;)W0(Ut)}function IA(){for(;Ut!==null&&!JT();)W0(Ut)}function W0(i){var t=q0(i.alternate,i,we);i.memoizedProps=i.pendingProps,t===null?Y0(i):Ut=t,qf.current=null}function Y0(i){var t=i;do{var e=t.alternate;if(i=t.return,t.flags&32768){if(e=TA(e,t),e!==null){e.flags&=32767,Ut=e;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{$t=6,Ut=null;return}}else if(e=xA(e,t,we),e!==null){Ut=e;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=i}while(t!==null);$t===0&&($t=5)}function Or(i,t,e){var r=_t,s=Ue.transition;try{Ue.transition=null,_t=1,DA(i,t,e,r)}finally{Ue.transition=s,_t=r}return null}function DA(i,t,e,r){do qs();while(lr!==null);if(pt&6)throw Error(L(327));e=i.finishedWork;var s=i.finishedLanes;if(e===null)return null;if(i.finishedWork=null,i.finishedLanes=0,e===i.current)throw Error(L(177));i.callbackNode=null,i.callbackPriority=0;var n=e.lanes|e.childLanes;if(h1(i,n),i===qt&&(Ut=qt=null,ee=0),!(e.subtreeFlags&2064)&&!(e.flags&2064)||uo||(uo=!0,K0(_l,function(){return qs(),null})),n=(e.flags&15990)!==0,e.subtreeFlags&15990||n){n=Ue.transition,Ue.transition=null;var a=_t;_t=1;var o=pt;pt|=4,qf.current=null,EA(i,e),V0(e,i),q1(Bc),yl=!!Oc,Bc=Oc=null,i.current=e,SA(e),t1(),pt=o,_t=a,Ue.transition=n}else i.current=e;if(uo&&(uo=!1,lr=i,Ol=s),n=i.pendingLanes,n===0&&(yr=null),r1(e.stateNode),Ae(i,Bt()),t!==null)for(r=i.onRecoverableError,e=0;e<t.length;e++)s=t[e],r(s.value,{componentStack:s.stack,digest:s.digest});if(Fl)throw Fl=!1,i=ed,ed=null,i;return Ol&1&&i.tag!==0&&qs(),n=i.pendingLanes,n&1?i===id?sa++:(sa=0,id=i):sa=0,Ir(),null}function qs(){if(lr!==null){var i=Cy(Ol),t=Ue.transition,e=_t;try{if(Ue.transition=null,_t=16>i?16:i,lr===null)var r=!1;else{if(i=lr,lr=null,Ol=0,pt&6)throw Error(L(331));var s=pt;for(pt|=4,Y=i.current;Y!==null;){var n=Y,a=n.child;if(Y.flags&16){var o=n.deletions;if(o!==null){for(var l=0;l<o.length;l++){var h=o[l];for(Y=h;Y!==null;){var u=Y;switch(u.tag){case 0:case 11:case 15:ia(8,u,n)}var d=u.child;if(d!==null)d.return=u,Y=d;else for(;Y!==null;){u=Y;var c=u.sibling,f=u.return;if(L0(u),u===h){Y=null;break}if(c!==null){c.return=f,Y=c;break}Y=f}}}var p=n.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Y=n}}if(n.subtreeFlags&2064&&a!==null)a.return=n,Y=a;else t:for(;Y!==null;){if(n=Y,n.flags&2048)switch(n.tag){case 0:case 11:case 15:ia(9,n,n.return)}var m=n.sibling;if(m!==null){m.return=n.return,Y=m;break t}Y=n.return}}var _=i.current;for(Y=_;Y!==null;){a=Y;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,Y=g;else t:for(a=_;Y!==null;){if(o=Y,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ch(9,o)}}catch(A){Pt(o,o.return,A)}if(o===a){Y=null;break t}var T=o.sibling;if(T!==null){T.return=o.return,Y=T;break t}Y=o.return}}if(pt=s,Ir(),Ti&&typeof Ti.onPostCommitFiberRoot=="function")try{Ti.onPostCommitFiberRoot(rh,i)}catch{}r=!0}return r}finally{_t=e,Ue.transition=t}}return!1}function Nm(i,t,e){t=un(e,t),t=C0(i,t,1),i=gr(i,t,1),t=de(),i!==null&&(Oa(i,1,t),Ae(i,t))}function Pt(i,t,e){if(i.tag===3)Nm(i,i,e);else for(;t!==null;){if(t.tag===3){Nm(t,i,e);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yr===null||!yr.has(r))){i=un(e,i),i=I0(t,i,1),t=gr(t,i,1),i=de(),t!==null&&(Oa(t,1,i),Ae(t,i));break}}t=t.return}}function RA(i,t,e){var r=i.pingCache;r!==null&&r.delete(t),t=de(),i.pingedLanes|=i.suspendedLanes&e,qt===i&&(ee&e)===e&&($t===4||$t===3&&(ee&130023424)===ee&&500>Bt()-Zf?jr(i,0):Kf|=e),Ae(i,t)}function j0(i,t){t===0&&(i.mode&1?(t=to,to<<=1,!(to&130023424)&&(to=4194304)):t=1);var e=de();i=Xi(i,t),i!==null&&(Oa(i,t,e),Ae(i,e))}function MA(i){var t=i.memoizedState,e=0;t!==null&&(e=t.retryLane),j0(i,e)}function PA(i,t){var e=0;switch(i.tag){case 13:var r=i.stateNode,s=i.memoizedState;s!==null&&(e=s.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(t),j0(i,e)}var q0;q0=function(i,t,e){if(i!==null)if(i.memoizedProps!==t.pendingProps||xe.current)ye=!0;else{if(!(i.lanes&e)&&!(t.flags&128))return ye=!1,vA(i,t,e);ye=!!(i.flags&131072)}else ye=!1,wt&&t.flags&1048576&&Jy(t,wl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wo(i,t),i=t.pendingProps;var s=an(t,ae.current);js(t,e),s=Xf(null,t,r,i,s,e);var n=$f();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Te(r)?(n=!0,El(t)):n=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uf(t),s.updater=uh,t.stateNode=s,s._reactInternals=t,Xc(t,r,i,e),t=Yc(null,t,r,!0,n,e)):(t.tag=0,wt&&n&&Pf(t),le(null,t,s,e),t=t.child),t;case 16:r=t.elementType;t:{switch(Wo(i,t),i=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=OA(r),i=Ye(r,i),s){case 0:t=Wc(null,t,r,i,e);break t;case 1:t=Cm(null,t,r,i,e);break t;case 11:t=wm(null,t,r,i,e);break t;case 14:t=bm(null,t,r,Ye(r.type,i),e);break t}throw Error(L(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ye(r,s),Wc(i,t,r,s,e);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ye(r,s),Cm(i,t,r,s,e);case 3:t:{if(P0(t),i===null)throw Error(L(387));r=t.pendingProps,n=t.memoizedState,s=n.element,n0(i,t),Il(t,r,null,e);var a=t.memoizedState;if(r=a.element,n.isDehydrated)if(n={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){s=un(Error(L(423)),t),t=Im(i,t,r,e,s);break t}else if(r!==s){s=un(Error(L(424)),t),t=Im(i,t,r,e,s);break t}else for(be=_r(t.stateNode.containerInfo.firstChild),Ce=t,wt=!0,Ke=null,e=r0(t,null,r,e),t.child=e;e;)e.flags=e.flags&-3|4096,e=e.sibling;else{if(on(),r===s){t=$i(i,t,e);break t}le(i,t,r,e)}t=t.child}return t;case 5:return a0(t),i===null&&Vc(t),r=t.type,s=t.pendingProps,n=i!==null?i.memoizedProps:null,a=s.children,kc(r,s)?a=null:n!==null&&kc(r,n)&&(t.flags|=32),M0(i,t),le(i,t,a,e),t.child;case 6:return i===null&&Vc(t),null;case 13:return F0(i,t,e);case 4:return Gf(t,t.stateNode.containerInfo),r=t.pendingProps,i===null?t.child=ln(t,null,r,e):le(i,t,r,e),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ye(r,s),wm(i,t,r,s,e);case 7:return le(i,t,t.pendingProps,e),t.child;case 8:return le(i,t,t.pendingProps.children,e),t.child;case 12:return le(i,t,t.pendingProps.children,e),t.child;case 10:t:{if(r=t.type._context,s=t.pendingProps,n=t.memoizedProps,a=s.value,yt(bl,r._currentValue),r._currentValue=a,n!==null)if(ii(n.value,a)){if(n.children===s.children&&!xe.current){t=$i(i,t,e);break t}}else for(n=t.child,n!==null&&(n.return=t);n!==null;){var o=n.dependencies;if(o!==null){a=n.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(n.tag===1){l=Gi(-1,e&-e),l.tag=2;var h=n.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?l.next=l:(l.next=u.next,u.next=l),h.pending=l}}n.lanes|=e,l=n.alternate,l!==null&&(l.lanes|=e),Hc(n.return,e,t),o.lanes|=e;break}l=l.next}}else if(n.tag===10)a=n.type===t.type?null:n.child;else if(n.tag===18){if(a=n.return,a===null)throw Error(L(341));a.lanes|=e,o=a.alternate,o!==null&&(o.lanes|=e),Hc(a,e,t),a=n.sibling}else a=n.child;if(a!==null)a.return=n;else for(a=n;a!==null;){if(a===t){a=null;break}if(n=a.sibling,n!==null){n.return=a.return,a=n;break}a=a.return}n=a}le(i,t,s.children,e),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,js(t,e),s=Ge(s),r=r(s),t.flags|=1,le(i,t,r,e),t.child;case 14:return r=t.type,s=Ye(r,t.pendingProps),s=Ye(r.type,s),bm(i,t,r,s,e);case 15:return D0(i,t,t.type,t.pendingProps,e);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ye(r,s),Wo(i,t),t.tag=1,Te(r)?(i=!0,El(t)):i=!1,js(t,e),b0(t,r,s),Xc(t,r,s,e),Yc(null,t,r,!0,i,e);case 19:return O0(i,t,e);case 22:return R0(i,t,e)}throw Error(L(156,t.tag))};function K0(i,t){return Ey(i,t)}function FA(i,t,e,r){this.tag=i,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ke(i,t,e,r){return new FA(i,t,e,r)}function ep(i){return i=i.prototype,!(!i||!i.isReactComponent)}function OA(i){if(typeof i=="function")return ep(i)?1:0;if(i!=null){if(i=i.$$typeof,i===xf)return 11;if(i===Tf)return 14}return 2}function xr(i,t){var e=i.alternate;return e===null?(e=ke(i.tag,t,i.key,i.mode),e.elementType=i.elementType,e.type=i.type,e.stateNode=i.stateNode,e.alternate=i,i.alternate=e):(e.pendingProps=t,e.type=i.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=i.flags&14680064,e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,t=i.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},e.sibling=i.sibling,e.index=i.index,e.ref=i.ref,e}function qo(i,t,e,r,s,n){var a=2;if(r=i,typeof i=="function")ep(i)&&(a=1);else if(typeof i=="string")a=5;else t:switch(i){case Ms:return qr(e.children,s,n,t);case vf:a=8,s|=8;break;case pc:return i=ke(12,e,t,s|2),i.elementType=pc,i.lanes=n,i;case mc:return i=ke(13,e,t,s),i.elementType=mc,i.lanes=n,i;case _c:return i=ke(19,e,t,s),i.elementType=_c,i.lanes=n,i;case ay:return fh(e,s,n,t);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case sy:a=10;break t;case ny:a=9;break t;case xf:a=11;break t;case Tf:a=14;break t;case tr:a=16,r=null;break t}throw Error(L(130,i==null?i:typeof i,""))}return t=ke(a,e,t,s),t.elementType=i,t.type=r,t.lanes=n,t}function qr(i,t,e,r){return i=ke(7,i,r,t),i.lanes=e,i}function fh(i,t,e,r){return i=ke(22,i,r,t),i.elementType=ay,i.lanes=e,i.stateNode={isHidden:!1},i}function uu(i,t,e){return i=ke(6,i,null,t),i.lanes=e,i}function cu(i,t,e){return t=ke(4,i.children!==null?i.children:[],i.key,t),t.lanes=e,t.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},t}function BA(i,t,e,r,s){this.tag=t,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$h(0),this.expirationTimes=$h(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$h(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ip(i,t,e,r,s,n,a,o,l){return i=new BA(i,t,e,o,l),t===1?(t=1,n===!0&&(t|=8)):t=0,n=ke(3,null,null,t),i.current=n,n.stateNode=i,n.memoizedState={element:r,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(n),i}function kA(i,t,e){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rs,key:r==null?null:""+r,children:i,containerInfo:t,implementation:e}}function Z0(i){if(!i)return Sr;i=i._reactInternals;t:{if(ds(i)!==i||i.tag!==1)throw Error(L(170));var t=i;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(Te(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(L(171))}if(i.tag===1){var e=i.type;if(Te(e))return Zy(i,e,t)}return t}function Q0(i,t,e,r,s,n,a,o,l){return i=ip(e,r,!0,i,s,n,a,o,l),i.context=Z0(null),e=i.current,r=de(),s=vr(e),n=Gi(r,s),n.callback=t??null,gr(e,n,s),i.current.lanes=s,Oa(i,s,r),Ae(i,r),i}function ph(i,t,e,r){var s=t.current,n=de(),a=vr(s);return e=Z0(e),t.context===null?t.context=e:t.pendingContext=e,t=Gi(n,a),t.payload={element:i},r=r===void 0?null:r,r!==null&&(t.callback=r),i=gr(s,t,a),i!==null&&(Je(i,s,a,n),zo(i,s,a)),a}function kl(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Lm(i,t){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var e=i.retryLane;i.retryLane=e!==0&&e<t?e:t}}function rp(i,t){Lm(i,t),(i=i.alternate)&&Lm(i,t)}function NA(){return null}var J0=typeof reportError=="function"?reportError:function(i){console.error(i)};function sp(i){this._internalRoot=i}mh.prototype.render=sp.prototype.render=function(i){var t=this._internalRoot;if(t===null)throw Error(L(409));ph(i,t,null,null)};mh.prototype.unmount=sp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var t=i.containerInfo;ns(function(){ph(null,i,null,null)}),t[zi]=null}};function mh(i){this._internalRoot=i}mh.prototype.unstable_scheduleHydration=function(i){if(i){var t=Ry();i={blockedOn:null,target:i,priority:t};for(var e=0;e<rr.length&&t!==0&&t<rr[e].priority;e++);rr.splice(e,0,i),e===0&&Py(i)}};function np(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function _h(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Um(){}function LA(i,t,e,r,s){if(s){if(typeof r=="function"){var n=r;r=function(){var h=kl(a);n.call(h)}}var a=Q0(t,r,i,0,null,!1,!1,"",Um);return i._reactRootContainer=a,i[zi]=a.current,ya(i.nodeType===8?i.parentNode:i),ns(),a}for(;s=i.lastChild;)i.removeChild(s);if(typeof r=="function"){var o=r;r=function(){var h=kl(l);o.call(h)}}var l=ip(i,0,!1,null,null,!1,!1,"",Um);return i._reactRootContainer=l,i[zi]=l.current,ya(i.nodeType===8?i.parentNode:i),ns(function(){ph(t,l,e,r)}),l}function gh(i,t,e,r,s){var n=e._reactRootContainer;if(n){var a=n;if(typeof s=="function"){var o=s;s=function(){var l=kl(a);o.call(l)}}ph(t,a,i,s)}else a=LA(e,t,i,s,r);return kl(a)}Iy=function(i){switch(i.tag){case 3:var t=i.stateNode;if(t.current.memoizedState.isDehydrated){var e=Un(t.pendingLanes);e!==0&&(Sf(t,e|1),Ae(t,Bt()),!(pt&6)&&(cn=Bt()+500,Ir()))}break;case 13:ns(function(){var r=Xi(i,1);if(r!==null){var s=de();Je(r,i,1,s)}}),rp(i,1)}};wf=function(i){if(i.tag===13){var t=Xi(i,134217728);if(t!==null){var e=de();Je(t,i,134217728,e)}rp(i,134217728)}};Dy=function(i){if(i.tag===13){var t=vr(i),e=Xi(i,t);if(e!==null){var r=de();Je(e,i,t,r)}rp(i,t)}};Ry=function(){return _t};My=function(i,t){var e=_t;try{return _t=i,t()}finally{_t=e}};bc=function(i,t,e){switch(t){case"input":if(vc(i,e),t=e.name,e.type==="radio"&&t!=null){for(e=i;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<e.length;t++){var r=e[t];if(r!==i&&r.form===i.form){var s=oh(r);if(!s)throw Error(L(90));ly(r),vc(r,s)}}}break;case"textarea":uy(i,e);break;case"select":t=e.value,t!=null&&Xs(i,!!e.multiple,t,!1)}};gy=Qf;yy=ns;var UA={usingClientEntryPoint:!1,Events:[ka,Bs,oh,my,_y,Qf]},Rn={findFiberByHostInstance:zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GA={bundleType:Rn.bundleType,version:Rn.version,rendererPackageName:Rn.rendererPackageName,rendererConfig:Rn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qi.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ty(i),i===null?null:i.stateNode},findFiberByHostInstance:Rn.findFiberByHostInstance||NA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var co=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!co.isDisabled&&co.supportsFiber)try{rh=co.inject(GA),Ti=co}catch{}}De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UA;De.createPortal=function(i,t){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!np(t))throw Error(L(200));return kA(i,t,null,e)};De.createRoot=function(i,t){if(!np(i))throw Error(L(299));var e=!1,r="",s=J0;return t!=null&&(t.unstable_strictMode===!0&&(e=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ip(i,1,!1,null,null,e,!1,r,s),i[zi]=t.current,ya(i.nodeType===8?i.parentNode:i),new sp(t)};De.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var t=i._reactInternals;if(t===void 0)throw typeof i.render=="function"?Error(L(188)):(i=Object.keys(i).join(","),Error(L(268,i)));return i=Ty(t),i=i===null?null:i.stateNode,i};De.flushSync=function(i){return ns(i)};De.hydrate=function(i,t,e){if(!_h(t))throw Error(L(200));return gh(null,i,t,!0,e)};De.hydrateRoot=function(i,t,e){if(!np(i))throw Error(L(405));var r=e!=null&&e.hydratedSources||null,s=!1,n="",a=J0;if(e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),t=Q0(t,null,i,1,e??null,s,!1,n,a),i[zi]=t.current,ya(i),r)for(i=0;i<r.length;i++)e=r[i],s=e._getVersion,s=s(e._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[e,s]:t.mutableSourceEagerHydrationData.push(e,s);return new mh(t)};De.render=function(i,t,e){if(!_h(t))throw Error(L(200));return gh(null,i,t,!1,e)};De.unmountComponentAtNode=function(i){if(!_h(i))throw Error(L(40));return i._reactRootContainer?(ns(function(){gh(null,null,i,!1,function(){i._reactRootContainer=null,i[zi]=null})}),!0):!1};De.unstable_batchedUpdates=Qf;De.unstable_renderSubtreeIntoContainer=function(i,t,e,r){if(!_h(e))throw Error(L(200));if(i==null||i._reactInternals===void 0)throw Error(L(38));return gh(i,t,e,!1,r)};De.version="18.3.1-next-f1338f8080-20240426";function tv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tv)}catch(i){console.error(i)}}tv(),ty.exports=De;var VA=ty.exports,Gm=VA;dc.createRoot=Gm.createRoot,dc.hydrateRoot=Gm.hydrateRoot;function HA(){const[i,t]=nt.useState(()=>{try{const r=JSON.parse(localStorage.getItem("offspot-user"));return r!=null&&r.username?r:null}catch{return null}});return nt.useEffect(()=>{const r=new URL(window.location.href),s=r.searchParams.get("username"),n=r.searchParams.get("avatar"),a=r.searchParams.get("id");if(s&&n&&a){const o={username:s,avatar:n,id:a};localStorage.setItem("offspot-user",JSON.stringify(o)),t(o),setTimeout(()=>{window.history.replaceState({},"","/")},50)}},[]),{user:i,setUser:t,logout:()=>{localStorage.removeItem("offspot-user"),t(null)}}}var fs=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(fs||{}),ev=(i=>(i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS",i))(ev||{}),nd=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(nd||{}),Z=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(Z||{}),xi=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(xi||{}),G=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(G||{}),Ks=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(Ks||{}),J=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(J||{}),$=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))($||{}),ki=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(ki||{}),Tr=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(Tr||{}),bi=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(bi||{}),ve=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(ve||{}),mi=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(mi||{}),ap=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(ap||{}),Ne=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(Ne||{}),zt=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(zt||{}),Lt=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(Lt||{}),Ei=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(Ei||{});const zA={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},W={ADAPTER:zA,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var du=/iPhone/i,Vm=/iPod/i,Hm=/iPad/i,zm=/\biOS-universal(?:.+)Mac\b/i,fu=/\bAndroid(?:.+)Mobile\b/i,Xm=/Android/i,gs=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,fo=/Silk/i,Di=/Windows Phone/i,$m=/\bWindows(?:.+)ARM\b/i,Wm=/BlackBerry/i,Ym=/BB10/i,jm=/Opera Mini/i,qm=/\b(CriOS|Chrome)(?:.+)Mobile/i,Km=/Mobile(?:.+)Firefox\b/i,Zm=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function XA(i){return function(t){return t.test(i)}}function Qm(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,r=e.split("[FBAN");typeof r[1]<"u"&&(e=r[0]),r=e.split("Twitter"),typeof r[1]<"u"&&(e=r[0]);var s=XA(e),n={apple:{phone:s(du)&&!s(Di),ipod:s(Vm),tablet:!s(du)&&(s(Hm)||Zm(t))&&!s(Di),universal:s(zm),device:(s(du)||s(Vm)||s(Hm)||s(zm)||Zm(t))&&!s(Di)},amazon:{phone:s(gs),tablet:!s(gs)&&s(fo),device:s(gs)||s(fo)},android:{phone:!s(Di)&&s(gs)||!s(Di)&&s(fu),tablet:!s(Di)&&!s(gs)&&!s(fu)&&(s(fo)||s(Xm)),device:!s(Di)&&(s(gs)||s(fo)||s(fu)||s(Xm))||s(/\bokhttp\b/i)},windows:{phone:s(Di),tablet:s($m),device:s(Di)||s($m)},other:{blackberry:s(Wm),blackberry10:s(Ym),opera:s(jm),firefox:s(Km),chrome:s(qm),device:s(Wm)||s(Ym)||s(jm)||s(Km)||s(qm)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const $A=Qm.default??Qm,Ni=$A(globalThis.navigator);W.RETINA_PREFIX=/@([0-9\.]+)x/;W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var iv={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function s(l,h,u){this.fn=l,this.context=h,this.once=u||!1}function n(l,h,u,d,c){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,d||l,c),p=e?e+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function a(l,h){--l._eventsCount===0?l._events=new r:delete l._events[h]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var h=[],u,d;if(this._eventsCount===0)return h;for(d in u=this._events)t.call(u,d)&&h.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},o.prototype.listeners=function(h){var u=e?e+h:h,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var c=0,f=d.length,p=new Array(f);c<f;c++)p[c]=d[c].fn;return p},o.prototype.listenerCount=function(h){var u=e?e+h:h,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(h,u,d,c,f,p){var y=e?e+h:h;if(!this._events[y])return!1;var x=this._events[y],m=arguments.length,_,g;if(x.fn){switch(x.once&&this.removeListener(h,x.fn,void 0,!0),m){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,d),!0;case 4:return x.fn.call(x.context,u,d,c),!0;case 5:return x.fn.call(x.context,u,d,c,f),!0;case 6:return x.fn.call(x.context,u,d,c,f,p),!0}for(g=1,_=new Array(m-1);g<m;g++)_[g-1]=arguments[g];x.fn.apply(x.context,_)}else{var T=x.length,A;for(g=0;g<T;g++)switch(x[g].once&&this.removeListener(h,x[g].fn,void 0,!0),m){case 1:x[g].fn.call(x[g].context);break;case 2:x[g].fn.call(x[g].context,u);break;case 3:x[g].fn.call(x[g].context,u,d);break;case 4:x[g].fn.call(x[g].context,u,d,c);break;default:if(!_)for(A=1,_=new Array(m-1);A<m;A++)_[A-1]=arguments[A];x[g].fn.apply(x[g].context,_)}}return!0},o.prototype.on=function(h,u,d){return n(this,h,u,d,!1)},o.prototype.once=function(h,u,d){return n(this,h,u,d,!0)},o.prototype.removeListener=function(h,u,d,c){var f=e?e+h:h;if(!this._events[f])return this;if(!u)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!c||p.once)&&(!d||p.context===d)&&a(this,f);else{for(var y=0,x=[],m=p.length;y<m;y++)(p[y].fn!==u||c&&!p[y].once||d&&p[y].context!==d)&&x.push(p[y]);x.length?this._events[f]=x.length===1?x[0]:x:a(this,f)}return this},o.prototype.removeAllListeners=function(h){var u;return h?(u=e?e+h:h,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,i.exports=o})(iv);var WA=iv.exports;const La=cf(WA);var op={exports:{}};op.exports=yh;op.exports.default=yh;function yh(i,t,e){e=e||2;var r=t&&t.length,s=r?t[0]*e:i.length,n=rv(i,0,s,e,!0),a=[];if(!n||n.next===n.prev)return a;var o,l,h,u,d,c,f;if(r&&(n=ZA(i,t,n,e)),i.length>80*e){o=h=i[0],l=u=i[1];for(var p=e;p<s;p+=e)d=i[p],c=i[p+1],d<o&&(o=d),c<l&&(l=c),d>h&&(h=d),c>u&&(u=c);f=Math.max(h-o,u-l),f=f!==0?32767/f:0}return Ca(n,a,e,o,l,f,0),a}function rv(i,t,e,r,s){var n,a;if(s===ld(i,t,e,r)>0)for(n=t;n<e;n+=r)a=Jm(n,i[n],i[n+1],a);else for(n=e-r;n>=t;n-=r)a=Jm(n,i[n],i[n+1],a);return a&&vh(a,a.next)&&(Da(a),a=a.next),a}function as(i,t){if(!i)return i;t||(t=i);var e=i,r;do if(r=!1,!e.steiner&&(vh(e,e.next)||Ct(e.prev,e,e.next)===0)){if(Da(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Ca(i,t,e,r,s,n,a){if(i){!a&&n&&iE(i,r,s,n);for(var o=i,l,h;i.prev!==i.next;){if(l=i.prev,h=i.next,n?jA(i,r,s,n):YA(i)){t.push(l.i/e|0),t.push(i.i/e|0),t.push(h.i/e|0),Da(i),i=h.next,o=h.next;continue}if(i=h,i===o){a?a===1?(i=qA(as(i),t,e),Ca(i,t,e,r,s,n,2)):a===2&&KA(i,t,e,r,s,n):Ca(as(i),t,e,r,s,n,1);break}}}}function YA(i){var t=i.prev,e=i,r=i.next;if(Ct(t,e,r)>=0)return!1;for(var s=t.x,n=e.x,a=r.x,o=t.y,l=e.y,h=r.y,u=s<n?s<a?s:a:n<a?n:a,d=o<l?o<h?o:h:l<h?l:h,c=s>n?s>a?s:a:n>a?n:a,f=o>l?o>h?o:h:l>h?l:h,p=r.next;p!==t;){if(p.x>=u&&p.x<=c&&p.y>=d&&p.y<=f&&Hs(s,o,n,l,a,h,p.x,p.y)&&Ct(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function jA(i,t,e,r){var s=i.prev,n=i,a=i.next;if(Ct(s,n,a)>=0)return!1;for(var o=s.x,l=n.x,h=a.x,u=s.y,d=n.y,c=a.y,f=o<l?o<h?o:h:l<h?l:h,p=u<d?u<c?u:c:d<c?d:c,y=o>l?o>h?o:h:l>h?l:h,x=u>d?u>c?u:c:d>c?d:c,m=ad(f,p,t,e,r),_=ad(y,x,t,e,r),g=i.prevZ,T=i.nextZ;g&&g.z>=m&&T&&T.z<=_;){if(g.x>=f&&g.x<=y&&g.y>=p&&g.y<=x&&g!==s&&g!==a&&Hs(o,u,l,d,h,c,g.x,g.y)&&Ct(g.prev,g,g.next)>=0||(g=g.prevZ,T.x>=f&&T.x<=y&&T.y>=p&&T.y<=x&&T!==s&&T!==a&&Hs(o,u,l,d,h,c,T.x,T.y)&&Ct(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;g&&g.z>=m;){if(g.x>=f&&g.x<=y&&g.y>=p&&g.y<=x&&g!==s&&g!==a&&Hs(o,u,l,d,h,c,g.x,g.y)&&Ct(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;T&&T.z<=_;){if(T.x>=f&&T.x<=y&&T.y>=p&&T.y<=x&&T!==s&&T!==a&&Hs(o,u,l,d,h,c,T.x,T.y)&&Ct(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function qA(i,t,e){var r=i;do{var s=r.prev,n=r.next.next;!vh(s,n)&&sv(s,r,r.next,n)&&Ia(s,n)&&Ia(n,s)&&(t.push(s.i/e|0),t.push(r.i/e|0),t.push(n.i/e|0),Da(r),Da(r.next),r=i=n),r=r.next}while(r!==i);return as(r)}function KA(i,t,e,r,s,n){var a=i;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&nE(a,o)){var l=nv(a,o);a=as(a,a.next),l=as(l,l.next),Ca(a,t,e,r,s,n,0),Ca(l,t,e,r,s,n,0);return}o=o.next}a=a.next}while(a!==i)}function ZA(i,t,e,r){var s=[],n,a,o,l,h;for(n=0,a=t.length;n<a;n++)o=t[n]*r,l=n<a-1?t[n+1]*r:i.length,h=rv(i,o,l,r,!1),h===h.next&&(h.steiner=!0),s.push(sE(h));for(s.sort(QA),n=0;n<s.length;n++)e=JA(s[n],e);return e}function QA(i,t){return i.x-t.x}function JA(i,t){var e=tE(i,t);if(!e)return t;var r=nv(e,i);return as(r,r.next),as(e,e.next)}function tE(i,t){var e=t,r=i.x,s=i.y,n=-1/0,a;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var o=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=r&&o>n&&(n=o,a=e.x<e.next.x?e:e.next,o===r))return a}e=e.next}while(e!==t);if(!a)return null;var l=a,h=a.x,u=a.y,d=1/0,c;e=a;do r>=e.x&&e.x>=h&&r!==e.x&&Hs(s<u?r:n,s,h,u,s<u?n:r,s,e.x,e.y)&&(c=Math.abs(s-e.y)/(r-e.x),Ia(e,i)&&(c<d||c===d&&(e.x>a.x||e.x===a.x&&eE(a,e)))&&(a=e,d=c)),e=e.next;while(e!==l);return a}function eE(i,t){return Ct(i.prev,i,t.prev)<0&&Ct(t.next,i,i.next)<0}function iE(i,t,e,r){var s=i;do s.z===0&&(s.z=ad(s.x,s.y,t,e,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,rE(s)}function rE(i){var t,e,r,s,n,a,o,l,h=1;do{for(e=i,i=null,n=null,a=0;e;){for(a++,r=e,o=0,t=0;t<h&&(o++,r=r.nextZ,!!r);t++);for(l=h;o>0||l>0&&r;)o!==0&&(l===0||!r||e.z<=r.z)?(s=e,e=e.nextZ,o--):(s=r,r=r.nextZ,l--),n?n.nextZ=s:i=s,s.prevZ=n,n=s;e=r}n.nextZ=null,h*=2}while(a>1);return i}function ad(i,t,e,r,s){return i=(i-e)*s|0,t=(t-r)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function sE(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Hs(i,t,e,r,s,n,a,o){return(s-a)*(t-o)>=(i-a)*(n-o)&&(i-a)*(r-o)>=(e-a)*(t-o)&&(e-a)*(n-o)>=(s-a)*(r-o)}function nE(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!aE(i,t)&&(Ia(i,t)&&Ia(t,i)&&oE(i,t)&&(Ct(i.prev,i,t.prev)||Ct(i,t.prev,t))||vh(i,t)&&Ct(i.prev,i,i.next)>0&&Ct(t.prev,t,t.next)>0)}function Ct(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function vh(i,t){return i.x===t.x&&i.y===t.y}function sv(i,t,e,r){var s=mo(Ct(i,t,e)),n=mo(Ct(i,t,r)),a=mo(Ct(e,r,i)),o=mo(Ct(e,r,t));return!!(s!==n&&a!==o||s===0&&po(i,e,t)||n===0&&po(i,r,t)||a===0&&po(e,i,r)||o===0&&po(e,t,r))}function po(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function mo(i){return i>0?1:i<0?-1:0}function aE(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&sv(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Ia(i,t){return Ct(i.prev,i,i.next)<0?Ct(i,t,i.next)>=0&&Ct(i,i.prev,t)>=0:Ct(i,t,i.prev)<0||Ct(i,i.next,t)<0}function oE(i,t){var e=i,r=!1,s=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==i);return r}function nv(i,t){var e=new od(i.i,i.x,i.y),r=new od(t.i,t.x,t.y),s=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=s,s.prev=e,r.next=e,e.prev=r,n.next=r,r.prev=n,r}function Jm(i,t,e,r){var s=new od(i,t,e);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function Da(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function od(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}yh.deviation=function(i,t,e,r){var s=t&&t.length,n=s?t[0]*e:i.length,a=Math.abs(ld(i,0,n,e));if(s)for(var o=0,l=t.length;o<l;o++){var h=t[o]*e,u=o<l-1?t[o+1]*e:i.length;a-=Math.abs(ld(i,h,u,e))}var d=0;for(o=0;o<r.length;o+=3){var c=r[o]*e,f=r[o+1]*e,p=r[o+2]*e;d+=Math.abs((i[c]-i[p])*(i[f+1]-i[c+1])-(i[c]-i[f])*(i[p+1]-i[c+1]))}return a===0&&d===0?0:Math.abs((d-a)/a)};function ld(i,t,e,r){for(var s=0,n=t,a=e-r;n<e;n+=r)s+=(i[a]-i[n])*(i[n+1]+i[a+1]),a=n;return s}yh.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<i.length;s++){for(var n=0;n<i[s].length;n++)for(var a=0;a<t;a++)e.vertices.push(i[s][n][a]);s>0&&(r+=i[s-1].length,e.holes.push(r))}return e};var lE=op.exports;const hE=cf(lE);var Nl={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Nl.exports;(function(i,t){(function(e){var r=t&&!t.nodeType&&t,s=i&&!i.nodeType&&i,n=typeof qn=="object"&&qn;(n.global===n||n.window===n||n.self===n)&&(e=n);var a,o=2147483647,l=36,h=1,u=26,d=38,c=700,f=72,p=128,y="-",x=/^xn--/,m=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=l-h,A=Math.floor,S=String.fromCharCode,w;function E(M){throw new RangeError(g[M])}function C(M,B){for(var z=M.length,st=[];z--;)st[z]=B(M[z]);return st}function D(M,B){var z=M.split("@"),st="";z.length>1&&(st=z[0]+"@",M=z[1]),M=M.replace(_,".");var tt=M.split("."),gt=C(tt,B).join(".");return st+gt}function k(M){for(var B=[],z=0,st=M.length,tt,gt;z<st;)tt=M.charCodeAt(z++),tt>=55296&&tt<=56319&&z<st?(gt=M.charCodeAt(z++),(gt&64512)==56320?B.push(((tt&1023)<<10)+(gt&1023)+65536):(B.push(tt),z--)):B.push(tt);return B}function F(M){return C(M,function(B){var z="";return B>65535&&(B-=65536,z+=S(B>>>10&1023|55296),B=56320|B&1023),z+=S(B),z}).join("")}function b(M){return M-48<10?M-22:M-65<26?M-65:M-97<26?M-97:l}function P(M,B){return M+22+75*(M<26)-((B!=0)<<5)}function N(M,B,z){var st=0;for(M=z?A(M/c):M>>1,M+=A(M/B);M>T*u>>1;st+=l)M=A(M/T);return A(st+(T+1)*M/(M+d))}function H(M){var B=[],z=M.length,st,tt=0,gt=p,et=f,it,vt,Ee,Zt,Et,Nt,Vt,si,ni;for(it=M.lastIndexOf(y),it<0&&(it=0),vt=0;vt<it;++vt)M.charCodeAt(vt)>=128&&E("not-basic"),B.push(M.charCodeAt(vt));for(Ee=it>0?it+1:0;Ee<z;){for(Zt=tt,Et=1,Nt=l;Ee>=z&&E("invalid-input"),Vt=b(M.charCodeAt(Ee++)),(Vt>=l||Vt>A((o-tt)/Et))&&E("overflow"),tt+=Vt*Et,si=Nt<=et?h:Nt>=et+u?u:Nt-et,!(Vt<si);Nt+=l)ni=l-si,Et>A(o/ni)&&E("overflow"),Et*=ni;st=B.length+1,et=N(tt-Zt,st,Zt==0),A(tt/st)>o-gt&&E("overflow"),gt+=A(tt/st),tt%=st,B.splice(tt++,0,gt)}return F(B)}function U(M){var B,z,st,tt,gt,et,it,vt,Ee,Zt,Et,Nt=[],Vt,si,ni,An;for(M=k(M),Vt=M.length,B=p,z=0,gt=f,et=0;et<Vt;++et)Et=M[et],Et<128&&Nt.push(S(Et));for(st=tt=Nt.length,tt&&Nt.push(y);st<Vt;){for(it=o,et=0;et<Vt;++et)Et=M[et],Et>=B&&Et<it&&(it=Et);for(si=st+1,it-B>A((o-z)/si)&&E("overflow"),z+=(it-B)*si,B=it,et=0;et<Vt;++et)if(Et=M[et],Et<B&&++z>o&&E("overflow"),Et==B){for(vt=z,Ee=l;Zt=Ee<=gt?h:Ee>=gt+u?u:Ee-gt,!(vt<Zt);Ee+=l)An=vt-Zt,ni=l-Zt,Nt.push(S(P(Zt+An%ni,0))),vt=A(An/ni);Nt.push(S(P(vt,0))),gt=N(z,si,st==tt),z=0,++st}++z,++B}return Nt.join("")}function R(M){return D(M,function(B){return x.test(B)?H(B.slice(4).toLowerCase()):B})}function V(M){return D(M,function(B){return m.test(B)?"xn--"+U(B):B})}if(a={version:"1.4.1",ucs2:{decode:k,encode:F},decode:H,encode:U,toASCII:V,toUnicode:R},r&&s)if(i.exports==r)s.exports=a;else for(w in a)a.hasOwnProperty(w)&&(r[w]=a[w]);else e.punycode=a})(qn)})(Nl,Nl.exports);var uE=Nl.exports,vn=TypeError;const cE={},dE=Object.freeze(Object.defineProperty({__proto__:null,default:cE},Symbol.toStringTag,{value:"Module"})),fE=TT(dE);var lp=typeof Map=="function"&&Map.prototype,pu=Object.getOwnPropertyDescriptor&&lp?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ll=lp&&pu&&typeof pu.get=="function"?pu.get:null,t_=lp&&Map.prototype.forEach,hp=typeof Set=="function"&&Set.prototype,mu=Object.getOwnPropertyDescriptor&&hp?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Ul=hp&&mu&&typeof mu.get=="function"?mu.get:null,e_=hp&&Set.prototype.forEach,pE=typeof WeakMap=="function"&&WeakMap.prototype,na=pE?WeakMap.prototype.has:null,mE=typeof WeakSet=="function"&&WeakSet.prototype,aa=mE?WeakSet.prototype.has:null,_E=typeof WeakRef=="function"&&WeakRef.prototype,i_=_E?WeakRef.prototype.deref:null,gE=Boolean.prototype.valueOf,yE=Object.prototype.toString,vE=Function.prototype.toString,xE=String.prototype.match,up=String.prototype.slice,hr=String.prototype.replace,TE=String.prototype.toUpperCase,r_=String.prototype.toLowerCase,av=RegExp.prototype.test,s_=Array.prototype.concat,_i=Array.prototype.join,AE=Array.prototype.slice,n_=Math.floor,hd=typeof BigInt=="function"?BigInt.prototype.valueOf:null,_u=Object.getOwnPropertySymbols,ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,dn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",oa=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===dn||!0)?Symbol.toStringTag:null,ov=Object.prototype.propertyIsEnumerable,a_=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(i){return i.__proto__}:null);function o_(i,t){if(i===1/0||i===-1/0||i!==i||i&&i>-1e3&&i<1e3||av.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof i=="number"){var r=i<0?-n_(-i):n_(i);if(r!==i){var s=String(r),n=up.call(t,s.length+1);return hr.call(s,e,"$&_")+"."+hr.call(hr.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return hr.call(t,e,"$&_")}var cd=fE,l_=cd.custom,h_=uv(l_)?l_:null,lv={__proto__:null,double:'"',single:"'"},EE={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},xh=function i(t,e,r,s){var n=e||{};if(Pi(n,"quoteStyle")&&!Pi(lv,n.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Pi(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Pi(n,"customInspect")?n.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Pi(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Pi(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return dv(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var l=String(t);return o?o_(t,l):l}if(typeof t=="bigint"){var h=String(t)+"n";return o?o_(t,h):h}var u=typeof n.depth>"u"?5:n.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof t=="object")return dd(t)?"[Array]":"[Object]";var d=VE(n,r);if(typeof s>"u")s=[];else if(cv(s,t)>=0)return"[Circular]";function c(b,P,N){if(P&&(s=AE.call(s),s.push(P)),N){var H={depth:n.depth};return Pi(n,"quoteStyle")&&(H.quoteStyle=n.quoteStyle),i(b,H,r+1,s)}return i(b,n,r+1,s)}if(typeof t=="function"&&!u_(t)){var f=PE(t),p=_o(t,c);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+_i.call(p,", ")+" }":"")}if(uv(t)){var y=dn?hr.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):ud.call(t);return typeof t=="object"&&!dn?Mn(y):y}if(LE(t)){for(var x="<"+r_.call(String(t.nodeName)),m=t.attributes||[],_=0;_<m.length;_++)x+=" "+m[_].name+"="+hv(SE(m[_].value),"double",n);return x+=">",t.childNodes&&t.childNodes.length&&(x+="..."),x+="</"+r_.call(String(t.nodeName))+">",x}if(dd(t)){if(t.length===0)return"[]";var g=_o(t,c);return d&&!GE(g)?"["+fd(g,d)+"]":"[ "+_i.call(g,", ")+" ]"}if(bE(t)){var T=_o(t,c);return!("cause"in Error.prototype)&&"cause"in t&&!ov.call(t,"cause")?"{ ["+String(t)+"] "+_i.call(s_.call("[cause]: "+c(t.cause),T),", ")+" }":T.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+_i.call(T,", ")+" }"}if(typeof t=="object"&&a){if(h_&&typeof t[h_]=="function"&&cd)return cd(t,{depth:u-r});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(FE(t)){var A=[];return t_&&t_.call(t,function(b,P){A.push(c(P,t,!0)+" => "+c(b,t))}),c_("Map",Ll.call(t),A,d)}if(kE(t)){var S=[];return e_&&e_.call(t,function(b){S.push(c(b,t))}),c_("Set",Ul.call(t),S,d)}if(OE(t))return gu("WeakMap");if(NE(t))return gu("WeakSet");if(BE(t))return gu("WeakRef");if(IE(t))return Mn(c(Number(t)));if(RE(t))return Mn(c(hd.call(t)));if(DE(t))return Mn(gE.call(t));if(CE(t))return Mn(c(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof qn<"u"&&t===qn)return"{ [object globalThis] }";if(!wE(t)&&!u_(t)){var w=_o(t,c),E=a_?a_(t)===Object.prototype:t instanceof Object||t.constructor===Object,C=t instanceof Object?"":"null prototype",D=!E&&oa&&Object(t)===t&&oa in t?up.call(Dr(t),8,-1):C?"Object":"",k=E||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",F=k+(D||C?"["+_i.call(s_.call([],D||[],C||[]),": ")+"] ":"");return w.length===0?F+"{}":d?F+"{"+fd(w,d)+"}":F+"{ "+_i.call(w,", ")+" }"}return String(t)};function hv(i,t,e){var r=e.quoteStyle||t,s=lv[r];return s+i+s}function SE(i){return hr.call(String(i),/"/g,"&quot;")}function ps(i){return!oa||!(typeof i=="object"&&(oa in i||typeof i[oa]<"u"))}function dd(i){return Dr(i)==="[object Array]"&&ps(i)}function wE(i){return Dr(i)==="[object Date]"&&ps(i)}function u_(i){return Dr(i)==="[object RegExp]"&&ps(i)}function bE(i){return Dr(i)==="[object Error]"&&ps(i)}function CE(i){return Dr(i)==="[object String]"&&ps(i)}function IE(i){return Dr(i)==="[object Number]"&&ps(i)}function DE(i){return Dr(i)==="[object Boolean]"&&ps(i)}function uv(i){if(dn)return i&&typeof i=="object"&&i instanceof Symbol;if(typeof i=="symbol")return!0;if(!i||typeof i!="object"||!ud)return!1;try{return ud.call(i),!0}catch{}return!1}function RE(i){if(!i||typeof i!="object"||!hd)return!1;try{return hd.call(i),!0}catch{}return!1}var ME=Object.prototype.hasOwnProperty||function(i){return i in this};function Pi(i,t){return ME.call(i,t)}function Dr(i){return yE.call(i)}function PE(i){if(i.name)return i.name;var t=xE.call(vE.call(i),/^function\s*([\w$]+)/);return t?t[1]:null}function cv(i,t){if(i.indexOf)return i.indexOf(t);for(var e=0,r=i.length;e<r;e++)if(i[e]===t)return e;return-1}function FE(i){if(!Ll||!i||typeof i!="object")return!1;try{Ll.call(i);try{Ul.call(i)}catch{return!0}return i instanceof Map}catch{}return!1}function OE(i){if(!na||!i||typeof i!="object")return!1;try{na.call(i,na);try{aa.call(i,aa)}catch{return!0}return i instanceof WeakMap}catch{}return!1}function BE(i){if(!i_||!i||typeof i!="object")return!1;try{return i_.call(i),!0}catch{}return!1}function kE(i){if(!Ul||!i||typeof i!="object")return!1;try{Ul.call(i);try{Ll.call(i)}catch{return!0}return i instanceof Set}catch{}return!1}function NE(i){if(!aa||!i||typeof i!="object")return!1;try{aa.call(i,aa);try{na.call(i,na)}catch{return!0}return i instanceof WeakSet}catch{}return!1}function LE(i){return!i||typeof i!="object"?!1:typeof HTMLElement<"u"&&i instanceof HTMLElement?!0:typeof i.nodeName=="string"&&typeof i.getAttribute=="function"}function dv(i,t){if(i.length>t.maxStringLength){var e=i.length-t.maxStringLength,r="... "+e+" more character"+(e>1?"s":"");return dv(up.call(i,0,t.maxStringLength),t)+r}var s=EE[t.quoteStyle||"single"];s.lastIndex=0;var n=hr.call(hr.call(i,s,"\\$1"),/[\x00-\x1f]/g,UE);return hv(n,"single",t)}function UE(i){var t=i.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+TE.call(t.toString(16))}function Mn(i){return"Object("+i+")"}function gu(i){return i+" { ? }"}function c_(i,t,e,r){var s=r?fd(e,r):_i.call(e,", ");return i+" ("+t+") {"+s+"}"}function GE(i){for(var t=0;t<i.length;t++)if(cv(i[t],`
`)>=0)return!1;return!0}function VE(i,t){var e;if(i.indent==="	")e="	";else if(typeof i.indent=="number"&&i.indent>0)e=_i.call(Array(i.indent+1)," ");else return null;return{base:e,prev:_i.call(Array(t+1),e)}}function fd(i,t){if(i.length===0)return"";var e=`
`+t.prev+t.base;return e+_i.call(i,","+e)+`
`+t.prev}function _o(i,t){var e=dd(i),r=[];if(e){r.length=i.length;for(var s=0;s<i.length;s++)r[s]=Pi(i,s)?t(i[s],i):""}var n=typeof _u=="function"?_u(i):[],a;if(dn){a={};for(var o=0;o<n.length;o++)a["$"+n[o]]=n[o]}for(var l in i)Pi(i,l)&&(e&&String(Number(l))===l&&l<i.length||dn&&a["$"+l]instanceof Symbol||(av.call(/[^\w$]/,l)?r.push(t(l,i)+": "+t(i[l],i)):r.push(l+": "+t(i[l],i))));if(typeof _u=="function")for(var h=0;h<n.length;h++)ov.call(i,n[h])&&r.push("["+t(n[h])+"]: "+t(i[n[h]],i));return r}var HE=xh,zE=vn,Th=function(i,t,e){for(var r=i,s;(s=r.next)!=null;r=s)if(s.key===t)return r.next=s.next,e||(s.next=i.next,i.next=s),s},XE=function(i,t){if(i){var e=Th(i,t);return e&&e.value}},$E=function(i,t,e){var r=Th(i,t);r?r.value=e:i.next={key:t,next:i.next,value:e}},WE=function(i,t){return i?!!Th(i,t):!1},YE=function(i,t){if(i)return Th(i,t,!0)},jE=function(){var t,e={assert:function(r){if(!e.has(r))throw new zE("Side channel does not contain "+HE(r))},delete:function(r){var s=t&&t.next,n=YE(t,r);return n&&s&&s===n&&(t=void 0),!!n},get:function(r){return XE(t,r)},has:function(r){return WE(t,r)},set:function(r,s){t||(t={next:void 0}),$E(t,r,s)}};return e},fv=Object,qE=Error,KE=EvalError,ZE=RangeError,QE=ReferenceError,JE=SyntaxError,tS=URIError,eS=Math.abs,iS=Math.floor,rS=Math.max,sS=Math.min,nS=Math.pow,aS=Math.round,oS=Number.isNaN||function(t){return t!==t},lS=oS,hS=function(t){return lS(t)||t===0?t:t<0?-1:1},uS=Object.getOwnPropertyDescriptor,Ko=uS;if(Ko)try{Ko([],"length")}catch{Ko=null}var pv=Ko,Zo=Object.defineProperty||!1;if(Zo)try{Zo({},"a",{value:1})}catch{Zo=!1}var cS=Zo,yu,d_;function dS(){return d_||(d_=1,yu=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),r=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(var n in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var a=Object.getOwnPropertySymbols(t);if(a.length!==1||a[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==s||o.enumerable!==!0)return!1}return!0}),yu}var vu,f_;function fS(){if(f_)return vu;f_=1;var i=typeof Symbol<"u"&&Symbol,t=dS();return vu=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},vu}var xu,p_;function mv(){return p_||(p_=1,xu=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),xu}var Tu,m_;function _v(){if(m_)return Tu;m_=1;var i=fv;return Tu=i.getPrototypeOf||null,Tu}var pS="Function.prototype.bind called on incompatible ",mS=Object.prototype.toString,_S=Math.max,gS="[object Function]",__=function(t,e){for(var r=[],s=0;s<t.length;s+=1)r[s]=t[s];for(var n=0;n<e.length;n+=1)r[n+t.length]=e[n];return r},yS=function(t,e){for(var r=[],s=e,n=0;s<t.length;s+=1,n+=1)r[n]=t[s];return r},vS=function(i,t){for(var e="",r=0;r<i.length;r+=1)e+=i[r],r+1<i.length&&(e+=t);return e},xS=function(t){var e=this;if(typeof e!="function"||mS.apply(e)!==gS)throw new TypeError(pS+e);for(var r=yS(arguments,1),s,n=function(){if(this instanceof s){var u=e.apply(this,__(r,arguments));return Object(u)===u?u:this}return e.apply(t,__(r,arguments))},a=_S(0,e.length-r.length),o=[],l=0;l<a;l++)o[l]="$"+l;if(s=Function("binder","return function ("+vS(o,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var h=function(){};h.prototype=e.prototype,s.prototype=new h,h.prototype=null}return s},TS=xS,Ah=Function.prototype.bind||TS,cp=Function.prototype.call,Au,g_;function gv(){return g_||(g_=1,Au=Function.prototype.apply),Au}var AS=typeof Reflect<"u"&&Reflect&&Reflect.apply,ES=Ah,SS=gv(),wS=cp,bS=AS,CS=bS||ES.call(wS,SS),IS=Ah,DS=vn,RS=cp,MS=CS,yv=function(t){if(t.length<1||typeof t[0]!="function")throw new DS("a function is required");return MS(IS,RS,t)},Eu,y_;function PS(){if(y_)return Eu;y_=1;var i=yv,t=pv,e;try{e=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var r=!!e&&t&&t(Object.prototype,"__proto__"),s=Object,n=s.getPrototypeOf;return Eu=r&&typeof r.get=="function"?i([r.get]):typeof n=="function"?function(o){return n(o==null?o:s(o))}:!1,Eu}var Su,v_;function FS(){if(v_)return Su;v_=1;var i=mv(),t=_v(),e=PS();return Su=i?function(s){return i(s)}:t?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return t(s)}:e?function(s){return e(s)}:null,Su}var wu,x_;function OS(){if(x_)return wu;x_=1;var i=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=Ah;return wu=e.call(i,t),wu}var ct,BS=fv,kS=qE,NS=KE,LS=ZE,US=QE,fn=JE,Zs=vn,GS=tS,VS=eS,HS=iS,zS=rS,XS=sS,$S=nS,WS=aS,YS=hS,vv=Function,bu=function(i){try{return vv('"use strict"; return ('+i+").constructor;")()}catch{}},Ra=pv,jS=cS,Cu=function(){throw new Zs},qS=Ra?function(){try{return arguments.callee,Cu}catch{try{return Ra(arguments,"callee").get}catch{return Cu}}}():Cu,ys=fS()(),Wt=FS(),KS=_v(),ZS=mv(),xv=gv(),Ua=cp,As={},QS=typeof Uint8Array>"u"||!Wt?ct:Wt(Uint8Array),Kr={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?ct:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ct:ArrayBuffer,"%ArrayIteratorPrototype%":ys&&Wt?Wt([][Symbol.iterator]()):ct,"%AsyncFromSyncIteratorPrototype%":ct,"%AsyncFunction%":As,"%AsyncGenerator%":As,"%AsyncGeneratorFunction%":As,"%AsyncIteratorPrototype%":As,"%Atomics%":typeof Atomics>"u"?ct:Atomics,"%BigInt%":typeof BigInt>"u"?ct:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ct:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ct:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ct:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":kS,"%eval%":eval,"%EvalError%":NS,"%Float16Array%":typeof Float16Array>"u"?ct:Float16Array,"%Float32Array%":typeof Float32Array>"u"?ct:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ct:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ct:FinalizationRegistry,"%Function%":vv,"%GeneratorFunction%":As,"%Int8Array%":typeof Int8Array>"u"?ct:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ct:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ct:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ys&&Wt?Wt(Wt([][Symbol.iterator]())):ct,"%JSON%":typeof JSON=="object"?JSON:ct,"%Map%":typeof Map>"u"?ct:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ys||!Wt?ct:Wt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":BS,"%Object.getOwnPropertyDescriptor%":Ra,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ct:Promise,"%Proxy%":typeof Proxy>"u"?ct:Proxy,"%RangeError%":LS,"%ReferenceError%":US,"%Reflect%":typeof Reflect>"u"?ct:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ct:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ys||!Wt?ct:Wt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ct:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ys&&Wt?Wt(""[Symbol.iterator]()):ct,"%Symbol%":ys?Symbol:ct,"%SyntaxError%":fn,"%ThrowTypeError%":qS,"%TypedArray%":QS,"%TypeError%":Zs,"%Uint8Array%":typeof Uint8Array>"u"?ct:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ct:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ct:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ct:Uint32Array,"%URIError%":GS,"%WeakMap%":typeof WeakMap>"u"?ct:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ct:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ct:WeakSet,"%Function.prototype.call%":Ua,"%Function.prototype.apply%":xv,"%Object.defineProperty%":jS,"%Object.getPrototypeOf%":KS,"%Math.abs%":VS,"%Math.floor%":HS,"%Math.max%":zS,"%Math.min%":XS,"%Math.pow%":$S,"%Math.round%":WS,"%Math.sign%":YS,"%Reflect.getPrototypeOf%":ZS};if(Wt)try{null.error}catch(i){var JS=Wt(Wt(i));Kr["%Error.prototype%"]=JS}var tw=function i(t){var e;if(t==="%AsyncFunction%")e=bu("async function () {}");else if(t==="%GeneratorFunction%")e=bu("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=bu("async function* () {}");else if(t==="%AsyncGenerator%"){var r=i("%AsyncGeneratorFunction%");r&&(e=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=i("%AsyncGenerator%");s&&Wt&&(e=Wt(s.prototype))}return Kr[t]=e,e},T_={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ga=Ah,Gl=OS(),ew=Ga.call(Ua,Array.prototype.concat),iw=Ga.call(xv,Array.prototype.splice),A_=Ga.call(Ua,String.prototype.replace),Vl=Ga.call(Ua,String.prototype.slice),rw=Ga.call(Ua,RegExp.prototype.exec),sw=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,nw=/\\(\\)?/g,aw=function(t){var e=Vl(t,0,1),r=Vl(t,-1);if(e==="%"&&r!=="%")throw new fn("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&e!=="%")throw new fn("invalid intrinsic syntax, expected opening `%`");var s=[];return A_(t,sw,function(n,a,o,l){s[s.length]=o?A_(l,nw,"$1"):a||n}),s},ow=function(t,e){var r=t,s;if(Gl(T_,r)&&(s=T_[r],r="%"+s[0]+"%"),Gl(Kr,r)){var n=Kr[r];if(n===As&&(n=tw(r)),typeof n>"u"&&!e)throw new Zs("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:n}}throw new fn("intrinsic "+t+" does not exist!")},dp=function(t,e){if(typeof t!="string"||t.length===0)throw new Zs("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Zs('"allowMissing" argument must be a boolean');if(rw(/^%?[^%]*%?$/,t)===null)throw new fn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=aw(t),s=r.length>0?r[0]:"",n=ow("%"+s+"%",e),a=n.name,o=n.value,l=!1,h=n.alias;h&&(s=h[0],iw(r,ew([0,1],h)));for(var u=1,d=!0;u<r.length;u+=1){var c=r[u],f=Vl(c,0,1),p=Vl(c,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new fn("property names with quotes must have matching quotes");if((c==="constructor"||!d)&&(l=!0),s+="."+c,a="%"+s+"%",Gl(Kr,a))o=Kr[a];else if(o!=null){if(!(c in o)){if(!e)throw new Zs("base intrinsic for "+t+" exists, but the property is not available.");return}if(Ra&&u+1>=r.length){var y=Ra(o,c);d=!!y,d&&"get"in y&&!("originalValue"in y.get)?o=y.get:o=o[c]}else d=Gl(o,c),o=o[c];d&&!l&&(Kr[a]=o)}}return o},Tv=dp,Av=yv,lw=Av([Tv("%String.prototype.indexOf%")]),Ev=function(t,e){var r=Tv(t,!!e);return typeof r=="function"&&lw(t,".prototype.")>-1?Av([r]):r},hw=dp,Va=Ev,uw=xh,cw=vn,E_=hw("%Map%",!0),dw=Va("Map.prototype.get",!0),fw=Va("Map.prototype.set",!0),pw=Va("Map.prototype.has",!0),mw=Va("Map.prototype.delete",!0),_w=Va("Map.prototype.size",!0),Sv=!!E_&&function(){var t,e={assert:function(r){if(!e.has(r))throw new cw("Side channel does not contain "+uw(r))},delete:function(r){if(t){var s=mw(t,r);return _w(t)===0&&(t=void 0),s}return!1},get:function(r){if(t)return dw(t,r)},has:function(r){return t?pw(t,r):!1},set:function(r,s){t||(t=new E_),fw(t,r,s)}};return e},gw=dp,Eh=Ev,yw=xh,go=Sv,vw=vn,vs=gw("%WeakMap%",!0),xw=Eh("WeakMap.prototype.get",!0),Tw=Eh("WeakMap.prototype.set",!0),Aw=Eh("WeakMap.prototype.has",!0),Ew=Eh("WeakMap.prototype.delete",!0),Sw=vs?function(){var t,e,r={assert:function(s){if(!r.has(s))throw new vw("Side channel does not contain "+yw(s))},delete:function(s){if(vs&&s&&(typeof s=="object"||typeof s=="function")){if(t)return Ew(t,s)}else if(go&&e)return e.delete(s);return!1},get:function(s){return vs&&s&&(typeof s=="object"||typeof s=="function")&&t?xw(t,s):e&&e.get(s)},has:function(s){return vs&&s&&(typeof s=="object"||typeof s=="function")&&t?Aw(t,s):!!e&&e.has(s)},set:function(s,n){vs&&s&&(typeof s=="object"||typeof s=="function")?(t||(t=new vs),Tw(t,s,n)):go&&(e||(e=go()),e.set(s,n))}};return r}:go,ww=vn,bw=xh,Cw=jE,Iw=Sv,Dw=Sw,Rw=Dw||Iw||Cw,Mw=function(){var t,e={assert:function(r){if(!e.has(r))throw new ww("Side channel does not contain "+bw(r))},delete:function(r){return!!t&&t.delete(r)},get:function(r){return t&&t.get(r)},has:function(r){return!!t&&t.has(r)},set:function(r,s){t||(t=Rw()),t.set(r,s)}};return e},Pw=String.prototype.replace,Fw=/%20/g,Iu={RFC1738:"RFC1738",RFC3986:"RFC3986"},fp={default:Iu.RFC3986,formatters:{RFC1738:function(i){return Pw.call(i,Fw,"+")},RFC3986:function(i){return String(i)}},RFC1738:Iu.RFC1738,RFC3986:Iu.RFC3986},Ow=fp,Du=Object.prototype.hasOwnProperty,Vr=Array.isArray,oi=function(){for(var i=[],t=0;t<256;++t)i.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return i}(),Bw=function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(Vr(r)){for(var s=[],n=0;n<r.length;++n)typeof r[n]<"u"&&s.push(r[n]);e.obj[e.prop]=s}}},wv=function(t,e){for(var r=e&&e.plainObjects?{__proto__:null}:{},s=0;s<t.length;++s)typeof t[s]<"u"&&(r[s]=t[s]);return r},kw=function i(t,e,r){if(!e)return t;if(typeof e!="object"&&typeof e!="function"){if(Vr(t))t.push(e);else if(t&&typeof t=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Du.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var s=t;return Vr(t)&&!Vr(e)&&(s=wv(t,r)),Vr(t)&&Vr(e)?(e.forEach(function(n,a){if(Du.call(t,a)){var o=t[a];o&&typeof o=="object"&&n&&typeof n=="object"?t[a]=i(o,n,r):t.push(n)}else t[a]=n}),t):Object.keys(e).reduce(function(n,a){var o=e[a];return Du.call(n,a)?n[a]=i(n[a],o,r):n[a]=o,n},s)},Nw=function(t,e){return Object.keys(e).reduce(function(r,s){return r[s]=e[s],r},t)},Lw=function(i,t,e){var r=i.replace(/\+/g," ");if(e==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},Ru=1024,Uw=function(t,e,r,s,n){if(t.length===0)return t;var a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),r==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var o="",l=0;l<a.length;l+=Ru){for(var h=a.length>=Ru?a.slice(l,l+Ru):a,u=[],d=0;d<h.length;++d){var c=h.charCodeAt(d);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||n===Ow.RFC1738&&(c===40||c===41)){u[u.length]=h.charAt(d);continue}if(c<128){u[u.length]=oi[c];continue}if(c<2048){u[u.length]=oi[192|c>>6]+oi[128|c&63];continue}if(c<55296||c>=57344){u[u.length]=oi[224|c>>12]+oi[128|c>>6&63]+oi[128|c&63];continue}d+=1,c=65536+((c&1023)<<10|h.charCodeAt(d)&1023),u[u.length]=oi[240|c>>18]+oi[128|c>>12&63]+oi[128|c>>6&63]+oi[128|c&63]}o+=u.join("")}return o},Gw=function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],s=0;s<e.length;++s)for(var n=e[s],a=n.obj[n.prop],o=Object.keys(a),l=0;l<o.length;++l){var h=o[l],u=a[h];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(e.push({obj:a,prop:h}),r.push(u))}return Bw(e),t},Vw=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},Hw=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},zw=function(t,e){return[].concat(t,e)},Xw=function(t,e){if(Vr(t)){for(var r=[],s=0;s<t.length;s+=1)r.push(e(t[s]));return r}return e(t)},bv={arrayToObject:wv,assign:Nw,combine:zw,compact:Gw,decode:Lw,encode:Uw,isBuffer:Hw,isRegExp:Vw,maybeMap:Xw,merge:kw},Cv=Mw,Qo=bv,la=fp,$w=Object.prototype.hasOwnProperty,Iv={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},pi=Array.isArray,Ww=Array.prototype.push,Dv=function(i,t){Ww.apply(i,pi(t)?t:[t])},Yw=Date.prototype.toISOString,S_=la.default,Ht={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Qo.encode,encodeValuesOnly:!1,filter:void 0,format:S_,formatter:la.formatters[S_],indices:!1,serializeDate:function(t){return Yw.call(t)},skipNulls:!1,strictNullHandling:!1},jw=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Mu={},qw=function i(t,e,r,s,n,a,o,l,h,u,d,c,f,p,y,x,m,_){for(var g=t,T=_,A=0,S=!1;(T=T.get(Mu))!==void 0&&!S;){var w=T.get(t);if(A+=1,typeof w<"u"){if(w===A)throw new RangeError("Cyclic object value");S=!0}typeof T.get(Mu)>"u"&&(A=0)}if(typeof u=="function"?g=u(e,g):g instanceof Date?g=f(g):r==="comma"&&pi(g)&&(g=Qo.maybeMap(g,function(M){return M instanceof Date?f(M):M})),g===null){if(a)return h&&!x?h(e,Ht.encoder,m,"key",p):e;g=""}if(jw(g)||Qo.isBuffer(g)){if(h){var E=x?e:h(e,Ht.encoder,m,"key",p);return[y(E)+"="+y(h(g,Ht.encoder,m,"value",p))]}return[y(e)+"="+y(String(g))]}var C=[];if(typeof g>"u")return C;var D;if(r==="comma"&&pi(g))x&&h&&(g=Qo.maybeMap(g,h)),D=[{value:g.length>0?g.join(",")||null:void 0}];else if(pi(u))D=u;else{var k=Object.keys(g);D=d?k.sort(d):k}var F=l?String(e).replace(/\./g,"%2E"):String(e),b=s&&pi(g)&&g.length===1?F+"[]":F;if(n&&pi(g)&&g.length===0)return b+"[]";for(var P=0;P<D.length;++P){var N=D[P],H=typeof N=="object"&&N&&typeof N.value<"u"?N.value:g[N];if(!(o&&H===null)){var U=c&&l?String(N).replace(/\./g,"%2E"):String(N),R=pi(g)?typeof r=="function"?r(b,U):b:b+(c?"."+U:"["+U+"]");_.set(t,A);var V=Cv();V.set(Mu,_),Dv(C,i(H,R,r,s,n,a,o,l,r==="comma"&&x&&pi(g)?null:h,u,d,c,f,p,y,x,m,V))}}return C},Kw=function(t){if(!t)return Ht;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||Ht.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=la.default;if(typeof t.format<"u"){if(!$w.call(la.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var s=la.formatters[r],n=Ht.filter;(typeof t.filter=="function"||pi(t.filter))&&(n=t.filter);var a;if(t.arrayFormat in Iv?a=t.arrayFormat:"indices"in t?a=t.indices?"indices":"repeat":a=Ht.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:Ht.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Ht.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Ht.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Ht.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Ht.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Ht.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Ht.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Ht.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Ht.encodeValuesOnly,filter:n,format:r,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Ht.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Ht.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Ht.strictNullHandling}},Zw=function(i,t){var e=i,r=Kw(t),s,n;typeof r.filter=="function"?(n=r.filter,e=n("",e)):pi(r.filter)&&(n=r.filter,s=n);var a=[];if(typeof e!="object"||e===null)return"";var o=Iv[r.arrayFormat],l=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(e)),r.sort&&s.sort(r.sort);for(var h=Cv(),u=0;u<s.length;++u){var d=s[u],c=e[d];r.skipNulls&&c===null||Dv(a,qw(c,d,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,h))}var f=a.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},os=bv,pd=Object.prototype.hasOwnProperty,w_=Array.isArray,Mt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:os.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},Qw=function(i){return i.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Rv=function(i,t,e){if(i&&typeof i=="string"&&t.comma&&i.indexOf(",")>-1)return i.split(",");if(t.throwOnLimitExceeded&&e>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(t.arrayLimit===1?"":"s")+" allowed in an array.");return i},Jw="utf8=%26%2310003%3B",tb="utf8=%E2%9C%93",eb=function(t,e){var r={__proto__:null},s=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;s=s.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var n=e.parameterLimit===1/0?void 0:e.parameterLimit,a=s.split(e.delimiter,e.throwOnLimitExceeded?n+1:n);if(e.throwOnLimitExceeded&&a.length>n)throw new RangeError("Parameter limit exceeded. Only "+n+" parameter"+(n===1?"":"s")+" allowed.");var o=-1,l,h=e.charset;if(e.charsetSentinel)for(l=0;l<a.length;++l)a[l].indexOf("utf8=")===0&&(a[l]===tb?h="utf-8":a[l]===Jw&&(h="iso-8859-1"),o=l,l=a.length);for(l=0;l<a.length;++l)if(l!==o){var u=a[l],d=u.indexOf("]="),c=d===-1?u.indexOf("="):d+1,f,p;c===-1?(f=e.decoder(u,Mt.decoder,h,"key"),p=e.strictNullHandling?null:""):(f=e.decoder(u.slice(0,c),Mt.decoder,h,"key"),p=os.maybeMap(Rv(u.slice(c+1),e,w_(r[f])?r[f].length:0),function(x){return e.decoder(x,Mt.decoder,h,"value")})),p&&e.interpretNumericEntities&&h==="iso-8859-1"&&(p=Qw(String(p))),u.indexOf("[]=")>-1&&(p=w_(p)?[p]:p);var y=pd.call(r,f);y&&e.duplicates==="combine"?r[f]=os.combine(r[f],p):(!y||e.duplicates==="last")&&(r[f]=p)}return r},ib=function(i,t,e,r){var s=0;if(i.length>0&&i[i.length-1]==="[]"){var n=i.slice(0,-1).join("");s=Array.isArray(t)&&t[n]?t[n].length:0}for(var a=r?t:Rv(t,e,s),o=i.length-1;o>=0;--o){var l,h=i[o];if(h==="[]"&&e.parseArrays)l=e.allowEmptyArrays&&(a===""||e.strictNullHandling&&a===null)?[]:os.combine([],a);else{l=e.plainObjects?{__proto__:null}:{};var u=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,d=e.decodeDotInKeys?u.replace(/%2E/g,"."):u,c=parseInt(d,10);!e.parseArrays&&d===""?l={0:a}:!isNaN(c)&&h!==d&&String(c)===d&&c>=0&&e.parseArrays&&c<=e.arrayLimit?(l=[],l[c]=a):d!=="__proto__"&&(l[d]=a)}a=l}return a},rb=function(t,e,r,s){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,l=r.depth>0&&a.exec(n),h=l?n.slice(0,l.index):n,u=[];if(h){if(!r.plainObjects&&pd.call(Object.prototype,h)&&!r.allowPrototypes)return;u.push(h)}for(var d=0;r.depth>0&&(l=o.exec(n))!==null&&d<r.depth;){if(d+=1,!r.plainObjects&&pd.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(l[1])}if(l){if(r.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");u.push("["+n.slice(l.index)+"]")}return ib(u,e,r,s)}},sb=function(t){if(!t)return Mt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof t.throwOnLimitExceeded<"u"&&typeof t.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=typeof t.charset>"u"?Mt.charset:t.charset,r=typeof t.duplicates>"u"?Mt.duplicates:t.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:Mt.allowDots:!!t.allowDots;return{allowDots:s,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Mt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Mt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Mt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Mt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Mt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Mt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:Mt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:Mt.decoder,delimiter:typeof t.delimiter=="string"||os.isRegExp(t.delimiter)?t.delimiter:Mt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Mt.depth,duplicates:r,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Mt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Mt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Mt.plainObjects,strictDepth:typeof t.strictDepth=="boolean"?!!t.strictDepth:Mt.strictDepth,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Mt.strictNullHandling,throwOnLimitExceeded:typeof t.throwOnLimitExceeded=="boolean"?t.throwOnLimitExceeded:!1}},nb=function(i,t){var e=sb(t);if(i===""||i===null||typeof i>"u")return e.plainObjects?{__proto__:null}:{};for(var r=typeof i=="string"?eb(i,e):i,s=e.plainObjects?{__proto__:null}:{},n=Object.keys(r),a=0;a<n.length;++a){var o=n[a],l=rb(o,r[o],e,typeof i=="string");s=os.merge(s,l,e)}return e.allowSparse===!0?s:os.compact(s)},ab=Zw,ob=nb,lb=fp,hb={formats:lb,parse:ob,stringify:ab},ub=uE;function Vi(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var cb=/^([a-z0-9.+-]+:)/i,db=/:[0-9]*$/,fb=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,pb=["<",">",'"',"`"," ","\r",`
`,"	"],mb=["{","}","|","\\","^","`"].concat(pb),md=["'"].concat(mb),b_=["%","/","?",";","#"].concat(md),C_=["/","?","#"],_b=255,I_=/^[+a-z0-9A-Z_-]{0,63}$/,gb=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,yb={javascript:!0,"javascript:":!0},_d={javascript:!0,"javascript:":!0},Qs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},gd=hb;function vb(i,t,e){if(i&&typeof i=="object"&&i instanceof Vi)return i;var r=new Vi;return r.parse(i,t,e),r}Vi.prototype.parse=function(i,t,e){if(typeof i!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var r=i.indexOf("?"),s=r!==-1&&r<i.indexOf("#")?"?":"#",n=i.split(s),a=/\\/g;n[0]=n[0].replace(a,"/"),i=n.join(s);var o=i;if(o=o.trim(),!e&&i.split("#").length===1){var l=fb.exec(o);if(l)return this.path=o,this.href=o,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=gd.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=cb.exec(o);if(h){h=h[0];var u=h.toLowerCase();this.protocol=u,o=o.substr(h.length)}if(e||h||o.match(/^\/\/[^@/]+@[^@/]+/)){var d=o.substr(0,2)==="//";d&&!(h&&_d[h])&&(o=o.substr(2),this.slashes=!0)}if(!_d[h]&&(d||h&&!Qs[h])){for(var c=-1,f=0;f<C_.length;f++){var p=o.indexOf(C_[f]);p!==-1&&(c===-1||p<c)&&(c=p)}var y,x;c===-1?x=o.lastIndexOf("@"):x=o.lastIndexOf("@",c),x!==-1&&(y=o.slice(0,x),o=o.slice(x+1),this.auth=decodeURIComponent(y)),c=-1;for(var f=0;f<b_.length;f++){var p=o.indexOf(b_[f]);p!==-1&&(c===-1||p<c)&&(c=p)}c===-1&&(c=o.length),this.host=o.slice(0,c),o=o.slice(c),this.parseHost(),this.hostname=this.hostname||"";var m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m)for(var _=this.hostname.split(/\./),f=0,g=_.length;f<g;f++){var T=_[f];if(T&&!T.match(I_)){for(var A="",S=0,w=T.length;S<w;S++)T.charCodeAt(S)>127?A+="x":A+=T[S];if(!A.match(I_)){var E=_.slice(0,f),C=_.slice(f+1),D=T.match(gb);D&&(E.push(D[1]),C.unshift(D[2])),C.length&&(o="/"+C.join(".")+o),this.hostname=E.join(".");break}}}this.hostname.length>_b?this.hostname="":this.hostname=this.hostname.toLowerCase(),m||(this.hostname=ub.toASCII(this.hostname));var k=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+k,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!yb[u])for(var f=0,g=md.length;f<g;f++){var b=md[f];if(o.indexOf(b)!==-1){var P=encodeURIComponent(b);P===b&&(P=escape(b)),o=o.split(b).join(P)}}var N=o.indexOf("#");N!==-1&&(this.hash=o.substr(N),o=o.slice(0,N));var H=o.indexOf("?");if(H!==-1?(this.search=o.substr(H),this.query=o.substr(H+1),t&&(this.query=gd.parse(this.query)),o=o.slice(0,H)):t&&(this.search="",this.query={}),o&&(this.pathname=o),Qs[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var k=this.pathname||"",U=this.search||"";this.path=k+U}return this.href=this.format(),this};Vi.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",r=this.hash||"",s=!1,n="";this.host?s=i+this.host:this.hostname&&(s=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=gd.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Qs[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),r&&r.charAt(0)!=="#"&&(r="#"+r),a&&a.charAt(0)!=="?"&&(a="?"+a),e=e.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),a=a.replace("#","%23"),t+s+e+a+r};Vi.prototype.resolve=function(i){return this.resolveObject(vb(i,!1,!0)).format()};Vi.prototype.resolveObject=function(i){if(typeof i=="string"){var t=new Vi;t.parse(i,!1,!0),i=t}for(var e=new Vi,r=Object.keys(this),s=0;s<r.length;s++){var n=r[s];e[n]=this[n]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var a=Object.keys(i),o=0;o<a.length;o++){var l=a[o];l!=="protocol"&&(e[l]=i[l])}return Qs[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!Qs[i.protocol]){for(var h=Object.keys(i),u=0;u<h.length;u++){var d=h[u];e[d]=i[d]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!_d[i.protocol]){for(var g=(i.pathname||"").split("/");g.length&&!(i.host=g.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),e.pathname=g.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var c=e.pathname||"",f=e.search||"";e.path=c+f}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",y=i.host||i.pathname&&i.pathname.charAt(0)==="/",x=y||p||e.host&&i.pathname,m=x,_=e.pathname&&e.pathname.split("/")||[],g=i.pathname&&i.pathname.split("/")||[],T=e.protocol&&!Qs[e.protocol];if(T&&(e.hostname="",e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(g[0]===""?g[0]=i.host:g.unshift(i.host)),i.host=null),x=x&&(g[0]===""||_[0]==="")),y)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,_=g;else if(g.length)_||(_=[]),_.pop(),_=_.concat(g),e.search=i.search,e.query=i.query;else if(i.search!=null){if(T){e.host=_.shift(),e.hostname=e.host;var A=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;A&&(e.auth=A.shift(),e.hostname=A.shift(),e.host=e.hostname)}return e.search=i.search,e.query=i.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!_.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var S=_.slice(-1)[0],w=(e.host||i.host||_.length>1)&&(S==="."||S==="..")||S==="",E=0,C=_.length;C>=0;C--)S=_[C],S==="."?_.splice(C,1):S===".."?(_.splice(C,1),E++):E&&(_.splice(C,1),E--);if(!x&&!m)for(;E--;E)_.unshift("..");x&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),w&&_.join("/").substr(-1)!=="/"&&_.push("");var D=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(T){e.hostname=D?"":_.length?_.shift():"",e.host=e.hostname;var A=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;A&&(e.auth=A.shift(),e.hostname=A.shift(),e.host=e.hostname)}return x=x||e.host&&_.length,x&&!D&&_.unshift(""),_.length>0?e.pathname=_.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};Vi.prototype.parseHost=function(){var i=this.host,t=db.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const D_={};function ht(i,t,e=3){if(D_[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(r))),D_[t]=!0}function ze(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function Pn(i){return i.split("?")[0].split("#")[0]}function xb(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Tb(i,t,e){return i.replace(new RegExp(xb(t),"g"),e)}function Ab(i,t){let e="",r=0,s=-1,n=0,a=-1;for(let o=0;o<=i.length;++o){if(o<i.length)a=i.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(s===o-1||n===1))if(s!==o-1&&n===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",r=0):(e=e.slice(0,l),r=e.length-1-e.lastIndexOf("/")),s=o,n=0;continue}}else if(e.length===2||e.length===1){e="",r=0,s=o,n=0;continue}}}else e.length>0?e+=`/${i.slice(s+1,o)}`:e=i.slice(s+1,o),r=o-s-1;s=o,n=0}else a===46&&n!==-1?++n:n=-1}return e}const Kt={toPosix(i){return Tb(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){ze(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(ze(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const r=Pn(this.toPosix(t??W.ADAPTER.getBaseUrl())),s=Pn(this.toPosix(e??this.rootname(r)));return i=this.toPosix(i),i.startsWith("/")?Kt.join(s,i.slice(1)):this.isAbsolute(i)?i:this.join(r,i)},normalize(i){if(ze(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const r=i.endsWith("/");return i=Ab(i),i.length>0&&r&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return ze(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const r=i[e];if(ze(r),r.length>0)if(t===void 0)t=r;else{const s=i[e-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(ze(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let r=-1,s=!0;const n=this.getProtocol(i),a=i;i=i.slice(n.length);for(let o=i.length-1;o>=1;--o)if(t=i.charCodeAt(o),t===47){if(!s){r=o;break}}else s=!1;return r===-1?e?"/":this.isUrl(a)?n+i:n:e&&r===1?"//":n+i.slice(0,r)},rootname(i){ze(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){ze(i),t&&ze(t),i=Pn(this.toPosix(i));let e=0,r=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let a=t.length-1,o=-1;for(n=i.length-1;n>=0;--n){const l=i.charCodeAt(n);if(l===47){if(!s){e=n+1;break}}else o===-1&&(s=!1,o=n+1),a>=0&&(l===t.charCodeAt(a)?--a===-1&&(r=n):(a=-1,r=o))}return e===r?r=o:r===-1&&(r=i.length),i.slice(e,r)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!s){e=n+1;break}}else r===-1&&(s=!1,r=n+1);return r===-1?"":i.slice(e,r)},extname(i){ze(i),i=Pn(this.toPosix(i));let t=-1,e=0,r=-1,s=!0,n=0;for(let a=i.length-1;a>=0;--a){const o=i.charCodeAt(a);if(o===47){if(!s){e=a+1;break}continue}r===-1&&(s=!1,r=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||r===-1||n===0||n===1&&t===r-1&&t===e+1?"":i.slice(t,r)},parse(i){ze(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=Pn(this.toPosix(i));let e=i.charCodeAt(0);const r=this.isAbsolute(i);let s;t.root=this.rootname(i),r||this.hasProtocol(i)?s=1:s=0;let n=-1,a=0,o=-1,l=!0,h=i.length-1,u=0;for(;h>=s;--h){if(e=i.charCodeAt(h),e===47){if(!l){a=h+1;break}continue}o===-1&&(l=!1,o=h+1),e===46?n===-1?n=h:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||o===-1||u===0||u===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&r?t.base=t.name=i.slice(1,o):t.base=t.name=i.slice(a,o)):(a===0&&r?(t.name=i.slice(1,n),t.base=i.slice(1,o)):(t.name=i.slice(a,n),t.base=i.slice(a,o)),t.ext=i.slice(n,o)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Pu;async function Eb(){return Pu??(Pu=(async()=>{var n;const i=document.createElement("canvas").getContext("webgl");if(!i)return ve.UNPACK;const t=await new Promise(a=>{const o=document.createElement("video");o.onloadeddata=()=>a(o),o.onerror=()=>a(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!t)return ve.UNPACK;const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);const r=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,s),i.deleteFramebuffer(r),i.deleteTexture(e),(n=i.getExtension("WEBGL_lose_context"))==null||n.loseContext(),s[0]<=s[3]?ve.PMA:ve.UNPACK})()),Pu}let Fu;function Sb(){return typeof Fu>"u"&&(Fu=function(){var t;const i={stencil:!0,failIfMajorPerformanceCaveat:W.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!W.ADAPTER.getWebGLRenderingContext())return!1;const e=W.ADAPTER.createCanvas();let r=e.getContext("webgl",i)||e.getContext("experimental-webgl",i);const s=!!((t=r==null?void 0:r.getContextAttributes())!=null&&t.stencil);if(r){const n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,s}catch{return!1}}()),Fu}var wb={grad:.9,turn:360,rad:360/(2*Math.PI)},Ri=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},jt=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},Le=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},Mv=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},R_=function(i){return{r:Le(i.r,0,255),g:Le(i.g,0,255),b:Le(i.b,0,255),a:Le(i.a)}},Ou=function(i){return{r:jt(i.r),g:jt(i.g),b:jt(i.b),a:jt(i.a,3)}},bb=/^#([0-9a-f]{3,8})$/i,yo=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},Pv=function(i){var t=i.r,e=i.g,r=i.b,s=i.a,n=Math.max(t,e,r),a=n-Math.min(t,e,r),o=a?n===t?(e-r)/a:n===e?2+(r-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:s}},Fv=function(i){var t=i.h,e=i.s,r=i.v,s=i.a;t=t/360*6,e/=100,r/=100;var n=Math.floor(t),a=r*(1-e),o=r*(1-(t-n)*e),l=r*(1-(1-t+n)*e),h=n%6;return{r:255*[r,o,a,a,l,r][h],g:255*[l,r,r,o,a,a][h],b:255*[a,a,l,r,r,o][h],a:s}},M_=function(i){return{h:Mv(i.h),s:Le(i.s,0,100),l:Le(i.l,0,100),a:Le(i.a)}},P_=function(i){return{h:jt(i.h),s:jt(i.s),l:jt(i.l),a:jt(i.a,3)}},F_=function(i){return Fv((e=(t=i).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},ha=function(i){return{h:(t=Pv(i)).h,s:(s=(200-(e=t.s))*(r=t.v)/100)>0&&s<200?e*r/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,r,s},Cb=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ib=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Db=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Rb=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yd={string:[[function(i){var t=bb.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?jt(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?jt(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=Db.exec(i)||Rb.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:R_({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=Cb.exec(i)||Ib.exec(i);if(!t)return null;var e,r,s=M_({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(wb[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return F_(s)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,r=i.b,s=i.a,n=s===void 0?1:s;return Ri(t)&&Ri(e)&&Ri(r)?R_({r:Number(t),g:Number(e),b:Number(r),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,r=i.l,s=i.a,n=s===void 0?1:s;if(!Ri(t)||!Ri(e)||!Ri(r))return null;var a=M_({h:Number(t),s:Number(e),l:Number(r),a:Number(n)});return F_(a)},"hsl"],[function(i){var t=i.h,e=i.s,r=i.v,s=i.a,n=s===void 0?1:s;if(!Ri(t)||!Ri(e)||!Ri(r))return null;var a=function(o){return{h:Mv(o.h),s:Le(o.s,0,100),v:Le(o.v,0,100),a:Le(o.a)}}({h:Number(t),s:Number(e),v:Number(r),a:Number(n)});return Fv(a)},"hsv"]]},O_=function(i,t){for(var e=0;e<t.length;e++){var r=t[e][0](i);if(r)return[r,t[e][1]]}return[null,void 0]},Mb=function(i){return typeof i=="string"?O_(i.trim(),yd.string):typeof i=="object"&&i!==null?O_(i,yd.object):[null,void 0]},Bu=function(i,t){var e=ha(i);return{h:e.h,s:Le(e.s+100*t,0,100),l:e.l,a:e.a}},ku=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},B_=function(i,t){var e=ha(i);return{h:e.h,s:e.s,l:Le(e.l+100*t,0,100),a:e.a}},vd=function(){function i(t){this.parsed=Mb(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return jt(ku(this.rgba),2)},i.prototype.isDark=function(){return ku(this.rgba)<.5},i.prototype.isLight=function(){return ku(this.rgba)>=.5},i.prototype.toHex=function(){return t=Ou(this.rgba),e=t.r,r=t.g,s=t.b,a=(n=t.a)<1?yo(jt(255*n)):"","#"+yo(e)+yo(r)+yo(s)+a;var t,e,r,s,n,a},i.prototype.toRgb=function(){return Ou(this.rgba)},i.prototype.toRgbString=function(){return t=Ou(this.rgba),e=t.r,r=t.g,s=t.b,(n=t.a)<1?"rgba("+e+", "+r+", "+s+", "+n+")":"rgb("+e+", "+r+", "+s+")";var t,e,r,s,n},i.prototype.toHsl=function(){return P_(ha(this.rgba))},i.prototype.toHslString=function(){return t=P_(ha(this.rgba)),e=t.h,r=t.s,s=t.l,(n=t.a)<1?"hsla("+e+", "+r+"%, "+s+"%, "+n+")":"hsl("+e+", "+r+"%, "+s+"%)";var t,e,r,s,n},i.prototype.toHsv=function(){return t=Pv(this.rgba),{h:jt(t.h),s:jt(t.s),v:jt(t.v),a:jt(t.a,3)};var t},i.prototype.invert=function(){return li({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),li(Bu(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),li(Bu(this.rgba,-t))},i.prototype.grayscale=function(){return li(Bu(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),li(B_(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),li(B_(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?li({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):jt(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=ha(this.rgba);return typeof t=="number"?li({h:t,s:e.s,l:e.l,a:e.a}):jt(e.h)},i.prototype.isEqual=function(t){return this.toHex()===li(t).toHex()},i}(),li=function(i){return i instanceof vd?i:new vd(i)},k_=[],Pb=function(i){i.forEach(function(t){k_.indexOf(t)<0&&(t(vd,yd),k_.push(t))})};function Fb(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var s in e)r[e[s]]=s;var n={};i.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,h=r[this.toHex()];if(h)return h;if(a!=null&&a.closest){var u=this.toRgb(),d=1/0,c="black";if(!n.length)for(var f in e)n[f]=new i(e[f]).toRgb();for(var p in e){var y=(o=u,l=n[p],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));y<d&&(d=y,c=p)}return c}},t.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":e[o];return l?new i(l).toRgb():null},"name"])}Pb([Fb]);const Es=class Jo{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Jo)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,n)=>s===e[n]);if(t!==null&&e!==null){const s=Object.keys(t),n=Object.keys(e);return s.length!==n.length?!1:s.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,r,s]=this._components;return{r:t,g:e,b:r,a:s}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,r,s]=this._components;return t[0]=e,t[1]=r,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,s,n]=Jo.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(r=r*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(r<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,r,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(r*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,r,s,n]=this._components;return t[0]=e,t[1]=r,t[2]=s,t[3]=n,t}normalize(t){let e,r,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,r=(a>>8&255)/255,s=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,s,n=255]=t,e/=255,r/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=Jo.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=li(t);a.isValid()&&({r:e,g:r,b:s,a:n}=a.rgba,e/=255,r/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),r)}),t)}};Es.shared=new Es,Es.temp=new Es,Es.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Tt=Es;function Ob(i){return ht("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Tt.shared.setValue(i).toHex()}function Bb(i){return ht("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Tt.shared.setValue(i).toNumber()}function kb(){const i=[],t=[];for(let r=0;r<32;r++)i[r]=r,t[r]=r;i[Z.NORMAL_NPM]=Z.NORMAL,i[Z.ADD_NPM]=Z.ADD,i[Z.SCREEN_NPM]=Z.SCREEN,t[Z.NORMAL]=Z.NORMAL_NPM,t[Z.ADD]=Z.ADD_NPM,t[Z.SCREEN]=Z.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const Ov=kb();function Bv(i,t){return Ov[t?1:0][i]}function Nb(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let r=0,s=0;r<e;r+=6,s+=4)t[r+0]=s+0,t[r+1]=s+1,t[r+2]=s+2,t[r+3]=s+0,t[r+4]=s+2,t[r+5]=s+3;return t}function kv(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function Hl(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function N_(i){return!(i&i-1)&&!!i}function L_(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function Js(i,t,e){const r=i.length;let s;if(t>=r||e===0)return;e=t+e>r?r-t:e;const n=r-e;for(s=t;s<n;++s)i[s]=i[s+e];i.length=n}function ur(i){return i===0?0:i<0?-1:1}let Lb=0;function ls(){return++Lb}const xd=class{constructor(i,t,e,r){this.left=i,this.top=t,this.right=e,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};xd.EMPTY=new xd(0,0,0,0);let U_=xd;const G_={},hi=Object.create(null),Zi=Object.create(null);class Ub{constructor(t,e,r){this._canvas=W.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||W.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function V_(i,t,e){for(let r=0,s=4*e*t;r<t;++r,s+=4)if(i[s+3]!==0)return!1;return!0}function H_(i,t,e,r,s){const n=4*t;for(let a=r,o=r*n+4*e;a<=s;++a,o+=n)if(i[o+3]!==0)return!1;return!0}function Gb(i){const{width:t,height:e}=i,r=i.getContext("2d",{willReadFrequently:!0});if(r===null)throw new TypeError("Failed to get canvas 2D context");const s=r.getImageData(0,0,t,e).data;let n=0,a=0,o=t-1,l=e-1;for(;a<e&&V_(s,t,a);)++a;if(a===e)return U_.EMPTY;for(;V_(s,t,l);)--l;for(;H_(s,t,n,a,l);)++n;for(;H_(s,t,o,a,l);)--o;return++o,++l,new U_(n,a,o,l)}function Vb(i){const t=Gb(i),{width:e,height:r}=t;let s=null;if(!t.isEmpty()){const n=i.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");s=n.getImageData(t.left,t.top,e,r)}return{width:e,height:r,data:s}}function Hb(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(i,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Wi(i,t=1){var r;const e=(r=W.RETINA_PREFIX)==null?void 0:r.exec(i);return e?parseFloat(e[1]):t}var X=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(X||{});const Td=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},z_=(i,t)=>Td(i).priority??t,q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Td).forEach(t=>{t.type.forEach(e=>{var r,s;return(s=(r=this._removeHandlers)[e])==null?void 0:s.call(r,t)})}),this},add(...i){return i.map(Td).forEach(t=>{t.type.forEach(e=>{var n,a;const r=this._addHandlers,s=this._queue;r[e]?(n=r[e])==null||n.call(r,t):(s[e]=s[e]||[],(a=s[e])==null||a.push(t))})}),this},handle(i,t,e){var a;const r=this._addHandlers,s=this._removeHandlers;if(r[i]||s[i])throw new Error(`Extension type ${i} already has a handler`);r[i]=t,s[i]=e;const n=this._queue;return n[i]&&((a=n[i])==null||a.forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((s,n)=>z_(n,e)-z_(s,e)))},r=>{const s=t.indexOf(r.ref);s!==-1&&t.splice(s,1)})}};class Ad{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const zb=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Xb(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function $b(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const r=zb.replace(/%forloop%/gi,Xb(i));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const Nu=0,Lu=1,Uu=2,Gu=3,Vu=4,Hu=5;class Ii{constructor(){this.data=0,this.blendMode=Z.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Nu)}set blend(t){!!(this.data&1<<Nu)!==t&&(this.data^=1<<Nu)}get offsets(){return!!(this.data&1<<Lu)}set offsets(t){!!(this.data&1<<Lu)!==t&&(this.data^=1<<Lu)}get culling(){return!!(this.data&1<<Uu)}set culling(t){!!(this.data&1<<Uu)!==t&&(this.data^=1<<Uu)}get depthTest(){return!!(this.data&1<<Gu)}set depthTest(t){!!(this.data&1<<Gu)!==t&&(this.data^=1<<Gu)}get depthMask(){return!!(this.data&1<<Hu)}set depthMask(t){!!(this.data&1<<Hu)!==t&&(this.data^=1<<Hu)}get clockwiseFrontFace(){return!!(this.data&1<<Vu)}set clockwiseFrontFace(t){!!(this.data&1<<Vu)!==t&&(this.data^=1<<Vu)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==Z.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Ii;return t.depthTest=!1,t.blend=!0,t}}Ii.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Ed=[];function Nv(i,t){if(!i)return null;let e="";if(typeof i=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);r&&(e=r[1].toLowerCase())}for(let r=Ed.length-1;r>=0;--r){const s=Ed[r];if(s.test&&s.test(i,e))return new s(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ti{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,r,s,n,a,o,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:u}=this;this._aliasCount++;for(let d=0,c=u.length;d<c;d++)u[d][h](t,e,r,s,n,a,o,l);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ti.prototype,{dispatch:{value:ti.prototype.emit},run:{value:ti.prototype.emit}});class Ma{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ti("setRealSize"),this.onUpdate=new ti("update"),this.onError=new ti("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Sh extends Ma{constructor(t,e){const{width:r,height:s}=e||{};if(!r||!s)throw new Error("BufferResource width or height invalid");super(r,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,r){const s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ve.UNPACK);const n=e.realWidth,a=e.realHeight;return r.width===n&&r.height===a?s.texSubImage2D(e.target,0,0,0,n,a,e.format,r.type,this.data):(r.width=n,r.height=a,s.texImage2D(e.target,0,r.internalFormat,n,a,0,e.format,r.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const Wb={scaleMode:ki.NEAREST,alphaMode:ve.NPM},Sd=class Ss extends La{constructor(t=null,e=null){super(),e=Object.assign({},Ss.defaultOptions,e);const{alphaMode:r,mipmap:s,anisotropicLevel:n,scaleMode:a,width:o,height:l,wrapMode:h,format:u,type:d,target:c,resolution:f,resourceOptions:p}=e;t&&!(t instanceof Ma)&&(t=Nv(t,p),t.internal=!0),this.resolution=f||W.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=h,this._scaleMode=a,this.format=u,this.type=d,this.target=c,this.alphaMode=r,this.uid=ls(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=N_(this.realWidth)&&N_(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Zi[this.cacheId],delete hi[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Ss.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=W.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else{if(!t._pixiId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${o}_${ls()}`}n=t._pixiId}let a=Zi[n];if(s&&r&&!a)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return a||(a=new Ss(t,e),a.cacheId=n,Ss.addToCache(a,n)),a}static fromBuffer(t,e,r,s){t=t||new Float32Array(e*r*4);const n=new Sh(t,{width:e,height:r,...s==null?void 0:s.resourceOptions});let a,o;return t instanceof Float32Array?(a=G.RGBA,o=J.FLOAT):t instanceof Int32Array?(a=G.RGBA_INTEGER,o=J.INT):t instanceof Uint32Array?(a=G.RGBA_INTEGER,o=J.UNSIGNED_INT):t instanceof Int16Array?(a=G.RGBA_INTEGER,o=J.SHORT):t instanceof Uint16Array?(a=G.RGBA_INTEGER,o=J.UNSIGNED_SHORT):t instanceof Int8Array?(a=G.RGBA,o=J.BYTE):(a=G.RGBA,o=J.UNSIGNED_BYTE),n.internal=!0,new Ss(n,Object.assign({},Wb,{type:o,format:a},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Zi[e]&&Zi[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Zi[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Zi[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Zi[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Zi[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Sd.defaultOptions={mipmap:bi.POW2,anisotropicLevel:0,scaleMode:ki.LINEAR,wrapMode:Tr.CLAMP,alphaMode:ve.UNPACK,target:Ks.TEXTURE_2D,format:G.RGBA,type:J.UNSIGNED_BYTE},Sd._globalBatch=0;let at=Sd;class wd{constructor(){this.texArray=null,this.blend=0,this.type=xi.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Yb=0;class Ot{constructor(t,e=!0,r=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Yb++,this.disposeRunner=new ti("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Ei.ELEMENT_ARRAY_BUFFER:Ei.ARRAY_BUFFER}get index(){return this.type===Ei.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Ot(t)}}class zl{constructor(t,e=0,r=!1,s=J.FLOAT,n,a,o,l=1){this.buffer=t,this.size=e,this.normalized=r,this.type=s,this.stride=n,this.start=a,this.instance=o,this.divisor=l}destroy(){this.buffer=null}static from(t,e,r,s,n){return new zl(t,e,r,s,n)}}const jb={Float32Array,Uint32Array,Int32Array,Uint8Array};function qb(i,t){let e=0,r=0;const s={};for(let l=0;l<i.length;l++)r+=t[l],e+=i[l].length;const n=new ArrayBuffer(e*4);let a=null,o=0;for(let l=0;l<i.length;l++){const h=t[l],u=i[l],d=kv(u);s[d]||(s[d]=new jb[d](n)),a=s[d];for(let c=0;c<u.length;c++){const f=(c/h|0)*r+o,p=c%h;a[f+p]=u[c]}o+=h}return new Float32Array(n)}const X_={5126:4,5123:2,5121:1};let Kb=0;const Zb={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class wr{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Kb++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ti("disposeGeometry"),this.refCount=0}addAttribute(t,e,r=0,s=!1,n,a,o,l=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Ot||(e instanceof Array&&(e=new Float32Array(e)),e=new Ot(e));const h=t.split("|");if(h.length>1){for(let d=0;d<h.length;d++)this.addAttribute(h[d],e,r,s,n);return this}let u=this.buffers.indexOf(e);return u===-1&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new zl(u,r,s,n,a,o,l),this.instanced=this.instanced||l,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Ot||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ot(t)),t.type=Ei.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],r=new Ot;let s;for(s in this.attributes){const n=this.attributes[s],a=this.buffers[n.buffer];t.push(a.data),e.push(n.size*X_[n.type]/4),n.buffer=0}for(r.data=qb(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new wr;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Ot(this.buffers[e].data.slice(0));for(const e in this.attributes){const r=this.attributes[e];t.attributes[e]=new zl(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Ei.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new wr,r=[],s=[],n=[];let a;for(let o=0;o<t.length;o++){a=t[o];for(let l=0;l<a.buffers.length;l++)s[l]=s[l]||0,s[l]+=a.buffers[l].data.length,n[l]=0}for(let o=0;o<a.buffers.length;o++)r[o]=new Zb[kv(a.buffers[o].data)](s[o]),e.buffers[o]=new Ot(r[o]);for(let o=0;o<t.length;o++){a=t[o];for(let l=0;l<a.buffers.length;l++)r[l].set(a.buffers[l].data,n[l]),n[l]+=a.buffers[l].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=Ei.ELEMENT_ARRAY_BUFFER;let o=0,l=0,h=0,u=0;for(let d=0;d<a.buffers.length;d++)if(a.buffers[d]!==a.indexBuffer){u=d;break}for(const d in a.attributes){const c=a.attributes[d];(c.buffer|0)===u&&(l+=c.size*X_[c.type]/4)}for(let d=0;d<t.length;d++){const c=t[d].indexBuffer.data;for(let f=0;f<c.length;f++)e.indexBuffer.data[f+h]+=o;o+=t[d].buffers[u].data.length/l,h+=c.length}}return e}}class Lv extends wr{constructor(t=!1){super(),this._buffer=new Ot(null,t,!1),this._indexBuffer=new Ot(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,J.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,J.FLOAT).addAttribute("aColor",this._buffer,4,!0,J.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,J.FLOAT).addIndex(this._indexBuffer)}}const Xl=Math.PI*2,Qb=180/Math.PI,Jb=Math.PI/180;var te=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(te||{});let mt=class Uv{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Uv(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}};mt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const vo=[new mt,new mt,new mt,new mt];let ot=class bd{constructor(t=0,e=0,r=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(s),this.type=te.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new bd(0,0,0,0)}clone(){return new bd(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const E=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=E)return!1;const C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}const r=this.left,s=this.right,n=this.top,a=this.bottom;if(s<=r||a<=n)return!1;const o=vo[0].set(t.left,t.top),l=vo[1].set(t.left,t.bottom),h=vo[2].set(t.right,t.top),u=vo[3].set(t.right,t.bottom);if(h.x<=o.x||l.y<=o.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(o,o),e.apply(l,l),e.apply(h,h),e.apply(u,u),Math.max(o.x,l.x,h.x,u.x)<=r||Math.min(o.x,l.x,h.x,u.x)>=s||Math.max(o.y,l.y,h.y,u.y)<=n||Math.min(o.y,l.y,h.y,u.y)>=a))return!1;const c=d*(l.y-o.y),f=d*(o.x-l.x),p=c*r+f*n,y=c*s+f*n,x=c*r+f*a,m=c*s+f*a;if(Math.max(p,y,x,m)<=c*o.x+f*o.y||Math.min(p,y,x,m)>=c*u.x+f*u.y)return!1;const _=d*(o.y-h.y),g=d*(h.x-o.x),T=_*r+g*n,A=_*s+g*n,S=_*r+g*a,w=_*s+g*a;return!(Math.max(T,A,S,w)<=_*o.x+g*o.y||Math.min(T,A,S,w)>=_*u.x+g*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=s,this.height=n-s,this}};ot.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class wh{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.radius=r,this.type=te.CIRC}clone(){return new wh(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let s=this.x-t,n=this.y-e;return s*=s,n*=n,s+n<=r}getBounds(){return new ot(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}wh.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class bh{constructor(t=0,e=0,r=0,s=0){this.x=t,this.y=e,this.width=r,this.height=s,this.type=te.ELIP}clone(){return new bh(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let r=(t-this.x)/this.width,s=(e-this.y)/this.height;return r*=r,s*=s,r+s<=1}getBounds(){return new ot(this.x-this.width,this.y-this.height,this.width,this.height)}}bh.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Zr{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let s=0,n=e.length;s<n;s++)r.push(e[s].x,e[s].y);e=r}this.points=e,this.type=te.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Zr(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let r=!1;const s=this.points.length/2;for(let n=0,a=s-1;n<s;a=n++){const o=this.points[n*2],l=this.points[n*2+1],h=this.points[a*2],u=this.points[a*2+1];l>e!=u>e&&t<(h-o)*((e-l)/(u-l))+o&&(r=!r)}return r}}Zr.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((i,t)=>`${i}, ${t}`,"")}]`};class Ch{constructor(t=0,e=0,r=0,s=0,n=20){this.x=t,this.y=e,this.width=r,this.height=s,this.radius=n,this.type=te.RREC}clone(){return new Ch(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let s=t-(this.x+r),n=e-(this.y+r);const a=r*r;if(s*s+n*n<=a||(s=t-(this.x+this.width-r),s*s+n*n<=a)||(n=e-(this.y+this.height-r),s*s+n*n<=a)||(s=t-(this.x+r),s*s+n*n<=a))return!0}return!1}}Ch.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};let kt=class tl{constructor(t=1,e=0,r=0,s=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=s,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,s,n,a){return this.a=t,this.b=e,this.c=r,this.d=s,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new mt;const r=t.x,s=t.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e}applyInverse(t,e){e=e||new mt;const r=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*r*s+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),s=this.a,n=this.c,a=this.tx;return this.a=s*e-this.b*r,this.b=s*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=a*e-this.ty*r,this.ty=a*r+this.ty*e,this}append(t){const e=this.a,r=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this}setTransform(t,e,r,s,n,a,o,l,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=t-(r*this.a+s*this.c),this.ty=e-(r*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,s=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,s=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-s,n),l=Math.atan2(r,e),h=Math.abs(o+l);return h<1e-5||Math.abs(Xl-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=l),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(a.x*e+a.y*s),t.position.y=this.ty+(a.x*r+a.y*n),t}invert(){const t=this.a,e=this.b,r=this.c,s=this.d,n=this.tx,a=t*s-e*r;return this.a=s/a,this.b=-e/a,this.c=-r/a,this.d=t/a,this.tx=(r*this.ty-s*n)/a,this.ty=-(t*this.ty-e*n)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new tl;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new tl}static get TEMP_MATRIX(){return new tl}};kt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Br=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],kr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Nr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Lr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Cd=[],Gv=[],xo=Math.sign;function tC(){for(let i=0;i<16;i++){const t=[];Cd.push(t);for(let e=0;e<16;e++){const r=xo(Br[i]*Br[e]+Nr[i]*kr[e]),s=xo(kr[i]*Br[e]+Lr[i]*kr[e]),n=xo(Br[i]*Nr[e]+Nr[i]*Lr[e]),a=xo(kr[i]*Nr[e]+Lr[i]*Lr[e]);for(let o=0;o<16;o++)if(Br[o]===r&&kr[o]===s&&Nr[o]===n&&Lr[o]===a){t.push(o);break}}}for(let i=0;i<16;i++){const t=new kt;t.set(Br[i],kr[i],Nr[i],Lr[i],0,0),Gv.push(t)}}tC();const St={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Br[i],uY:i=>kr[i],vX:i=>Nr[i],vY:i=>Lr[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Cd[i][t],sub:(i,t)=>Cd[i][St.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?St.S:St.N:Math.abs(t)*2<=Math.abs(i)?i>0?St.E:St.W:t>0?i>0?St.SE:St.SW:i>0?St.NE:St.NW,matrixAppendRotationInv:(i,t,e=0,r=0)=>{const s=Gv[St.inv(t)];s.tx=e,s.ty=r,i.append(s)}};class Li{constructor(t,e,r=0,s=0){this._x=r,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Li(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Li.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Id=class{constructor(){this.worldTransform=new kt,this.localTransform=new kt,this.position=new Li(this.onChange,this,0,0),this.scale=new Li(this.onChange,this,1,1),this.pivot=new Li(this.onChange,this,0,0),this.skew=new Li(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,r=this.worldTransform;r.a=t.a*e.a+t.b*e.c,r.b=t.a*e.b+t.b*e.d,r.c=t.c*e.a+t.d*e.c,r.d=t.c*e.b+t.d*e.d,r.tx=t.tx*e.a+t.ty*e.c+e.tx,r.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};Id.IDENTITY=new Id;let pp=Id;pp.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var eC=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,iC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function $_(i,t,e){const r=i.createShader(t);return i.shaderSource(r,e),i.compileShader(r),r}function zu(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Vv(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return zu(2*t);case"bvec3":return zu(3*t);case"bvec4":return zu(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const tn=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${i}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(i,t)=>i.type==="vec3"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${i}"].location, v.red, v.green, v.blue)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],rC={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},sC={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function nC(i,t){var r;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in i.uniforms){const n=t[s];if(!n){((r=i.uniforms[s])==null?void 0:r.group)===!0&&(i.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const a=i.uniforms[s];let o=!1;for(let l=0;l<tn.length;l++)if(tn[l].test(n,a)){e.push(tn[l].code(s,a)),o=!0;break}if(!o){const l=(n.size===1&&!n.isArray?rC:sC)[n.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Hv={};let xs=Hv;function aC(){if(xs===Hv||xs!=null&&xs.isContextLost()){const i=W.ADAPTER.createCanvas();let t;W.PREFER_ENV>=fs.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),xs=t}return xs}let To;function oC(){if(!To){To=Ne.MEDIUM;const i=aC();if(i&&i.getShaderPrecisionFormat){const t=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);t&&(To=t.precision?Ne.HIGH:Ne.MEDIUM)}}return To}function W_(i,t){const e=i.getShaderSource(t).split(`
`).map((h,u)=>`${u}: ${h}`),r=i.getShaderInfoLog(t),s=r.split(`
`),n={},a=s.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),o=[""];a.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=e.join(`
`);o[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function lC(i,t,e,r){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||W_(i,e),i.getShaderParameter(r,i.COMPILE_STATUS)||W_(i,r),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const hC={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function zv(i){return hC[i]}let Ao=null;const Y_={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Xv(i,t){if(!Ao){const e=Object.keys(Y_);Ao={};for(let r=0;r<e.length;++r){const s=e[r];Ao[i[s]]=Y_[s]}}return Ao[t]}function j_(i,t,e){if(i.substring(0,9)!=="precision"){let r=t;return t===Ne.HIGH&&e!==Ne.HIGH&&(r=Ne.MEDIUM),`precision ${r} float;
${i}`}else if(e!==Ne.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Fn;function uC(){if(typeof Fn=="boolean")return Fn;try{Fn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Fn=!1}return Fn}let cC=0;const Eo={},Dd=class ws{constructor(t,e,r="pixi-shader",s={}){this.extra={},this.id=cC++,this.vertexSrc=t||ws.defaultVertexSrc,this.fragmentSrc=e||ws.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),Eo[r]?(Eo[r]++,r+=`-${Eo[r]}`):Eo[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=j_(this.vertexSrc,ws.defaultVertexPrecision,Ne.HIGH),this.fragmentSrc=j_(this.fragmentSrc,ws.defaultFragmentPrecision,oC())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return iC}static get defaultFragmentSrc(){return eC}static from(t,e,r){const s=t+e;let n=G_[s];return n||(G_[s]=n=new ws(t,e,r)),n}};Dd.defaultVertexPrecision=Ne.HIGH,Dd.defaultFragmentPrecision=Ni.apple.device?Ne.HIGH:Ne.MEDIUM;let Ui=Dd,dC=0;class ei{constructor(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=dC++,this.static=!!e,this.ubo=!!r,t instanceof Ot?(this.buffer=t,this.buffer.type=Ei.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ot(new Float32Array(1)),this.buffer.type=Ei.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,r){if(!this.ubo)this.uniforms[t]=new ei(e,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,r){return new ei(t,e,r)}static uboFrom(t,e){return new ei(t,e??!0,!0)}}class Si{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ei?this.uniformGroup=e:this.uniformGroup=new ei(e):this.uniformGroup=new ei({}),this.disposeRunner=new ti("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const r in e.uniforms){const s=e.uniforms[r];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,r){const s=Ui.from(t,e);return new Si(s,r)}}class fC{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=n;this.defaultGroupCache[t]=ei.from({uSamplers:r},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ui(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:this.defaultGroupCache[t]};return new Si(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let r=0;r<t;r++)r>0&&(e+=`
else `),r<t-1&&(e+=`if(vTextureId < ${r}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Rd{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function pC(){return!Ni.apple.device}function mC(i){let t=!0;const e=W.ADAPTER.getNavigator();if(Ni.tablet||Ni.phone){if(Ni.apple.device){const r=e.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(t=!1)}if(Ni.android.device){const r=e.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(t=!1)}}return t?i:4}class Ih{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var _C=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,gC=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Vn=class $e extends Ih{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Lv,this.vertexSize=6,this.state=Ii.for2d(),this.size=$e.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??mC(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??pC(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return ht("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return gC}static get defaultFragmentTemplate(){return _C}setShaderGenerator({vertex:t=$e.defaultVertexSrc,fragment:e=$e.defaultFragmentTemplate}={}){this.shaderGenerator=new fC(t,e)}contextChange(){const t=this.renderer.gl;W.PREFER_ENV===fs.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),$e.defaultMaxTextures),this.maxTextures=$b(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=$e,r=this.size/4,s=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new wd);for(;e.length<s;)e.push(new Rd);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,r=$e._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,a=this.renderer.textureGC.count;let o=++at._globalBatch,l=0,h=r[0],u=0;s.copyBoundTextures(n,e);for(let d=0;d<this._bufferSize;++d){const c=t[d];t[d]=null,c._batchEnabled!==o&&(h.count>=e&&(s.boundArray(h,n,o,e),this.buildDrawCalls(h,u,d),u=d,h=r[++l],++o),c._batchEnabled=o,c.touched=a,h.elements[h.count++]=c)}h.count>0&&(s.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++l,++o);for(let d=0;d<n.length;d++)n[d]=null;at._globalBatch=o}buildDrawCalls(t,e,r){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:a,vertexSize:o}=this,l=$e._drawCallPool;let h=this._dcIndex,u=this._aIndex,d=this._iIndex,c=l[h];c.start=this._iIndex,c.texArray=t;for(let f=e;f<r;++f){const p=s[f],y=p._texture.baseTexture,x=Ov[y.alphaMode?1:0][p.blendMode];s[f]=null,e<f&&c.blend!==x&&(c.size=d-c.start,e=f,c=l[++h],c.texArray=t,c.start=d),this.packInterleavedGeometry(p,n,a,u,d),u+=p.vertexData.length/2*o,d+=p.indices.length,c.blend=x}e<r&&(c.size=d-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(t){const e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;$e.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:r}=this.renderer,s=$e._drawCallPool;let n=null;for(let a=0;a<t;a++){const{texArray:o,type:l,size:h,start:u,blend:d}=s[a];n!==o&&(n=o,this.bindAndClearTexArray(o)),this.state.blendMode=d,r.set(this.state),e.drawElements(l,h,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),$e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Hl(Math.ceil(t/8)),r=L_(e),s=e*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new Ad(s*this.vertexSize*4)),n}getIndexBuffer(t){const e=Hl(Math.ceil(t/12)),r=L_(e),s=e*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(s)),n}packInterleavedGeometry(t,e,r,s,n){const{uint32View:a,float32View:o}=e,l=s/this.vertexSize,h=t.uvs,u=t.indices,d=t.vertexData,c=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),p=Tt.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let y=0;y<d.length;y+=2)o[s++]=d[y],o[s++]=d[y+1],o[s++]=h[y],o[s++]=h[y+1],a[s++]=p,o[s++]=c;for(let y=0;y<u.length;y++)r[n++]=l+u[y]}};Vn.defaultBatchSize=4096,Vn.extension={name:"batch",type:X.RendererPlugin},Vn._drawCallPool=[],Vn._textureArrayPool=[];let Ur=Vn;q.add(Ur);var yC=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,vC=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Md=class Hn extends Si{constructor(t,e,r){const s=Ui.from(t||Hn.defaultVertexSrc,e||Hn.defaultFragmentSrc);super(s,r),this.padding=0,this.resolution=Hn.defaultResolution,this.multisample=Hn.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ii}apply(t,e,r,s,n){t.applyFilter(this,e,r,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return vC}static get defaultFragmentSrc(){return yC}};Md.defaultResolution=1,Md.defaultMultisample=Lt.NONE;let ue=Md;class $l{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Tt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:r,backgroundAlpha:s}=t,n=r??e;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}$l.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},$l.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"background"};q.add($l);class $v{constructor(t){this.renderer=t,this.emptyRenderer=new Ih(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:r}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=r[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,r,s){const{elements:n,ids:a,count:o}=t;let l=0;for(let h=0;h<o;h++){const u=n[h],d=u._batchLocation;if(d>=0&&d<s&&e[d]===u){a[h]=d;continue}for(;l<s;){const c=e[l];if(c&&c._batchEnabled===r&&c._batchLocation===l){l++;continue}a[h]=l,u._batchLocation=l,e[l]=u;break}}}destroy(){this.renderer=null}}$v.extension={type:X.RendererSystem,name:"batch"};q.add($v);let q_=0;class Wl{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=q_++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,r=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=q_++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let r;if(W.PREFER_ENV>=fs.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Wl.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Wl.extension={type:X.RendererSystem,name:"context"};q.add(Wl);class Pd{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ti("disposeFramebuffer"),this.multisample=Lt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new at(null,{scaleMode:ki.NEAREST,resolution:1,mipmap:bi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new at(null,{scaleMode:ki.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:bi.OFF,format:G.DEPTH_COMPONENT,type:J.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const s=this.colorTextures[r],n=s.resolution;s.setSize(t/n,e/n)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Wv extends at{constructor(t={}){if(typeof t=="number"){const e=arguments[0],r=arguments[1],s=arguments[2],n=arguments[3];t={width:e,height:r,scaleMode:s,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Lt.NONE),super(null,t),this.mipmap=bi.OFF,this.valid=!0,this._clear=new Tt([0,0,0,0]),this.framebuffer=new Pd(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Yi extends Ma{constructor(t){const e=t,r=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,s=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(r,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=Hb(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}upload(t,e,r,s){const n=t.gl,a=e.realWidth,o=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ve.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&r.width===a&&r.height===o?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,r.type,s):(r.width=a,r.height=o,n.texImage2D(e.target,0,r.internalFormat,e.format,r.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(e,r),super.update()}dispose(){this.source=null}}class Yv extends Yi{constructor(t,e){if(e=e||{},typeof t=="string"){const r=new Image;Yi.crossOrigin(r,t,e.crossorigin),r.src=t,t=r}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??W.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,r)=>{const s=this.source;this.url=s.src;const n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=a=>{r(a),this.onError.emit(a)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,r=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ve.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,r){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,r,this.bitmap),!this.preserveBitmap){let s=!0;const n=e._glTextures;for(const a in n){const o=n[a];if(o!==r&&o.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class mp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,r){const s=e.width,n=e.height;if(r){const a=t.width/2/s,o=t.height/2/n,l=t.x/s+a,h=t.y/n+o;r=St.add(r,St.NW),this.x0=l+a*St.uX(r),this.y0=h+o*St.uY(r),r=St.add(r,2),this.x1=l+a*St.uX(r),this.y1=h+o*St.uY(r),r=St.add(r,2),this.x2=l+a*St.uX(r),this.y2=h+o*St.uY(r),r=St.add(r,2),this.x3=l+a*St.uX(r),this.y3=h+o*St.uY(r)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}mp.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const K_=new mp;function So(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class j extends La{constructor(t,e,r,s,n,a,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new ot(0,0,1,1)),t instanceof j&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=K_,this.uvMatrix=null,this.orig=r||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new mt(a.x,a.y):new mt(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&hi[e.url]&&j.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,j.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),r=new j(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===K_&&(this._uvs=new mp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},r=W.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else if(t instanceof at){if(!t.cacheId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${o}-${ls()}`,at.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const o=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${o}_${ls()}`}n=t._pixiId}let a=hi[n];if(s&&r&&!a)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!a&&!(t instanceof at)?(e.resolution||(e.resolution=Wi(t)),a=new j(new at(t,e)),a.baseTexture.cacheId=n,at.addToCache(a.baseTexture,n),j.addToCache(a,n)):!a&&t instanceof at&&(a=new j(t),j.addToCache(a,n)),a}static fromURL(t,e){const r=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=j.from(t,Object.assign({resourceOptions:r},e),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,r,s){return new j(at.fromBuffer(t,e,r,s))}static fromLoader(t,e,r,s){const n=new at(t,Object.assign({scaleMode:at.defaultOptions.scaleMode,resolution:Wi(e)},s)),{resource:a}=n;a instanceof Yv&&(a.url=e);const o=new j(n);return r||(r=e),at.addToCache(o.baseTexture,r),j.addToCache(o,r),r!==e&&(at.addToCache(o.baseTexture,e),j.addToCache(o,e)),o.baseTexture.valid?Promise.resolve(o):new Promise(l=>{o.baseTexture.once("loaded",()=>l(o))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),hi[e]&&hi[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),hi[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=hi[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete hi[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)hi[t.textureCacheIds[e]]===t&&delete hi[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:r,width:s,height:n}=t,a=e+s>this.baseTexture.width,o=r+n>this.baseTexture.height;if(a||o){const l=a&&o?"and":"or",h=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,u=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${u}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return j._EMPTY||(j._EMPTY=new j(new at),So(j._EMPTY),So(j._EMPTY.baseTexture)),j._EMPTY}static get WHITE(){if(!j._WHITE){const t=W.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),j._WHITE=new j(at.from(t)),So(j._WHITE),So(j._WHITE.baseTexture)}return j._WHITE}}class ms extends j{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,r=!0){const s=this.baseTexture.resolution,n=Math.round(t*s)/s,a=Math.round(e*s)/s;this.valid=n>0&&a>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=a,r&&this.baseTexture.resize(n,a),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new ms(new Wv(t))}}class jv{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,r=Lt.NONE){const s=new Wv(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new ms(s)}getOptimalTexture(t,e,r=1,s=Lt.NONE){let n;t=Math.max(Math.ceil(t*r-1e-6),1),e=Math.max(Math.ceil(e*r-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Hl(t),e=Hl(e),n=((t&65535)<<16|e&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let a=this.texturePool[n].pop();return a||(a=this.createTexture(t,e,s)),a.filterPoolKey=n,a.setResolution(r),a}getFilterTexture(t,e,r){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||Lt.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}jv.SCREEN_KEY=-1;class xC extends wr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class qv extends wr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ot(this.vertices),this.uvBuffer=new Ot(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let r=0,s=0;return this.uvs[0]=r,this.uvs[1]=s,this.uvs[2]=r+e.width/t.width,this.uvs[3]=s,this.uvs[4]=r+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=r,this.uvs[7]=s+e.height/t.height,r=e.x,s=e.y,this.vertices[0]=r,this.vertices[1]=s,this.vertices[2]=r+e.width,this.vertices[3]=s,this.vertices[4]=r+e.width,this.vertices[5]=s+e.height,this.vertices[6]=r,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class TC{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Lt.NONE,this.sourceFrame=new ot,this.destinationFrame=new ot,this.bindingSourceFrame=new ot,this.bindingDestinationFrame=new ot,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const wo=[new mt,new mt,new mt,new mt],Xu=new kt;class Kv{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new jv,this.statePool=[],this.quad=new xC,this.quadUv=new qv,this.tempRect=new ot,this.activeState={},this.globalUniforms=new ei({outputFrame:new ot,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const r=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new TC,a=r.renderTexture;let o,l;if(a.current){const x=a.current;o=x.resolution,l=x.multisample}else o=r.resolution,l=r.multisample;let h=e[0].resolution||o,u=e[0].multisample??l,d=e[0].padding,c=e[0].autoFit,f=e[0].legacy??!0;for(let x=1;x<e.length;x++){const m=e[x];h=Math.min(h,m.resolution||o),u=Math.min(u,m.multisample??l),d=this.useMaxPadding?Math.max(d,m.padding):d+m.padding,c=c&&m.autoFit,f=f||(m.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(n),n.resolution=h,n.multisample=u,n.legacy=f,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(d);const p=this.tempRect.copyFrom(a.sourceFrame);r.projection.transform&&this.transformAABB(Xu.copyFrom(r.projection.transform).invert(),p),c?(n.sourceFrame.fit(p),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(p)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,h,u),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const y=this.tempRect;y.x=0,y.y=0,y.width=n.sourceFrame.width,y.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(a.sourceFrame),n.bindingDestinationFrame.copyFrom(a.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,a.bind(n.renderTexture,n.sourceFrame,y),r.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const n=s.inputSize,a=s.inputPixel,o=s.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=Math.round(n[0]*e.resolution),a[1]=Math.round(n[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=e.sourceFrame.width*n[2]-.5*a[2],o[3]=e.sourceFrame.height*n[3]-.5*a[3],e.legacy){const h=s.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const l=t[t.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,e.renderTexture,l.renderTexture,mi.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,e.resolution);u.filterFrame=h.filterFrame;let d=0;for(d=0;d<r.length-1;++d){d===1&&e.multisample>1&&(u=this.getOptimalFilterTexture(h.width,h.height,e.resolution),u.filterFrame=h.filterFrame),r[d].apply(this,h,u,mi.CLEAR,e);const c=h;h=u,u=c}r[d].apply(this,h,l.renderTexture,mi.BLEND,e),d>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=mi.CLEAR){const{renderTexture:r,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,r.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=s.stateId&1||this.forceClear;(e===mi.CLEAR||e===mi.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,r,s){const n=this.renderer;n.state.set(t.state),this.bindAndClear(r,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(xi.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(xi.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:r,destinationFrame:s}=this.activeState,{orig:n}=e._texture,a=t.set(s.width,0,0,s.height,r.x,r.y),o=e.worldTransform.copyTo(kt.TEMP_MATRIX);return o.invert(),a.prepend(o),a.scale(1/n.width,1/n.height),a.translate(e.anchor.x,e.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,r=1,s=Lt.NONE){return this.texturePool.getOptimalTexture(t,e,r,s)}getFilterTexture(t,e,r){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||Lt.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const r=wo[0],s=wo[1],n=wo[2],a=wo[3];r.set(e.left,e.top),s.set(e.left,e.bottom),n.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(r,r),t.apply(s,s),t.apply(n,n),t.apply(a,a);const o=Math.min(r.x,s.x,n.x,a.x),l=Math.min(r.y,s.y,n.y,a.y),h=Math.max(r.x,s.x,n.x,a.x),u=Math.max(r.y,s.y,n.y,a.y);e.x=o,e.y=l,e.width=h-o,e.height=u-l}roundFrame(t,e,r,s,n){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(n){const{a,b:o,c:l,d:h}=n;if((Math.abs(o)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(h)>1e-4))return}n=n?Xu.copyFrom(n):Xu.identity(),n.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}Kv.extension={type:X.RendererSystem,name:"filter"};q.add(Kv);class AC{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Lt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const EC=new ot;class Zv{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Pd(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ot,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;W.PREFER_ENV===fs.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,r=0){const{gl:s}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=r),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){const o=t.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const a=e.width>>r,o=e.height>>r,l=a/e.width;this.setViewport(e.x*l,e.y*l,a,o)}else{const a=t.width>>r,o=t.height>>r;this.setViewport(0,0,a,o)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,r,s){const n=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),s=Math.round(s),(n.width!==r||n.height!==s||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=r,n.height=s,this.gl.viewport(t,e,r,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,r,s,n=nd.COLOR|nd.DEPTH){const{gl:a}=this;a.clearColor(t,e,r,s),a.clear(n)}initFramebuffer(t){const{gl:e}=this,r=new AC(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r}resizeFramebuffer(t){const{gl:e}=this,r=t.glFramebuffers[this.CONTEXT_UID];if(r.stencil){e.bindRenderbuffer(e.RENDERBUFFER,r.stencil);let a;this.renderer.context.webGLVersion===1?a=e.DEPTH_STENCIL:t.depth&&t.stencil?a=e.DEPTH24_STENCIL8:t.depth?a=e.DEPTH_COMPONENT24:a=e.STENCIL_INDEX8,r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,a,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,a,t.width,t.height)}const s=t.colorTextures;let n=s.length;e.drawBuffers||(n=Math.min(n,1));for(let a=0;a<n;a++){const o=s[a],l=o.parentTextureArray||o;this.renderer.texture.bind(l,0),a===0&&r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:r}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let a=n.length;r.drawBuffers||(a=Math.min(a,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||r.createRenderbuffer():s.msaaBuffer&&(r.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const o=[];for(let l=0;l<a;l++){const h=n[l],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),l===0&&s.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,s.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,h.target,u._glTextures[this.CONTEXT_UID].texture,e),o.push(r.COLOR_ATTACHMENT0+l))}if(o.length>1&&r.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||r.createRenderbuffer();let l,h;this.renderer.context.webGLVersion===1?(l=r.DEPTH_STENCIL_ATTACHMENT,h=r.DEPTH_STENCIL):t.depth&&t.stencil?(l=r.DEPTH_STENCIL_ATTACHMENT,h=r.DEPTH24_STENCIL8):t.depth?(l=r.DEPTH_ATTACHMENT,h=r.DEPTH_COMPONENT24):(l=r.STENCIL_ATTACHMENT,h=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),s.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,h,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,h,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,l,r.RENDERBUFFER,s.stencil)}else s.stencil&&(r.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let r=Lt.NONE;if(t<=1||e===null)return r;for(let s=0;s<e.length;s++)if(e[s]<=t){r=e[s];break}return r===1&&(r=Lt.NONE),r}blit(t,e,r){const{current:s,renderer:n,gl:a,CONTEXT_UID:o}=this;if(n.context.webGLVersion!==2||!s)return;const l=s.glFramebuffers[o];if(!l)return;if(!t){if(!l.msaaBuffer)return;const u=s.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new Pd(s.width,s.height),l.blitFramebuffer.addColorTexture(0,u)),t=l.blitFramebuffer,t.colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=EC,e.width=s.width,e.height=s.height),r||(r=e);const h=e.width===r.width&&e.height===r.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,l.framebuffer),a.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const r=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!r)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&s.deleteRenderbuffer(r.msaaBuffer),r.stencil&&s.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const r=t.width,s=t.height,n=this.gl,a=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a);let o,l;this.renderer.context.webGLVersion===1?(o=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH_STENCIL):t.depth?(o=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH24_STENCIL8):(o=n.STENCIL_ATTACHMENT,l=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,l,r,s):n.renderbufferStorage(n.RENDERBUFFER,l,r,s),n.framebufferRenderbuffer(n.FRAMEBUFFER,o,n.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ot}destroy(){this.renderer=null}}Zv.extension={type:X.RendererSystem,name:"framebuffer"};q.add(Zv);const $u={5126:4,5123:2,5121:1};class Qv{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;W.PREFER_ENV===fs.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=()=>r.createVertexArrayOES(),t.bindVertexArray=s=>r.bindVertexArrayOES(s),t.deleteVertexArray=s=>r.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=(s,n)=>r.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,a,o,l)=>r.drawElementsInstancedANGLE(s,n,a,o,l),t.drawArraysInstanced=(s,n,a,o)=>r.drawArraysInstancedANGLE(s,n,a,o)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:r}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);const a=s[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?r.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let r=0;r<t.buffers.length;r++){const s=t.buffers[r];e.update(s)}}checkCompatibility(t,e){const r=t.attributes,s=e.attributeData;for(const n in s)if(!r[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const r=t.attributes,s=e.attributeData,n=["g",t.id];for(const a in r)s[a]&&n.push(a,s[a].location);return n.join("-")}initGeometryVao(t,e,r=!0){const s=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);const l=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID];let u=h[l];if(u)return h[o.id]=u,u;const d=t.buffers,c=t.attributes,f={},p={};for(const y in d)f[y]=0,p[y]=0;for(const y in c)!c[y].size&&o.attributeData[y]?c[y].size=o.attributeData[y].size:c[y].size||console.warn(`PIXI Geometry attribute '${y}' size cannot be determined (likely the bound shader does not have the attribute)`),f[c[y].buffer]+=c[y].size*$u[c[y].type];for(const y in c){const x=c[y],m=x.size;x.stride===void 0&&(f[x.buffer]===m*$u[x.type]?x.stride=0:x.stride=f[x.buffer]),x.start===void 0&&(x.start=p[x.buffer],p[x.buffer]+=m*$u[x.type])}u=s.createVertexArray(),s.bindVertexArray(u);for(let y=0;y<d.length;y++){const x=d[y];a.bind(x),r&&x._glBuffers[n].refCount++}return this.activateVao(t,o),h[o.id]=u,h[l]=u,s.bindVertexArray(null),a.unbind(Ei.ARRAY_BUFFER),u}disposeGeometry(t,e){var o;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const r=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,a=(o=this.renderer)==null?void 0:o.buffer;if(t.disposeRunner.remove(this),!!r){if(a)for(let l=0;l<n.length;l++){const h=n[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&a.dispose(n[l],e))}if(!e){for(const l in r)if(l[0]==="g"){const h=r[l];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)}activateVao(t,e){const r=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,a=t.buffers,o=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let l=null;for(const h in o){const u=o[h],d=a[u.buffer],c=d._glBuffers[s];if(e.attributeData[h]){l!==c&&(n.bind(d),l=c);const f=e.attributeData[h].location;if(r.enableVertexAttribArray(f),r.vertexAttribPointer(f,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)r.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,r,s){const{gl:n}=this,a=this._activeGeometry;if(a.indexBuffer){const o=a.indexBuffer.data.BYTES_PER_ELEMENT,l=o===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(t,e||a.indexBuffer.data.length,l,(r||0)*o,s||1):n.drawElements(t,e||a.indexBuffer.data.length,l,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(t,r,e||a.getSize(),s||1):n.drawArrays(t,r,e||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Qv.extension={type:X.RendererSystem,name:"geometry"};q.add(Qv);const Z_=new kt;class Jv{constructor(t,e){this._texture=t,this.mapCoord=new kt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],a=t[s+1];e[s]=n*r.a+a*r.c+r.tx,e[s+1]=n*r.b+a*r.d+r.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,n=e.trim;n&&(Z_.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Z_));const a=e.baseTexture,o=this.uClampFrame,l=this.clampMargin/a.resolution,h=this.clampOffset;return o[0]=(e._frame.x+l+h)/a.width,o[1]=(e._frame.y+l+h)/a.height,o[2]=(e._frame.x+e._frame.width-l+h)/a.width,o[3]=(e._frame.y+e._frame.height-l+h)/a.height,this.uClampOffset[0]=h/a.realWidth,this.uClampOffset[1]=h/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&e.rotate===0,!0}}var SC=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,wC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class bC extends ue{constructor(t,e,r){let s=null;typeof t!="string"&&e===void 0&&r===void 0&&(s=t,t=void 0,e=void 0,r=void 0),super(t||wC,e||SC,r),this.maskSprite=s,this.maskMatrix=new kt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,r,s){const n=this._maskSprite,a=n._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Jv(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,r,s))}}class CC{constructor(t=null){this.type=zt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ue.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=zt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class tx{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let r=e;if(!r.isMaskData){const n=this.maskDataPool.pop()||new CC;n.pooled=!0,n.maskObject=e,r=n}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(s),r._colorMask=s?s._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==zt.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case zt.SCISSOR:this.renderer.scissor.push(r);break;case zt.STENCIL:this.renderer.stencil.push(r);break;case zt.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case zt.COLOR:this.pushColorMask(r);break}r.type===zt.SPRITE&&this.maskStack.push(r)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case zt.SCISSOR:this.renderer.scissor.pop(e);break;case zt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case zt.SPRITE:this.popSpriteMask(e);break;case zt.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===zt.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=zt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=zt.SCISSOR:t.type=zt.STENCIL:t.type=zt.COLOR}pushSpriteMask(t){const{maskObject:e}=t,r=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new bC])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;const n=r.filterArea;r.filterArea=e.getBounds(!0),this.renderer.filter.push(r,s),r.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(t){const e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}tx.extension={type:X.RendererSystem,name:"mask"};q.add(tx);class ex{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,r=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==r&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Q_=new kt,J_=[],ix=class el extends ex{constructor(t){super(t),this.glConst=W.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:r}=t,{renderer:s}=this,n=s.renderTexture,a=r.getBounds(!0,J_.pop()??new ot);this.roundFrameToPixels(a,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),e&&a.fit(e),t._scissorRectLocal=a}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:r,c:s,d:n}=t;return(Math.abs(r)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||el.isMatrixRotated(e.worldTransform)||el.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,s,n){el.isMatrixRotated(n)||(n=n?Q_.copyFrom(n):Q_.identity(),n.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&J_.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};ix.extension={type:X.RendererSystem,name:"scissor"};let IC=ix;q.add(IC);class rx extends ex{constructor(t){super(t),this.glConst=W.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:r}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,s,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=r?r._colorMask:15;s!==0&&(r._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(r._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}rx.extension={type:X.RendererSystem,name:"stencil"};q.add(rx);class sx{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return ht("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}sx.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"_plugin"};q.add(sx);class nx{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new kt,this.transform=null}update(t,e,r,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,s),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,r,s){const n=this.projectionMatrix,a=s?-1:1;n.identity(),n.a=1/e.width*2,n.d=a*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-a-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}nx.extension={type:X.RendererSystem,name:"projection"};q.add(nx);const DC=new pp,tg=new ot;class ax{constructor(t){this.renderer=t,this._tempMatrix=new kt}generateTexture(t,e){const{region:r,...s}=e||{},n=(r==null?void 0:r.copyTo(tg))||t.getLocalBounds(tg,!0),a=s.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/a),n.height=Math.max(n.height,1/a),s.width=n.width,s.height=n.height,s.resolution=a,s.multisample??(s.multisample=this.renderer.multisample);const o=ms.create(s);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const l=t.transform;return t.transform=DC,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,o}destroy(){}}ax.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"textureGenerator"};q.add(ax);const Mr=new ot,On=new ot;class ox{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ot,this.destinationFrame=new ot,this.viewportFrame=new ot}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,r){const s=this.renderer;this.current=t;let n,a,o;t?(n=t.baseTexture,o=n.resolution,e||(Mr.width=t.frame.width,Mr.height=t.frame.height,e=Mr),r||(On.x=t.frame.x,On.y=t.frame.y,On.width=e.width,On.height=e.height,r=On),a=n.framebuffer):(o=s.resolution,e||(Mr.width=s._view.screen.width,Mr.height=s._view.screen.height,e=Mr),r||(r=Mr,r.width=e.width,r.height=e.height));const l=this.viewportFrame;l.x=r.x*o,l.y=r.y*o,l.width=r.width*o,l.height=r.height*o,t||(l.y=s.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(a,l),this.renderer.projection.update(r,e,o,!a),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)}clear(t,e){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=Tt.shared.setValue(t||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const n=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==a.width||n.height!==a.height;if(o){let{x:l,y:h,width:u,height:d}=this.viewportFrame;l=Math.round(l),h=Math.round(h),u=Math.round(u),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,u,d)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}ox.extension={type:X.RendererSystem,name:"renderTexture"};q.add(ox);class RC{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function MC(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const n=t.getActiveAttrib(i,s);if(n.name.startsWith("gl_"))continue;const a=Xv(t,n.type),o={type:a,name:n.name,size:zv(a),location:t.getAttribLocation(i,n.name)};e[n.name]=o}return e}function PC(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let s=0;s<r;s++){const n=t.getActiveUniform(i,s),a=n.name.replace(/\[.*?\]$/,""),o=!!n.name.match(/\[.*?\]$/),l=Xv(t,n.type);e[a]={name:a,index:s,type:l,size:n.size,isArray:o,value:Vv(l,n.size)}}return e}function FC(i,t){var o;const e=$_(i,i.VERTEX_SHADER,t.vertexSrc),r=$_(i,i.FRAGMENT_SHADER,t.fragmentSrc),s=i.createProgram();i.attachShader(s,e),i.attachShader(s,r);const n=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(n&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||lC(i,s,e,r),t.attributeData=MC(s,i),t.uniformData=PC(s,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((h,u)=>h>u?1:-1);for(let h=0;h<l.length;h++)t.attributeData[l[h]].location=h,i.bindAttribLocation(s,h,l[h]);i.linkProgram(s)}i.deleteShader(e),i.deleteShader(r);const a={};for(const l in t.uniformData){const h=t.uniformData[l];a[l]={location:i.getUniformLocation(s,l),value:Vv(h.type,h.size)}}return new RC(s,a)}function OC(i,t,e,r,s){e.buffer.update(s)}const BC={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},lx={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function kC(i){const t=i.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,r=0,s=0;for(let n=0;n<t.length;n++){const a=t[n];if(e=lx[a.data.type],a.data.size>1&&(e=Math.max(e,16)*a.data.size),a.dataLen=e,r%e!==0&&r<16){const o=r%e%16;r+=o,s+=o}r+e>16?(s=Math.ceil(s/16)*16,a.offset=s,s+=e,r=e):(a.offset=s,r+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function NC(i,t){const e=[];for(const r in i)t[r]&&e.push(t[r]);return e.sort((r,s)=>r.index-s.index),e}function LC(i,t){if(!i.autoManage)return{size:0,syncFunc:OC};const e=NC(i.uniforms,t),{uboElements:r,size:s}=kC(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<r.length;a++){const o=r[a],l=i.uniforms[o.data.name],h=o.data.name;let u=!1;for(let d=0;d<tn.length;d++){const c=tn[d];if(c.codeUbo&&c.test(o.data,l)){n.push(`offset = ${o.offset/4};`,tn[d].codeUbo(o.data.name,l)),u=!0;break}}if(!u)if(o.data.size>1){const d=zv(o.data.type),c=Math.max(lx[o.data.type]/16,1),f=d/c,p=(4-f%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${o.offset/4};

                t = 0;

                for(var i=0; i < ${o.data.size*c}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const d=BC[o.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${o.offset/4};
                ${d};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let UC=0;const bo={textureCount:0,uboCount:0};class hx{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UC++}systemCheck(){if(!uC())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const r=t.program,s=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(s.program)),e||(bo.textureCount=0,bo.uboCount=0,this.syncUniformGroup(t.uniformGroup,bo)),s}setUniforms(t){const e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)}syncUniformGroup(t,e){const r=this.getGlProgram();(!t.static||t.dirtyId!==r.uniformDirtyGroups[t.id])&&(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))}syncUniforms(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=nC(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const r=this.getGlProgram();if(!t.static||t.dirtyId!==0||!r.uniformGroups[t.id]){t.dirtyId=0;const s=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),s(r.uniformData,t.uniforms,this.renderer,bo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])}createSyncBufferGroup(t,e,r){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(t,this.shader.program.uniformData,"ubo");let o=this._uboCache[a];if(o||(o=this._uboCache[a]=LC(t,this.shader.program.uniformData)),t.autoManage){const l=new Float32Array(o.size/4);t.buffer.update(l)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,r){const s=t.uniforms,n=[`${r}-`];for(const a in s)n.push(a),e[a]&&n.push(e[a].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,r=t.program,s=FC(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}hx.extension={type:X.RendererSystem,name:"shader"};q.add(hx);class Yl{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.3 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Yl.defaultOptions={hello:!1},Yl.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"startup"};q.add(Yl);function GC(i,t=[]){return t[Z.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.ADD]=[i.ONE,i.ONE],t[Z.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.NONE]=[0,0],t[Z.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[Z.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[Z.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[Z.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[Z.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[Z.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[Z.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[Z.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[Z.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[Z.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[Z.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const VC=0,HC=1,zC=2,XC=3,$C=4,WC=5,ux=class Fd{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Z.NONE,this._blendEq=!1,this.map=[],this.map[VC]=this.setBlend,this.map[HC]=this.setOffset,this.map[zC]=this.setCullFace,this.map[XC]=this.setDepthTest,this.map[$C]=this.setFrontFace,this.map[WC]=this.setDepthMask,this.checks=[],this.defaultState=new Ii,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=GC(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)e&1&&this.map[r].call(this,!!(t.data&1<<r)),e=e>>1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Fd.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Fd.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],r=this.gl;e.length===2?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const r=this.checks.indexOf(t);e&&r===-1?this.checks.push(t):!e&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};ux.extension={type:X.RendererSystem,name:"state"};let YC=ux;q.add(YC);class jC extends La{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),r=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of r)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ti(e)})}addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const s in this.runners)this.runners[s].add(r);return this}emitWithCustomOptions(t,e){const r=Object.keys(this._systemsHash);t.items.forEach(s=>{const n=r.find(a=>this._systemsHash[a]===s);s[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const zn=class il{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=il.defaultMaxIdle,this.checkCountMax=il.defaultCheckCountMax,this.mode=il.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ap.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let r=!1;for(let s=0;s<e.length;s++){const n=e[s];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[s]=null,r=!0)}if(r){let s=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[s++]=e[n]);e.length=s}}unload(t){const e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};zn.defaultMode=ap.AUTO,zn.defaultMaxIdle=60*60,zn.defaultCheckCountMax=60*10,zn.extension={type:X.RendererSystem,name:"textureGC"};let Gr=zn;q.add(Gr);class Wu{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=J.UNSIGNED_BYTE,this.internalFormat=G.RGBA,this.samplerType=0}}function qC(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[i.RGB]:$.FLOAT,[i.RGBA]:$.FLOAT,[i.ALPHA]:$.FLOAT,[i.LUMINANCE]:$.FLOAT,[i.LUMINANCE_ALPHA]:$.FLOAT,[i.R8]:$.FLOAT,[i.R8_SNORM]:$.FLOAT,[i.RG8]:$.FLOAT,[i.RG8_SNORM]:$.FLOAT,[i.RGB8]:$.FLOAT,[i.RGB8_SNORM]:$.FLOAT,[i.RGB565]:$.FLOAT,[i.RGBA4]:$.FLOAT,[i.RGB5_A1]:$.FLOAT,[i.RGBA8]:$.FLOAT,[i.RGBA8_SNORM]:$.FLOAT,[i.RGB10_A2]:$.FLOAT,[i.RGB10_A2UI]:$.FLOAT,[i.SRGB8]:$.FLOAT,[i.SRGB8_ALPHA8]:$.FLOAT,[i.R16F]:$.FLOAT,[i.RG16F]:$.FLOAT,[i.RGB16F]:$.FLOAT,[i.RGBA16F]:$.FLOAT,[i.R32F]:$.FLOAT,[i.RG32F]:$.FLOAT,[i.RGB32F]:$.FLOAT,[i.RGBA32F]:$.FLOAT,[i.R11F_G11F_B10F]:$.FLOAT,[i.RGB9_E5]:$.FLOAT,[i.R8I]:$.INT,[i.R8UI]:$.UINT,[i.R16I]:$.INT,[i.R16UI]:$.UINT,[i.R32I]:$.INT,[i.R32UI]:$.UINT,[i.RG8I]:$.INT,[i.RG8UI]:$.UINT,[i.RG16I]:$.INT,[i.RG16UI]:$.UINT,[i.RG32I]:$.INT,[i.RG32UI]:$.UINT,[i.RGB8I]:$.INT,[i.RGB8UI]:$.UINT,[i.RGB16I]:$.INT,[i.RGB16UI]:$.UINT,[i.RGB32I]:$.INT,[i.RGB32UI]:$.UINT,[i.RGBA8I]:$.INT,[i.RGBA8UI]:$.UINT,[i.RGBA16I]:$.INT,[i.RGBA16UI]:$.UINT,[i.RGBA32I]:$.INT,[i.RGBA32UI]:$.UINT,[i.DEPTH_COMPONENT16]:$.FLOAT,[i.DEPTH_COMPONENT24]:$.FLOAT,[i.DEPTH_COMPONENT32F]:$.FLOAT,[i.DEPTH_STENCIL]:$.FLOAT,[i.DEPTH24_STENCIL8]:$.FLOAT,[i.DEPTH32F_STENCIL8]:$.FLOAT}:t={[i.RGB]:$.FLOAT,[i.RGBA]:$.FLOAT,[i.ALPHA]:$.FLOAT,[i.LUMINANCE]:$.FLOAT,[i.LUMINANCE_ALPHA]:$.FLOAT,[i.DEPTH_STENCIL]:$.FLOAT},t}function KC(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[J.UNSIGNED_BYTE]:{[G.RGBA]:i.RGBA8,[G.RGB]:i.RGB8,[G.RG]:i.RG8,[G.RED]:i.R8,[G.RGBA_INTEGER]:i.RGBA8UI,[G.RGB_INTEGER]:i.RGB8UI,[G.RG_INTEGER]:i.RG8UI,[G.RED_INTEGER]:i.R8UI,[G.ALPHA]:i.ALPHA,[G.LUMINANCE]:i.LUMINANCE,[G.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[J.BYTE]:{[G.RGBA]:i.RGBA8_SNORM,[G.RGB]:i.RGB8_SNORM,[G.RG]:i.RG8_SNORM,[G.RED]:i.R8_SNORM,[G.RGBA_INTEGER]:i.RGBA8I,[G.RGB_INTEGER]:i.RGB8I,[G.RG_INTEGER]:i.RG8I,[G.RED_INTEGER]:i.R8I},[J.UNSIGNED_SHORT]:{[G.RGBA_INTEGER]:i.RGBA16UI,[G.RGB_INTEGER]:i.RGB16UI,[G.RG_INTEGER]:i.RG16UI,[G.RED_INTEGER]:i.R16UI,[G.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[J.SHORT]:{[G.RGBA_INTEGER]:i.RGBA16I,[G.RGB_INTEGER]:i.RGB16I,[G.RG_INTEGER]:i.RG16I,[G.RED_INTEGER]:i.R16I},[J.UNSIGNED_INT]:{[G.RGBA_INTEGER]:i.RGBA32UI,[G.RGB_INTEGER]:i.RGB32UI,[G.RG_INTEGER]:i.RG32UI,[G.RED_INTEGER]:i.R32UI,[G.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[J.INT]:{[G.RGBA_INTEGER]:i.RGBA32I,[G.RGB_INTEGER]:i.RGB32I,[G.RG_INTEGER]:i.RG32I,[G.RED_INTEGER]:i.R32I},[J.FLOAT]:{[G.RGBA]:i.RGBA32F,[G.RGB]:i.RGB32F,[G.RG]:i.RG32F,[G.RED]:i.R32F,[G.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[J.HALF_FLOAT]:{[G.RGBA]:i.RGBA16F,[G.RGB]:i.RGB16F,[G.RG]:i.RG16F,[G.RED]:i.R16F},[J.UNSIGNED_SHORT_5_6_5]:{[G.RGB]:i.RGB565},[J.UNSIGNED_SHORT_4_4_4_4]:{[G.RGBA]:i.RGBA4},[J.UNSIGNED_SHORT_5_5_5_1]:{[G.RGBA]:i.RGB5_A1},[J.UNSIGNED_INT_2_10_10_10_REV]:{[G.RGBA]:i.RGB10_A2,[G.RGBA_INTEGER]:i.RGB10_A2UI},[J.UNSIGNED_INT_10F_11F_11F_REV]:{[G.RGB]:i.R11F_G11F_B10F},[J.UNSIGNED_INT_5_9_9_9_REV]:{[G.RGB]:i.RGB9_E5},[J.UNSIGNED_INT_24_8]:{[G.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[J.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[G.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[J.UNSIGNED_BYTE]:{[G.RGBA]:i.RGBA,[G.RGB]:i.RGB,[G.ALPHA]:i.ALPHA,[G.LUMINANCE]:i.LUMINANCE,[G.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[J.UNSIGNED_SHORT_5_6_5]:{[G.RGB]:i.RGB},[J.UNSIGNED_SHORT_4_4_4_4]:{[G.RGBA]:i.RGBA},[J.UNSIGNED_SHORT_5_5_5_1]:{[G.RGBA]:i.RGBA}},t}class cx{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new at,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=KC(t),this.samplerTypes=qC(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const r=new Wu(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Wu(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:r}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<r.length;s++)r[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<r.length;s++)r[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:r,CONTEXT_UID:s}=this;if(r)for(let n=t-1;n>=0;--n){const a=e[n];a&&a._glTextures[s].samplerType!==$.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){const e=new Wu(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var r;e.internalFormat=((r=this.internalFormats[t.type])==null?void 0:r[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??$.FLOAT,this.webGLVersion===2&&t.type===J.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const r=this.renderer;if(this.initTextureType(t,e),(s=t.resource)==null?void 0:s.upload(r,t,e))e.samplerType!==$.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,a=t.realHeight,o=r.gl;(e.width!==n||e.height!==a||e.dirtyId<0)&&(e.width=n,e.height=a,o.texImage2D(t.target,0,e.internalFormat,n,a,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:r}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&Js(this.managedTextures,s,1)}}updateTextureStyle(t){var r;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===bi.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Tr.CLAMP:e.wrapMode=t.wrapMode,(r=t.resource)!=null&&r.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const r=this.gl;if(e.mipmap&&t.mipmap!==bi.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ki.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===ki.LINEAR){const n=Math.min(t.anisotropicLevel,r.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ki.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===ki.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}cx.extension={type:X.RendererSystem,name:"texture"};q.add(cx);class dx{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glTransformFeedbacks[r]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:r,renderer:s}=this;e&&s.shader.bind(e),r.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:r,CONTEXT_UID:s}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[s]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let a=0;a<t.buffers.length;a++){const o=t.buffers[a];o&&(r.buffer.update(o),o._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a,o._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const r=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let a=0;a<t.buffers.length;a++){const o=t.buffers[a];if(!o)continue;const l=o._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&n.dispose(o,e))}r&&(e||s.deleteTransformFeedback(r),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}dx.extension={type:X.RendererSystem,name:"transformFeedback"};q.add(dx);class jl{constructor(t){this.renderer=t}init(t){this.screen=new ot(0,0,t.width,t.height),this.element=t.view||W.ADAPTER.createCanvas(),this.resolution=t.resolution||W.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const r=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=r,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",r,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}jl.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},jl.extension={type:[X.RendererSystem,X.CanvasRendererSystem],name:"_view"};q.add(jl);W.PREFER_ENV=fs.WEBGL2;W.STRICT_TEXTURE_CACHE=!1;W.RENDER_OPTIONS={...Wl.defaultOptions,...$l.defaultOptions,...jl.defaultOptions,...Yl.defaultOptions};Object.defineProperties(W,{WRAP_MODE:{get(){return at.defaultOptions.wrapMode},set(i){ht("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),at.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return at.defaultOptions.scaleMode},set(i){ht("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),at.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return at.defaultOptions.mipmap},set(i){ht("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),at.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return at.defaultOptions.anisotropicLevel},set(i){ht("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),at.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return ht("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ue.defaultResolution},set(i){ue.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return ht("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ue.defaultMultisample},set(i){ue.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return Ur.defaultMaxTextures},set(i){ht("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Ur.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return Ur.defaultBatchSize},set(i){ht("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Ur.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return Ur.canUploadSameBuffer},set(i){ht("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Ur.canUploadSameBuffer=i}},GC_MODE:{get(){return Gr.defaultMode},set(i){ht("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Gr.defaultMode=i}},GC_MAX_IDLE:{get(){return Gr.defaultMaxIdle},set(i){ht("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Gr.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return Gr.defaultCheckCountMax},set(i){ht("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Gr.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return Ui.defaultVertexPrecision},set(i){ht("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ui.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return Ui.defaultFragmentPrecision},set(i){ht("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ui.defaultFragmentPrecision=i}}});var hs=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(hs||{});class Yu{constructor(t,e=null,r=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const fx=class Se{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Yu(null,null,1/0),this.deltaMS=1/Se.targetFPMS,this.elapsedMS=1/Se.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=hs.NORMAL){return this._addListener(new Yu(t,e,r))}addOnce(t,e,r=hs.NORMAL){return this._addListener(new Yu(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Se.targetFPMS;const r=this._head;let s=r.next;for(;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,Se.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Se._shared){const t=Se._shared=new Se;t.autoStart=!0,t._protected=!0}return Se._shared}static get system(){if(!Se._system){const t=Se._system=new Se;t.autoStart=!0,t._protected=!0}return Se._system}};fx.targetFPMS=.06;let ce=fx;Object.defineProperties(W,{TARGET_FPMS:{get(){return ce.targetFPMS},set(i){ht("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ce.targetFPMS=i}}});class px{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,hs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ce.shared:new ce,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}px.extension=X.Application;q.add(px);const mx=[];q.handleByList(X.Renderer,mx);function ZC(i){for(const t of mx)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var QC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,JC=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const tI=QC,_x=JC;class gx{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{const r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}e>=Lt.HIGH?this.multisample=Lt.HIGH:e>=Lt.MEDIUM?this.multisample=Lt.MEDIUM:e>=Lt.LOW?this.multisample=Lt.LOW:this.multisample=Lt.NONE}destroy(){}}gx.extension={type:X.RendererSystem,name:"_multisample"};q.add(gx);class eI{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class yx{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:r,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,r){const{gl:s,CONTEXT_UID:n}=this;r=r||0;const a=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,a.buffer,r*256,256)}update(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const r=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),r&&(e||s.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:r}=this;return t._glBuffers[e]=new eI(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}yx.extension={type:X.RendererSystem,name:"buffer"};q.add(yx);class vx{constructor(t){this.renderer=t}render(t,e){const r=this.renderer;let s,n,a,o;if(e&&(s=e.renderTexture,n=e.clear,a=e.transform,o=e.skipUpdateTransform),this.renderingToScreen=!s,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=a,!r.context.isLost){if(s||(this.lastObjectRendered=t),!o){const l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}r.renderTexture.bind(s),r.batch.currentRenderer.start(),(n??r.background.clearBeforeRender)&&r.renderTexture.clear(),t.render(r),r.batch.currentRenderer.flush(),s&&(e.blit&&r.framebuffer.blit(),s.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}vx.extension={type:X.RendererSystem,name:"objectRenderer"};q.add(vx);const rl=class Od extends jC{constructor(t){super(),this.type=ev.WEBGL,t=Object.assign({},W.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ei({projectionMatrix:new kt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Od.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(ht("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Od.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:Sb()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ht("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ht("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ht("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ht("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){ht("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return ht("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){ht("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return ht("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};rl.extension={type:X.Renderer,priority:1},rl.__plugins={},rl.__systems={};let _p=rl;q.handleByMap(X.RendererPlugin,_p.__plugins);q.handleByMap(X.RendererSystem,_p.__systems);q.add(_p);class xx extends Ma{constructor(t,e){const{width:r,height:s}=e||{};super(r,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const a=new at;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof Ma?this.addResourceAt(t[r],r):this.addResourceAt(Nv(t[r],e),r))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:r}=this.items[0];return this.resize(e,r),this.update(),Promise.resolve(this)}),this._load}}class iI extends xx{constructor(t,e){const{width:r,height:s}=e||{};let n,a;Array.isArray(t)?(n=t,a=t.length):a=t,super(a,{width:r,height:s}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Ks.TEXTURE_2D_ARRAY}upload(t,e,r){const{length:s,itemDirtyIds:n,items:a}=this,{gl:o}=t;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,s,0,e.format,r.type,null);for(let l=0;l<s;l++){const h=a[l];n[l]<h.dirtyId&&(n[l]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,e.format,r.type,h.resource.source))}return!0}}class rI extends Yi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Tx=class Xn extends xx{constructor(t,e){const{width:r,height:s,autoLoad:n,linkBaseTexture:a}=e||{};if(t&&t.length!==Xn.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:s});for(let o=0;o<Xn.SIDES;o++)this.items[o].target=Ks.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=a!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=Ks.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Ks.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){const s=this.itemDirtyIds;for(let n=0;n<Xn.SIDES;n++){const a=this.items[n];(s[n]<a.dirtyId||r.dirtyId<e.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,r),s[n]=a.dirtyId):s[n]<-1&&(t.gl.texImage2D(a.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),s[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Xn.SIDES}};Tx.SIDES=6;let sI=Tx;class zs extends Yi{constructor(t,e){e=e||{};let r,s,n;typeof t=="string"?(r=zs.EMPTY,s=t,n=!0):(r=t,s=null,n=!1),super(r),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const r=await W.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await r.blob();if(this.destroyed)return;const n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ve.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(r){if(this.destroyed)return;e(r),this.onError.emit(r)}}),this._load)}upload(t,e,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return zs._EMPTY=zs._EMPTY??W.ADAPTER.createCanvas(0,0),zs._EMPTY}}const Bd=class sl extends Yi{constructor(t,e){e=e||{},super(W.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},sl.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Yi.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/r*e,n=this._overrideHeight||this._overrideWidth/e*r),s=Math.round(s),n=Math.round(n);const a=this.source;a.width=s,a.height=n,a._pixiId=`canvas_${ls()}`,a.getContext("2d").drawImage(t,0,0,e,r,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(t){const e=sl.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&sl.SVG_XML.test(t)}};Bd.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Bd.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let kd=Bd;class nI extends Yi{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const Nd=class Ld extends Yi{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const r=document.createElement("video");e.autoLoad!==!1&&r.setAttribute("preload","auto"),e.playsinline!==!1&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),e.muted===!0&&(r.setAttribute("muted",""),r.muted=!0),e.loop===!0&&r.setAttribute("loop",""),e.autoPlay!==!1&&r.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];Yi.crossOrigin(r,s,e.crossorigin);for(let n=0;n<t.length;++n){const a=document.createElement("source");let{src:o,mime:l}=t[n];if(o=o||t[n],o.startsWith("data:"))l=o.slice(5,o.indexOf(";"));else if(!o.startsWith("blob:")){const h=o.split("?").shift().toLowerCase(),u=h.slice(h.lastIndexOf(".")+1);l=l||Ld.MIME_TYPES[u]||`video/${u}`}a.src=o,l&&(a.type=l),r.appendChild(a)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=ce.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,r)=>{this.valid?e(this):(this._resolve=e,this._reject=r,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ce.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ce.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ce.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Ld.TYPES.includes(e)}};Nd.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Nd.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Ax=Nd;Ed.push(zs,Yv,rI,Ax,nI,kd,Sh,sI,iI);class ql{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ot.EMPTY:(t=t||new ot(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:r,b:s,c:n,d:a,tx:o,ty:l}=t,h=r*e.x+n*e.y+o,u=s*e.x+a*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,r=this.minY,s=this.maxX,n=this.maxY,a=t[0],o=t[1];e=a<e?a:e,r=o<r?o:r,s=a>s?a:s,n=o>n?o:n,a=t[2],o=t[3],e=a<e?a:e,r=o<r?o:r,s=a>s?a:s,n=o>n?o:n,a=t[4],o=t[5],e=a<e?a:e,r=o<r?o:r,s=a>s?a:s,n=o>n?o:n,a=t[6],o=t[7],e=a<e?a:e,r=o<r?o:r,s=a>s?a:s,n=o>n?o:n,this.minX=e,this.minY=r,this.maxX=s,this.maxY=n}addFrame(t,e,r,s,n){this.addFrameMatrix(t.worldTransform,e,r,s,n)}addFrameMatrix(t,e,r,s,n){const a=t.a,o=t.b,l=t.c,h=t.d,u=t.tx,d=t.ty;let c=this.minX,f=this.minY,p=this.maxX,y=this.maxY,x=a*e+l*r+u,m=o*e+h*r+d;c=x<c?x:c,f=m<f?m:f,p=x>p?x:p,y=m>y?m:y,x=a*s+l*r+u,m=o*s+h*r+d,c=x<c?x:c,f=m<f?m:f,p=x>p?x:p,y=m>y?m:y,x=a*e+l*n+u,m=o*e+h*n+d,c=x<c?x:c,f=m<f?m:f,p=x>p?x:p,y=m>y?m:y,x=a*s+l*n+u,m=o*s+h*n+d,c=x<c?x:c,f=m<f?m:f,p=x>p?x:p,y=m>y?m:y,this.minX=c,this.minY=f,this.maxX=p,this.maxY=y}addVertexData(t,e,r){let s=this.minX,n=this.minY,a=this.maxX,o=this.maxY;for(let l=e;l<r;l+=2){const h=t[l],u=t[l+1];s=h<s?h:s,n=u<n?u:n,a=h>a?h:a,o=u>o?u:o}this.minX=s,this.minY=n,this.maxX=a,this.maxY=o}addVertices(t,e,r,s){this.addVerticesMatrix(t.worldTransform,e,r,s)}addVerticesMatrix(t,e,r,s,n=0,a=n){const o=t.a,l=t.b,h=t.c,u=t.d,d=t.tx,c=t.ty;let f=this.minX,p=this.minY,y=this.maxX,x=this.maxY;for(let m=r;m<s;m+=2){const _=e[m],g=e[m+1],T=o*_+h*g+d,A=u*g+l*_+c;f=Math.min(f,T-n),y=Math.max(y,T+n),p=Math.min(p,A-a),x=Math.max(x,A+a)}this.minX=f,this.minY=p,this.maxX=y,this.maxY=x}addBounds(t){const e=this.minX,r=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const r=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&s<=a){const o=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=s<l?s:l,this.maxX=n>h?n:h,this.maxY=a>u?a:u}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const r=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&s<=a){const o=this.minX,l=this.minY,h=this.maxX,u=this.maxY;this.minX=r<o?r:o,this.minY=s<l?s:l,this.maxX=n>h?n:h,this.maxY=a>u?a:u}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,r,s,n,a){t-=n,e-=a,r+=n,s+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class Rt extends La{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new pp,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ql,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let r=0;r<e.length;++r){const s=e[r];Object.defineProperty(Rt.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ot),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ot),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ql);const e=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(r==null?void 0:r.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-n,a}toGlobal(t,e,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,r,s){return e&&(t=e.toGlobal(t,r,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,r=1,s=1,n=0,a=0,o=0,l=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=s||1,this.rotation=n,this.skew.x=a,this.skew.y=o,this.pivot.x=l,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new aI),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Qb}set angle(t){this.transform.rotation=t*Jb}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class aI extends Rt{constructor(){super(...arguments),this.sortDirty=null}}Rt.prototype.displayObjectUpdateTransform=Rt.prototype.updateTransform;const oI=new kt;function lI(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const Ex=class Ud extends Rt{constructor(){super(),this.children=[],this.sortableChildren=Ud.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),s=this.getChildIndex(e);this.children[r]=e,this.children[s]=t,this.onChildrenChange(r<s?r:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(t);Js(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],r=this.children.indexOf(e);if(r===-1)return null;e.parent=null,e.transform._parentID=-1,Js(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Js(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const r=t,s=e,n=s-r;let a;if(n>0&&n<=s){a=this.children.splice(r,n);for(let o=0;o<a.length;++o)a[o].parent=null,a[o].transform&&(a[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let o=0;o<a.length;++o)a[o].emit("removed",this),this.emit("childRemoved",a[o],this,o);return a}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,r=this.children.length;e<r;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(lI),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const r=this.children[t];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const r=super.getLocalBounds(t);if(!e)for(let s=0,n=this.children.length;s<n;++s){const a=this.children[s];a.visible&&a.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let r,s;this.cullArea?(r=this.cullArea,s=this.worldTransform):this._render!==Ud.prototype._render&&(r=this.getBounds(!0));const n=t.projection.transform;if(n&&(s?(s=oI.copyFrom(s),s.prepend(n)):s=n),r&&e.intersects(r,s))this._render(t);else if(this.cullArea)return;for(let a=0,o=this.children.length;a<o;++a){const l=this.children[a],h=l.cullable;l.cullable=h||!this.cullArea,l.render(t),l.cullable=h}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let r=0,s=this.children.length;r<s;++r)this.children[r].render(t)}}renderAdvanced(t){var n,a,o;const e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<e.length;l++)e[l].enabled&&this._enabledFilters.push(e[l])}const s=e&&((n=this._enabledFilters)==null?void 0:n.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==zt.NONE));if(s&&t.batch.flush(),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let l=0,h=this.children.length;l<h;++l)this.children[l].render(t)}s&&t.batch.flush(),r&&t.mask.pop(this),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,r=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<r.length;++s)r[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};Ex.defaultSortableChildren=!1;let Ft=Ex;Ft.prototype.containerUpdateTransform=Ft.prototype.updateTransform;Object.defineProperties(W,{SORTABLE_CHILDREN:{get(){return Ft.defaultSortableChildren},set(i){ht("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ft.defaultSortableChildren=i}}});const Bn=new mt,hI=new Uint16Array([0,1,2,0,2,3]);class fe extends Ft{constructor(t){super(),this._anchor=new Li(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Tt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Z.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||j.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=hI,this.pluginName="batch",this.isSprite=!0,this._roundPixels=W.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ur(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ur(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,r=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,l=e.ty,h=this.vertexData,u=t.trim,d=t.orig,c=this._anchor;let f=0,p=0,y=0,x=0;if(u?(p=u.x-c._x*d.width,f=p+u.width,x=u.y-c._y*d.height,y=x+u.height):(p=-c._x*d.width,f=p+d.width,x=-c._y*d.height,y=x+d.height),h[0]=r*p+n*x+o,h[1]=a*x+s*p+l,h[2]=r*f+n*x+o,h[3]=a*x+s*f+l,h[4]=r*f+n*y+o,h[5]=a*y+s*f+l,h[6]=r*p+n*y+o,h[7]=a*y+s*p+l,this._roundPixels){const m=W.RESOLUTION;for(let _=0;_<h.length;++_)h[_]=Math.round(h[_]*m)/m}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,r=t.orig,s=this._anchor,n=this.transform.worldTransform,a=n.a,o=n.b,l=n.c,h=n.d,u=n.tx,d=n.ty,c=-s._x*r.width,f=c+r.width,p=-s._y*r.height,y=p+r.height;if(e[0]=a*c+l*p+u,e[1]=h*p+o*c+d,e[2]=a*f+l*p+u,e[3]=h*p+o*f+d,e[4]=a*f+l*y+u,e[5]=h*y+o*f+d,e[6]=a*c+l*y+u,e[7]=h*y+o*c+d,this._roundPixels){const x=W.RESOLUTION;for(let m=0;m<e.length;++m)e[m]=Math.round(e[m]*x)/x}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new ql),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ot),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Bn);const e=this._texture.orig.width,r=this._texture.orig.height,s=-e*this.anchor.x;let n=0;return Bn.x>=s&&Bn.x<s+e&&(n=-r*this.anchor.y,Bn.y>=n&&Bn.y<n+r)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const r=t instanceof j?t:j.from(t,e);return new fe(r)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=ur(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=ur(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||j.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Sx=new kt;Rt.prototype._cacheAsBitmap=!1;Rt.prototype._cacheData=null;Rt.prototype._cacheAsBitmapResolution=null;Rt.prototype._cacheAsBitmapMultisample=null;class uI{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Rt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new uI),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Rt.prototype._renderCached=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(i),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(i))};Rt.prototype._initCachedDisplayObject=function(i){var c,f;if((c=this._cacheData)!=null&&c.sprite)return;const t=this.alpha;this.alpha=1,i.batch.flush();const e=this.getLocalBounds(new ot,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;e.pad(p)}const r=this.cacheAsBitmapResolution||i.resolution;e.ceil(r),e.width=Math.max(e.width,1/r),e.height=Math.max(e.height,1/r);const s=i.renderTexture.current,n=i.renderTexture.sourceFrame.clone(),a=i.renderTexture.destinationFrame.clone(),o=i.projection.transform,l=ms.create({width:e.width,height:e.height,resolution:r,multisample:this.cacheAsBitmapMultisample??i.multisample}),h=`cacheAsBitmap_${ls()}`;this._cacheData.textureCacheId=h,at.addToCache(l.baseTexture,h),j.addToCache(l,h);const u=this.transform.localTransform.copyTo(Sx).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,i.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),i.framebuffer.blit(),i.projection.transform=o,i.renderTexture.bind(s,n,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const d=new fe(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(e.x/e.width),d.anchor.y=-(e.y/e.height),d.alpha=t,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)};Rt.prototype._renderCachedCanvas=function(i){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(i),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(i))};Rt.prototype._initCachedDisplayObjectCanvas=function(i){var u;if((u=this._cacheData)!=null&&u.sprite)return;const t=this.getLocalBounds(new ot,!0),e=this.alpha;this.alpha=1;const r=i.canvasContext.activeContext,s=i._projTransform,n=this.cacheAsBitmapResolution||i.resolution;t.ceil(n),t.width=Math.max(t.width,1/n),t.height=Math.max(t.height,1/n);const a=ms.create({width:t.width,height:t.height,resolution:n}),o=`cacheAsBitmap_${ls()}`;this._cacheData.textureCacheId=o,at.addToCache(a.baseTexture,o),j.addToCache(a,o);const l=Sx;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,i.render(this,{renderTexture:a,clear:!0,transform:l,skipUpdateTransform:!1}),i.canvasContext.activeContext=r,i._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new fe(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(t.x/t.width),h.anchor.y=-(t.y/t.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=i._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};Rt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Rt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Rt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,at.removeFromCache(this._cacheData.textureCacheId),j.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Rt.prototype._cacheAsBitmapDestroy=function(i){this.cacheAsBitmap=!1,this.destroy(i)};Rt.prototype.name=null;Ft.prototype.getChildByName=function(i,t){for(let e=0,r=this.children.length;e<r;e++)if(this.children[e].name===i)return this.children[e];if(t)for(let e=0,r=this.children.length;e<r;e++){const s=this.children[e];if(!s.getChildByName)continue;const n=s.getChildByName(i,!0);if(n)return n}return null};Rt.prototype.getGlobalPosition=function(i=new mt,t=!1){return this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i};var cI=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class dI extends ue{constructor(t=1){super(tI,cI,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const fI={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},pI=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function mI(i){const t=fI[i],e=t.length;let r=pI,s="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let o=0;o<i;o++){let l=n.replace("%index%",o.toString());a=o,o>=e&&(a=i-o-1),l=l.replace("%value%",t[a].toString()),s+=l,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}const _I=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function gI(i,t){const e=Math.ceil(i/2);let r=_I,s="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<i;a++){let o=n.replace("%index%",a.toString());o=o.replace("%sampleIndex%",`${a-(e-1)}.0`),s+=o,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}class Gd extends ue{constructor(t,e=8,r=4,s=ue.defaultResolution,n=5){const a=gI(n,t),o=mI(n);super(a,o),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=r,this.blur=e}apply(t,e,r,s){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,r,s);else{const n=t.getFilterTexture(),a=t.renderer;let o=e,l=n;this.state.blend=!1,t.applyFilter(this,o,l,mi.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(o,mi.BLIT),this.uniforms.uSampler=l;const u=l;l=o,o=u,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,l,r,s),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class yI extends ue{constructor(t=8,e=4,r=ue.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Gd(!0,t,e,r,s),this.blurYFilter=new Gd(!1,t,e,r,s),this.resolution=r,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,r,s){const n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(n&&a){const o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,mi.CLEAR),this.blurYFilter.apply(t,o,r,s),t.returnFilterTexture(o)}else a?this.blurYFilter.apply(t,e,r,s):this.blurXFilter.apply(t,e,r,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var vI=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Vd extends ue{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(_x,vI,t),this.alpha=1}_loadMatrix(t,e=!1){let r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}tint(t,e){const[r,s,n]=Tt.shared.setValue(t).toArray(),a=[r,0,0,0,0,0,s,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(a,e)}greyscale(t,e){const r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const r=Math.cos(t),s=Math.sin(t),n=Math.sqrt,a=1/3,o=n(a),l=r+(1-r)*a,h=a*(1-r)-o*s,u=a*(1-r)+o*s,d=a*(1-r)+o*s,c=r+a*(1-r),f=a*(1-r)-o*s,p=a*(1-r)-o*s,y=a*(1-r)+o*s,x=r+a*(1-r),m=[l,h,u,0,0,d,c,f,0,0,p,y,x,0,0,0,0,0,1,0];this._loadMatrix(m,e)}contrast(t,e){const r=(t||0)+1,s=-.5*(r-1),n=[r,0,0,0,s,0,r,0,0,s,0,0,r,0,s,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const r=t*2/3+1,s=(r-1)*-.5,n=[r,s,s,0,0,s,r,s,0,0,s,s,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,r,s,n){t=t||.2,e=e||.15,r=r||16770432,s=s||3375104;const a=Tt.shared,[o,l,h]=a.setValue(r).toArray(),[u,d,c]=a.setValue(s).toArray(),f=[.3,.59,.11,0,0,o,l,h,t,0,u,d,c,e,0,o-u,l-d,h-c,0,0];this._loadMatrix(f,n)}night(t,e){t=t||.1;const r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,e)}predator(t,e){const r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Vd.prototype.grayscale=Vd.prototype.greyscale;var xI=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,TI=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class AI extends ue{constructor(t,e){const r=new kt;t.renderable=!1,super(TI,xI,{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=r,e==null&&(e=20),this.scale=new mt(e,e)}apply(t,e,r,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,a=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);a!==0&&o!==0&&(this.uniforms.rotation[0]=n.a/a,this.uniforms.rotation[1]=n.b/a,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),t.applyFilter(this,e,r,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var EI=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,SI=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class wI extends ue{constructor(){super(SI,EI)}}var bI=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class CI extends ue{constructor(t=.5,e=Math.random()){super(_x,bI,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const eg={AlphaFilter:dI,BlurFilter:yI,BlurFilterPass:Gd,ColorMatrixFilter:Vd,DisplacementFilter:AI,FXAAFilter:wI,NoiseFilter:CI};Object.entries(eg).forEach(([i,t])=>{Object.defineProperty(eg,i,{get(){return ht("7.1.0",`filters.${i} has moved to ${i}`),t}})});class II{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ce.system.add(this.tickerUpdate,this,hs.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ce.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const nr=new II;class Ha{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ha.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new mt,this.page=new mt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,r,s,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Kl extends Ha{constructor(){super(...arguments),this.client=new mt,this.movement=new mt,this.offset=new mt,this.global=new mt,this.screen=new mt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,r,s,n,a,o,l,h,u,d,c,f,p,y){throw new Error("Method not implemented.")}}class We extends Kl{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class en extends Kl{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}en.DOM_DELTA_PIXEL=0,en.DOM_DELTA_LINE=1,en.DOM_DELTA_PAGE=2;const DI=2048,RI=new mt,ju=new mt;class MI{constructor(t){this.dispatch=new La,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((r,s)=>r.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let r=0,s=e.length;r<s;r++)e[r].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){nr.pauseUpdate=!0;const r=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[r](this.rootTarget,this.rootTarget.eventMode,RI.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,n=r.length-1;s<n;s++)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=r.length-2;s>=0;s--)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,r=this._allInteractiveElements){if(r.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const s=Array.isArray(e)?e:[e];for(let n=r.length-1;n>=0;n--)s.forEach(a=>{t.currentTarget=r[n],this.notifyTarget(t,a)})}propagationPath(t){const e=[t];for(let r=0;r<DI&&t!==this.rootTarget;r++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,r,s,n,a=!1){let o=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(nr.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let d=u.length-1;d>=0;d--){const c=u[d],f=this.hitTestMoveRecursive(c,this._isInteractive(e)?e:c.eventMode,r,s,n,a||n(t,r));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),o=!0}}}const l=this._isInteractive(e),h=t.isInteractive();return l&&h&&this._allInteractiveElements.push(t),a||this._hitElements.length>0?null:o?this._hitElements:l&&!n(t,r)&&s(t,r)?h?[t]:[]:null}hitTestRecursive(t,e,r,s,n){if(this._interactivePrune(t)||n(t,r))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(nr.pauseUpdate=!1),t.interactiveChildren&&t.children){const l=t.children;for(let h=l.length-1;h>=0;h--){const u=l[h],d=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,r,s,n);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const c=t.isInteractive();return(d.length>0||c)&&d.push(t),d}}}const a=this._isInteractive(e),o=t.isInteractive();return a&&s(t,r)?o?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var r;if(t.hitArea&&(t.worldTransform.applyInverse(e,ju),!t.hitArea.contains(ju.x,ju.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((r=s.containsPoint)!=null&&r.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,a;e=e??t.type;const r=`on${e}`;(a=(n=t.currentTarget)[r])==null||a.call(n,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const r=this.trackingData(t.pointerId);r.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var l,h;if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const r=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.overTargets);if(((l=s.overTargets)==null?void 0:l.length)>0&&n!==e.target){const u=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,u,n);if(this.dispatchEvent(d,"pointerout"),r&&this.dispatchEvent(d,"mouseout"),!e.composedPath().includes(n)){const c=this.createPointerEvent(t,"pointerleave",n);for(c.eventPhase=c.AT_TARGET;c.target&&!e.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),r&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(d)}if(n!==e.target){const u=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(e,u);this.dispatchEvent(d,"pointerover"),r&&this.dispatchEvent(d,"mouseover");let c=n==null?void 0:n.parent;for(;c&&c!==this.rootTarget.parent&&c!==e.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==n&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),r&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}const a=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(e,"pointermove"),o&&a.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),o&&a.push("globaltouchmove")),r&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),o&&a.push("globalmousemove"),this.cursor=(h=e.target)==null?void 0:h.cursor),a.length>0&&this.all(e,a),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var a;if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.createPointerEvent(t),s=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),s&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=(a=r.target)==null?void 0:a.cursor);const n=this.clonePointerEvent(r,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),s&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const r=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout");const a=this.createPointerEvent(t,"pointerleave",s);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),r&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const o=r.button===2;this.dispatchEvent(r,o?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.pressTargetsByButton[t.button]);let a=n;if(n&&!r.composedPath().includes(n)){let o=n;for(;o&&!r.composedPath().includes(o);){if(r.currentTarget=o,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const l=r.button===2;this.notifyTarget(r,l?"rightupoutside":"mouseupoutside")}o=o.parent}delete s.pressTargetsByButton[t.button],a=o}if(a){const o=this.clonePointerEvent(r,"click");o.target=a,o.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:o.target,timeStamp:e});const l=s.clicksByButton[t.button];if(l.target===o.target&&e-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=o.target,l.timeStamp=e,o.detail=l.clickCount,o.pointerType==="mouse"){const h=o.button===2;this.dispatchEvent(o,h?"rightclick":"click")}else o.pointerType==="touch"&&this.dispatchEvent(o,"tap");this.dispatchEvent(o,"pointertap"),this.freeEvent(o)}this.freeEvent(r)}mapPointerUpOutside(t){if(!(t instanceof We)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(r){let n=r;for(;n;)s.currentTarget=n,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof en)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let r=1;r<t.length&&t[r].parent===e;r++)e=t[r];return e}createPointerEvent(t,e,r){const s=this.allocateEvent(We);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=r??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(en);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const r=this.allocateEvent(We);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=e??r.type,r}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof We&&e instanceof We&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Kl&&e instanceof Kl&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const r=t.currentTarget._events[e];if(r&&t.currentTarget.isInteractive())if("fn"in r)r.once&&t.currentTarget.removeListener(e,r.fn,void 0,!0),r.fn.call(r.context,t);else for(let s=0,n=r.length;s<n&&!t.propagationImmediatelyStopped;s++)r[s].once&&t.currentTarget.removeListener(e,r[s].fn,void 0,!0),r[s].fn.call(r[s].context,t)}}const PI=1,FI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Hd=class zd{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new MI(null),nr.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new We(null),this.rootWheelEvent=new en(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...zd.defaultEventFeatures},{set:(e,r,s)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[r]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:r}=this.renderer;this.setTargetElement(e),this.resolution=r,zd._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.domElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.domElement.style,r);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let r=0,s=e.length;r<s;r++){const n=e[r],a=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,nr.pointerMoved();const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const r=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let n=0,a=s.length;n<a;n++){const o=this.bootstrapEvent(this.rootPointerEvent,s[n]);o.type+=r,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const n=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,nr.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;nr.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;nr.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,r){const s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*n,t.y=(r-s.top)*(this.domElement.height/s.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let r=0,s=t.changedTouches.length;r<s;r++){const n=t.changedTouches[r];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const r=t;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=PI),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=FI[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Hd.extension={name:"events",type:[X.RendererSystem,X.CanvasRendererSystem]},Hd.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Xd=Hd;q.add(Xd);function ig(i){return i==="dynamic"||i==="static"}const OI={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??ig(Xd.defaultEventMode)},set interactive(i){ht("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=i,this.eventMode=i?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Xd.defaultEventMode},set eventMode(i){this._internalInteractive=ig(i),this._internalEventMode=i},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof e=="object"?e.signal:void 0,n=typeof e=="object"?e.once===!0:!1,a=typeof t=="function"?void 0:t;i=r?`${i}capture`:i;const o=typeof t=="function"?t:t.handleEvent,l=this;s&&s.addEventListener("abort",()=>{l.off(i,o,a)}),n?l.once(i,o,a):l.on(i,o,a)},removeEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=r?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,s)},dispatchEvent(i){if(!(i instanceof Ha))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};Rt.mixin(OI);const BI={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Rt.mixin(BI);const kI=9,Co=100,NI=0,LI=0,rg=2,sg=1,UI=-1e3,GI=-1e3,VI=2;class wx{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Ni.tablet||Ni.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${Co}px`,e.style.height=`${Co}px`,e.style.position="absolute",e.style.top=`${NI}px`,e.style.left=`${LI}px`,e.style.zIndex=rg.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${sg}px`,t.style.height=`${sg}px`,t.style.position="absolute",t.style.top=`${UI}px`,t.style.left=`${GI}px`,t.style.zIndex=VI.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}update(){const t=performance.now();if(Ni.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:r,width:s,height:n}=this.renderer.view.getBoundingClientRect(),{width:a,height:o,resolution:l}=this.renderer,h=s/a*l,u=n/o*l;let d=this.div;d.style.left=`${e}px`,d.style.top=`${r}px`,d.style.width=`${a}px`,d.style.height=`${o}px`;for(let c=0;c<this.children.length;c++){const f=this.children[c];if(f.renderId!==this.renderId)f._accessibleActive=!1,Js(this.children,c,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,c--;else{d=f._accessibleDiv;let p=f.hitArea;const y=f.worldTransform;f.hitArea?(d.style.left=`${(y.tx+p.x*y.a)*h}px`,d.style.top=`${(y.ty+p.y*y.d)*u}px`,d.style.width=`${p.width*y.a*h}px`,d.style.height=`${p.height*y.d*u}px`):(p=f.getBounds(),this.capHitArea(p),d.style.left=`${p.x*h}px`,d.style.top=`${p.y*u}px`,d.style.width=`${p.width*h}px`,d.style.height=`${p.height*u}px`,d.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&d.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==d.title||f.tabIndex!==d.tabIndex)&&(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:r}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>r&&(t.height=r-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${Co}px`,e.style.height=`${Co}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=rg.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:r}=t.target,s=this.renderer.events.rootBoundary,n=Object.assign(new Ha(s),{target:r});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(a=>s.dispatchEvent(n,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===kI&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}wx.extension={name:"accessibility",type:[X.RendererPlugin,X.CanvasRendererPlugin]};q.add(wx);const bx=class $d{constructor(t){this.stage=new Ft,t=Object.assign({forceCanvas:!1},t),this.renderer=ZC(t),$d._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const r=$d._plugins.slice(0);r.reverse(),r.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};bx._plugins=[];let Cx=bx;q.handleByList(X.Application,Cx._plugins);class Ix{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,r;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:n}=this._resizeTo;e=s,r=n}this.renderer.resize(e,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Ix.extension=X.Application;q.add(Ix);const ng={loader:X.LoadParser,resolver:X.ResolveParser,cache:X.CacheParser,detection:X.DetectionParser};q.handle(X.Asset,i=>{const t=i.ref;Object.entries(ng).filter(([e])=>!!t[e]).forEach(([e,r])=>q.add(Object.assign(t[e],{extension:t[e].extension??r})))},i=>{const t=i.ref;Object.keys(ng).filter(e=>!!t[e]).forEach(e=>q.remove(t[e]))});class HI{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function xn(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function Rr(i,t){const e=i.split("?")[0],r=Kt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const Ze=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(r=>typeof r=="string"||e?t(r):r):i),Wd=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i};function Dx(i,t,e,r,s){const n=t[e];for(let a=0;a<n.length;a++){const o=n[a];e<t.length-1?Dx(i.replace(r[e],o),t,e+1,r,s):s.push(i.replace(r[e],o))}}function zI(i){const t=/\{(.*?)\}/g,e=i.match(t),r=[];if(e){const s=[];e.forEach(n=>{const a=n.substring(1,n.length-1).split(",");s.push(a)}),Dx(i,s,0,e,r)}else r.push(i);return r}const Zl=i=>!Array.isArray(i);class XI{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Ze(t);let s;for(let o=0;o<this.parsers.length;o++){const l=this.parsers[o];if(l.test(e)){s=l.getCacheableAssets(r,e);break}}s||(s={},r.forEach(o=>{s[o]=e}));const n=Object.keys(s),a={cacheKeys:n,keys:r};if(r.forEach(o=>{this._cacheMap.set(o,a)}),n.forEach(o=>{const l=s?s[o]:e;this._cache.has(o)&&this._cache.get(o)!==l&&console.warn("[Cache] already has key:",o),this._cache.set(o,s[o])}),e instanceof j){const o=e;r.forEach(l=>{o.baseTexture!==j.EMPTY.baseTexture&&at.addToCache(o.baseTexture,l),j.addToCache(o,l)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Hr=new XI;class $I{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var a,o;let s=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((a=h.test)!=null&&a.call(h,t,e,this))){n=h;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,e,this),r.parser=n;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((o=h.testParse)==null?void 0:o.call(h,s,e,this))&&(s=await h.parse(s,e,this)||s,r.parser=h)}return s})(),r}async load(t,e){this._parsersValidated||this._validateParsers();let r=0;const s={},n=Zl(t),a=Ze(t,h=>({alias:[h],src:h})),o=a.length,l=a.map(async h=>{const u=Kt.toAbsolute(h.src);if(!s[h.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,h)),s[h.src]=await this.promiseCache[u].promise,e&&e(++r/o)}catch(d){throw delete this.promiseCache[u],delete s[h.src],new Error(`[Loader.load] Failed to load ${u}.
${d}`)}});return await Promise.all(l),n?s[a[0].src]:s}async unload(t){const e=Ze(t,r=>({alias:[r],src:r})).map(async r=>{var a,o;const s=Kt.toAbsolute(r.src),n=this.promiseCache[s];if(n){const l=await n.promise;delete this.promiseCache[s],(o=(a=n.parser)==null?void 0:a.unload)==null||o.call(a,l,r,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var ri=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(ri||{});const WI=".json",YI="application/json",jI={extension:{type:X.LoadParser,priority:ri.Low},name:"loadJson",test(i){return xn(i,YI)||Rr(i,WI)},async load(i){return await(await W.ADAPTER.fetch(i)).json()}};q.add(jI);const qI=".txt",KI="text/plain",ZI={name:"loadTxt",extension:{type:X.LoadParser,priority:ri.Low},test(i){return xn(i,KI)||Rr(i,qI)},async load(i){return await(await W.ADAPTER.fetch(i)).text()}};q.add(ZI);const QI=["normal","bold","100","200","300","400","500","600","700","800","900"],JI=[".ttf",".otf",".woff",".woff2"],tD=["font/ttf","font/otf","font/woff","font/woff2"],eD=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function iD(i){const t=Kt.extname(i),e=Kt.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let r=e.length>0;for(const n of e)if(!n.match(eD)){r=!1;break}let s=e.join(" ");return r||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}const rD=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function sD(i){return rD.test(i)?i:encodeURI(i)}const nD={extension:{type:X.LoadParser,priority:ri.Low},name:"loadWebFont",test(i){return xn(i,tD)||Rr(i,JI)},async load(i,t){var r,s,n;const e=W.ADAPTER.getFontFaceSet();if(e){const a=[],o=((r=t.data)==null?void 0:r.family)??iD(i),l=((n=(s=t.data)==null?void 0:s.weights)==null?void 0:n.filter(u=>QI.includes(u)))??["normal"],h=t.data??{};for(let u=0;u<l.length;u++){const d=l[u],c=new FontFace(o,`url(${sD(i)})`,{...h,weight:d});await c.load(),e.add(c),a.push(c)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>W.ADAPTER.getFontFaceSet().delete(t))}};q.add(nD);const aD=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let rn=null,Yd=class{constructor(){rn||(rn=URL.createObjectURL(new Blob([aD],{type:"application/javascript"}))),this.worker=new Worker(rn)}};Yd.revokeObjectURL=function(){rn&&(URL.revokeObjectURL(rn),rn=null)};const oD=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let sn=null;class Rx{constructor(){sn||(sn=URL.createObjectURL(new Blob([oD],{type:"application/javascript"}))),this.worker=new Worker(sn)}}Rx.revokeObjectURL=function(){sn&&(URL.revokeObjectURL(sn),sn=null)};let ag=0,qu;class lD{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Yd;e.addEventListener("message",r=>{e.terminate(),Yd.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){qu===void 0&&(qu=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<qu&&(this._createdWorkers++,t=new Rx().worker,t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise((s,n)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:n})});return this.next(),r}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),r=e.id;this.resolveHash[ag]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:ag++,id:r})}}const og=new lD;function za(i,t,e){i.resource.internal=!0;const r=new j(i),s=()=>{delete t.promiseCache[e],Hr.has(e)&&Hr.remove(e)};return r.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),r.once("destroyed",()=>{i.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),r}const hD=[".jpeg",".jpg",".png",".webp",".avif"],uD=["image/jpeg","image/png","image/webp","image/avif"];async function cD(i){const t=await W.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Dh={name:"loadTextures",extension:{type:X.LoadParser,priority:ri.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return xn(i,uD)||Rr(i,hD)},async load(i,t,e){var o;const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let s;r?this.config.preferWorkers&&await og.isImageBitmapSupported()?s=await og.loadImageBitmap(i):s=await cD(i):s=await new Promise((l,h)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=i,u.complete?l(u):(u.onload=()=>l(u),u.onerror=d=>h(d))});const n={...t.data};n.resolution??(n.resolution=Wi(i)),r&&((o=n.resourceOptions)==null?void 0:o.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const a=new at(s,n);return a.resource.src=i,za(a,e,i)},unload(i){i.destroy(!0)}};q.add(Dh);const dD=".svg",fD="image/svg+xml",pD={extension:{type:X.LoadParser,priority:ri.High},name:"loadSVG",test(i){return xn(i,fD)||Rr(i,dD)},async testParse(i){return kd.test(i)},async parse(i,t,e){var n;const r=new kd(i,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await r.load();const s=new at(r,{resolution:Wi(i),...t==null?void 0:t.data});return s.resource.src=t.src,za(s,e,t.src)},async load(i,t){return(await W.ADAPTER.fetch(i)).text()},unload:Dh.unload};q.add(pD);const mD=[".mp4",".m4v",".webm",".ogv"],_D=["video/mp4","video/webm","video/ogg"],gD={name:"loadVideo",extension:{type:X.LoadParser,priority:ri.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(i){return xn(i,_D)||Rr(i,mD)},async load(i,t,e){var a;let r;const s=await(await W.ADAPTER.fetch(i)).blob(),n=URL.createObjectURL(s);try{const o={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions,autoLoad:!0},l=new Ax(n,o);await l.load();const h=new at(l,{alphaMode:await Eb(),resolution:Wi(i),...t==null?void 0:t.data});h.resource.src=i,r=za(h,e,i),r.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(o){throw URL.revokeObjectURL(n),o}return r},unload(i){i.destroy(!0)}};q.add(gD);class yD{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,name:r,src:s,srcs:n}=t;return Ze(e||r||s||n,a=>typeof a=="string"?a:Array.isArray(a)?a.map(o=>(o==null?void 0:o.src)??(o==null?void 0:o.srcs)??o):a!=null&&a.src||a!=null&&a.srcs?a.src??a.srcs:a,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];Array.isArray(e)?e.forEach(s=>{const n=s.src??s.srcs,a=s.alias??s.name;let o;if(typeof a=="string"){const l=this._createBundleAssetId(t,a);r.push(l),o=[a,l]}else{const l=a.map(h=>this._createBundleAssetId(t,h));r.push(...l),o=[...a,...l]}this.add({...s,alias:o,src:n})}):Object.keys(e).forEach(s=>{const n=[s,this._createBundleAssetId(t,s)];if(typeof e[s]=="string")this.add({alias:n,src:e[s]});else if(Array.isArray(e[s]))this.add({alias:n,src:e[s]});else{const a=e[s],o=a.src??a.srcs;this.add({...a,alias:n,src:Array.isArray(o)?o:[o]})}r.push(...n)}),this._bundles[t]=r}add(t,e,r,s,n){const a=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(ht("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),a.push({alias:t,src:e,data:r,format:s,loadParser:n})):Array.isArray(t)?a.push(...t):a.push(t);let o;o=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},Ze(a).forEach(l=>{const{src:h,srcs:u}=l;let{data:d,format:c,loadParser:f}=l;const p=Ze(h||u).map(m=>typeof m=="string"?zI(m):Array.isArray(m)?m:[m]),y=this.getAlias(l);Array.isArray(y)?y.forEach(o):o(y);const x=[];p.forEach(m=>{m.forEach(_=>{let g={};if(typeof _!="object"){g.src=_;for(let T=0;T<this._parsers.length;T++){const A=this._parsers[T];if(A.test(_)){g=A.parse(_);break}}}else d=_.data??d,c=_.format??c,f=_.loadParser??f,g={...g,..._};if(!y)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:y,data:d,format:c,loadParser:f}),x.push(g)})}),y.forEach(m=>{this._assetMap[m]=x})})}resolveBundle(t){const e=Zl(t);t=Ze(t);const r={};return t.forEach(s=>{const n=this._bundles[s];if(n){const a=this.resolve(n),o={};for(const l in a){const h=a[l];o[this._extractAssetIdFromBundle(s,l)]=h}r[s]=o}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const s in e)r[s]=e[s].src;return r}return e.src}resolve(t){const e=Zl(t);t=Ze(t);const r={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const a=n[0],o=this._getPreferredOrder(n);o==null||o.priority.forEach(l=>{o.params[l].forEach(h=>{const u=n.filter(d=>d[l]?d[l]===h:!1);u.length&&(n=u)})}),this._resolverHash[s]=n[0]??a}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});r[s]=this._resolverHash[s]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(r.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:r,data:s,loadParser:n,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=Kt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=n??t.loadParser,t.format=a??t.format??Kt.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class vD{constructor(){this._detections=[],this._initialized=!1,this.resolver=new yD,this.loader=new $I,this.cache=Hr,this._backgroundLoader=new HI(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,r=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(a=t.texturePreference)==null?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,r,s,n){this.resolver.add(t,e,r,s,n)}async load(t,e){this._initialized||await this.init();const r=Zl(t),s=Ze(t).map(o=>{if(typeof o!="string"){const l=this.resolver.getAlias(o);return l.some(h=>!this.resolver.hasKey(h))&&this.add(o),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(s),a=await this._mapLoadToResolve(n,e);return r?a[s[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const s=this.resolver.resolveBundle(t),n={},a=Object.keys(s);let o=0,l=0;const h=()=>{e==null||e(++o/l)},u=a.map(d=>{const c=s[d];return l+=Object.keys(c).length,this._mapLoadToResolve(c,h).then(f=>{n[d]=f})});return await Promise.all(u),r?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Hr.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=Hr.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(r,e);this._backgroundLoader.active=!0;const a={};return r.forEach((o,l)=>{const h=n[o.src],u=[o.src];o.alias&&u.push(...o.alias),a[s[l]]=h,Hr.set(u,h)}),a}async unload(t){this._initialized||await this.init();const e=Ze(t).map(s=>typeof s!="string"?s.src:s),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Ze(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{Hr.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,s)=>e.indexOf(r)===s),e}get detections(){return this._detections}get preferWorkers(){return Dh.config.preferWorkers}set preferWorkers(t){ht("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const Wr=new vD;q.handleByList(X.LoadParser,Wr.loader.parsers).handleByList(X.ResolveParser,Wr.resolver.parsers).handleByList(X.CacheParser,Wr.cache.parsers).handleByList(X.DetectionParser,Wr.detections);const xD={extension:X.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof j),getCacheableAssets:(i,t)=>{const e={};return i.forEach(r=>{t.forEach((s,n)=>{e[r+(n===0?"":n+1)]=s})}),e}};q.add(xD);async function Mx(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const TD={extension:{type:X.DetectionParser,priority:1},test:async()=>Mx("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};q.add(TD);const AD={extension:{type:X.DetectionParser,priority:0},test:async()=>Mx("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};q.add(AD);const lg=["png","jpg","jpeg"],ED={extension:{type:X.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...lg],remove:async i=>i.filter(t=>!lg.includes(t))};q.add(ED);const SD="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function gp(i){return SD?!1:document.createElement("video").canPlayType(i)!==""}const wD={extension:{type:X.DetectionParser,priority:0},test:async()=>gp("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")};q.add(wD);const bD={extension:{type:X.DetectionParser,priority:0},test:async()=>gp("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")};q.add(bD);const CD={extension:{type:X.DetectionParser,priority:0},test:async()=>gp("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")};q.add(CD);const ID={extension:X.ResolveParser,test:Dh.test,parse:i=>{var t;return{resolution:parseFloat(((t=W.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:Kt.extname(i).slice(1),src:i}}};q.add(ID);var Qt=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i[i.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",i[i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",i[i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",i[i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",i))(Qt||{});const Ql={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let ui,bs;function hg(){bs={bptc:ui.getExtension("EXT_texture_compression_bptc"),astc:ui.getExtension("WEBGL_compressed_texture_astc"),etc:ui.getExtension("WEBGL_compressed_texture_etc"),s3tc:ui.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ui.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:ui.getExtension("WEBGL_compressed_texture_pvrtc")||ui.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:ui.getExtension("WEBGL_compressed_texture_etc1"),atc:ui.getExtension("WEBGL_compressed_texture_atc")}}const DD={extension:{type:X.DetectionParser,priority:2},test:async()=>{const i=W.ADAPTER.createCanvas().getContext("webgl");return i?(ui=i,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{bs||hg();const t=[];for(const e in bs)bs[e]&&t.push(e);return[...t,...i]},remove:async i=>(bs||hg(),i.filter(t=>!(t in bs)))};q.add(DD);class RD extends Sh{constructor(t,e={width:1,height:1,autoLoad:!0}){let r,s;typeof t=="string"?(r=t,s=new Uint8Array):(r=null,s=t),super(s,e),this.origin=r,this.buffer=s?new Ad(s):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Ad(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Qr extends RD{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Qr._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Qr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,r){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;s.pixelStorei(s.UNPACK_ALIGNMENT,4);for(let n=0,a=this.levels;n<a;n++){const{levelID:o,levelWidth:l,levelHeight:h,levelBuffer:u}=this._levelBuffers[n];s.compressedTexImage2D(s.TEXTURE_2D,o,this.format,l,h,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Qr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t===36196)return"etc1";if(t===35986||t===35987||t===34798)return"atc";if(t>=36492&&t<=36495)return"bptc";if(t===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,r,s,n,a,o){const l=new Array(r);let h=t.byteOffset,u=a,d=o,c=u+s-1&~(s-1),f=d+n-1&~(n-1),p=c*f*Ql[e];for(let y=0;y<r;y++)l[y]={levelID:y,levelWidth:r>1?u:c,levelHeight:r>1?d:f,levelBuffer:new Uint8Array(t.buffer,h,p)},h+=p,u=u>>1||1,d=d>>1||1,c=u+s-1&~(s-1),f=d+n-1&~(n-1),p=c*f*Ql[e];return l}}const Ku=4,Io=124,MD=32,ug=20,PD=542327876,Do={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},FD={FOURCC:2},Ro={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},OD=1,BD=2,kD=4,ND=64,LD=512,UD=131072,GD=827611204,VD=861165636,HD=894720068,zD=808540228,XD=4,$D={[GD]:Qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,[VD]:Qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,[HD]:Qt.COMPRESSED_RGBA_S3TC_DXT5_EXT},WD={70:Qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Qt.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Qt.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Qt.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Qt.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Qt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Qt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Qt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Qt.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Qt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function YD(i){const t=new Uint32Array(i);if(t[0]!==PD)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(i,0,Io/Uint32Array.BYTES_PER_ELEMENT),r=e[Do.HEIGHT],s=e[Do.WIDTH],n=e[Do.MIPMAP_COUNT],a=new Uint32Array(i,Do.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,MD/Uint32Array.BYTES_PER_ELEMENT),o=a[OD];if(o&kD){const l=a[FD.FOURCC];if(l!==zD){const _=$D[l],g=Ku+Io,T=new Uint8Array(i,g);return[new Qr(T,{format:_,width:s,height:r,levels:n})]}const h=Ku+Io,u=new Uint32Array(t.buffer,h,ug/Uint32Array.BYTES_PER_ELEMENT),d=u[Ro.DXGI_FORMAT],c=u[Ro.RESOURCE_DIMENSION],f=u[Ro.MISC_FLAG],p=u[Ro.ARRAY_SIZE],y=WD[d];if(y===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(f===XD)throw new Error("DDSParser does not support cubemap textures");if(c===6)throw new Error("DDSParser does not supported 3D texture data");const x=new Array,m=Ku+Io+ug;if(p===1)x.push(new Uint8Array(i,m));else{const _=Ql[y];let g=0,T=s,A=r;for(let w=0;w<n;w++){const E=Math.max(1,T+3&-4),C=Math.max(1,A+3&-4),D=E*C*_;g+=D,T=T>>>1,A=A>>>1}let S=m;for(let w=0;w<p;w++)x.push(new Uint8Array(i,S,g)),S+=g}return x.map(_=>new Qr(_,{format:y,width:s,height:r,levels:n}))}throw o&ND?new Error("DDSParser does not support uncompressed texture data."):o&LD?new Error("DDSParser does not supported YUV uncompressed texture data."):o&UD?new Error("DDSParser does not support single-channel (lumninance) texture data!"):o&BD?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const cg=[171,75,84,88,32,49,49,187,13,10,26,10],jD=67305985,Xe={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},jd=64,dg={[J.UNSIGNED_BYTE]:1,[J.UNSIGNED_SHORT]:2,[J.INT]:4,[J.UNSIGNED_INT]:4,[J.FLOAT]:4,[J.HALF_FLOAT]:8},qD={[G.RGBA]:4,[G.RGB]:3,[G.RG]:2,[G.RED]:1,[G.LUMINANCE]:1,[G.LUMINANCE_ALPHA]:2,[G.ALPHA]:1},KD={[J.UNSIGNED_SHORT_4_4_4_4]:2,[J.UNSIGNED_SHORT_5_5_5_1]:2,[J.UNSIGNED_SHORT_5_6_5]:2};function ZD(i,t,e=!1){const r=new DataView(t);if(!QD(i,r))return null;const s=r.getUint32(Xe.ENDIANNESS,!0)===jD,n=r.getUint32(Xe.GL_TYPE,s),a=r.getUint32(Xe.GL_FORMAT,s),o=r.getUint32(Xe.GL_INTERNAL_FORMAT,s),l=r.getUint32(Xe.PIXEL_WIDTH,s),h=r.getUint32(Xe.PIXEL_HEIGHT,s)||1,u=r.getUint32(Xe.PIXEL_DEPTH,s)||1,d=r.getUint32(Xe.NUMBER_OF_ARRAY_ELEMENTS,s)||1,c=r.getUint32(Xe.NUMBER_OF_FACES,s),f=r.getUint32(Xe.NUMBER_OF_MIPMAP_LEVELS,s),p=r.getUint32(Xe.BYTES_OF_KEY_VALUE_DATA,s);if(h===0||u!==1)throw new Error("Only 2D textures are supported");if(c!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(d!==1)throw new Error("WebGL does not support array textures");const y=4,x=4,m=l+3&-4,_=h+3&-4,g=new Array(d);let T=l*h;n===0&&(T=m*_);let A;if(n!==0?dg[n]?A=dg[n]*qD[a]:A=KD[n]:A=Ql[o],A===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const S=e?tR(r,p,s):null;let w=T*A,E=l,C=h,D=m,k=_,F=jd+p;for(let b=0;b<f;b++){const P=r.getUint32(F,s);let N=F+4;for(let H=0;H<d;H++){let U=g[H];U||(U=g[H]=new Array(f)),U[b]={levelID:b,levelWidth:f>1||n!==0?E:D,levelHeight:f>1||n!==0?C:k,levelBuffer:new Uint8Array(t,N,w)},N+=w}F+=P+4,F=F%4!==0?F+4-F%4:F,E=E>>1||1,C=C>>1||1,D=E+y-1&-4,k=C+x-1&-4,w=D*k*A}return n!==0?{uncompressed:g.map(b=>{let P=b[0].levelBuffer,N=!1;return n===J.FLOAT?P=new Float32Array(b[0].levelBuffer.buffer,b[0].levelBuffer.byteOffset,b[0].levelBuffer.byteLength/4):n===J.UNSIGNED_INT?(N=!0,P=new Uint32Array(b[0].levelBuffer.buffer,b[0].levelBuffer.byteOffset,b[0].levelBuffer.byteLength/4)):n===J.INT&&(N=!0,P=new Int32Array(b[0].levelBuffer.buffer,b[0].levelBuffer.byteOffset,b[0].levelBuffer.byteLength/4)),{resource:new Sh(P,{width:b[0].levelWidth,height:b[0].levelHeight}),type:n,format:N?JD(a):a}}),kvData:S}:{compressed:g.map(b=>new Qr(null,{format:o,width:l,height:h,levels:f,levelBuffers:b})),kvData:S}}function QD(i,t){for(let e=0;e<cg.length;e++)if(t.getUint8(e)!==cg[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function JD(i){switch(i){case G.RGBA:return G.RGBA_INTEGER;case G.RGB:return G.RGB_INTEGER;case G.RG:return G.RG_INTEGER;case G.RED:return G.RED_INTEGER;default:return i}}function tR(i,t,e){const r=new Map;let s=0;for(;s<t;){const n=i.getUint32(jd+s,e),a=jd+s+4,o=3-(n+3)%4;if(n===0||n>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<n&&i.getUint8(a+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(i.buffer,a,l)),u=new DataView(i.buffer,a+l+1,n-l-1);r.set(h,u),s+=4+n+o}return r}const eR={extension:{type:X.LoadParser,priority:ri.High},name:"loadDDS",test(i){return Rr(i,".dds")},async load(i,t,e){const r=await(await W.ADAPTER.fetch(i)).arrayBuffer(),s=YD(r).map(n=>{const a=new at(n,{mipmap:bi.OFF,alphaMode:ve.NO_PREMULTIPLIED_ALPHA,resolution:Wi(i),...t.data});return za(a,e,i)});return s.length===1?s[0]:s},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};q.add(eR);const iR={extension:{type:X.LoadParser,priority:ri.High},name:"loadKTX",test(i){return Rr(i,".ktx")},async load(i,t,e){const r=await(await W.ADAPTER.fetch(i)).arrayBuffer(),{compressed:s,uncompressed:n,kvData:a}=ZD(i,r),o=s??n,l={mipmap:bi.OFF,alphaMode:ve.NO_PREMULTIPLIED_ALPHA,resolution:Wi(i),...t.data},h=o.map(u=>{o===n&&Object.assign(l,{type:u.type,format:u.format});const d=u.resource??u,c=new at(d,l);return c.ktxKeyValueData=a,za(c,e,i)});return h.length===1?h[0]:h},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};q.add(iR);const rR=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],sR={extension:X.ResolveParser,test:i=>{const t=Kt.extname(i).slice(1);return["basis","ktx","dds"].includes(t)},parse:i=>{var r,s;const t=i.split("."),e=t.pop();if(["ktx","dds"].includes(e)){const n=t.pop();if(rR.includes(n))return{resolution:parseFloat(((r=W.RETINA_PREFIX.exec(i))==null?void 0:r[1])??"1"),format:n,src:i}}return{resolution:parseFloat(((s=W.RETINA_PREFIX.exec(i))==null?void 0:s[1])??"1"),format:e,src:i}}};q.add(sR);const Mo=new ot,nR=4,Px=class $n{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,r,s){const n=new Image;return n.src=await this.base64(t,e,r,s),n}async base64(t,e,r,s){const n=this.canvas(t,s);if(n.toBlob!==void 0)return new Promise((a,o)=>{n.toBlob(l=>{if(!l){o(new Error("ICanvas.toBlob failed!"));return}const h=new FileReader;h.onload=()=>a(h.result),h.onerror=o,h.readAsDataURL(l)},e,r)});if(n.toDataURL!==void 0)return n.toDataURL(e,r);if(n.convertToBlob!==void 0){const a=await n.convertToBlob({type:e,quality:r});return new Promise((o,l)=>{const h=new FileReader;h.onload=()=>o(h.result),h.onerror=l,h.readAsDataURL(a)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:r,width:s,height:n,flipY:a,premultipliedAlpha:o}=this._rawPixels(t,e);a&&$n._flipY(r,s,n),o&&$n._unpremultiplyAlpha(r);const l=new Ub(s,n,1),h=new ImageData(new Uint8ClampedArray(r.buffer),s,n);return l.context.putImageData(h,0,0),l.canvas}pixels(t,e){const{pixels:r,width:s,height:n,flipY:a,premultipliedAlpha:o}=this._rawPixels(t,e);return a&&$n._flipY(r,s,n),o&&$n._unpremultiplyAlpha(r),r}_rawPixels(t,e){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let s,n=!1,a=!1,o,l=!1;t&&(t instanceof ms?o=t:(o=r.generateTexture(t,{region:e,resolution:r.resolution,multisample:r.multisample}),l=!0,e&&(Mo.width=e.width,Mo.height=e.height,e=Mo)));const h=r.gl;if(o){if(s=o.baseTexture.resolution,e=e??o.frame,n=!1,a=o.baseTexture.alphaMode>0&&o.baseTexture.format===G.RGBA,!l){r.renderTexture.bind(o);const f=o.framebuffer.glFramebuffers[r.CONTEXT_UID];f.blitFramebuffer&&r.framebuffer.bind(f.blitFramebuffer)}}else s=r.resolution,e||(e=Mo,e.width=r.width/s,e.height=r.height/s),n=!0,a=this._rendererPremultipliedAlpha,r.renderTexture.bind();const u=Math.max(Math.round(e.width*s),1),d=Math.max(Math.round(e.height*s),1),c=new Uint8Array(nR*u*d);return h.readPixels(Math.round(e.x*s),Math.round(e.y*s),u,d,h.RGBA,h.UNSIGNED_BYTE,c),l&&(o==null||o.destroy(!0)),{pixels:c,width:u,height:d,flipY:n,premultipliedAlpha:a}}destroy(){this.renderer=null}static _flipY(t,e,r){const s=e<<2,n=r>>1,a=new Uint8Array(s);for(let o=0;o<n;o++){const l=o*s,h=(r-o-1)*s;a.set(t.subarray(l,l+s)),t.copyWithin(l,h,h+s),t.set(a,h)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let r=0;r<e;r+=4){const s=t[r+3];if(s!==0){const n=255.001/s;t[r]=t[r]*n+.5,t[r+1]=t[r+1]*n+.5,t[r+2]=t[r+2]*n+.5}}}};Px.extension={name:"extract",type:X.RendererSystem};let aR=Px;q.add(aR);const Jl={build(i){const t=i.points;let e,r,s,n,a,o;if(i.type===te.CIRC){const p=i.shape;e=p.x,r=p.y,a=o=p.radius,s=n=0}else if(i.type===te.ELIP){const p=i.shape;e=p.x,r=p.y,a=p.width,o=p.height,s=n=0}else{const p=i.shape,y=p.width/2,x=p.height/2;e=p.x+y,r=p.y+x,a=o=Math.max(0,Math.min(p.radius,Math.min(y,x))),s=y-a,n=x-o}if(!(a>=0&&o>=0&&s>=0&&n>=0)){t.length=0;return}const l=Math.ceil(2.3*Math.sqrt(a+o)),h=l*8+(s?4:0)+(n?4:0);if(t.length=h,h===0)return;if(l===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=r+n,t[2]=t[4]=e-s,t[5]=t[7]=r-n;return}let u=0,d=l*4+(s?2:0)+2,c=d,f=h;{const p=s+a,y=n,x=e+p,m=e-p,_=r+y;if(t[u++]=x,t[u++]=_,t[--d]=_,t[--d]=m,n){const g=r-y;t[c++]=m,t[c++]=g,t[--f]=g,t[--f]=x}}for(let p=1;p<l;p++){const y=Math.PI/2*(p/l),x=s+Math.cos(y)*a,m=n+Math.sin(y)*o,_=e+x,g=e-x,T=r+m,A=r-m;t[u++]=_,t[u++]=T,t[--d]=T,t[--d]=g,t[c++]=g,t[c++]=A,t[--f]=A,t[--f]=_}{const p=s,y=n+o,x=e+p,m=e-p,_=r+y,g=r-y;t[u++]=x,t[u++]=_,t[--f]=g,t[--f]=x,s&&(t[u++]=m,t[u++]=_,t[--f]=g,t[--f]=m)}},triangulate(i,t){const e=i.points,r=t.points,s=t.indices;if(e.length===0)return;let n=r.length/2;const a=n;let o,l;if(i.type!==te.RREC){const u=i.shape;o=u.x,l=u.y}else{const u=i.shape;o=u.x+u.width/2,l=u.y+u.height/2}const h=i.matrix;r.push(i.matrix?h.a*o+h.c*l+h.tx:o,i.matrix?h.b*o+h.d*l+h.ty:l),n++,r.push(e[0],e[1]);for(let u=2;u<e.length;u+=2)r.push(e[u],e[u+1]),s.push(n++,a,n);s.push(a+1,a,n)}};function fg(i,t=!1){const e=i.length;if(e<6)return;let r=0;for(let s=0,n=i[e-2],a=i[e-1];s<e;s+=2){const o=i[s],l=i[s+1];r+=(o-n)*(l+a),n=o,a=l}if(!t&&r>0||t&&r<=0){const s=e/2;for(let n=s+s%2;n<e;n+=2){const a=e-n-2,o=e-n-1,l=n,h=n+1;[i[a],i[l]]=[i[l],i[a]],[i[o],i[h]]=[i[h],i[o]]}}}const Fx={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const r=i.holes,s=t.points,n=t.indices;if(e.length>=6){fg(e,!1);const a=[];for(let h=0;h<r.length;h++){const u=r[h];fg(u.points,!0),a.push(e.length/2),e=e.concat(u.points)}const o=hE(e,a,2);if(!o)return;const l=s.length/2;for(let h=0;h<o.length;h+=3)n.push(o[h]+l),n.push(o[h+1]+l),n.push(o[h+2]+l);for(let h=0;h<e.length;h++)s.push(e[h])}}},oR={build(i){const t=i.shape,e=t.x,r=t.y,s=t.width,n=t.height,a=i.points;a.length=0,s>=0&&n>=0&&a.push(e,r,e+s,r,e+s,r+n,e,r+n)},triangulate(i,t){const e=i.points,r=t.points;if(e.length===0)return;const s=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},lR={build(i){Jl.build(i)},triangulate(i,t){Jl.triangulate(i,t)}};var Me=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(Me||{}),cr=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(cr||{});const pn={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class pg{static curveTo(t,e,r,s,n,a){const o=a[a.length-2],l=a[a.length-1]-e,h=o-t,u=s-e,d=r-t,c=Math.abs(l*d-h*u);if(c<1e-8||n===0)return(a[a.length-2]!==t||a[a.length-1]!==e)&&a.push(t,e),null;const f=l*l+h*h,p=u*u+d*d,y=l*u+h*d,x=n*Math.sqrt(f)/c,m=n*Math.sqrt(p)/c,_=x*y/f,g=m*y/p,T=x*d+m*h,A=x*u+m*l,S=h*(m+_),w=l*(m+_),E=d*(x+g),C=u*(x+g),D=Math.atan2(w-A,S-T),k=Math.atan2(C-A,E-T);return{cx:T+t,cy:A+e,radius:n,startAngle:D,endAngle:k,anticlockwise:h*u>d*l}}static arc(t,e,r,s,n,a,o,l,h){const u=o-a,d=pn._segmentsCount(Math.abs(u)*n,Math.ceil(Math.abs(u)/Xl)*40),c=u/(d*2),f=c*2,p=Math.cos(c),y=Math.sin(c),x=d-1,m=x%1/x;for(let _=0;_<=x;++_){const g=_+m*_,T=c+a+f*g,A=Math.cos(T),S=-Math.sin(T);h.push((p*A+y*S)*n+r,(p*-S+y*A)*n+s)}}}class hR{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class yp{static curveLength(t,e,r,s,n,a,o,l){let h=0,u=0,d=0,c=0,f=0,p=0,y=0,x=0,m=0,_=0,g=0,T=t,A=e;for(let S=1;S<=10;++S)u=S/10,d=u*u,c=d*u,f=1-u,p=f*f,y=p*f,x=y*t+3*p*u*r+3*f*d*n+c*o,m=y*e+3*p*u*s+3*f*d*a+c*l,_=T-x,g=A-m,T=x,A=m,h+=Math.sqrt(_*_+g*g);return h}static curveTo(t,e,r,s,n,a,o){const l=o[o.length-2],h=o[o.length-1];o.length-=2;const u=pn._segmentsCount(yp.curveLength(l,h,t,e,r,s,n,a));let d=0,c=0,f=0,p=0,y=0;o.push(l,h);for(let x=1,m=0;x<=u;++x)m=x/u,d=1-m,c=d*d,f=c*d,p=m*m,y=p*m,o.push(f*l+3*c*m*t+3*d*p*r+y*n,f*h+3*c*m*e+3*d*p*s+y*a)}}function mg(i,t,e,r,s,n,a,o){const l=i-e*s,h=t-r*s,u=i+e*n,d=t+r*n;let c,f;a?(c=r,f=-e):(c=-r,f=e);const p=l+c,y=h+f,x=u+c,m=d+f;return o.push(p,y,x,m),2}function Pr(i,t,e,r,s,n,a,o){const l=e-i,h=r-t;let u=Math.atan2(l,h),d=Math.atan2(s-i,n-t);o&&u<d?u+=Math.PI*2:!o&&u>d&&(d+=Math.PI*2);let c=u;const f=d-u,p=Math.abs(f),y=Math.sqrt(l*l+h*h),x=(15*p*Math.sqrt(y)/Math.PI>>0)+1,m=f/x;if(c+=m,o){a.push(i,t,e,r);for(let _=1,g=c;_<x;_++,g+=m)a.push(i,t,i+Math.sin(g)*y,t+Math.cos(g)*y);a.push(i,t,s,n)}else{a.push(e,r,i,t);for(let _=1,g=c;_<x;_++,g+=m)a.push(i+Math.sin(g)*y,t+Math.cos(g)*y,i,t);a.push(s,n,i,t)}return x*2}function uR(i,t){const e=i.shape;let r=i.points||e.points.slice();const s=t.closePointEps;if(r.length===0)return;const n=i.lineStyle,a=new mt(r[0],r[1]),o=new mt(r[r.length-2],r[r.length-1]),l=e.type!==te.POLY||e.closeStroke,h=Math.abs(a.x-o.x)<s&&Math.abs(a.y-o.y)<s;if(l){r=r.slice(),h&&(r.pop(),r.pop(),o.set(r[r.length-2],r[r.length-1]));const U=(a.x+o.x)*.5,R=(o.y+a.y)*.5;r.unshift(U,R),r.push(U,R)}const u=t.points,d=r.length/2;let c=r.length;const f=u.length/2,p=n.width/2,y=p*p,x=n.miterLimit*n.miterLimit;let m=r[0],_=r[1],g=r[2],T=r[3],A=0,S=0,w=-(_-T),E=m-g,C=0,D=0,k=Math.sqrt(w*w+E*E);w/=k,E/=k,w*=p,E*=p;const F=n.alignment,b=(1-F)*2,P=F*2;l||(n.cap===cr.ROUND?c+=Pr(m-w*(b-P)*.5,_-E*(b-P)*.5,m-w*b,_-E*b,m+w*P,_+E*P,u,!0)+2:n.cap===cr.SQUARE&&(c+=mg(m,_,w,E,b,P,!0,u))),u.push(m-w*b,_-E*b,m+w*P,_+E*P);for(let U=1;U<d-1;++U){m=r[(U-1)*2],_=r[(U-1)*2+1],g=r[U*2],T=r[U*2+1],A=r[(U+1)*2],S=r[(U+1)*2+1],w=-(_-T),E=m-g,k=Math.sqrt(w*w+E*E),w/=k,E/=k,w*=p,E*=p,C=-(T-S),D=g-A,k=Math.sqrt(C*C+D*D),C/=k,D/=k,C*=p,D*=p;const R=g-m,V=_-T,M=g-A,B=S-T,z=R*M+V*B,st=V*M-B*R,tt=st<0;if(Math.abs(st)<.001*Math.abs(z)){u.push(g-w*b,T-E*b,g+w*P,T+E*P),z>=0&&(n.join===Me.ROUND?c+=Pr(g,T,g-w*b,T-E*b,g-C*b,T-D*b,u,!1)+4:c+=2,u.push(g-C*P,T-D*P,g+C*b,T+D*b));continue}const gt=(-w+m)*(-E+T)-(-w+g)*(-E+_),et=(-C+A)*(-D+T)-(-C+g)*(-D+S),it=(R*et-M*gt)/st,vt=(B*gt-V*et)/st,Ee=(it-g)*(it-g)+(vt-T)*(vt-T),Zt=g+(it-g)*b,Et=T+(vt-T)*b,Nt=g-(it-g)*P,Vt=T-(vt-T)*P,si=Math.min(R*R+V*V,M*M+B*B),ni=tt?b:P,An=si+ni*ni*y,xT=Ee<=An;let ja=n.join;if(ja===Me.MITER&&Ee/y>x&&(ja=Me.BEVEL),xT)switch(ja){case Me.MITER:{u.push(Zt,Et,Nt,Vt);break}case Me.BEVEL:{tt?u.push(Zt,Et,g+w*P,T+E*P,Zt,Et,g+C*P,T+D*P):u.push(g-w*b,T-E*b,Nt,Vt,g-C*b,T-D*b,Nt,Vt),c+=2;break}case Me.ROUND:{tt?(u.push(Zt,Et,g+w*P,T+E*P),c+=Pr(g,T,g+w*P,T+E*P,g+C*P,T+D*P,u,!0)+4,u.push(Zt,Et,g+C*P,T+D*P)):(u.push(g-w*b,T-E*b,Nt,Vt),c+=Pr(g,T,g-w*b,T-E*b,g-C*b,T-D*b,u,!1)+4,u.push(g-C*b,T-D*b,Nt,Vt));break}}else{switch(u.push(g-w*b,T-E*b,g+w*P,T+E*P),ja){case Me.MITER:{tt?u.push(Nt,Vt,Nt,Vt):u.push(Zt,Et,Zt,Et),c+=2;break}case Me.ROUND:{tt?c+=Pr(g,T,g+w*P,T+E*P,g+C*P,T+D*P,u,!0)+2:c+=Pr(g,T,g-w*b,T-E*b,g-C*b,T-D*b,u,!1)+2;break}}u.push(g-C*b,T-D*b,g+C*P,T+D*P),c+=2}}m=r[(d-2)*2],_=r[(d-2)*2+1],g=r[(d-1)*2],T=r[(d-1)*2+1],w=-(_-T),E=m-g,k=Math.sqrt(w*w+E*E),w/=k,E/=k,w*=p,E*=p,u.push(g-w*b,T-E*b,g+w*P,T+E*P),l||(n.cap===cr.ROUND?c+=Pr(g-w*(b-P)*.5,T-E*(b-P)*.5,g-w*b,T-E*b,g+w*P,T+E*P,u,!1)+2:n.cap===cr.SQUARE&&(c+=mg(g,T,w,E,b,P,!1,u)));const N=t.indices,H=pn.epsilon*pn.epsilon;for(let U=f;U<c+f-2;++U)m=u[U*2],_=u[U*2+1],g=u[(U+1)*2],T=u[(U+1)*2+1],A=u[(U+2)*2],S=u[(U+2)*2+1],!(Math.abs(m*(T-S)+g*(S-_)+A*(_-T))<H)&&N.push(U,U+1,U+2)}function cR(i,t){let e=0;const r=i.shape,s=i.points||r.points,n=r.type!==te.POLY||r.closeStroke;if(s.length===0)return;const a=t.points,o=t.indices,l=s.length/2,h=a.length/2;let u=h;for(a.push(s[0],s[1]),e=1;e<l;e++)a.push(s[e*2],s[e*2+1]),o.push(u,u+1),u++;n&&o.push(u,h)}function _g(i,t){i.lineStyle.native?cR(i,t):uR(i,t)}class vp{static curveLength(t,e,r,s,n,a){const o=t-2*r+n,l=e-2*s+a,h=2*r-2*t,u=2*s-2*e,d=4*(o*o+l*l),c=4*(o*h+l*u),f=h*h+u*u,p=2*Math.sqrt(d+c+f),y=Math.sqrt(d),x=2*d*y,m=2*Math.sqrt(f),_=c/y;return(x*p+y*c*(p-m)+(4*f*d-c*c)*Math.log((2*y+_+p)/(_+m)))/(4*x)}static curveTo(t,e,r,s,n){const a=n[n.length-2],o=n[n.length-1],l=pn._segmentsCount(vp.curveLength(a,o,t,e,r,s));let h=0,u=0;for(let d=1;d<=l;++d){const c=d/l;h=a+(t-a)*c,u=o+(e-o)*c,n.push(h+(t+(r-t)*c-h)*c,u+(e+(s-e)*c-u)*c)}}}const Zu={[te.POLY]:Fx,[te.CIRC]:Jl,[te.ELIP]:Jl,[te.RECT]:oR,[te.RREC]:lR},gg=[],Po=[];class th{constructor(t,e=null,r=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new th(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Ts=new mt,Ox=class Bx extends Lv{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new ql,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Po.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),gg.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,s=null){const n=new th(t,e,r,s);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new th(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=s.lineStyle,s.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const s=e[r];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Ts):Ts.copyFrom(t),s.shape.contains(Ts.x,Ts.y))){let n=!1;if(s.holes){for(let a=0;a<s.holes.length;a++)if(s.holes[a].shape.contains(Ts.x,Ts.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let r=null,s=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],s=r.style);for(let l=this.shapeIndex;l<e.length;l++){this.shapeIndex++;const h=e[l],u=h.fillStyle,d=h.lineStyle;Zu[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(u.visible||d.visible)&&this.processHoles(h.holes);for(let c=0;c<2;c++){const f=c===0?u:d;if(!f.visible)continue;const p=f.texture.baseTexture,y=this.indices.length,x=this.points.length/2;p.wrapMode=Tr.REPEAT,c===0?this.processFill(h):this.processLine(h);const m=this.points.length/2-x;m!==0&&(r&&!this._compareStyles(s,f)&&(r.end(y,x),r=null),r||(r=gg.pop()||new hR,r.begin(f,y,x),this.batches.push(r),s=f),this.addUvs(this.points,t,f.texture,x,m,f.matrix))}}const n=this.indices.length,a=this.points.length/2;if(r&&r.end(n,a),this.batches.length===0){this.batchable=!0;return}const o=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const r=this.graphicsData[t],s=r.fillStyle,n=r.lineStyle;if(s&&!s.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,r=t.length;e<r;e++){const s=t[e];for(let n=0;n<s.size;n++){const a=s.start+n;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<Bx.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++at._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Po.push(this.drawCalls[d]);this.drawCalls.length=0;const e=this.colors,r=this.textureIds;let s=Po.pop();s||(s=new wd,s.texArray=new Rd),s.texArray.count=0,s.start=0,s.size=0,s.type=xi.TRIANGLES;let n=0,a=null,o=0,l=!1,h=xi.TRIANGLES,u=0;this.drawCalls.push(s);for(let d=0;d<this.batches.length;d++){const c=this.batches[d],f=8,p=c.style,y=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,h=l?xi.LINES:xi.TRIANGLES,a=null,n=f,t++),a!==y&&(a=y,y._batchEnabled!==t&&(n===f&&(t++,n=0,s.size>0&&(s=Po.pop(),s||(s=new wd,s.texArray=new Rd),this.drawCalls.push(s)),s.start=u,s.size=0,s.texArray.count=0,s.type=h),y.touched=1,y._batchEnabled=t,y._batchLocation=n,y.wrapMode=Tr.REPEAT,s.texArray.elements[s.texArray.count++]=y,n++)),s.size+=c.size,u+=c.size,o=y._batchLocation,this.addColors(e,p.color,p.alpha,c.attribSize,c.attribStart),this.addTextureIds(r,o,c.attribSize,c.attribStart)}at._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,r=this.colors,s=this.textureIds,n=new ArrayBuffer(t.length*3*4),a=new Float32Array(n),o=new Uint32Array(n);let l=0;for(let h=0;h<t.length/2;h++)a[l++]=t[h*2],a[l++]=t[h*2+1],a[l++]=e[h*2],a[l++]=e[h*2+1],o[l++]=r[h],a[l++]=s[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Fx.triangulate(t,this):Zu[t.type].triangulate(t,this)}processLine(t){_g(t,this);for(let e=0;e<t.holes.length;e++)_g(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e];Zu[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const s=t[r*2],n=t[r*2+1];t[r*2]=e.a*s+e.c*n+e.tx,t[r*2+1]=e.b*s+e.d*n+e.ty}}addColors(t,e,r,s,n=0){const a=Tt.shared.setValue(e).toLittleEndianNumber(),o=Tt.shared.setValue(a).toPremultiplied(r);t.length=Math.max(t.length,n+s);for(let l=0;l<s;l++)t[n+l]=o}addTextureIds(t,e,r,s=0){t.length=Math.max(t.length,s+r);for(let n=0;n<r;n++)t[s+n]=e}addUvs(t,e,r,s,n,a=null){let o=0;const l=e.length,h=r.frame;for(;o<n;){let d=t[(s+o)*2],c=t[(s+o)*2+1];if(a){const f=a.a*d+a.c*c+a.tx;c=a.b*d+a.d*c+a.ty,d=f}o++,e.push(d/h.width,c/h.height)}const u=r.baseTexture;(h.width<u.width||h.height<u.height)&&this.adjustUvs(e,r,l,n)}adjustUvs(t,e,r,s){const n=e.baseTexture,a=1e-6,o=r+s*2,l=e.frame,h=l.width/n.width,u=l.height/n.height;let d=l.x/l.width,c=l.y/l.height,f=Math.floor(t[r]+a),p=Math.floor(t[r+1]+a);for(let y=r+2;y<o;y+=2)f=Math.min(f,Math.floor(t[y]+a)),p=Math.min(p,Math.floor(t[y+1]+a));d-=f,c-=p;for(let y=r;y<o;y+=2)t[y]=(t[y]+d)*h,t[y+1]=(t[y+1]+c)*u}};Ox.BATCHABLE_SIZE=100;let dR=Ox;class Rh{constructor(){this.color=16777215,this.alpha=1,this.texture=j.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Rh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=j.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class xp extends Rh{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=cr.BUTT,this.join=Me.MITER,this.miterLimit=10}clone(){const t=new xp;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=cr.BUTT,this.join=Me.MITER,this.miterLimit=10}}const Qu={},qd=class nl extends Ft{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Rh,this._lineStyle=new xp,this._matrix=null,this._holeMode=!1,this.state=Ii.for2d(),this._geometry=t||new dR,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Tt(16777215),this.blendMode=Z.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new nl(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r,s=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:r,alignment:s,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:j.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:cr.BUTT,join:Me.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.width>0&&t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:r},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Zr,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Zr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,s=r[r.length-2],n=r[r.length-1];return(s!==t||n!==e)&&r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,s){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),vp.curveTo(t,e,r,s,n),this}bezierCurveTo(t,e,r,s,n,a){return this._initCurve(),yp.curveTo(t,e,r,s,n,a,this.currentPath.points),this}arcTo(t,e,r,s,n){this._initCurve(t,e);const a=this.currentPath.points,o=pg.curveTo(t,e,r,s,n,a);if(o){const{cx:l,cy:h,radius:u,startAngle:d,endAngle:c,anticlockwise:f}=o;this.arc(l,h,u,d,c,f)}return this}arc(t,e,r,s,n,a=!1){if(s===n)return this;if(!a&&n<=s?n+=Xl:a&&s<=n&&(s+=Xl),n-s===0)return this;const o=t+Math.cos(s)*r,l=e+Math.sin(s)*r,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const d=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-l);d<h&&c<h||u.push(o,l)}else this.moveTo(o,l),u=this.currentPath.points;return pg.arc(o,l,t,e,r,s,n,a,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:j.WHITE,color:t,alpha:e})}normalizeColor(t){const e=Tt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:j.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:r},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,s){return this.drawShape(new ot(t,e,r,s))}drawRoundedRect(t,e,r,s,n){return this.drawShape(new Ch(t,e,r,s,n))}drawCircle(t,e,r){return this.drawShape(new wh(t,e,r))}drawEllipse(t,e,r,s){return this.drawShape(new bh(t,e,r,s))}drawPolygon(...t){let e,r=!0;const s=t[0];s.points?(r=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;const n=new Zr(e);return n.closeStroke=r,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===te.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let s=0;s<r;s++){const n=t.batches[s],a=n.style.color,o=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),l=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),h=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),u={vertexData:o,blendMode:e,indices:h,uvs:l,_batchRGB:Tt.shared.setValue(a).toRgbArray(),_tintRGB:a,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){const e=this._resolveDirectShader(t),r=this._geometry,s=this.worldAlpha,n=e.uniforms,a=r.drawCalls;n.translationMatrix=this.transform.worldTransform,Tt.shared.setValue(this._tintColor).premultiply(s).toArray(n.tint),t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(let o=0,l=a.length;o<l;o++)this._renderDrawCallDirect(t,r.drawCalls[o])}_renderDrawCallDirect(t,e){const{texArray:r,type:s,size:n,start:a}=e,o=r.count;for(let l=0;l<o;l++)t.texture.bind(r.elements[l],l);t.geometry.draw(s,n,a)}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;if(!e){if(!Qu[r]){const{maxTextures:s}=t.plugins[r],n=new Int32Array(s);for(let l=0;l<s;l++)n[l]=l;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:ei.from({uSamplers:n},!0)},o=t.plugins[r]._shader.program;Qu[r]=new Si(o,a)}e=Qu[r]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:s,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,r,s,n)}containsPoint(t){return this.worldTransform.applyInverse(t,nl._TEMP_POINT),this._geometry.containsPoint(nl._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=Tt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,l=e.ty,h=this._geometry.points,u=this.vertexData;let d=0;for(let c=0;c<h.length;c+=2){const f=h[c],p=h[c+1];u[d++]=r*f+n*p+o,u[d++]=a*p+s*f+l}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};qd.curves=pn,qd._TEMP_POINT=new mt;let Pa=qd;class fR{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Ju=new mt,yg=new Zr,kx=class Nx extends Ft{constructor(t,e,r,s=xi.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=r||Ii.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=W.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===xi.TRIANGLES&&e.length<Nx.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,n=s.a,a=s.b,o=s.c,l=s.d,h=s.tx,u=s.ty,d=this.vertexData;for(let c=0;c<d.length/2;c++){const f=e[c*2],p=e[c*2+1];d[c*2]=n*f+o*p+h,d[c*2+1]=a*f+l*p+u}if(this._roundPixels){const c=W.RESOLUTION;for(let f=0;f<d.length;++f)d[f]=Math.round(d[f]*c)/c}this.vertexDirty=r}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new fR(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ju);const e=this.geometry.getBuffer("aVertexPosition").data,r=yg.points,s=this.geometry.getIndex().data,n=s.length,a=this.drawMode===4?3:1;for(let o=0;o+2<n;o+=a){const l=s[o]*2,h=s[o+1]*2,u=s[o+2]*2;if(r[0]=e[l],r[1]=e[l+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],yg.contains(Ju.x,Ju.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};kx.BATCHABLE_SIZE=100;let Kd=kx;class Lx extends wr{constructor(t,e,r){super();const s=new Ot(t),n=new Ot(e,!0),a=new Ot(r,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,J.FLOAT).addAttribute("aTextureCoord",n,2,!1,J.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var pR=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,mR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Zd extends Si{constructor(t,e){const r={uSampler:t,alpha:1,uTextureMatrix:kt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(r,e.uniforms),super(e.program||Ui.from(mR,pR),r),this._colorDirty=!1,this.uvMatrix=new Jv(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new Tt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;Tt.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Ux extends Kd{constructor(t=j.EMPTY,e,r,s,n){const a=new Lx(e,r,s);a.getBuffer("aVertexPosition").static=!1;const o=new Zd(t);super(a,o,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class vg{constructor(t,e,r){this.geometry=new wr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||J.FLOAT,offset:n.offset},e[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Ot(Nb(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const o=this.dynamicProperties[a];o.offset=e,e+=o.size,this.dynamicStride+=o.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Ot(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const o=this.staticProperties[a];o.offset=s,s+=o.size,this.staticStride+=o.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Ot(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const o=this.dynamicProperties[a];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===J.UNSIGNED_BYTE,o.type,this.dynamicStride*4,o.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const o=this.staticProperties[a];t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===J.UNSIGNED_BYTE,o.type,this.staticStride*4,o.offset*4)}}uploadDynamic(t,e,r){for(let s=0;s<this.dynamicProperties.length;s++){const n=this.dynamicProperties[s];n.uploadFunction(t,e,r,n.type===J.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,r){for(let s=0;s<this.staticProperties.length;s++){const n=this.staticProperties[s];n.uploadFunction(t,e,r,n.type===J.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var _R=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,gR=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Gx extends Ih{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new kt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:J.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Si.from(gR,_R,{}),this.state=Ii.for2d()}render(t){const e=t.children,r=t._maxSize,s=t._batchSize,n=this.renderer;let a=e.length;if(a===0)return;a>r&&!t.autoResize&&(a=r);let o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));const l=e[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=Bv(t.blendMode,h),n.state.set(this.state);const u=n.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=Tt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let c=!1;for(let f=0,p=0;f<a;f+=s,p+=1){let y=a-f;y>s&&(y=s),p>=o.length&&o.push(this._generateOneMoreBuffer(t));const x=o[p];x.uploadDynamic(e,f,y);const m=t._bufferUpdateIDs[p]||0;c=c||x._updateID<m,c&&(x._updateID=t._updateID,x.uploadStatic(e,f,y)),n.geometry.bind(x.geometry),u.drawElements(u.TRIANGLES,y*6,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],r=t._maxSize,s=t._batchSize,n=t._properties;for(let a=0;a<r;a+=s)e.push(new vg(this.properties,n,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,r=t._properties;return new vg(this.properties,r,e)}uploadVertices(t,e,r,s,n,a){let o=0,l=0,h=0,u=0;for(let d=0;d<r;++d){const c=t[e+d],f=c._texture,p=c.scale.x,y=c.scale.y,x=f.trim,m=f.orig;x?(l=x.x-c.anchor.x*m.width,o=l+x.width,u=x.y-c.anchor.y*m.height,h=u+x.height):(o=m.width*(1-c.anchor.x),l=m.width*-c.anchor.x,h=m.height*(1-c.anchor.y),u=m.height*-c.anchor.y),s[a]=l*p,s[a+1]=u*y,s[a+n]=o*p,s[a+n+1]=u*y,s[a+n*2]=o*p,s[a+n*2+1]=h*y,s[a+n*3]=l*p,s[a+n*3+1]=h*y,a+=n*4}}uploadPosition(t,e,r,s,n,a){for(let o=0;o<r;o++){const l=t[e+o].position;s[a]=l.x,s[a+1]=l.y,s[a+n]=l.x,s[a+n+1]=l.y,s[a+n*2]=l.x,s[a+n*2+1]=l.y,s[a+n*3]=l.x,s[a+n*3+1]=l.y,a+=n*4}}uploadRotation(t,e,r,s,n,a){for(let o=0;o<r;o++){const l=t[e+o].rotation;s[a]=l,s[a+n]=l,s[a+n*2]=l,s[a+n*3]=l,a+=n*4}}uploadUvs(t,e,r,s,n,a){for(let o=0;o<r;++o){const l=t[e+o]._texture._uvs;l?(s[a]=l.x0,s[a+1]=l.y0,s[a+n]=l.x1,s[a+n+1]=l.y1,s[a+n*2]=l.x2,s[a+n*2+1]=l.y2,s[a+n*3]=l.x3,s[a+n*3+1]=l.y3,a+=n*4):(s[a]=0,s[a+1]=0,s[a+n]=0,s[a+n+1]=0,s[a+n*2]=0,s[a+n*2+1]=0,s[a+n*3]=0,s[a+n*3+1]=0,a+=n*4)}}uploadTint(t,e,r,s,n,a){for(let o=0;o<r;++o){const l=t[e+o],h=Tt.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);s[a]=h,s[a+n]=h,s[a+n*2]=h,s[a+n*3]=h,a+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Gx.extension={name:"particle",type:X.RendererPlugin};q.add(Gx);var Mh=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(Mh||{});const Fo={willReadFrequently:!0},ci=class K{static get experimentalLetterSpacingSupported(){let t=K._experimentalLetterSpacingSupported;if(t!==void 0){const e=W.ADAPTER.getCanvasRenderingContext2D().prototype;t=K._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,s,n,a,o,l,h){this.text=t,this.style=e,this.width=r,this.height=s,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=h}static measureText(t,e,r,s=K._canvas){r=r??e.wordWrap;const n=e.toFontString(),a=K.measureFont(n);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const o=s.getContext("2d",Fo);o.font=n;const l=(r?K.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let u=0;for(let p=0;p<l.length;p++){const y=K._measureText(l[p],e.letterSpacing,o);h[p]=y,u=Math.max(u,y)}let d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);const c=e.lineHeight||a.fontSize+e.strokeThickness;let f=Math.max(c,a.fontSize+e.strokeThickness*2)+e.leading+(l.length-1)*(c+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new K(t,e,d,f,l,h,c+e.leading,u,a)}static _measureText(t,e,r){let s=!1;K.experimentalLetterSpacingSupported&&(K.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,s=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(t).width;return n>0&&(s?n-=e:n+=(K.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,r=K._canvas){const s=r.getContext("2d",Fo);let n=0,a="",o="";const l=Object.create(null),{letterSpacing:h,whiteSpace:u}=e,d=K.collapseSpaces(u),c=K.collapseNewlines(u);let f=!d;const p=e.wordWrapWidth+h,y=K.tokenize(t);for(let x=0;x<y.length;x++){let m=y[x];if(K.isNewline(m)){if(!c){o+=K.addLine(a),f=!d,a="",n=0;continue}m=" "}if(d){const g=K.isBreakingSpace(m),T=K.isBreakingSpace(a[a.length-1]);if(g&&T)continue}const _=K.getFromCache(m,h,l,s);if(_>p)if(a!==""&&(o+=K.addLine(a),a="",n=0),K.canBreakWords(m,e.breakWords)){const g=K.wordWrapSplit(m);for(let T=0;T<g.length;T++){let A=g[T],S=A,w=1;for(;g[T+w];){const C=g[T+w];if(!K.canBreakChars(S,C,m,T,e.breakWords))A+=C;else break;S=C,w++}T+=w-1;const E=K.getFromCache(A,h,l,s);E+n>p&&(o+=K.addLine(a),f=!1,a="",n=0),a+=A,n+=E}}else{a.length>0&&(o+=K.addLine(a),a="",n=0);const g=x===y.length-1;o+=K.addLine(m,!g),f=!1,a="",n=0}else _+n>p&&(f=!1,o+=K.addLine(a),a="",n=0),(a.length>0||!K.isBreakingSpace(m)||f)&&(a+=m,n+=_)}return o+=K.addLine(a,!1),o}static addLine(t,e=!0){return t=K.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,r,s){let n=r[t];return typeof n!="number"&&(n=K._measureText(t,e,s)+e,r[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!K.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:K._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:K._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let r="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const n=t[s],a=t[s+1];if(K.isBreakingSpace(n,a)||K.isNewline(n)){r!==""&&(e.push(r),r=""),e.push(n);continue}r+=n}return r!==""&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,s,n){return!0}static wordWrapSplit(t){return K.graphemeSegmenter(t)}static measureFont(t){if(K._fonts[t])return K._fonts[t];const e={ascent:0,descent:0,fontSize:0},r=K._canvas,s=K._context;s.font=t;const n=K.METRICS_STRING+K.BASELINE_SYMBOL,a=Math.ceil(s.measureText(n).width);let o=Math.ceil(s.measureText(K.BASELINE_SYMBOL).width);const l=Math.ceil(K.HEIGHT_MULTIPLIER*o);if(o=o*K.BASELINE_MULTIPLIER|0,a===0||l===0)return K._fonts[t]=e,e;r.width=a,r.height=l,s.fillStyle="#f00",s.fillRect(0,0,a,l),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(n,0,o);const h=s.getImageData(0,0,a,l).data,u=h.length,d=a*4;let c=0,f=0,p=!1;for(c=0;c<o;++c){for(let y=0;y<d;y+=4)if(h[f+y]!==255){p=!0;break}if(!p)f+=d;else break}for(e.ascent=o-c,f=u-d,p=!1,c=l;c>o;--c){for(let y=0;y<d;y+=4)if(h[f+y]!==255){p=!0;break}if(!p)f-=d;else break}return e.descent=c-o,e.fontSize=e.ascent+e.descent,K._fonts[t]=e,e}static clearMetrics(t=""){t?delete K._fonts[t]:K._fonts={}}static get _canvas(){var t;if(!K.__canvas){let e;try{const r=new OffscreenCanvas(0,0);if((t=r.getContext("2d",Fo))!=null&&t.measureText)return K.__canvas=r,r;e=W.ADAPTER.createCanvas()}catch{e=W.ADAPTER.createCanvas()}e.width=e.height=10,K.__canvas=e}return K.__canvas}static get _context(){return K.__context||(K.__context=K._canvas.getContext("2d",Fo)),K.__context}};ci.METRICS_STRING="|ÉqÅ",ci.BASELINE_SYMBOL="M",ci.BASELINE_MULTIPLIER=1.4,ci.HEIGHT_MULTIPLIER=2,ci.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})(),ci.experimentalLetterSpacing=!1,ci._fonts={},ci._newlines=[10,13],ci._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ir=ci;const yR=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Vx=class Wn{constructor(t){this.styleID=0,this.reset(),ec(this,t,t)}clone(){const t={};return ec(t,this,Wn.defaultStyle),new Wn(t)}reset(){ec(this,Wn.defaultStyle,Wn.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=tc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=tc(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){vR(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=tc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let r=e.length-1;r>=0;r--){let s=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!yR.includes(s)&&(s=`"${s}"`),e[r]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};Vx.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Mh.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ji=Vx;function tc(i){const t=Tt.shared,e=r=>{const s=t.setValue(r);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(i)?i.map(e):e(i)}function vR(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function ec(i,t,e){for(const r in e)Array.isArray(t[r])?i[r]=t[r].slice():i[r]=t[r]}const xR={texture:!0,children:!1,baseTexture:!0},Hx=class Qd extends fe{constructor(t,e,r){let s=!1;r||(r=W.ADAPTER.createCanvas(),s=!0),r.width=3,r.height=3;const n=j.from(r);n.orig=new ot,n.trim=new ot,super(n),this._ownCanvas=s,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=Qd.defaultResolution??W.RESOLUTION,this._autoResolution=Qd.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return ir.experimentalLetterSpacing}static set experimentalLetterSpacing(t){ht("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ir.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const r=this.context,s=ir.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=s.width,a=s.height,o=s.lines,l=s.lineHeight,h=s.lineWidths,u=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+e.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;let c,f;const p=e.dropShadow?2:1;for(let y=0;y<p;++y){const x=e.dropShadow&&y===0,m=x?Math.ceil(Math.max(1,a)+e.padding*2):0,_=m*this._resolution;if(x){r.fillStyle="black",r.strokeStyle="black";const T=e.dropShadowColor,A=e.dropShadowBlur*this._resolution,S=e.dropShadowDistance*this._resolution;r.shadowColor=Tt.shared.setValue(T).setAlpha(e.dropShadowAlpha).toRgbaString(),r.shadowBlur=A,r.shadowOffsetX=Math.cos(e.dropShadowAngle)*S,r.shadowOffsetY=Math.sin(e.dropShadowAngle)*S+_}else r.fillStyle=this._generateFillStyle(e,o,s),r.strokeStyle=e.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let g=(l-d.fontSize)/2;l-d.fontSize<0&&(g=0);for(let T=0;T<o.length;T++)c=e.strokeThickness/2,f=e.strokeThickness/2+T*l+d.ascent+g,e.align==="right"?c+=u-h[T]:e.align==="center"&&(c+=(u-h[T])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[T],c+e.padding,f+e.padding-m,!0),e.fill&&this.drawLetterSpacing(o[T],c+e.padding,f+e.padding-m)}this.updateTexture()}drawLetterSpacing(t,e,r,s=!1){const n=this._style.letterSpacing;let a=!1;if(ir.experimentalLetterSpacingSupported&&(ir.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||a){s?this.context.strokeText(t,e,r):this.context.fillText(t,e,r);return}let o=e;const l=ir.graphemeSegmenter(t);let h=this.context.measureText(t).width,u=0;for(let d=0;d<l.length;++d){const c=l[d];s?this.context.strokeText(c,o,r):this.context.fillText(c,o,r);let f="";for(let p=d+1;p<l.length;++p)f+=l[p];u=this.context.measureText(f).width,o+=h-u+n,h=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const a=Vb(t);a.data&&(t.width=a.width,t.height=a.height,this.context.putImageData(a.data,0,0))}const e=this._texture,r=this._style,s=r.trim?0:r.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,r){const s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let n;const a=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,l=this.canvas.width/this._resolution-a-o*2,h=this.canvas.height/this._resolution-a-o*2,u=s.slice(),d=t.fillGradientStops.slice();if(!d.length){const c=u.length+1;for(let f=1;f<c;++f)d.push(f/c)}if(u.unshift(s[0]),d.unshift(0),u.push(s[s.length-1]),d.push(1),t.fillGradientType===Mh.LINEAR_VERTICAL){n=this.context.createLinearGradient(l/2,o,l/2,h+o);const c=r.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const p=r.lineHeight*(f-1)+c,y=r.lineHeight*f;let x=y;f>0&&p>y&&(x=(y+p)/2);const m=y+c,_=r.lineHeight*(f+1);let g=m;f+1<e.length&&_<m&&(g=(m+_)/2);const T=(g-x)/h;for(let A=0;A<u.length;A++){let S=0;typeof d[A]=="number"?S=d[A]:S=A/u.length;let w=Math.min(1,Math.max(0,x/h+S*T));w=Number(w.toFixed(5)),n.addColorStop(w,u[A])}}}else{n=this.context.createLinearGradient(o,h/2,l+o,h/2);const c=u.length+1;let f=1;for(let p=0;p<u.length;p++){let y;typeof d[p]=="number"?y=d[p]:y=f/c,n.addColorStop(y,u[p]),f++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},xR,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=ur(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=ur(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof ji?this._style=t:this._style=new ji(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};Hx.defaultAutoResolution=!0;let Jr=Hx;class TR{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function AR(i,t){var r;let e=!1;if((r=i==null?void 0:i._textures)!=null&&r.length){for(let s=0;s<i._textures.length;s++)if(i._textures[s]instanceof j){const n=i._textures[s].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function ER(i,t){if(i.baseTexture instanceof at){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function SR(i,t){if(i._texture&&i._texture instanceof j){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function wR(i,t){return t instanceof Jr?(t.updateText(!0),!0):!1}function bR(i,t){if(t instanceof ji){const e=t.toFontString();return ir.measureFont(e),!0}return!1}function CR(i,t){if(i instanceof Jr){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function IR(i,t){return i instanceof ji?(t.includes(i)||t.push(i),!0):!1}const zx=class Xx{constructor(t){this.limiter=new TR(Xx.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(CR),this.registerFindHook(IR),this.registerFindHook(AR),this.registerFindHook(ER),this.registerFindHook(SR),this.registerUploadHook(wR),this.registerUploadHook(bR)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,ce.system.addOnce(this.tick,this,hs.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)ce.system.addOnce(this.tick,this,hs.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,r=t.length;e<r;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Ft)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&ce.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};zx.uploadsPerFrame=4;let Jd=zx;Object.defineProperties(W,{UPLOADS_PER_FRAME:{get(){return Jd.uploadsPerFrame},set(i){ht("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Jd.uploadsPerFrame=i}}});function $x(i,t){return t instanceof at?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function DR(i,t){if(!(t instanceof Pa))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:r}=e;for(let s=0;s<r.length;s++){const{texture:n}=r[s].style;n&&$x(i,n.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function RR(i,t){return i instanceof Pa?(t.push(i),!0):!1}class Wx extends Jd{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(RR),this.registerUploadHook($x),this.registerUploadHook(DR)}}Wx.extension={name:"prepare",type:X.RendererSystem};q.add(Wx);var MR=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,PR=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,FR=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,xg=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,OR=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Oo=new kt;class Yx extends Ih{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new qv,this.state=Ii.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Si.from(xg,OR,e),this.shader=t.context.webGLVersion>1?Si.from(PR,MR,e):Si.from(xg,FR,e)}render(t){const e=this.renderer,r=this.quad;let s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;s=r.uvs,s[0]=s[6]=-n,s[1]=s[3]=-a,s[2]=s[4]=1-n,s[5]=s[7]=1-a,r.invalidate();const o=t._texture,l=o.baseTexture,h=l.alphaMode>0,u=t.tileTransform.localTransform,d=t.uvMatrix;let c=l.isPowerOfTwo&&o.frame.width===l.width&&o.frame.height===l.height;c&&(l._glTextures[e.CONTEXT_UID]?c=l.wrapMode!==Tr.CLAMP:l.wrapMode===Tr.CLAMP&&(l.wrapMode=Tr.REPEAT));const f=c?this.simpleShader:this.shader,p=o.width,y=o.height,x=t._width,m=t._height;Oo.set(u.a*p/x,u.b*p/m,u.c*y/x,u.d*y/m,u.tx/x,u.ty/m),Oo.invert(),c?Oo.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=Oo.toArray(!0),f.uniforms.uColor=Tt.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=o,e.shader.bind(f),e.geometry.bind(r),this.state.blendMode=Bv(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Yx.extension={name:"tilingSprite",type:X.RendererPlugin};q.add(Yx);const jx=class Yn{constructor(t,e,r){this.linkedSheets=[],(t instanceof at||t instanceof j)&&(t={texture:t,data:e,resolutionFilename:r});const{texture:s,data:n,resolutionFilename:a=null,cachePrefix:o=""}=t;this.cachePrefix=o,this._texture=s instanceof j?s:null,this.baseTexture=s instanceof at?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;const l=this.baseTexture.resource;this.resolution=this._updateResolution(a||(l?l.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let r=Wi(t,null);return r===null&&(r=typeof e=="number"?e:parseFloat(e??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Yn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const r=Yn.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const s=this._frameKeys[e],n=this._frames[s],a=n.frame;if(a){let o=null,l=null;const h=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,u=new ot(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);n.rotated?o=new ot(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new ot(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new ot(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new j(this.baseTexture,o,u,l,n.rotated?2:0,n.anchor,n.borders),j.addToCache(this.textures[s],this.cachePrefix+s.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const s=t[e][r];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Yn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Yn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};jx.BATCH_SIZE=1e3;let Tg=jx;const BR=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function qx(i,t,e){const r={};if(i.forEach(s=>{r[s]=t}),Object.keys(t.textures).forEach(s=>{r[`${t.cachePrefix}${s}`]=t.textures[s]}),!e){const s=Kt.dirname(i[0]);t.linkedSheets.forEach((n,a)=>{Object.assign(r,qx([`${s}/${t.data.meta.related_multi_packs[a]}`],n,!0))})}return r}const kR={extension:X.Asset,cache:{test:i=>i instanceof Tg,getCacheableAssets:(i,t)=>qx(i,t,!1)},resolver:{test:i=>{const t=i.split("?")[0].split("."),e=t.pop(),r=t.pop();return e==="json"&&BR.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=W.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:X.LoadParser,priority:ri.Normal},async testParse(i,t){return Kt.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var u,d;const{texture:r,imageFilename:s,cachePrefix:n}=(t==null?void 0:t.data)??{};let a=Kt.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let o;if(r&&r.baseTexture)o=r;else{const c=Wd(a+(s??i.meta.image),t.src);o=(await e.load([c]))[c]}const l=new Tg({texture:o.baseTexture,data:i,resolutionFilename:t.src,cachePrefix:n});await l.parse();const h=(u=i==null?void 0:i.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(h)){const c=[];for(const p of h){if(typeof p!="string")continue;let y=a+p;(d=t.data)!=null&&d.ignoreMultiPack||(y=Wd(y,t.src),c.push(e.load({src:y,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(c);l.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[l].concat(l.linkedSheets.filter(y=>y!==p))})}return l},unload(i){i.destroy(!0)}}};q.add(kR);class eh{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class al{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const a=e[n].match(/^[a-z]+/gm)[0],o=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const h in o){const u=o[h].split("="),d=u[0],c=u[1].replace(/"/gm,""),f=parseFloat(c),p=isNaN(f)?c:f;l[d]=p}r[a].push(l)}const s=new eh;return r.info.forEach(n=>s.info.push({face:n.face,size:parseInt(n.size,10)})),r.common.forEach(n=>s.common.push({lineHeight:parseInt(n.lineHeight,10)})),r.page.forEach(n=>s.page.push({id:parseInt(n.id,10),file:n.file})),r.char.forEach(n=>s.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),r.kerning.forEach(n=>s.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),r.distanceField.forEach(n=>s.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),s}}class tf{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new eh,r=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField");for(let h=0;h<r.length;h++)e.info.push({face:r[h].getAttribute("face"),size:parseInt(r[h].getAttribute("size"),10)});for(let h=0;h<s.length;h++)e.common.push({lineHeight:parseInt(s[h].getAttribute("lineHeight"),10)});for(let h=0;h<n.length;h++)e.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(let h=0;h<a.length;h++){const u=a[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let h=0;h<o.length;h++)e.kerning.push({first:parseInt(o[h].getAttribute("first"),10),second:parseInt(o[h].getAttribute("second"),10),amount:parseInt(o[h].getAttribute("amount"),10)});for(let h=0;h<l.length;h++)e.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return e}}class ef{static test(t){return typeof t=="string"&&t.includes("<font>")?tf.test(W.ADAPTER.parseXML(t)):!1}static parse(t){return tf.parse(W.ADAPTER.parseXML(t))}}const ic=[al,tf,ef];function NR(i){for(let t=0;t<ic.length;t++)if(ic[t].test(i))return ic[t];return null}function LR(i,t,e,r,s,n){const a=e.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let o;const l=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,u=i.width/r-l-h*2,d=i.height/r-l-h*2,c=a.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=c.length+1;for(let y=1;y<p;++y)f.push(y/p)}if(c.unshift(a[0]),f.unshift(0),c.push(a[a.length-1]),f.push(1),e.fillGradientType===Mh.LINEAR_VERTICAL){o=t.createLinearGradient(u/2,h,u/2,d+h);let p=0;const y=(n.fontProperties.fontSize+e.strokeThickness)/d;for(let x=0;x<s.length;x++){const m=n.lineHeight*x;for(let _=0;_<c.length;_++){let g=0;typeof f[_]=="number"?g=f[_]:g=_/c.length;const T=m/d+g*y;let A=Math.max(p,T);A=Math.min(A,1),o.addColorStop(A,c[_]),p=A}}}else{o=t.createLinearGradient(h,d/2,u+h,d/2);const p=c.length+1;let y=1;for(let x=0;x<c.length;x++){let m;typeof f[x]=="number"?m=f[x]:m=y/p,o.addColorStop(m,c[x]),y++}}return o}function UR(i,t,e,r,s,n,a){const o=e.text,l=e.fontProperties;t.translate(r,s),t.scale(n,n);const h=a.strokeThickness/2,u=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=LR(i,t,a,n,[o],e),t.strokeStyle=a.stroke,a.dropShadow){const d=a.dropShadowColor,c=a.dropShadowBlur*n,f=a.dropShadowDistance*n;t.shadowColor=Tt.shared.setValue(d).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=c,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(o,h,u+e.lineHeight-l.descent),a.fill&&t.fillText(o,h,u+e.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function ol(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function Kx(i){return Array.from?Array.from(i):i.split("")}function GR(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,r=i.length;e<r;e++){const s=i[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const n=s[0].charCodeAt(0),a=s[1].charCodeAt(0);if(a<n)throw new Error("[BitmapFont]: Invalid character range.");for(let o=n,l=a;o<=l;o++)t.push(String.fromCharCode(o))}else t.push(...Kx(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Qi=class di{constructor(t,e,r){var u;const[s]=t.info,[n]=t.common,[a]=t.page,[o]=t.distanceField,l=Wi(a.file),h={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=n.lineHeight/l,this.chars={},this.pageTextures=h;for(let d=0;d<t.page.length;d++){const{id:c,file:f}=t.page[d];h[c]=e instanceof Array?e[d]:e[f],o!=null&&o.fieldType&&o.fieldType!=="none"&&(h[c].baseTexture.alphaMode=ve.NO_PREMULTIPLIED_ALPHA,h[c].baseTexture.mipmap=bi.OFF)}for(let d=0;d<t.char.length;d++){const{id:c,page:f}=t.char[d];let{x:p,y,width:x,height:m,xoffset:_,yoffset:g,xadvance:T}=t.char[d];p/=l,y/=l,x/=l,m/=l,_/=l,g/=l,T/=l;const A=new ot(p+h[f].frame.x/l,y+h[f].frame.y/l,x,m);this.chars[c]={xOffset:_,yOffset:g,xAdvance:T,kerning:{},texture:new j(h[f].baseTexture,A),page:f}}for(let d=0;d<t.kerning.length;d++){let{first:c,second:f,amount:p}=t.kerning[d];c/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[c]=p)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((u=o==null?void 0:o.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,r){let s;if(t instanceof eh)s=t;else{const a=NR(t);if(!a)throw new Error("Unrecognized data format for font.");s=a.parse(t)}e instanceof j&&(e=[e]);const n=new di(s,e,r);return di.available[n.font]=n,n}static uninstall(t){const e=di.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete di.available[t]}static from(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:n,resolution:a,textureWidth:o,textureHeight:l,...h}=Object.assign({},di.defaultOptions,r),u=GR(s),d=e instanceof ji?e:new ji(e),c=o,f=new eh;f.info[0]={face:d.fontFamily,size:d.fontSize},f.common[0]={lineHeight:d.fontSize};let p=0,y=0,x,m,_,g=0;const T=[];for(let S=0;S<u.length;S++){x||(x=W.ADAPTER.createCanvas(),x.width=o,x.height=l,m=x.getContext("2d"),_=new at(x,{resolution:a,...h}),T.push(new j(_)),f.page.push({id:T.length-1,file:""}));const w=u[S],E=ir.measureText(w,d,!1,x),C=E.width,D=Math.ceil(E.height),k=Math.ceil((d.fontStyle==="italic"?2:1)*C);if(y>=l-D*a){if(y===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${w}')`);--S,x=null,m=null,_=null,y=0,p=0,g=0;continue}if(g=Math.max(D+E.fontProperties.descent,g),k*a+p>=c){if(p===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${w}')`);--S,y+=g*a,y=Math.ceil(y),p=0,g=0;continue}UR(x,m,E,p,y,a,d);const F=ol(E.text);f.char.push({id:F,page:T.length-1,x:p/a,y:y/a,width:k,height:D,xoffset:0,yoffset:0,xadvance:C-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),p+=(k+2*n)*a,p=Math.ceil(p)}if(!(r!=null&&r.skipKerning))for(let S=0,w=u.length;S<w;S++){const E=u[S];for(let C=0;C<w;C++){const D=u[C],k=m.measureText(E).width,F=m.measureText(D).width,b=m.measureText(E+D).width-(k+F);b&&f.kerning.push({first:ol(E),second:ol(D),amount:b})}}const A=new di(f,T,!0);return di.available[t]!==void 0&&di.uninstall(t),di.available[t]=A,A}};Qi.ALPHA=[["a","z"],["A","Z"]," "],Qi.NUMERIC=[["0","9"]],Qi.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Qi.ASCII=[[" ","~"]],Qi.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Qi.ALPHANUMERIC},Qi.available={};let Ji=Qi;var VR=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,HR=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Ag=[],Eg=[],Sg=[],zR=class Zx extends Ft{constructor(t,e={}){super();const{align:r,tint:s,maxWidth:n,letterSpacing:a,fontName:o,fontSize:l}=Object.assign({},Zx.styleDefaults,e);if(!Ji.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new Tt(s),this._font=void 0,this._fontName=o,this._fontSize=l,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new Li(()=>{this.dirty=!0},this,0,0),this._roundPixels=W.ROUND_PIXELS,this.dirty=!0,this._resolution=W.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var k;const t=Ji.available[this._fontName],e=this.fontSize,r=e/t.size,s=new mt,n=[],a=[],o=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=Kx(l),u=this._maxWidth*t.size/e,d=t.distanceFieldType==="none"?Ag:Eg;let c=null,f=0,p=0,y=0,x=-1,m=0,_=0,g=0,T=0;for(let F=0;F<h.length;F++){const b=h[F],P=ol(b);if(/(?:\s)/.test(b)&&(x=F,m=f,T++),b==="\r"||b===`
`){a.push(f),o.push(-1),p=Math.max(p,f),++y,++_,s.x=0,s.y+=t.lineHeight,c=null,T=0;continue}const N=t.chars[P];if(!N)continue;c&&N.kerning[c]&&(s.x+=N.kerning[c]);const H=Sg.pop()||{texture:j.EMPTY,line:0,charCode:0,prevSpaces:0,position:new mt};H.texture=N.texture,H.line=y,H.charCode=P,H.position.x=Math.round(s.x+N.xOffset+this._letterSpacing/2),H.position.y=Math.round(s.y+N.yOffset),H.prevSpaces=T,n.push(H),f=H.position.x+Math.max(N.xAdvance-N.xOffset,N.texture.orig.width),s.x+=N.xAdvance+this._letterSpacing,g=Math.max(g,N.yOffset+N.texture.height),c=P,x!==-1&&u>0&&s.x>u&&(++_,Js(n,1+x-_,1+F-x),F=x,x=-1,a.push(m),o.push(n.length>0?n[n.length-1].prevSpaces:0),p=Math.max(p,m),y++,s.x=0,s.y+=t.lineHeight,c=null,T=0)}const A=h[h.length-1];A!=="\r"&&A!==`
`&&(/(?:\s)/.test(A)&&(f=m),a.push(f),p=Math.max(p,f),o.push(-1));const S=[];for(let F=0;F<=y;F++){let b=0;this._align==="right"?b=p-a[F]:this._align==="center"?b=(p-a[F])/2:this._align==="justify"&&(b=o[F]<0?0:(p-a[F])/o[F]),S.push(b)}const w=n.length,E={},C=[],D=this._activePagesMeshData;d.push(...D);for(let F=0;F<w;F++){const b=n[F].texture,P=b.baseTexture.uid;if(!E[P]){let N=d.pop();if(!N){const U=new Lx;let R,V;t.distanceFieldType==="none"?(R=new Zd(j.EMPTY),V=Z.NORMAL):(R=new Zd(j.EMPTY,{program:Ui.from(HR,VR),uniforms:{uFWidth:0}}),V=Z.NORMAL_NPM);const M=new Kd(U,R);M.blendMode=V,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:M,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;const{_textureCache:H}=this;H[P]=H[P]||new j(b.baseTexture),N.mesh.texture=H[P],N.mesh.tint=this._tintColor.value,C.push(N),E[P]=N}E[P].total++}for(let F=0;F<D.length;F++)C.includes(D[F])||this.removeChild(D[F].mesh);for(let F=0;F<C.length;F++)C[F].mesh.parent!==this&&this.addChild(C[F].mesh);this._activePagesMeshData=C;for(const F in E){const b=E[F],P=b.total;if(!(((k=b.indices)==null?void 0:k.length)>6*P)||b.vertices.length<Kd.BATCHABLE_SIZE*2)b.vertices=new Float32Array(4*2*P),b.uvs=new Float32Array(4*2*P),b.indices=new Uint16Array(6*P);else{const N=b.total,H=b.vertices;for(let U=N*4*2;U<H.length;U++)H[U]=0}b.mesh.size=6*P}for(let F=0;F<w;F++){const b=n[F];let P=b.position.x+S[b.line]*(this._align==="justify"?b.prevSpaces:1);this._roundPixels&&(P=Math.round(P));const N=P*r,H=b.position.y*r,U=b.texture,R=E[U.baseTexture.uid],V=U.frame,M=U._uvs,B=R.index++;R.indices[B*6+0]=0+B*4,R.indices[B*6+1]=1+B*4,R.indices[B*6+2]=2+B*4,R.indices[B*6+3]=0+B*4,R.indices[B*6+4]=2+B*4,R.indices[B*6+5]=3+B*4,R.vertices[B*8+0]=N,R.vertices[B*8+1]=H,R.vertices[B*8+2]=N+V.width*r,R.vertices[B*8+3]=H,R.vertices[B*8+4]=N+V.width*r,R.vertices[B*8+5]=H+V.height*r,R.vertices[B*8+6]=N,R.vertices[B*8+7]=H+V.height*r,R.uvs[B*8+0]=M.x0,R.uvs[B*8+1]=M.y0,R.uvs[B*8+2]=M.x1,R.uvs[B*8+3]=M.y1,R.uvs[B*8+4]=M.x2,R.uvs[B*8+5]=M.y2,R.uvs[B*8+6]=M.x3,R.uvs[B*8+7]=M.y3}this._textWidth=p*r,this._textHeight=(s.y+t.lineHeight)*r;for(const F in E){const b=E[F];if(this.anchor.x!==0||this.anchor.y!==0){let U=0;const R=this._textWidth*this.anchor.x,V=this._textHeight*this.anchor.y;for(let M=0;M<b.total;M++)b.vertices[U++]-=R,b.vertices[U++]-=V,b.vertices[U++]-=R,b.vertices[U++]-=V,b.vertices[U++]-=R,b.vertices[U++]-=V,b.vertices[U++]-=R,b.vertices[U++]-=V}this._maxLineHeight=g*r;const P=b.mesh.geometry.getBuffer("aVertexPosition"),N=b.mesh.geometry.getBuffer("aTextureCoord"),H=b.mesh.geometry.getIndex();P.data=b.vertices,N.data=b.uvs,H.data=b.indices,P.update(),N.update(),H.update()}for(let F=0;F<n.length;F++)Sg.push(n[F]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:r,size:s}=Ji.available[this._fontName];if(r!=="none"){const{a:n,b:a,c:o,d:l}=this.worldTransform,h=Math.sqrt(n*n+a*a),u=Math.sqrt(o*o+l*l),d=(Math.abs(h)+Math.abs(u))/2,c=this.fontSize/s,f=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=d*e*c*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Ji.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Ji.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Ji.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,r=Ji.available[this._fontName].distanceFieldType==="none"?Ag:Eg;r.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],r.filter(s=>e[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=j.EMPTY});for(const s in e)e[s].destroy(),delete e[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};zR.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const XR=[".xml",".fnt"],$R={extension:{type:X.LoadParser,priority:ri.Normal},name:"loadBitmapFont",test(i){return XR.includes(Kt.extname(i).toLowerCase())},async testParse(i){return al.test(i)||ef.test(i)},async parse(i,t,e){const r=al.test(i)?al.parse(i):ef.parse(i),{src:s}=t,{page:n}=r,a=[];for(let h=0;h<n.length;++h){const u=n[h].file;let d=Kt.join(Kt.dirname(s),u);d=Wd(d,s),a.push(d)}const o=await e.load(a),l=a.map(h=>o[h]);return Ji.install(r,l,!0)},async load(i,t){return(await W.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};q.add($R);const rf=class Cs extends ji{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Cs(Object.keys(Cs.defaultOptions).reduce((e,r)=>({...e,[r]:t[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Cs.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:r}=Cs;if(r[t]){const s=r[t];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return W.ADAPTER.fetch(t).then(s=>s.blob()).then(async s=>new Promise((n,a)=>{const o=URL.createObjectURL(s),l=new FileReader;l.onload=()=>n([o,l.result]),l.onerror=a,l.readAsDataURL(s)})).then(async([s,n])=>{const a=Object.assign({family:Kt.basename(t,Kt.extname(t)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);r[t]=a,this._fonts.push(a),this.styleID++;const o=new FontFace(a.family,`url(${a.src})`,{weight:a.weight,style:a.style,display:a.display});a.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(r=>!this._overrides.includes(r));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(r=>this._overrides.includes(r));e.length>0&&(this._overrides=this._overrides.filter(r=>!e.includes(r)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Bb(t)),typeof t=="number"?Ob(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const n=`${r}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,Cs.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=W.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};rf.availableFonts={},rf.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let rc=rf;const Bo=class Is extends fe{constructor(t="",e={}){super(j.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const r=new Image,s=j.from(r,{scaleMode:W.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new ot,s.trim=new ot,this.texture=s;const n="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",o=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject"),h=document.createElementNS(a,"div"),u=document.createElementNS(a,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",o.appendChild(l),this.maxWidth=Is.defaultMaxWidth,this.maxHeight=Is.defaultMaxHeight,this._domElement=h,this._styleElement=u,this._svgRoot=o,this._foreignObject=l,this._foreignObject.appendChild(u),this._foreignObject.appendChild(h),this._image=r,this._loadImage=new Image,this._autoResolution=Is.defaultAutoResolution,this._resolution=Is.defaultResolution??W.RESOLUTION,this.text=t,this.style=e}measureText(t){var u,d;const{text:e,style:r,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:r.toCSS(s)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:a,height:o}=n;(a>this.maxWidth||o>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(a)),h=Math.min(this.maxHeight,Math.ceil(o));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",h.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(s)}),this._styleElement.textContent=(d=this._style)==null?void 0:d.toGlobalCSS()),{width:l+r.padding*2,height:h+r.padding*2}}async updateText(t=!0){const{style:e,_image:r,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:a}=this.measureText();r.width=s.width=Math.ceil(Math.max(1,n)),r.height=s.height=Math.ceil(Math.max(1,a)),this._updateID++;const o=this._updateID;await new Promise(l=>{s.onload=async()=>{if(o<this._updateID){l();return}await e.onBeforeDraw(),r.src=s.src,s.onload=null,s.src="",this.updateTexture(),l()};const h=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(h)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:r,resolution:s}=this,{padding:n}=t,{baseTexture:a}=e;e.trim.width=e._frame.width=r.width/s,e.trim.height=e._frame.height=r.height/s,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),a.setRealSize(r.width,r.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var r,s,n,a,o;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Is.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((r=this._style)==null||r.cleanFonts()),this._style=e,(s=this._svgRoot)==null||s.remove(),this._svgRoot=e,(n=this._domElement)==null||n.remove(),this._domElement=e,(a=this._foreignObject)==null||a.remove(),this._foreignObject=e,(o=this._styleElement)==null||o.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=ur(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=ur(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof rc?(this.ownsStyle=!1,this._style=t):t instanceof ji?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=rc.from(t)):(this.ownsStyle=!0,this._style=new rc(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Bo.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Bo.defaultMaxWidth=2024,Bo.defaultMaxHeight=2024,Bo.defaultAutoResolution=!0;class O{constructor(){this.hashCode=O._hashCode++,this._isInPool=!1}static _returnObject(t){const e=t.constructor.toString(),r=e in O._maxCountMap?O._maxCountMap[e]:O._defaultMaxCount,s=O._poolsMap[e]=O._poolsMap[e]||[];s.length<r&&(t._isInPool?console.warn("The object is already in the pool."):(t._isInPool=!0,s.push(t)))}static toString(){throw new Error}static setMaxCount(t,e){if((e<0||e!==e)&&(e=0),t!==null){const r=t.toString(),s=r in O._poolsMap?O._poolsMap[r]:null;s!==null&&s.length>e&&(s.length=e),O._maxCountMap[r]=e}else{O._defaultMaxCount=e;for(let r in O._poolsMap){const s=O._poolsMap[r];s.length>e&&(s.length=e),r in O._maxCountMap&&(O._maxCountMap[r]=e)}}}static clearPool(t=null){if(t!==null){const e=t.toString(),r=e in O._poolsMap?O._poolsMap[e]:null;r!==null&&r.length>0&&(r.length=0)}else for(let e in O._poolsMap){const r=O._poolsMap[e];r.length=0}}static borrowObject(t){const e=t.toString(),r=e in O._poolsMap?O._poolsMap[e]:null;if(r!==null&&r.length>0){const n=r.pop();return n._isInPool=!1,n}const s=new t;return s._onClear(),s}returnToPool(){this._onClear(),O._returnObject(this)}}O._hashCode=0;O._defaultMaxCount=3e3;O._maxCountMap={};O._poolsMap={};class lt extends O{static actionDataToInstance(t,e,r){t.type===0?e.type=lt.FRAME_EVENT:e.type=t.type===10?lt.FRAME_EVENT:lt.SOUND_EVENT,e.name=t.name,e.armature=r,e.actionData=t,e.data=t.data,t.bone!==null&&(e.bone=r.getBone(t.bone.name)),t.slot!==null&&(e.slot=r.getSlot(t.slot.name))}static toString(){return"[class dragonBones.EventObject]"}_onClear(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null}}lt.START="start";lt.LOOP_COMPLETE="loopComplete";lt.COMPLETE="complete";lt.FADE_IN="fadeIn";lt.FADE_IN_COMPLETE="fadeInComplete";lt.FADE_OUT="fadeOut";lt.FADE_OUT_COMPLETE="fadeOutComplete";lt.FRAME_EVENT="frameEvent";lt.SOUND_EVENT="soundEvent";class Be{constructor(t){this._clock=new _M,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=t}advanceTime(t){if(this._objects.length>0){for(const e of this._objects)e.returnToPool();this._objects.length=0}if(this._clock.advanceTime(t),this._events.length>0){for(let e=0;e<this._events.length;++e){const r=this._events[e],s=r.armature;s._armatureData!==null&&(s.eventDispatcher.dispatchDBEvent(r.type,r),r.type===lt.SOUND_EVENT&&this._eventManager.dispatchDBEvent(r.type,r)),this.bufferObject(r)}this._events.length=0}}bufferEvent(t){this._events.indexOf(t)<0&&this._events.push(t)}bufferObject(t){this._objects.indexOf(t)<0&&this._objects.push(t)}get clock(){return this._clock}get eventManager(){return this._eventManager}}Be.VERSION="5.7.000";Be.yDown=!0;Be.debug=!1;Be.debugDraw=!1;class WR extends O{constructor(){super(...arguments),this.boneMask=[]}static toString(){return"[class dragonBones.AnimationConfig]"}_onClear(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additive=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0}clear(){this._onClear()}copyFrom(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additive=t.additive,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(let e=0,r=this.boneMask.length;e<r;++e)this.boneMask[e]=t.boneMask[e]}}class Qx extends O{constructor(){super(...arguments),this.cachedFrames=[],this.boneTimelines={},this.slotTimelines={},this.constraintTimelines={},this.animationTimelines={},this.boneCachedFrameIndices={},this.slotCachedFrameIndices={},this.actionTimeline=null,this.zOrderTimeline=null}static toString(){return"[class dragonBones.AnimationData]"}_onClear(){for(let t in this.boneTimelines){for(const e of this.boneTimelines[t])e.returnToPool();delete this.boneTimelines[t]}for(let t in this.slotTimelines){for(const e of this.slotTimelines[t])e.returnToPool();delete this.slotTimelines[t]}for(let t in this.constraintTimelines){for(const e of this.constraintTimelines[t])e.returnToPool();delete this.constraintTimelines[t]}for(let t in this.animationTimelines){for(const e of this.animationTimelines[t])e.returnToPool();delete this.animationTimelines[t]}for(let t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(let t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];this.actionTimeline!==null&&this.actionTimeline.returnToPool(),this.zOrderTimeline!==null&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.blendType=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null}cacheFrames(t){if(this.cacheFrameRate>0)return;this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);const e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(let r=0,s=this.cacheFrames.length;r<s;++r)this.cachedFrames[r]=!1;for(const r of this.parent.sortedBones){const s=new Array(e);for(let n=0,a=s.length;n<a;++n)s[n]=-1;this.boneCachedFrameIndices[r.name]=s}for(const r of this.parent.sortedSlots){const s=new Array(e);for(let n=0,a=s.length;n<a;++n)s[n]=-1;this.slotCachedFrameIndices[r.name]=s}}addBoneTimeline(t,e){const r=t in this.boneTimelines?this.boneTimelines[t]:this.boneTimelines[t]=[];r.indexOf(e)<0&&r.push(e)}addSlotTimeline(t,e){const r=t in this.slotTimelines?this.slotTimelines[t]:this.slotTimelines[t]=[];r.indexOf(e)<0&&r.push(e)}addConstraintTimeline(t,e){const r=t in this.constraintTimelines?this.constraintTimelines[t]:this.constraintTimelines[t]=[];r.indexOf(e)<0&&r.push(e)}addAnimationTimeline(t,e){const r=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];r.indexOf(e)<0&&r.push(e)}getBoneTimelines(t){return t in this.boneTimelines?this.boneTimelines[t]:null}getSlotTimelines(t){return t in this.slotTimelines?this.slotTimelines[t]:null}getConstraintTimelines(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null}getAnimationTimelines(t){return t in this.animationTimelines?this.animationTimelines[t]:null}getBoneCachedFrameIndices(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null}getSlotCachedFrameIndices(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null}}class Tp extends O{static toString(){return"[class dragonBones.TimelineData]"}_onClear(){this.type=10,this.offset=0,this.frameIndicesOffset=-1}}class Jx extends Tp{static toString(){return"[class dragonBones.AnimationTimelineData]"}_onClear(){super._onClear(),this.x=0,this.y=0}}class Ph{constructor(t=1,e=1,r=1,s=1,n=0,a=0,o=0,l=0){this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=r,this.blueMultiplier=s,this.alphaOffset=n,this.redOffset=a,this.greenOffset=o,this.blueOffset=l}copyFrom(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset}identity(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0}}class mn{constructor(t=1,e=0,r=0,s=1,n=0,a=0){this.a=t,this.b=e,this.c=r,this.d=s,this.tx=n,this.ty=a}toString(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}copyFromArray(t,e=0){return this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this}identity(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this}concat(t){let e=this.a*t.a,r=0,s=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;return(this.b!==0||this.c!==0)&&(e+=this.b*t.c,r+=this.b*t.d,s+=this.c*t.a,n+=this.c*t.b),(t.b!==0||t.c!==0)&&(r+=this.a*t.b,s+=this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=r,this.c=s,this.d=n,this.tx=a,this.ty=o,this}invert(){let t=this.a,e=this.b,r=this.c,s=this.d;const n=this.tx,a=this.ty;if(e===0&&r===0)return this.b=this.c=0,t===0||s===0?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,s=this.d=1/s,this.tx=-t*n,this.ty=-s*a),this;let o=t*s-e*r;if(o===0)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;o=1/o;let l=this.a=s*o;return e=this.b=-e*o,r=this.c=-r*o,s=this.d=t*o,this.tx=-(l*n+r*a),this.ty=-(e*n+s*a),this}transformPoint(t,e,r,s=!1){r.x=this.a*t+this.c*e,r.y=this.b*t+this.d*e,s||(r.x+=this.tx,r.y+=this.ty)}transformRectangle(t,e=!1){const r=this.a,s=this.b,n=this.c,a=this.d,o=e?0:this.tx,l=e?0:this.ty,h=t.x,u=t.y,d=h+t.width,c=u+t.height;let f=r*h+n*u+o,p=s*h+a*u+l,y=r*d+n*u+o,x=s*d+a*u+l,m=r*d+n*c+o,_=s*d+a*c+l,g=r*h+n*c+o,T=s*h+a*c+l,A=0;f>y&&(A=f,f=y,y=A),m>g&&(A=m,m=g,g=A),t.x=Math.floor(f<m?f:m),t.width=Math.ceil((y>g?y:g)-t.x),p>x&&(A=p,p=x,x=A),_>T&&(A=_,_=T,T=A),t.y=Math.floor(p<_?p:_),t.height=Math.ceil((x>T?x:T)-t.y)}}class Fh{constructor(t=0,e=0){this.x=t,this.y=e}copyFrom(t){this.x=t.x,this.y=t.y}clear(){this.x=this.y=0}}class sf{constructor(t=0,e=0,r=0,s=0){this.x=t,this.y=e,this.width=r,this.height=s}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}clear(){this.x=this.y=0,this.width=this.height=0}}class rt{constructor(t=0,e=0,r=0,s=0,n=1,a=1){this.x=t,this.y=e,this.skew=r,this.rotation=s,this.scaleX=n,this.scaleY=a}static normalizeRadian(t){return t=(t+Math.PI)%(Math.PI*2),t+=t>0?-Math.PI:Math.PI,t}toString(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+this.skew*180/Math.PI+" skewY:"+this.rotation*180/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY}copyFrom(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}identity(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this}add(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this}minus(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this}fromMatrix(t){const e=this.scaleX,r=this.scaleY,s=rt.PI_Q;this.x=t.tx,this.y=t.ty,this.rotation=Math.atan(t.b/t.a);let n=Math.atan(-t.c/t.d);return this.scaleX=this.rotation>-s&&this.rotation<s?t.a/Math.cos(this.rotation):t.b/Math.sin(this.rotation),this.scaleY=n>-s&&n<s?t.d/Math.cos(n):-t.c/Math.sin(n),e>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),r>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,n=n-Math.PI),this.skew=n-this.rotation,this}toMatrix(t){return this.rotation===0?(t.a=1,t.b=0):(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation)),this.skew===0?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),this.scaleX!==1&&(t.a*=this.scaleX,t.b*=this.scaleX),this.scaleY!==1&&(t.c*=this.scaleY,t.d*=this.scaleY),t.tx=this.x,t.ty=this.y,this}}rt.PI=Math.PI;rt.PI_D=Math.PI*2;rt.PI_H=Math.PI/2;rt.PI_Q=Math.PI/4;rt.RAD_DEG=180/Math.PI;rt.DEG_RAD=Math.PI/180;class Ap{constructor(){this.weight=null}clear(){!this.isShared&&this.weight!==null&&this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null}shareFrom(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight}get vertexCount(){return this.data.intArray[this.offset+0]}get triangleCount(){return this.data.intArray[this.offset+1]}}class Xa extends O{constructor(){super(...arguments),this.transform=new rt}_onClear(){this.name="",this.path="",this.transform.identity(),this.parent=null}}class YR extends Xa{constructor(){super(...arguments),this.pivot=new Fh}static toString(){return"[class dragonBones.ImageDisplayData]"}_onClear(){super._onClear(),this.type=0,this.pivot.clear(),this.texture=null}}class jR extends Xa{constructor(){super(...arguments),this.actions=[]}static toString(){return"[class dragonBones.ArmatureDisplayData]"}_onClear(){super._onClear();for(const t of this.actions)t.returnToPool();this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null}addAction(t){this.actions.push(t)}}class qR extends Xa{constructor(){super(...arguments),this.geometry=new Ap}static toString(){return"[class dragonBones.MeshDisplayData]"}_onClear(){super._onClear(),this.type=2,this.geometry.clear(),this.texture=null}}class KR extends Xa{constructor(){super(...arguments),this.boundingBox=null}static toString(){return"[class dragonBones.BoundingBoxDisplayData]"}_onClear(){super._onClear(),this.boundingBox!==null&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null}}class wg extends Xa{constructor(){super(...arguments),this.geometry=new Ap,this.curveLengths=[]}static toString(){return"[class dragonBones.PathDisplayData]"}_onClear(){super._onClear(),this.type=4,this.closed=!1,this.constantSpeed=!1,this.geometry.clear(),this.curveLengths.length=0}}class tT extends O{constructor(){super(...arguments),this.bones=[]}static toString(){return"[class dragonBones.WeightData]"}_onClear(){this.count=0,this.offset=0,this.bones.length=0}addBone(t){this.bones.push(t)}}class ZR extends O{constructor(){super(...arguments),this.aabb=new sf,this.animationNames=[],this.sortedBones=[],this.sortedSlots=[],this.defaultActions=[],this.actions=[],this.bones={},this.slots={},this.constraints={},this.skins={},this.animations={},this.canvas=null,this.userData=null}static toString(){return"[class dragonBones.ArmatureData]"}_onClear(){for(const t of this.defaultActions)t.returnToPool();for(const t of this.actions)t.returnToPool();for(let t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(let t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(let t in this.constraints)this.constraints[t].returnToPool(),delete this.constraints[t];for(let t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(let t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];this.canvas!==null&&this.canvas.returnToPool(),this.userData!==null&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null}sortBones(){const t=this.sortedBones.length;if(t<=0)return;const e=this.sortedBones.concat();let r=0,s=0;for(this.sortedBones.length=0;s<t;){const n=e[r++];if(r>=t&&(r=0),this.sortedBones.indexOf(n)>=0)continue;let a=!1;for(let o in this.constraints){const l=this.constraints[o];if(l.root===n&&this.sortedBones.indexOf(l.target)<0){a=!0;break}}a||n.parent!==null&&this.sortedBones.indexOf(n.parent)<0||(this.sortedBones.push(n),s++)}}cacheFrames(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=t;for(let e in this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)}}setCacheFrame(t,e){const r=this.parent.cachedFrames;let s=r.length;return r.length+=10,r[s]=t.a,r[s+1]=t.b,r[s+2]=t.c,r[s+3]=t.d,r[s+4]=t.tx,r[s+5]=t.ty,r[s+6]=e.rotation,r[s+7]=e.skew,r[s+8]=e.scaleX,r[s+9]=e.scaleY,s}getCacheFrame(t,e,r){const s=this.parent.cachedFrames;t.a=s[r],t.b=s[r+1],t.c=s[r+2],t.d=s[r+3],t.tx=s[r+4],t.ty=s[r+5],e.rotation=s[r+6],e.skew=s[r+7],e.scaleX=s[r+8],e.scaleY=s[r+9],e.x=t.tx,e.y=t.ty}addBone(t){if(t.name in this.bones){console.warn("Same bone: "+t.name);return}this.bones[t.name]=t,this.sortedBones.push(t)}addSlot(t){if(t.name in this.slots){console.warn("Same slot: "+t.name);return}this.slots[t.name]=t,this.sortedSlots.push(t)}addConstraint(t){if(t.name in this.constraints){console.warn("Same constraint: "+t.name);return}this.constraints[t.name]=t}addSkin(t){if(t.name in this.skins){console.warn("Same skin: "+t.name);return}t.parent=this,this.skins[t.name]=t,this.defaultSkin===null&&(this.defaultSkin=t),t.name==="default"&&(this.defaultSkin=t)}addAnimation(t){if(t.name in this.animations){console.warn("Same animation: "+t.name);return}t.parent=this,this.animations[t.name]=t,this.animationNames.push(t.name),this.defaultAnimation===null&&(this.defaultAnimation=t)}addAction(t,e){e?this.defaultActions.push(t):this.actions.push(t)}getBone(t){return t in this.bones?this.bones[t]:null}getSlot(t){return t in this.slots?this.slots[t]:null}getConstraint(t){return t in this.constraints?this.constraints[t]:null}getSkin(t){return t in this.skins?this.skins[t]:null}getMesh(t,e,r){const s=this.getSkin(t);return s===null?null:s.getDisplay(e,r)}getAnimation(t){return t in this.animations?this.animations[t]:null}}class eT extends O{constructor(){super(...arguments),this.transform=new rt,this.userData=null}static toString(){return"[class dragonBones.BoneData]"}_onClear(){this.userData!==null&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.alpha=1,this.name="",this.transform.identity(),this.userData=null,this.parent=null}}class QR extends eT{constructor(){super(...arguments),this.geometry=new Ap}static toString(){return"[class dragonBones.SurfaceData]"}_onClear(){super._onClear(),this.type=1,this.segmentX=0,this.segmentY=0,this.geometry.clear()}}class ll extends O{constructor(){super(...arguments),this.color=null,this.userData=null}static createColor(){return new Ph}static toString(){return"[class dragonBones.SlotData]"}_onClear(){this.userData!==null&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.zIndex=0,this.alpha=1,this.name="",this.color=null,this.userData=null,this.parent=null}}ll.DEFAULT_COLOR=new Ph;class Ep extends O{_onClear(){this.color=0,this.width=0,this.height=0}}class ar extends Ep{static toString(){return"[class dragonBones.RectangleBoundingBoxData]"}static _computeOutCode(t,e,r,s,n,a){let o=0;return t<r?o|=1:t>n&&(o|=2),e<s?o|=4:e>a&&(o|=8),o}static rectangleIntersectsSegment(t,e,r,s,n,a,o,l,h=null,u=null,d=null){const c=t>n&&t<o&&e>a&&e<l,f=r>n&&r<o&&s>a&&s<l;if(c&&f)return-1;let p=0,y=ar._computeOutCode(t,e,n,a,o,l),x=ar._computeOutCode(r,s,n,a,o,l);for(;;){if(y|x){if(y&x)break}else{p=2;break}let m=0,_=0,g=0;const T=y!==0?y:x;T&4?(m=t+(r-t)*(a-e)/(s-e),_=a,d!==null&&(g=-Math.PI*.5)):T&8?(m=t+(r-t)*(l-e)/(s-e),_=l,d!==null&&(g=Math.PI*.5)):T&2?(_=e+(s-e)*(o-t)/(r-t),m=o,d!==null&&(g=0)):T&1&&(_=e+(s-e)*(n-t)/(r-t),m=n,d!==null&&(g=Math.PI)),T===y?(t=m,e=_,y=ar._computeOutCode(t,e,n,a,o,l),d!==null&&(d.x=g)):(r=m,s=_,x=ar._computeOutCode(r,s,n,a,o,l),d!==null&&(d.y=g))}return p&&(c?(p=2,h!==null&&(h.x=r,h.y=s),u!==null&&(u.x=r,u.y=r),d!==null&&(d.x=d.y+Math.PI)):f?(p=1,h!==null&&(h.x=t,h.y=e),u!==null&&(u.x=t,u.y=e),d!==null&&(d.y=d.x+Math.PI)):(p=3,h!==null&&(h.x=t,h.y=e),u!==null&&(u.x=r,u.y=s))),p}_onClear(){super._onClear(),this.type=0}containsPoint(t,e){const r=this.width*.5;if(t>=-r&&t<=r){const s=this.height*.5;if(e>=-s&&e<=s)return!0}return!1}intersectsSegment(t,e,r,s,n=null,a=null,o=null){const l=this.width*.5,h=this.height*.5;return ar.rectangleIntersectsSegment(t,e,r,s,-l,-h,l,h,n,a,o)}}class Sp extends Ep{static toString(){return"[class dragonBones.EllipseData]"}static ellipseIntersectsSegment(t,e,r,s,n,a,o,l,h=null,u=null,d=null){const c=o/l,f=c*c;e*=c,s*=c;const p=r-t,y=s-e,x=Math.sqrt(p*p+y*y),m=p/x,_=y/x,g=(n-t)*m+(a-e)*_,T=g*g,A=t*t+e*e,S=o*o,w=S-A+T;let E=0;if(w>=0){const C=Math.sqrt(w),D=g-C,k=g+C,F=D<0?-1:D<=x?0:1,b=k<0?-1:k<=x?0:1,P=F*b;if(P<0)return-1;P===0&&(F===-1?(E=2,r=t+k*m,s=(e+k*_)/c,h!==null&&(h.x=r,h.y=s),u!==null&&(u.x=r,u.y=s),d!==null&&(d.x=Math.atan2(s/S*f,r/S),d.y=d.x+Math.PI)):b===1?(E=1,t=t+D*m,e=(e+D*_)/c,h!==null&&(h.x=t,h.y=e),u!==null&&(u.x=t,u.y=e),d!==null&&(d.x=Math.atan2(e/S*f,t/S),d.y=d.x+Math.PI)):(E=3,h!==null&&(h.x=t+D*m,h.y=(e+D*_)/c,d!==null&&(d.x=Math.atan2(h.y/S*f,h.x/S))),u!==null&&(u.x=t+k*m,u.y=(e+k*_)/c,d!==null&&(d.y=Math.atan2(u.y/S*f,u.x/S)))))}return E}_onClear(){super._onClear(),this.type=1}containsPoint(t,e){const r=this.width*.5;if(t>=-r&&t<=r){const s=this.height*.5;if(e>=-s&&e<=s)return e*=r/s,Math.sqrt(t*t+e*e)<=r}return!1}intersectsSegment(t,e,r,s,n=null,a=null,o=null){return Sp.ellipseIntersectsSegment(t,e,r,s,0,0,this.width*.5,this.height*.5,n,a,o)}}class wp extends Ep{constructor(){super(...arguments),this.vertices=[]}static toString(){return"[class dragonBones.PolygonBoundingBoxData]"}static polygonIntersectsSegment(t,e,r,s,n,a=null,o=null,l=null){t===r&&(t=r+1e-6),e===s&&(e=s+1e-6);const h=n.length,u=t-r,d=e-s,c=t*s-e*r;let f=0,p=n[h-2],y=n[h-1],x=0,m=0,_=0,g=0,T=0,A=0;for(let S=0;S<h;S+=2){const w=n[S],E=n[S+1];p===w&&(p=w+1e-4),y===E&&(y=E+1e-4);const C=p-w,D=y-E,k=p*E-y*w,F=u*D-d*C,b=(c*C-u*k)/F;if((b>=p&&b<=w||b>=w&&b<=p)&&(u===0||b>=t&&b<=r||b>=r&&b<=t)){const P=(c*D-d*k)/F;if((P>=y&&P<=E||P>=E&&P<=y)&&(d===0||P>=e&&P<=s||P>=s&&P<=e))if(o!==null){let N=b-t;N<0&&(N=-N),f===0?(x=N,m=N,_=b,g=P,T=b,A=P,l!==null&&(l.x=Math.atan2(E-y,w-p)-Math.PI*.5,l.y=l.x)):(N<x&&(x=N,_=b,g=P,l!==null&&(l.x=Math.atan2(E-y,w-p)-Math.PI*.5)),N>m&&(m=N,T=b,A=P,l!==null&&(l.y=Math.atan2(E-y,w-p)-Math.PI*.5))),f++}else{_=b,g=P,T=b,A=P,f++,l!==null&&(l.x=Math.atan2(E-y,w-p)-Math.PI*.5,l.y=l.x);break}}p=w,y=E}return f===1?(a!==null&&(a.x=_,a.y=g),o!==null&&(o.x=_,o.y=g),l!==null&&(l.y=l.x+Math.PI)):f>1&&(f++,a!==null&&(a.x=_,a.y=g),o!==null&&(o.x=T,o.y=A)),f}_onClear(){super._onClear(),this.type=2,this.x=0,this.y=0,this.vertices.length=0}containsPoint(t,e){let r=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(let s=0,n=this.vertices.length,a=n-2;s<n;s+=2){const o=this.vertices[a+1],l=this.vertices[s+1];if(l<e&&o>=e||o<e&&l>=e){const h=this.vertices[a],u=this.vertices[s];(e-l)*(h-u)/(o-l)+u<t&&(r=!r)}a=s}return r}intersectsSegment(t,e,r,s,n=null,a=null,o=null){let l=0;return ar.rectangleIntersectsSegment(t,e,r,s,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)!==0&&(l=wp.polygonIntersectsSegment(t,e,r,s,this.vertices,n,a,o)),l}}class JR extends O{static toString(){return"[class dragonBones.CanvasData]"}_onClear(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0}}class iT extends O{_onClear(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null}}class tM extends iT{static toString(){return"[class dragonBones.IKConstraintData]"}_onClear(){super._onClear(),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1}}class eM extends iT{constructor(){super(...arguments),this.bones=[]}static toString(){return"[class dragonBones.PathConstraintData]"}_onClear(){super._onClear(),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0}AddBone(t){this.bones.push(t)}}class iM extends O{constructor(){super(...arguments),this.frameIndices=[],this.cachedFrames=[],this.armatureNames=[],this.armatures={},this.userData=null}static toString(){return"[class dragonBones.DragonBonesData]"}_onClear(){for(let t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];this.userData!==null&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.colorArray=null,this.userData=null}addArmature(t){if(t.name in this.armatures){console.warn("Same armature: "+t.name);return}t.parent=this,this.armatures[t.name]=t,this.armatureNames.push(t.name)}getArmature(t){return t in this.armatures?this.armatures[t]:null}}class rM extends O{constructor(){super(...arguments),this.displays={}}static toString(){return"[class dragonBones.SkinData]"}_onClear(){for(let t in this.displays){const e=this.displays[t];for(const r of e)r!==null&&r.returnToPool();delete this.displays[t]}this.name="",this.parent=null}addDisplay(t,e){t in this.displays||(this.displays[t]=[]),e!==null&&(e.parent=this),this.displays[t].push(e)}getDisplay(t,e){const r=this.getDisplays(t);if(r!==null){for(const s of r)if(s!==null&&s.name===e)return s}return null}getDisplays(t){return t in this.displays?this.displays[t]:null}}class sM extends O{constructor(){super(...arguments),this.textures={}}_onClear(){for(let t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""}copyFrom(t){this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath;for(let e in this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(let e in t.textures){const r=this.createTexture();r.copyFrom(t.textures[e]),this.textures[e]=r}}addTexture(t){if(t.name in this.textures){console.warn("Same texture: "+t.name);return}t.parent=this,this.textures[t.name]=t}getTexture(t){return t in this.textures?this.textures[t]:null}}class Oh extends O{constructor(){super(...arguments),this.region=new sf,this.frame=null}static createRectangle(){return new sf}_onClear(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null}copyFrom(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,this.frame===null&&t.frame!==null?this.frame=Oh.createRectangle():this.frame!==null&&t.frame===null&&(this.frame=null),this.frame!==null&&t.frame!==null&&this.frame.copyFrom(t.frame)}}class sc extends O{constructor(){super(...arguments),this.ints=[],this.floats=[],this.strings=[]}static toString(){return"[class dragonBones.UserData]"}_onClear(){this.ints.length=0,this.floats.length=0,this.strings.length=0}addInt(t){this.ints.push(t)}addFloat(t){this.floats.push(t)}addString(t){this.strings.push(t)}getInt(t=0){return t>=0&&t<this.ints.length?this.ints[t]:0}getFloat(t=0){return t>=0&&t<this.floats.length?this.floats[t]:0}getString(t=0){return t>=0&&t<this.strings.length?this.strings[t]:""}}class bg extends O{constructor(){super(...arguments),this.data=null}static toString(){return"[class dragonBones.ActionData]"}_onClear(){this.data!==null&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null}}class Bh extends O{_onClear(){this.dirty=!1,this.playState=-1,this.currentPlayTimes=0,this.currentTime=-1,this.target=null,this._isTween=!1,this._valueOffset=0,this._frameValueOffset=0,this._frameOffset=0,this._frameRate=0,this._frameCount=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._valueArray=null,this._timelineArray=null,this._frameIndices=null}_setCurrentTime(t){const e=this.playState,r=this.currentPlayTimes,s=this.currentTime;if(this._actionTimeline!==null&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(this._actionTimeline===null||this._timeScale!==1||this._timeOffset!==0){const n=this._animationState.playTimes,a=n*this._duration;t*=this._timeScale,this._timeOffset!==0&&(t+=this._timeOffset*this._animationData.duration),n>0&&(t>=a||t<=-a)?(this.playState<=0&&this._animationState._playheadState===3&&(this.playState=1),this.currentPlayTimes=n,t<0?this.currentTime=0:this.currentTime=this.playState===1?this._duration+1e-6:this._duration):(this.playState!==0&&this._animationState._playheadState===3&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return this.currentPlayTimes===r&&this.currentTime===s?!1:((e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==r)&&(this._frameIndex=-1),!0)}init(t,e,r){if(this._armature=t,this._animationState=e,this._timelineData=r,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState.animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._timelineData!==null){const s=this._animationData.parent.parent;this._frameArray=s.frameArray,this._timelineArray=s.timelineArray,this._frameIndices=s.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=this._timelineArray[this._timelineData.offset+1]*.01}}fadeOut(){this.dirty=!1}update(t){if(this._setCurrentTime(t)){if(this._frameCount>1){const e=Math.floor(this.currentTime*this._frameRate),r=this._frameIndices[this._timelineData.frameIndicesOffset+e];this._frameIndex!==r&&(this._frameIndex=r,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,this._timelineData!==null&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());(this._isTween||this.dirty)&&this._onUpdateFrame()}}blend(t){}}class us extends Bh{static _getEasingValue(t,e,r){let s=e;switch(t){case 3:s=Math.pow(e,2);break;case 4:s=1-Math.pow(1-e,2);break;case 5:s=.5*(1-Math.cos(e*Math.PI));break}return(s-e)*r+e}static _getEasingCurveValue(t,e,r,s){if(t<=0)return 0;if(t>=1)return 1;const n=r>0,a=r+1,o=Math.floor(t*a);let l=0,h=0;return n?(l=o===0?0:e[s+o-1],h=o===a-1?1e4:e[s+o]):(l=e[s+o-1],h=e[s+o]),(l+(h-l)*(t*a-o))*1e-4}_onClear(){super._onClear(),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenEasing=0,this._tweenProgress=0,this._valueScale=1}_onArriveAtFrame(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||this._animationState.playTimes===0||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._isTween=this._tweenType!==0,this._isTween?this._tweenType===2?this._curveCount=this._frameArray[this._frameOffset+2]:this._tweenType!==0&&this._tweenType!==1&&(this._tweenEasing=this._frameArray[this._frameOffset+2]*.01):this.dirty=!0,this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{const t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],e=this._frameArray[t]*this._frameRateR-this._framePosition;e>0?this._frameDurationR=1/e:this._frameDurationR=0}else this.dirty=!0,this._isTween=!1}_onUpdateFrame(){this._isTween&&(this.dirty=!0,this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,this._tweenType===2?this._tweenProgress=us._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):this._tweenType!==1&&(this._tweenProgress=us._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)))}}class kh extends us{_onClear(){super._onClear(),this._current=0,this._difference=0,this._result=0}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){const t=this._valueScale,e=this._valueArray,r=this._valueOffset+this._frameValueOffset+this._frameIndex;if(this._isTween){const s=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:r+1;t===1?(this._current=e[r],this._difference=e[s]-this._current):(this._current=e[r]*t,this._difference=e[s]*t-this._current)}else this._result=e[r]*t}else this._result=0}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._result=this._current+this._difference*this._tweenProgress)}}class $a extends us{_onClear(){super._onClear(),this._currentA=0,this._currentB=0,this._differenceA=0,this._differenceB=0,this._resultA=0,this._resultB=0}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){const t=this._valueScale,e=this._valueArray,r=this._valueOffset+this._frameValueOffset+this._frameIndex*2;if(this._isTween){const s=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:r+2;t===1?(this._currentA=e[r],this._currentB=e[r+1],this._differenceA=e[s]-this._currentA,this._differenceB=e[s+1]-this._currentB):(this._currentA=e[r]*t,this._currentB=e[r+1]*t,this._differenceA=e[s]*t-this._currentA,this._differenceB=e[s+1]*t-this._currentB)}else this._resultA=e[r]*t,this._resultB=e[r+1]*t}else this._resultA=0,this._resultB=0}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._resultA=this._currentA+this._differenceA*this._tweenProgress,this._resultB=this._currentB+this._differenceB*this._tweenProgress)}}class bp extends us{constructor(){super(...arguments),this._rd=[]}_onClear(){super._onClear(),this._valueCount=0,this._rd.length=0}_onArriveAtFrame(){super._onArriveAtFrame();const t=this._valueCount,e=this._rd;if(this._timelineData!==null){const r=this._valueScale,s=this._valueArray,n=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(this._isTween){const a=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:n+t;if(r===1)for(let o=0;o<t;++o)e[t+o]=s[a+o]-s[n+o];else for(let o=0;o<t;++o)e[t+o]=(s[a+o]-s[n+o])*r}else if(r===1)for(let a=0;a<t;++a)e[a]=s[n+a];else for(let a=0;a<t;++a)e[a]=s[n+a]*r}else for(let r=0;r<t;++r)e[r]=0}_onUpdateFrame(){if(super._onUpdateFrame(),this._isTween){const t=this._valueCount,e=this._valueScale,r=this._tweenProgress,s=this._valueArray,n=this._rd,a=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(e===1)for(let o=0;o<t;++o)n[o]=s[a+o]+n[t+o]*r;else for(let o=0;o<t;++o)n[o]=s[a+o]*e+n[t+o]*r}}}class nM extends Bh{static toString(){return"[class dragonBones.ActionTimelineState]"}_onCrossFrame(t){const e=this._armature.eventDispatcher;if(this._animationState.actionEnabled){const r=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+t],s=this._frameArray[r+1],n=this._animationData.parent.actions;for(let a=0;a<s;++a){const o=this._frameArray[r+2+a],l=n[o];if(l.type===0){const h=O.borrowObject(lt);h.time=this._frameArray[r]/this._frameRate,h.animationState=this._animationState,lt.actionDataToInstance(l,h,this._armature),this._armature._bufferAction(h,!0)}else{const h=l.type===10?lt.FRAME_EVENT:lt.SOUND_EVENT;if(l.type===11||e.hasDBEventListener(h)){const u=O.borrowObject(lt);u.time=this._frameArray[r]/this._frameRate,u.animationState=this._animationState,lt.actionDataToInstance(l,u,this._armature),this._armature._dragonBones.bufferEvent(u)}}}}}_onArriveAtFrame(){}_onUpdateFrame(){}update(t){const e=this.playState;let r=this.currentPlayTimes,s=this.currentTime;if(this._setCurrentTime(t)){const n=this._animationState._parent===null&&this._animationState.actionEnabled,a=this._armature.eventDispatcher;if(e<0)if(this.playState!==e){if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),n&&a.hasDBEventListener(lt.START)){const u=O.borrowObject(lt);u.type=lt.START,u.armature=this._armature,u.animationState=this._animationState,this._armature._dragonBones.bufferEvent(u)}}else return;const o=this._animationState.timeScale<0;let l=null,h=null;if(n&&this.currentPlayTimes!==r&&(a.hasDBEventListener(lt.LOOP_COMPLETE)&&(l=O.borrowObject(lt),l.type=lt.LOOP_COMPLETE,l.armature=this._armature,l.animationState=this._animationState),this.playState>0&&a.hasDBEventListener(lt.COMPLETE)&&(h=O.borrowObject(lt),h.type=lt.COMPLETE,h.armature=this._armature,h.animationState=this._animationState)),this._frameCount>1){const u=this._timelineData,d=Math.floor(this.currentTime*this._frameRate),c=this._frameIndices[u.frameIndicesOffset+d];if(this._frameIndex!==c){let f=this._frameIndex;if(this._frameIndex=c,this._timelineArray!==null)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[u.offset+5+this._frameIndex],o){if(f<0){const p=Math.floor(s*this._frameRate);f=this._frameIndices[u.frameIndicesOffset+p],this.currentPlayTimes===r&&f===c&&(f=-1)}for(;f>=0;){const p=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],y=this._frameArray[p]/this._frameRate;if(this._position<=y&&y<=this._position+this._duration&&this._onCrossFrame(f),l!==null&&f===0&&(this._armature._dragonBones.bufferEvent(l),l=null),f>0?f--:f=this._frameCount-1,f===c)break}}else{if(f<0){const p=Math.floor(s*this._frameRate);f=this._frameIndices[u.frameIndicesOffset+p];const y=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],x=this._frameArray[y]/this._frameRate;this.currentPlayTimes===r&&(s<=x?f>0?f--:f=this._frameCount-1:f===c&&(f=-1))}for(;f>=0;){f<this._frameCount-1?f++:f=0;const p=this._animationData.frameOffset+this._timelineArray[u.offset+5+f],y=this._frameArray[p]/this._frameRate;if(this._position<=y&&y<=this._position+this._duration&&this._onCrossFrame(f),l!==null&&f===0&&(this._armature._dragonBones.bufferEvent(l),l=null),f===c)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,this._timelineData!==null)){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];const u=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===r?s<=u&&this._onCrossFrame(this._frameIndex):this._position<=u&&(!o&&l!==null&&(this._armature._dragonBones.bufferEvent(l),l=null),this._onCrossFrame(this._frameIndex))}l!==null&&this._armature._dragonBones.bufferEvent(l),h!==null&&this._armature._dragonBones.bufferEvent(h)}}setCurrentTime(t){this._setCurrentTime(t),this._frameIndex=-1}}class aM extends Bh{static toString(){return"[class dragonBones.ZOrderTimelineState]"}_onArriveAtFrame(){this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))}_onUpdateFrame(){}}class Cg extends bp{static toString(){return"[class dragonBones.BoneAllTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._isTween&&this._frameIndex===this._frameCount-1&&(this._rd[2]=rt.normalizeRadian(this._rd[2]),this._rd[3]=rt.normalizeRadian(this._rd[3])),this._timelineData===null&&(this._rd[4]=1,this._rd[5]=1)}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=6,this._valueArray=this._animationData.parent.parent.frameFloatArray}fadeOut(){this.dirty=!1,this._rd[2]=rt.normalizeRadian(this._rd[2]),this._rd[3]=rt.normalizeRadian(this._rd[3])}blend(t){const e=this._armature.armatureData.scale,r=this._rd,s=this.target,n=s.target,a=s.blendWeight,o=n.animationPose;s.dirty>1?(o.x+=r[0]*a*e,o.y+=r[1]*a*e,o.rotation+=r[2]*a,o.skew+=r[3]*a,o.scaleX+=(r[4]-1)*a,o.scaleY+=(r[5]-1)*a):(o.x=r[0]*a*e,o.y=r[1]*a*e,o.rotation=r[2]*a,o.skew=r[3]*a,o.scaleX=(r[4]-1)*a+1,o.scaleY=(r[5]-1)*a+1),(t||this.dirty)&&(this.dirty=!1,n._transformDirty=!0)}}class oM extends $a{static toString(){return"[class dragonBones.BoneTranslateTimelineState]"}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=this._animationData.parent.parent.frameFloatArray}blend(t){const e=this.target,r=e.target,s=e.blendWeight,n=r.animationPose;e.dirty>1?(n.x+=this._resultA*s,n.y+=this._resultB*s):s!==1?(n.x=this._resultA*s,n.y=this._resultB*s):(n.x=this._resultA,n.y=this._resultB),(t||this.dirty)&&(this.dirty=!1,r._transformDirty=!0)}}class lM extends $a{static toString(){return"[class dragonBones.BoneRotateTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._isTween&&this._frameIndex===this._frameCount-1&&(this._differenceA=rt.normalizeRadian(this._differenceA),this._differenceB=rt.normalizeRadian(this._differenceB))}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray}fadeOut(){this.dirty=!1,this._resultA=rt.normalizeRadian(this._resultA),this._resultB=rt.normalizeRadian(this._resultB)}blend(t){const e=this.target,r=e.target,s=e.blendWeight,n=r.animationPose;e.dirty>1?(n.rotation+=this._resultA*s,n.skew+=this._resultB*s):s!==1?(n.rotation=this._resultA*s,n.skew=this._resultB*s):(n.rotation=this._resultA,n.skew=this._resultB),(t||this.dirty)&&(this.dirty=!1,r._transformDirty=!0)}}class hM extends $a{static toString(){return"[class dragonBones.BoneScaleTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._timelineData===null&&(this._resultA=1,this._resultB=1)}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray}blend(t){const e=this.target,r=e.target,s=e.blendWeight,n=r.animationPose;e.dirty>1?(n.scaleX+=(this._resultA-1)*s,n.scaleY+=(this._resultB-1)*s):s!==1?(n.scaleX=(this._resultA-1)*s+1,n.scaleY=(this._resultB-1)*s+1):(n.scaleX=this._resultA,n.scaleY=this._resultB),(t||this.dirty)&&(this.dirty=!1,r._transformDirty=!0)}}class Ig extends bp{static toString(){return"[class dragonBones.SurfaceTimelineState]"}_onClear(){super._onClear(),this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0}init(t,e,r){if(super.init(t,e,r),this._timelineData!==null){const s=this._animationData.parent.parent,n=s.frameIntArray,a=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=n[a+2],this._deformCount=n[a+1],this._deformOffset=n[a+3],this._sameValueOffset=n[a+4]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=s.frameFloatArray,this._rd.length=this._valueCount*2}else this._deformCount=this.target.target._deformVertices.length}blend(t){const e=this.target,r=e.target,s=e.blendWeight,n=r._deformVertices,a=this._valueArray;if(a!==null){const o=this._valueCount,l=this._deformOffset,h=this._sameValueOffset,u=this._rd;for(let d=0;d<this._deformCount;++d){let c=0;d<l?c=a[h+d]:d<l+o?c=u[d-l]:c=a[h+d-o],e.dirty>1?n[d]+=c*s:n[d]=c*s}}else if(e.dirty===1)for(let o=0;o<this._deformCount;++o)n[o]=0;(t||this.dirty)&&(this.dirty=!1,r._transformDirty=!0)}}class Dg extends kh{static toString(){return"[class dragonBones.AlphaTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._timelineData===null&&(this._result=1)}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray}blend(t){const e=this.target,r=e.target,s=e.blendWeight;e.dirty>1?(r._alpha+=this._result*s,r._alpha>1&&(r._alpha=1)):r._alpha=this._result*s,(t||this.dirty)&&(this.dirty=!1,this._armature._alphaDirty=!0)}}class Rg extends Bh{static toString(){return"[class dragonBones.SlotDisplayTimelineState]"}_onArriveAtFrame(){if(this.playState>=0){const t=this.target,e=this._timelineData!==null?this._frameArray[this._frameOffset+1]:t._slotData.displayIndex;t.displayIndex!==e&&t._setDisplayIndex(e,!0)}}_onUpdateFrame(){}}class Mg extends us{constructor(){super(...arguments),this._current=[0,0,0,0,0,0,0,0],this._difference=[0,0,0,0,0,0,0,0],this._result=[0,0,0,0,0,0,0,0]}static toString(){return"[class dragonBones.SlotColorTimelineState]"}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){const t=this._animationData.parent.parent,e=t.colorArray,r=t.frameIntArray,s=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex;let n=r[s];n<0&&(n+=65536),this._isTween?(this._current[0]=e[n++],this._current[1]=e[n++],this._current[2]=e[n++],this._current[3]=e[n++],this._current[4]=e[n++],this._current[5]=e[n++],this._current[6]=e[n++],this._current[7]=e[n++],this._frameIndex===this._frameCount-1?n=r[this._animationData.frameIntOffset+this._frameValueOffset]:n=r[s+1],n<0&&(n+=65536),this._difference[0]=e[n++]-this._current[0],this._difference[1]=e[n++]-this._current[1],this._difference[2]=e[n++]-this._current[2],this._difference[3]=e[n++]-this._current[3],this._difference[4]=e[n++]-this._current[4],this._difference[5]=e[n++]-this._current[5],this._difference[6]=e[n++]-this._current[6],this._difference[7]=e[n++]-this._current[7]):(this._result[0]=e[n++]*.01,this._result[1]=e[n++]*.01,this._result[2]=e[n++]*.01,this._result[3]=e[n++]*.01,this._result[4]=e[n++],this._result[5]=e[n++],this._result[6]=e[n++],this._result[7]=e[n++])}else{const e=this.target.slotData.color;this._result[0]=e.alphaMultiplier,this._result[1]=e.redMultiplier,this._result[2]=e.greenMultiplier,this._result[3]=e.blueMultiplier,this._result[4]=e.alphaOffset,this._result[5]=e.redOffset,this._result[6]=e.greenOffset,this._result[7]=e.blueOffset}}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._result[0]=(this._current[0]+this._difference[0]*this._tweenProgress)*.01,this._result[1]=(this._current[1]+this._difference[1]*this._tweenProgress)*.01,this._result[2]=(this._current[2]+this._difference[2]*this._tweenProgress)*.01,this._result[3]=(this._current[3]+this._difference[3]*this._tweenProgress)*.01,this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress,this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress,this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress,this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress)}fadeOut(){this._isTween=!1}update(t){if(super.update(t),this._isTween||this.dirty){const e=this.target,r=e._colorTransform;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){if(r.alphaMultiplier!==this._result[0]||r.redMultiplier!==this._result[1]||r.greenMultiplier!==this._result[2]||r.blueMultiplier!==this._result[3]||r.alphaOffset!==this._result[4]||r.redOffset!==this._result[5]||r.greenOffset!==this._result[6]||r.blueOffset!==this._result[7]){const s=Math.pow(this._animationState._fadeProgress,4);r.alphaMultiplier+=(this._result[0]-r.alphaMultiplier)*s,r.redMultiplier+=(this._result[1]-r.redMultiplier)*s,r.greenMultiplier+=(this._result[2]-r.greenMultiplier)*s,r.blueMultiplier+=(this._result[3]-r.blueMultiplier)*s,r.alphaOffset+=(this._result[4]-r.alphaOffset)*s,r.redOffset+=(this._result[5]-r.redOffset)*s,r.greenOffset+=(this._result[6]-r.greenOffset)*s,r.blueOffset+=(this._result[7]-r.blueOffset)*s,e._colorDirty=!0}}else this.dirty&&(this.dirty=!1,(r.alphaMultiplier!==this._result[0]||r.redMultiplier!==this._result[1]||r.greenMultiplier!==this._result[2]||r.blueMultiplier!==this._result[3]||r.alphaOffset!==this._result[4]||r.redOffset!==this._result[5]||r.greenOffset!==this._result[6]||r.blueOffset!==this._result[7])&&(r.alphaMultiplier=this._result[0],r.redMultiplier=this._result[1],r.greenMultiplier=this._result[2],r.blueMultiplier=this._result[3],r.alphaOffset=this._result[4],r.redOffset=this._result[5],r.greenOffset=this._result[6],r.blueOffset=this._result[7],e._colorDirty=!0))}}}class uM extends kh{static toString(){return"[class dragonBones.SlotZIndexTimelineState]"}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData===null){const e=this.target.target;this._result=e.slotData.zIndex}}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueArray=this._animationData.parent.parent.frameIntArray}blend(t){const e=this.target,r=e.target,s=e.blendWeight;e.dirty>1?r._zIndex+=this._result*s:r._zIndex=this._result*s,(t||this.dirty)&&(this.dirty=!1,this._armature._zIndexDirty=!0)}}class Pg extends bp{static toString(){return"[class dragonBones.DeformTimelineState]"}_onClear(){super._onClear(),this.displayFrame=null,this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0}init(t,e,r){if(super.init(t,e,r),this._timelineData!==null){const s=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3],n=this._animationData.parent.parent,a=n.frameIntArray;this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=a[s+2],this._deformCount=a[s+1],this._deformOffset=a[s+3],this._sameValueOffset=a[s+4],this._sameValueOffset<0&&(this._sameValueOffset+=65536),this._sameValueOffset+=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=n.frameFloatArray,this._rd.length=this._valueCount*2}else this._deformCount=this.displayFrame.deformVertices.length}blend(t){const e=this.target,r=e.target,s=e.blendWeight,n=this.displayFrame.deformVertices,a=this._valueArray;if(a!==null){const o=this._valueCount,l=this._deformOffset,h=this._sameValueOffset,u=this._rd;for(let d=0;d<this._deformCount;++d){let c=0;d<l?c=a[h+d]:d<l+o?c=u[d-l]:c=a[h+d-o],e.dirty>1?n[d]+=c*s:n[d]=c*s}}else if(e.dirty===1)for(let o=0;o<this._deformCount;++o)n[o]=0;(t||this.dirty)&&(this.dirty=!1,r._geometryData===this.displayFrame.getGeometryData()&&(r._verticesDirty=!0))}}class Fg extends $a{static toString(){return"[class dragonBones.IKConstraintTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;if(this._timelineData!==null)t._bendPositive=this._currentA>0,t._weight=this._currentB;else{const e=t._constraintData;t._bendPositive=e.bendPositive,t._weight=e.weight}t.invalidUpdate(),this.dirty=!1}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray}}class cM extends kh{static toString(){return"[class dragonBones.AnimationProgressTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.currentTime=this._result*t.totalTime),this.dirty=!1}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class dM extends kh{static toString(){return"[class dragonBones.AnimationWeightTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.weight=this._result),this.dirty=!1}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class fM extends $a{static toString(){return"[class dragonBones.AnimationParametersTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.parameterX=this._resultA,t.parameterY=this._resultB),this.dirty=!1}init(t,e,r){super.init(t,e,r),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class pM extends O{constructor(){super(...arguments),this._boneMask=[],this._boneTimelines=[],this._boneBlendTimelines=[],this._slotTimelines=[],this._slotBlendTimelines=[],this._constraintTimelines=[],this._animationTimelines=[],this._poseTimelines=[],this._actionTimeline=null,this._zOrderTimeline=null}static toString(){return"[class dragonBones.AnimationState]"}_onClear(){for(const t of this._boneTimelines)t.returnToPool();for(const t of this._boneBlendTimelines)t.returnToPool();for(const t of this._slotTimelines)t.returnToPool();for(const t of this._slotBlendTimelines)t.returnToPool();for(const t of this._constraintTimelines)t.returnToPool();for(const t of this._animationTimelines){const e=t.target;e._parent===this&&(e._fadeState=1,e._subFadeState=1,e._parent=null),t.returnToPool()}this._actionTimeline!==null&&this._actionTimeline.returnToPool(),this._zOrderTimeline!==null&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additive=!1,this.displayControl=!1,this.resetToPose=!1,this.blendType=0,this.playTimes=1,this.layer=0,this.timeScale=1,this._weight=1,this.parameterX=0,this.parameterY=0,this.positionX=0,this.positionY=0,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._boneBlendTimelines.length=0,this._slotTimelines.length=0,this._slotBlendTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._activeChildA=null,this._activeChildB=null,this._parent=null}_updateTimelines(){for(const t of this._armature._constraints){const e=this._animationData.getConstraintTimelines(t.name);if(e!==null)for(const r of e)switch(r.type){case 30:{const s=O.borrowObject(Fg);s.target=t,s.init(this._armature,this,r),this._constraintTimelines.push(s);break}}else if(this.resetToPose){const r=O.borrowObject(Fg);r.target=t,r.init(this._armature,this,null),this._constraintTimelines.push(r),this._poseTimelines.push(r)}}}_updateBoneAndSlotTimelines(){{const t={};for(const e of this._boneTimelines){const r=e.target.target.name;r in t||(t[r]=[]),t[r].push(e)}for(const e of this._boneBlendTimelines){const r=e.target.target.name;r in t||(t[r]=[]),t[r].push(e)}for(const e of this._armature.getBones()){const r=e.name;if(this.containsBoneMask(r))if(r in t)delete t[r];else{const s=this._animationData.getBoneTimelines(r),n=this._armature.animation.getBlendState(he.BONE_TRANSFORM,e.name,e);if(s!==null)for(const a of s)switch(a.type){case 10:{const o=O.borrowObject(Cg);o.target=n,o.init(this._armature,this,a),this._boneTimelines.push(o);break}case 11:{const o=O.borrowObject(oM);o.target=n,o.init(this._armature,this,a),this._boneTimelines.push(o);break}case 12:{const o=O.borrowObject(lM);o.target=n,o.init(this._armature,this,a),this._boneTimelines.push(o);break}case 13:{const o=O.borrowObject(hM);o.target=n,o.init(this._armature,this,a),this._boneTimelines.push(o);break}case 60:{const o=O.borrowObject(Dg);o.target=this._armature.animation.getBlendState(he.BONE_ALPHA,e.name,e),o.init(this._armature,this,a),this._boneBlendTimelines.push(o);break}case 50:{const o=O.borrowObject(Ig);o.target=this._armature.animation.getBlendState(he.SURFACE,e.name,e),o.init(this._armature,this,a),this._boneBlendTimelines.push(o);break}}else if(this.resetToPose)if(e._boneData.type===0){const a=O.borrowObject(Cg);a.target=n,a.init(this._armature,this,null),this._boneTimelines.push(a),this._poseTimelines.push(a)}else{const a=O.borrowObject(Ig);a.target=this._armature.animation.getBlendState(he.SURFACE,e.name,e),a.init(this._armature,this,null),this._boneBlendTimelines.push(a),this._poseTimelines.push(a)}}}for(let e in t)for(const r of t[e]){let s=this._boneTimelines.indexOf(r);s>=0&&(this._boneTimelines.splice(s,1),r.returnToPool()),s=this._boneBlendTimelines.indexOf(r),s>=0&&(this._boneBlendTimelines.splice(s,1),r.returnToPool())}}{const t={},e=[];for(const r of this._slotTimelines){const s=r.target.name;s in t||(t[s]=[]),t[s].push(r)}for(const r of this._slotBlendTimelines){const s=r.target.target.name;s in t||(t[s]=[]),t[s].push(r)}for(const r of this._armature.getSlots()){const s=r.parent.name;if(!this.containsBoneMask(s))continue;const n=r.name;if(n in t)delete t[n];else{let a=!1,o=!1;e.length=0;const l=this._animationData.getSlotTimelines(n);if(l!==null)for(const h of l)switch(h.type){case 20:{const u=O.borrowObject(Rg);u.target=r,u.init(this._armature,this,h),this._slotTimelines.push(u),a=!0;break}case 23:{const u=O.borrowObject(uM);u.target=this._armature.animation.getBlendState(he.SLOT_Z_INDEX,r.name,r),u.init(this._armature,this,h),this._slotBlendTimelines.push(u);break}case 21:{const u=O.borrowObject(Mg);u.target=r,u.init(this._armature,this,h),this._slotTimelines.push(u),o=!0;break}case 22:{const u=this._animationData.parent.parent,d=u.timelineArray,c=this._animationData.frameIntOffset+d[h.offset+3];let p=u.frameIntArray[c+0];p<0&&(p+=65536);for(let y=0,x=r.displayFrameCount;y<x;++y){const m=r.getDisplayFrameAt(y),_=m.getGeometryData();if(_!==null&&_.offset===p){const g=O.borrowObject(Pg);g.target=this._armature.animation.getBlendState(he.SLOT_DEFORM,m.rawDisplayData.name,r),g.displayFrame=m,g.init(this._armature,this,h),this._slotBlendTimelines.push(g),m.updateDeformVertices(),e.push(p);break}}break}case 24:{const u=O.borrowObject(Dg);u.target=this._armature.animation.getBlendState(he.SLOT_ALPHA,r.name,r),u.init(this._armature,this,h),this._slotBlendTimelines.push(u);break}}if(this.resetToPose){if(!a){const h=O.borrowObject(Rg);h.target=r,h.init(this._armature,this,null),this._slotTimelines.push(h),this._poseTimelines.push(h)}if(!o){const h=O.borrowObject(Mg);h.target=r,h.init(this._armature,this,null),this._slotTimelines.push(h),this._poseTimelines.push(h)}for(let h=0,u=r.displayFrameCount;h<u;++h){const d=r.getDisplayFrameAt(h);if(d.deformVertices.length===0)continue;const c=d.getGeometryData();if(c!==null&&e.indexOf(c.offset)<0){const f=O.borrowObject(Pg);f.displayFrame=d,f.target=this._armature.animation.getBlendState(he.SLOT_DEFORM,r.name,r),f.init(this._armature,this,null),this._slotBlendTimelines.push(f),this._poseTimelines.push(f)}}}}}for(let r in t)for(const s of t[r]){let n=this._slotTimelines.indexOf(s);n>=0&&(this._slotTimelines.splice(n,1),s.returnToPool()),n=this._slotBlendTimelines.indexOf(s),n>=0&&(this._slotBlendTimelines.splice(n,1),s.returnToPool())}}}_advanceFadeTime(t){const e=this._fadeState>0;if(this._subFadeState<0&&(this._subFadeState=0,this._parent===null&&this.actionEnabled)){const s=e?lt.FADE_OUT:lt.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(s)){const n=O.borrowObject(lt);n.type=s,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}if(t<0&&(t=-t),this._fadeTime+=t,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=e?0:1):this._fadeTime>0?this._fadeProgress=e?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=e?1:0,this._subFadeState>0&&(e||(this._playheadState|=1,this._fadeState=0),this._parent===null&&this.actionEnabled)){const s=e?lt.FADE_OUT_COMPLETE:lt.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(s)){const n=O.borrowObject(lt);n.type=s,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}}init(t,e,r){if(this._armature===null){if(this._armature=t,this._animationData=e,this.resetToPose=r.resetToPose,this.additive=r.additive,this.displayControl=r.displayControl,this.actionEnabled=r.actionEnabled,this.blendType=e.blendType,this.layer=r.layer,this.playTimes=r.playTimes,this.timeScale=r.timeScale,this.fadeTotalTime=r.fadeInTime,this.autoFadeOutTime=r.autoFadeOutTime,this.name=r.name.length>0?r.name:r.animation,this.group=r.group,this._weight=r.weight,r.pauseFadeIn?this._playheadState=2:this._playheadState=3,r.duration<0?(this._position=0,this._duration=this._animationData.duration,r.position!==0?this.timeScale>=0?this._time=r.position:this._time=r.position-this._duration:this._time=0):(this._position=r.position,this._duration=r.duration,this._time=0),this.timeScale<0&&this._time===0&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),r.boneMask.length>0){this._boneMask.length=r.boneMask.length;for(let s=0,n=this._boneMask.length;s<n;++s)this._boneMask[s]=r.boneMask[s]}this._actionTimeline=O.borrowObject(nM),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),this._animationData.zOrderTimeline!==null&&(this._zOrderTimeline=O.borrowObject(aM),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}}advanceTime(t,e){(this._fadeState!==0||this._subFadeState!==0)&&this._advanceFadeTime(t),this._playheadState===3&&(this.timeScale!==1&&(t*=this.timeScale),this._time+=t),this._timelineDirty!==0&&(this._timelineDirty===2&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines());const r=this._fadeState!==0||this._subFadeState===0,s=this._fadeState===0&&e>0;let n=!0,a=!0,o=this._time;if(this._weightResult=this._weight*this._fadeProgress,this._parent!==null&&(this._weightResult*=this._parent._weightResult),this._actionTimeline.playState<=0&&this._actionTimeline.update(o),this._weight!==0){if(s){const l=e*2;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*l)/l}if(this._zOrderTimeline!==null&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(o),s){const l=Math.floor(this._actionTimeline.currentTime*e);this._armature._cacheFrameIndex===l?(n=!1,a=!1):(this._armature._cacheFrameIndex=l,this._animationData.cachedFrames[l]?a=!1:this._animationData.cachedFrames[l]=!0)}if(n){let l=!1,h=null;if(a)for(let u=0,d=this._boneTimelines.length;u<d;++u){const c=this._boneTimelines[u];if(c.playState<=0&&c.update(o),c.target!==h){const f=c.target;if(l=f.update(this),h=f,f.dirty===1){const p=f.target.animationPose;p.x=0,p.y=0,p.rotation=0,p.skew=0,p.scaleX=1,p.scaleY=1}}l&&c.blend(r)}for(let u=0,d=this._boneBlendTimelines.length;u<d;++u){const c=this._boneBlendTimelines[u];c.playState<=0&&c.update(o),c.target.update(this)&&c.blend(r)}if(this.displayControl)for(let u=0,d=this._slotTimelines.length;u<d;++u){const c=this._slotTimelines[u];if(c.playState<=0){const p=c.target.displayController;(p===null||p===this.name||p===this.group)&&c.update(o)}}for(let u=0,d=this._slotBlendTimelines.length;u<d;++u){const c=this._slotBlendTimelines[u];if(c.playState<=0){const f=c.target;c.update(o),f.update(this)&&c.blend(r)}}for(let u=0,d=this._constraintTimelines.length;u<d;++u){const c=this._constraintTimelines[u];c.playState<=0&&c.update(o)}if(this._animationTimelines.length>0){let u=100,d=100,c=null,f=null;for(let p=0,y=this._animationTimelines.length;p<y;++p){const x=this._animationTimelines[p];if(x.playState<=0&&x.update(o),this.blendType===1){const m=x.target,_=this.parameterX-m.positionX;_>=0?_<u&&(u=_,c=m):-_<d&&(d=-_,f=m)}}c!==null&&(this._activeChildA!==c&&(this._activeChildA!==null&&(this._activeChildA.weight=0),this._activeChildA=c,this._activeChildA.activeTimeline()),this._activeChildB!==f&&(this._activeChildB!==null&&(this._activeChildB.weight=0),this._activeChildB=f),c.weight=d/(u+d),f&&(f.weight=1-c.weight))}}if(this._fadeState===0){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(const l of this._poseTimelines){let h=this._boneTimelines.indexOf(l);if(h>=0){this._boneTimelines.splice(h,1),l.returnToPool();continue}if(h=this._boneBlendTimelines.indexOf(l),h>=0){this._boneBlendTimelines.splice(h,1),l.returnToPool();continue}if(h=this._slotTimelines.indexOf(l),h>=0){this._slotTimelines.splice(h,1),l.returnToPool();continue}if(h=this._slotBlendTimelines.indexOf(l),h>=0){this._slotBlendTimelines.splice(h,1),l.returnToPool();continue}if(h=this._constraintTimelines.indexOf(l),h>=0){this._constraintTimelines.splice(h,1),l.returnToPool();continue}}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}}play(){this._playheadState=3}stop(){this._playheadState&=1}fadeOut(t,e=!0){if(t<0&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(const r of this._boneTimelines)r.fadeOut();for(const r of this._boneBlendTimelines)r.fadeOut();for(const r of this._slotTimelines)r.fadeOut();for(const r of this._slotBlendTimelines)r.fadeOut();for(const r of this._constraintTimelines)r.fadeOut();for(const r of this._animationTimelines)r.fadeOut(),r.target.fadeOut(999999,!0)}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)}containsBoneMask(t){return this._boneMask.length===0||this._boneMask.indexOf(t)>=0}addBoneMask(t,e=!0){const r=this._armature.getBone(t);if(r!==null){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(const s of this._armature.getBones())this._boneMask.indexOf(s.name)<0&&r.contains(s)&&this._boneMask.push(s.name);this._timelineDirty=1}}removeBoneMask(t,e=!0){const r=this._boneMask.indexOf(t);if(r>=0&&this._boneMask.splice(r,1),e){const s=this._armature.getBone(t);if(s!==null){const n=this._armature.getBones();if(this._boneMask.length>0)for(const a of n){const o=this._boneMask.indexOf(a.name);o>=0&&s.contains(a)&&this._boneMask.splice(o,1)}else for(const a of n)a!==s&&(s.contains(a)||this._boneMask.push(a.name))}}this._timelineDirty=1}removeAllBoneMask(){this._boneMask.length=0,this._timelineDirty=1}addState(t,e=null){if(e!==null)for(const r of e)switch(r.type){case 40:{const s=O.borrowObject(cM);if(s.target=t,s.init(this._armature,this,r),this._animationTimelines.push(s),this.blendType!==0){const n=r;t.positionX=n.x,t.positionY=n.y,t.weight=0}t._parent=this,this.resetToPose=!1;break}case 41:{const s=O.borrowObject(dM);s.target=t,s.init(this._armature,this,r),this._animationTimelines.push(s);break}case 42:{const s=O.borrowObject(fM);s.target=t,s.init(this._armature,this,r),this._animationTimelines.push(s);break}}t._parent===null&&(t._parent=this)}activeTimeline(){for(const t of this._slotTimelines)t.dirty=!0,t.currentTime=-1}get isFadeIn(){return this._fadeState<0}get isFadeOut(){return this._fadeState>0}get isFadeComplete(){return this._fadeState===0}get isPlaying(){return(this._playheadState&2)!==0&&this._actionTimeline.playState<=0}get isCompleted(){return this._actionTimeline.playState>0}get currentPlayTimes(){return this._actionTimeline.currentPlayTimes}get totalTime(){return this._duration}get currentTime(){return this._actionTimeline.currentTime}set currentTime(t){const e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+e*this._duration,t<0&&(t+=this._duration)),this.playTimes>0&&e===this.playTimes-1&&t===this._duration&&this._parent===null&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),this._zOrderTimeline!==null&&(this._zOrderTimeline.playState=-1);for(const r of this._boneTimelines)r.playState=-1;for(const r of this._slotTimelines)r.playState=-1}}get weight(){return this._weight}set weight(t){if(this._weight!==t){this._weight=t;for(const e of this._boneTimelines)e.dirty=!0;for(const e of this._boneBlendTimelines)e.dirty=!0;for(const e of this._slotBlendTimelines)e.dirty=!0}}get animationData(){return this._animationData}}class he extends O{static toString(){return"[class dragonBones.BlendState]"}_onClear(){this.reset(),this.target=null}update(t){const e=t.layer;let r=t._weightResult;if(this.dirty>0){if(this.leftWeight>0){if(this.layer!==e){if(this.layerWeight>=this.leftWeight)return this.dirty++,this.layer=e,this.leftWeight=0,this.blendWeight=0,!1;this.layer=e,this.leftWeight-=this.layerWeight,this.layerWeight=0}return r*=this.leftWeight,this.dirty++,this.blendWeight=r,this.layerWeight+=this.blendWeight,!0}return!1}return this.dirty++,this.layer=e,this.leftWeight=1,this.blendWeight=r,this.layerWeight=r,!0}reset(){this.dirty=0,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0}}he.BONE_TRANSFORM="boneTransform";he.BONE_ALPHA="boneAlpha";he.SURFACE="surface";he.SLOT_DEFORM="slotDeform";he.SLOT_ALPHA="slotAlpha";he.SLOT_Z_INDEX="slotZIndex";class mM extends O{constructor(){super(...arguments),this._animationNames=[],this._animationStates=[],this._animations={},this._blendStates={},this._animationConfig=null}static toString(){return"[class dragonBones.Animation]"}_onClear(){for(const t of this._animationStates)t.returnToPool();for(let t in this._animations)delete this._animations[t];for(let t in this._blendStates){const e=this._blendStates[t];for(let r in e)e[r].returnToPool();delete this._blendStates[t]}this._animationConfig!==null&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null}_fadeOut(t){switch(t.fadeOutMode){case 1:for(const e of this._animationStates)e._parent===null&&e.layer===t.layer&&e.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 2:for(const e of this._animationStates)e._parent===null&&e.group===t.group&&e.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 3:for(const e of this._animationStates)e._parent===null&&e.layer===t.layer&&e.group===t.group&&e.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 4:for(const e of this._animationStates)e._parent===null&&e.fadeOut(t.fadeOutTime,t.pauseFadeOut);break}}init(t){this._armature===null&&(this._armature=t,this._animationConfig=O.borrowObject(WR))}advanceTime(t){t<0&&(t=-t),this._armature.inheritAnimation&&this._armature._parent!==null?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,this._inheritTimeScale!==1&&(t*=this._inheritTimeScale);for(let r in this._blendStates){const s=this._blendStates[r];for(let n in s)s[n].reset()}const e=this._animationStates.length;if(e===1){const r=this._animationStates[0];if(r._fadeState>0&&r._subFadeState>0)this._armature._dragonBones.bufferObject(r),this._animationStates.length=0,this._lastAnimationState=null;else{const s=r.animationData,n=s.cacheFrameRate;if(this._animationDirty&&n>0){this._animationDirty=!1;for(const a of this._armature.getBones())a._cachedFrameIndices=s.getBoneCachedFrameIndices(a.name);for(const a of this._armature.getSlots()){if(a.displayFrameCount>0){const o=a.getDisplayFrameAt(0).rawDisplayData;if(o!==null&&o.parent===this._armature.armatureData.defaultSkin){a._cachedFrameIndices=s.getSlotCachedFrameIndices(a.name);continue}}a._cachedFrameIndices=null}}r.advanceTime(t,n)}}else if(e>1){for(let r=0,s=0;r<e;++r){const n=this._animationStates[r];n._fadeState>0&&n._subFadeState>0?(s++,this._armature._dragonBones.bufferObject(n),this._animationDirty=!0,this._lastAnimationState===n&&(this._lastAnimationState=null)):(s>0&&(this._animationStates[r-s]=n),n.advanceTime(t,0)),r===e-1&&s>0&&(this._animationStates.length-=s,this._lastAnimationState===null&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1}reset(){for(const t of this._animationStates)t.returnToPool();this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null}stop(t=null){if(t!==null){const e=this.getState(t);e!==null&&e.stop()}else for(const e of this._animationStates)e.stop()}playConfig(t){const e=t.animation;if(!(e in this._animations))return console.warn(`Non-existent animation.
`,"DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+e),null;const r=this._animations[e];if(t.fadeOutMode===5){for(const n of this._animationStates)if(n._fadeState<1&&n.layer===t.layer&&n.animationData===r)return n}this._animationStates.length===0?t.fadeInTime=0:t.fadeInTime<0&&(t.fadeInTime=r.fadeInTime),t.fadeOutTime<0&&(t.fadeOutTime=t.fadeInTime),t.timeScale<=-100&&(t.timeScale=1/r.scale),r.frameCount>0?(t.position<0?(t.position%=r.duration,t.position=r.duration-t.position):t.position===r.duration?t.position-=1e-6:t.position>r.duration&&(t.position%=r.duration),t.duration>0&&t.position+t.duration>r.duration&&(t.duration=r.duration-t.position),t.playTimes<0&&(t.playTimes=r.playTimes)):(t.playTimes=1,t.position=0,t.duration>0&&(t.duration=0)),t.duration===0&&(t.duration=-1),this._fadeOut(t);const s=O.borrowObject(pM);if(s.init(this._armature,r,t),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){let n=!1;for(let a=0,o=this._animationStates.length;a<o;++a)if(s.layer>this._animationStates[a].layer){n=!0,this._animationStates.splice(a,0,s);break}else if(a!==o-1&&s.layer>this._animationStates[a+1].layer){n=!0,this._animationStates.splice(a+1,0,s);break}n||this._animationStates.push(s)}else this._animationStates.push(s);for(const n of this._armature.getSlots()){const a=n.childArmature;a!==null&&a.inheritAnimation&&a.animation.hasAnimation(e)&&a.animation.getState(e)===null&&a.animation.fadeIn(e)}for(let n in r.animationTimelines){const a=this.fadeIn(n,0,1,s.layer,"",5);if(a===null)continue;const o=r.animationTimelines[n];a.actionEnabled=!1,a.resetToPose=!1,a.stop(),s.addState(a,o);const l=this._animationStates.indexOf(s),h=this._animationStates.indexOf(a);h<l&&(this._animationStates.splice(l,1),this._animationStates.splice(h,0,s))}return!this._armature._lockUpdate&&t.fadeInTime<=0&&this.advanceTime(0),this._lastAnimationState=s,s}play(t=null,e=-1){if(this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t!==null?t:"",t!==null&&t.length>0)this.playConfig(this._animationConfig);else if(this._lastAnimationState===null){const r=this._armature.armatureData.defaultAnimation;r!==null&&(this._animationConfig.animation=r.name,this.playConfig(this._animationConfig))}else!this._lastAnimationState.isPlaying&&!this._lastAnimationState.isCompleted?this._lastAnimationState.play():(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig));return this._lastAnimationState}fadeIn(t,e=-1,r=-1,s=0,n=null,a=3){return this._animationConfig.clear(),this._animationConfig.fadeOutMode=a,this._animationConfig.playTimes=r,this._animationConfig.layer=s,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=n!==null?n:"",this.playConfig(this._animationConfig)}gotoAndPlayByTime(t,e=0,r=-1){return this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=r,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)}gotoAndPlayByFrame(t,e=0,r=-1){this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=r,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;const s=t in this._animations?this._animations[t]:null;return s!==null&&(this._animationConfig.position=s.frameCount>0?s.duration*e/s.frameCount:0),this.playConfig(this._animationConfig)}gotoAndPlayByProgress(t,e=0,r=-1){this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=r,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;const s=t in this._animations?this._animations[t]:null;return s!==null&&(this._animationConfig.position=s.duration*(e>0?e:0)),this.playConfig(this._animationConfig)}gotoAndStopByTime(t,e=0){const r=this.gotoAndPlayByTime(t,e,1);return r!==null&&r.stop(),r}gotoAndStopByFrame(t,e=0){const r=this.gotoAndPlayByFrame(t,e,1);return r!==null&&r.stop(),r}gotoAndStopByProgress(t,e=0){const r=this.gotoAndPlayByProgress(t,e,1);return r!==null&&r.stop(),r}getBlendState(t,e,r){t in this._blendStates||(this._blendStates[t]={});const s=this._blendStates[t];if(!(e in s)){const n=s[e]=O.borrowObject(he);n.target=r}return s[e]}getState(t,e=-1){let r=this._animationStates.length;for(;r--;){const s=this._animationStates[r];if(s.name===t&&(e<0||s.layer===e))return s}return null}hasAnimation(t){return t in this._animations}getStates(){return this._animationStates}get isPlaying(){for(const t of this._animationStates)if(t.isPlaying)return!0;return!1}get isCompleted(){for(const t of this._animationStates)if(!t.isCompleted)return!1;return this._animationStates.length>0}get lastAnimationName(){return this._lastAnimationState!==null?this._lastAnimationState.name:""}get animationNames(){return this._animationNames}get animations(){return this._animations}set animations(t){if(this._animations!==t){this._animationNames.length=0;for(let e in this._animations)delete this._animations[e];for(let e in t)this._animationNames.push(e),this._animations[e]=t[e]}}get animationConfig(){return this._animationConfig.clear(),this._animationConfig}get lastAnimationState(){return this._lastAnimationState}}class _M{constructor(t=0){this.time=0,this.timeScale=1,this._animatebles=[],this.time=t}advanceTime(t){if(t===0)return;t*=this.timeScale,this.time+=t;const e=this._animatebles;let r=0,s=0,n=e.length;for(;r<n;++r){const a=e[r];a!==null?(s>0&&(e[r-s]=a,e[r]=null),a.stopped||a.advanceTime(t)):s++}if(s>0){for(n=e.length;r<n;++r){const a=e[r];a!==null?e[r-s]=a:s++}if(s<8)for(let a=0;a<s;a+=1)e.pop();else e.splice(-s)}}contains(t){return this._animatebles.indexOf(t)>=0}add(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)}remove(t){const e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)}clear(){for(const t of this._animatebles)t!==null&&(t.clock=null)}}class dr extends O{constructor(){super(...arguments),this.stopped=!1,this._bones=[],this._slots=[],this._constraints=[],this._actions=[],this._animation=null,this._proxy=null,this._replaceTextureAtlasData=null,this._clock=null}static toString(){return"[class dragonBones.Armature]"}static _onSortSlots(t,e){return t._zIndex*1e3+t._zOrder>e._zIndex*1e3+e._zOrder?1:-1}_onClear(){this._clock!==null&&this._clock.remove(this);for(const t of this._bones)t.returnToPool();for(const t of this._slots)t.returnToPool();for(const t of this._constraints)t.returnToPool();for(const t of this._actions)t.returnToPool();this._animation!==null&&this._animation.returnToPool(),this._proxy!==null&&this._proxy.dbClear(),this._replaceTextureAtlasData!==null&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._zIndexDirty=!1,this._alphaDirty=!0,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._alpha=1,this._globalAlpha=1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null}_sortZOrder(t,e){const r=this._armatureData.sortedSlots,s=t===null;if(this._zOrderDirty||!s){for(let n=0,a=r.length;n<a;++n){const o=s?n:t[e+n];if(o<0||o>=a)continue;const l=r[o],h=this.getSlot(l.name);h!==null&&h._setZOrder(n)}this._slotsDirty=!0,this._zOrderDirty=!s}}_addBone(t){this._bones.indexOf(t)<0&&this._bones.push(t)}_addSlot(t){this._slots.indexOf(t)<0&&this._slots.push(t)}_addConstraint(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)}_bufferAction(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))}dispose(){this._armatureData!==null&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))}init(t,e,r,s){this._armatureData===null&&(this._armatureData=t,this._animation=O.borrowObject(mM),this._proxy=e,this._display=r,this._dragonBones=s,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)}advanceTime(t){if(this._lockUpdate)return;if(this._lockUpdate=!0,this._armatureData===null){console.warn("The armature has been disposed.");return}else if(this._armatureData.parent===null){console.warn(`The armature data has been disposed.
Please make sure dispose armature before call factory.clear().`);return}const e=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty||this._zIndexDirty){if(this._slots.sort(dr._onSortSlots),this._zIndexDirty)for(let r=0,s=this._slots.length;r<s;++r)this._slots[r]._setZOrder(r);this._slotsDirty=!1,this._zIndexDirty=!1}if(this._alphaDirty){this._alphaDirty=!1,this._globalAlpha=this._alpha*(this._parent!==null?this._parent._globalAlpha:1);for(const r of this._bones)r._updateAlpha();for(const r of this._slots)r._updateAlpha()}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==e){let r=0,s=0;for(r=0,s=this._bones.length;r<s;++r)this._bones[r].update(this._cacheFrameIndex);for(r=0,s=this._slots.length;r<s;++r)this._slots[r].update(this._cacheFrameIndex)}if(this._actions.length>0){for(const r of this._actions){const s=r.actionData;if(s!==null&&s.type===0)if(r.slot!==null){const n=r.slot.childArmature;n!==null&&n.animation.fadeIn(s.name)}else if(r.bone!==null){for(const n of this.getSlots())if(n.parent===r.bone){const a=n.childArmature;a!==null&&a.animation.fadeIn(s.name)}}else this._animation.fadeIn(s.name);r.returnToPool()}this._actions.length=0}if(this.clock==null)for(const r of this._slots){const s=r.childArmature;s!==null&&s.clock==null&&!s.stopped&&s.advanceTime(t)}this._lockUpdate=!1,this._proxy.dbUpdate()}invalidUpdate(t=null,e=!1){if(t!==null&&t.length>0){const r=this.getBone(t);if(r!==null&&(r.invalidUpdate(),e))for(const s of this._slots)s.parent===r&&s.invalidUpdate()}else{for(const r of this._bones)r.invalidUpdate();if(e)for(const r of this._slots)r.invalidUpdate()}}containsPoint(t,e){for(const r of this._slots)if(r.containsPoint(t,e))return r;return null}intersectsSegment(t,e,r,s,n=null,a=null,o=null){const l=t===r;let h=0,u=0,d=0,c=0,f=0,p=0,y=0,x=0,m=null,_=null;for(const g of this._slots)if(g.intersectsSegment(t,e,r,s,n,a,o)>0)if(n!==null||a!==null){if(n!==null){let A=l?n.y-e:n.x-t;A<0&&(A=-A),(m===null||A<h)&&(h=A,d=n.x,c=n.y,m=g,o&&(y=o.x))}if(a!==null){let A=a.x-t;A<0&&(A=-A),(_===null||A>u)&&(u=A,f=a.x,p=a.y,_=g,o!==null&&(x=o.y))}}else{m=g;break}return m!==null&&n!==null&&(n.x=d,n.y=c,o!==null&&(o.x=y)),_!==null&&a!==null&&(a.x=f,a.y=p,o!==null&&(o.y=x)),m}getBone(t){for(const e of this._bones)if(e.name===t)return e;return null}getBoneByDisplay(t){const e=this.getSlotByDisplay(t);return e!==null?e.parent:null}getSlot(t){for(const e of this._slots)if(e.name===t)return e;return null}getSlotByDisplay(t){if(t!==null){for(const e of this._slots)if(e.display===t)return e}return null}getBones(){return this._bones}getSlots(){return this._slots}get flipX(){return this._flipX}set flipX(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())}get flipY(){return this._flipY}set flipY(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())}get cacheFrameRate(){return this._armatureData.cacheFrameRate}set cacheFrameRate(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(const e of this._slots){const r=e.childArmature;r!==null&&(r.cacheFrameRate=t)}}}get name(){return this._armatureData.name}get armatureData(){return this._armatureData}get animation(){return this._animation}get proxy(){return this._proxy}get eventDispatcher(){return this._proxy}get display(){return this._display}get replacedTexture(){return this._replacedTexture}set replacedTexture(t){if(this._replacedTexture!==t){this._replaceTextureAtlasData!==null&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(const e of this._slots)e.invalidUpdate(),e.update(-1)}}get clock(){return this._clock}set clock(t){if(this._clock!==t){this._clock!==null&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(const e of this._slots){const r=e.childArmature;r!==null&&(r.clock=this._clock)}}}get parent(){return this._parent}getDisplay(){return this._display}}class Wa extends O{constructor(){super(...arguments),this.globalTransformMatrix=new mn,this.global=new rt,this.offset=new rt}_onClear(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._alpha=1,this._globalAlpha=1,this._armature=null}updateGlobalTransform(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))}get armature(){return this._armature}}Wa._helpMatrix=new mn;Wa._helpTransform=new rt;Wa._helpPoint=new Fh;class rT extends Wa{constructor(){super(...arguments),this.animationPose=new rt}static toString(){return"[class dragonBones.Bone]"}_onClear(){super._onClear(),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._boneData=null,this._parent=null,this._cachedFrameIndices=null}_updateGlobalTransformMatrix(t){const e=this._boneData,r=this.global,s=this.globalTransformMatrix,n=this.origin,a=this.offset,o=this.animationPose,l=this._parent,h=this._armature.flipX,u=this._armature.flipY===Be.yDown;let d=l!==null,c=0;if(this.offsetMode===1?n!==null?(r.x=n.x+a.x+o.x,r.scaleX=n.scaleX*a.scaleX*o.scaleX,r.scaleY=n.scaleY*a.scaleY*o.scaleY,Be.yDown?(r.y=n.y+a.y+o.y,r.skew=n.skew+a.skew+o.skew,r.rotation=n.rotation+a.rotation+o.rotation):(r.y=n.y-a.y+o.y,r.skew=n.skew-a.skew+o.skew,r.rotation=n.rotation-a.rotation+o.rotation)):(r.copyFrom(a),Be.yDown||(r.y=-r.y,r.skew=-r.skew,r.rotation=-r.rotation),r.add(o)):this.offsetMode===0?n!==null?r.copyFrom(n).add(o):r.copyFrom(o):(d=!1,r.copyFrom(a),Be.yDown||(r.y=-r.y,r.skew=-r.skew,r.rotation=-r.rotation)),d){const f=l._boneData.type===1,p=f?l._bone:null,y=f?l._getGlobalTransformMatrix(r.x,r.y):l.globalTransformMatrix;if(e.inheritScale&&(!f||p!==null))f?(e.inheritRotation&&(r.rotation+=l.global.rotation),p.updateGlobalTransform(),r.scaleX*=p.global.scaleX,r.scaleY*=p.global.scaleY,y.transformPoint(r.x,r.y,r),r.toMatrix(s),e.inheritTranslation?(r.x=s.tx,r.y=s.ty):(s.tx=r.x,s.ty=r.y)):(e.inheritRotation||(l.updateGlobalTransform(),h&&u?c=r.rotation-(l.global.rotation+Math.PI):h?c=r.rotation+l.global.rotation+Math.PI:u?c=r.rotation+l.global.rotation:c=r.rotation-l.global.rotation,r.rotation=c),r.toMatrix(s),s.concat(y),e.inheritTranslation?(r.x=s.tx,r.y=s.ty):(s.tx=r.x,s.ty=r.y),t?r.fromMatrix(s):this._globalDirty=!0);else{if(e.inheritTranslation){const x=r.x,m=r.y;r.x=y.a*x+y.c*m+y.tx,r.y=y.b*x+y.d*m+y.ty}else h&&(r.x=-r.x),u&&(r.y=-r.y);e.inheritRotation?(l.updateGlobalTransform(),l.global.scaleX<0?c=r.rotation+l.global.rotation+Math.PI:c=r.rotation+l.global.rotation,y.a*y.d-y.b*y.c<0&&(c-=r.rotation*2,(h!==u||e.inheritReflection)&&(r.skew+=Math.PI),Be.yDown||(r.skew=-r.skew)),r.rotation=c):(h||u)&&(h&&u?c=r.rotation+Math.PI:(h?c=Math.PI-r.rotation:c=-r.rotation,r.skew+=Math.PI),r.rotation=c),r.toMatrix(s)}}else(h||u)&&(h&&(r.x=-r.x),u&&(r.y=-r.y),h&&u?c=r.rotation+Math.PI:(h?c=Math.PI-r.rotation:c=-r.rotation,r.skew+=Math.PI),r.rotation=c),r.toMatrix(s)}_updateAlpha(){this._parent!==null?this._globalAlpha=this._alpha*this._parent._globalAlpha:this._globalAlpha=this._alpha*this._armature._globalAlpha}init(t,e){this._boneData===null&&(this._boneData=t,this._armature=e,this._alpha=this._boneData.alpha,this._boneData.parent!==null&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)}update(t){if(t>=0&&this._cachedFrameIndices!==null){const e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(const r of this._armature._constraints)r._root===this&&r.update();this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(const e of this._armature._constraints)e._root===this&&e.update();(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){const e=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(e),e&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0}updateByConstraint(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)}invalidUpdate(){this._transformDirty=!0}contains(t){if(t===this)return!1;let e=t;for(;e!==this&&e!==null;)e=e.parent;return e===this}get boneData(){return this._boneData}get visible(){return this._visible}set visible(t){if(this._visible!==t){this._visible=t;for(const e of this._armature.getSlots())e.parent===this&&e._updateVisible()}}get name(){return this._boneData.name}get parent(){return this._parent}}class Ya extends O{_onClear(){this._armature=null,this._target=null,this._root=null,this._bone=null}get name(){return this._constraintData.name}}Ya._helpMatrix=new mn;Ya._helpTransform=new rt;Ya._helpPoint=new Fh;class Og extends Ya{static toString(){return"[class dragonBones.IKConstraint]"}_onClear(){super._onClear(),this._bendPositive=!1,this._weight=1,this._constraintData=null}_computeA(){const t=this._target.global,e=this._root.global,r=this._root.globalTransformMatrix;let s=Math.atan2(t.y-e.y,t.x-e.x);e.scaleX<0&&(s+=Math.PI),e.rotation+=rt.normalizeRadian(s-e.rotation)*this._weight,e.toMatrix(r)}_computeB(){const t=this._bone._boneData.length,e=this._root,r=this._target.global,s=e.global,n=this._bone.global,a=this._bone.globalTransformMatrix,o=a.a*t,l=a.b*t,h=o*o+l*l,u=Math.sqrt(h);let d=n.x-s.x,c=n.y-s.y;const f=d*d+c*c,p=Math.sqrt(f),y=n.rotation,x=s.rotation,m=Math.atan2(c,d);d=r.x-s.x,c=r.y-s.y;const _=d*d+c*c,g=Math.sqrt(_);let T=0;if(u+p<=g||g+u<=p||g+p<=u)T=Math.atan2(r.y-s.y,r.x-s.x),u+p<=g||p<u&&(T+=Math.PI);else{const E=(f-h+_)/(2*_),C=Math.sqrt(f-E*E*_)/g,D=s.x+d*E,k=s.y+c*E,F=-c*C,b=d*C;let P=!1;const N=e.parent;if(N!==null){const H=N.globalTransformMatrix;P=H.a*H.d-H.b*H.c<0}P!==this._bendPositive?(n.x=D-F,n.y=k-b):(n.x=D+F,n.y=k+b),T=Math.atan2(n.y-s.y,n.x-s.x)}const A=rt.normalizeRadian(T-m);s.rotation=x+A*this._weight,s.toMatrix(e.globalTransformMatrix);const S=m+A*this._weight;n.x=s.x+Math.cos(S)*p,n.y=s.y+Math.sin(S)*p;let w=Math.atan2(r.y-n.y,r.x-n.x);n.scaleX<0&&(w+=Math.PI),n.rotation=s.rotation+y-x+rt.normalizeRadian(w-A-y)*this._weight,n.toMatrix(a)}init(t,e){if(this._constraintData===null){this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=this._constraintData.bone!==null?this._armature.getBone(this._constraintData.bone.name):null;{const r=this._constraintData;this._bendPositive=r.bendPositive,this._weight=r.weight}this._root._hasConstraint=!0}}update(){this._root.updateByConstraint(),this._bone!==null?(this._bone.updateByConstraint(),this._computeB()):this._computeA()}invalidUpdate(){this._root.invalidUpdate(),this._bone!==null&&this._bone.invalidUpdate()}}class gM extends Ya{constructor(){super(...arguments),this._bones=[],this._spaces=[],this._positions=[],this._curves=[],this._boneLengths=[],this._pathGlobalVertices=[],this._segments=[10]}static toString(){return"[class dragonBones.PathConstraint]"}_onClear(){super._onClear(),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0}_updatePathVertices(t){const e=this._armature,r=e.armatureData.parent,s=e.armatureData.scale,n=r.intArray,a=r.floatArray,o=t.offset,l=n[o+0],h=n[o+2];this._pathGlobalVertices.length=l*2;const u=t.weight;if(u===null){const m=this._pathSlot.parent;m.updateByConstraint();const _=m.globalTransformMatrix;for(let g=0,T=h;g<l;g+=2){const A=a[T++]*s,S=a[T++]*s,w=_.a*A+_.c*S+_.tx,E=_.b*A+_.d*S+_.ty;this._pathGlobalVertices[g]=w,this._pathGlobalVertices[g+1]=E}return}const d=this._pathSlot._geometryBones,c=u.bones.length,f=u.offset;let y=n[f+1],x=f+2+c;for(let m=0,_=0;m<l;m++){const g=n[x++];let T=0,A=0;for(let S=0,w=g;S<w;S++){const E=n[x++],C=d[E];if(C===null)continue;C.updateByConstraint();const D=C.globalTransformMatrix,k=a[y++],F=a[y++]*s,b=a[y++]*s;T+=(D.a*F+D.c*b+D.tx)*k,A+=(D.b*F+D.d*b+D.ty)*k}this._pathGlobalVertices[_++]=T,this._pathGlobalVertices[_++]=A}}_computeVertices(t,e,r,s){for(let n=r,a=t;n<e;n+=2)s[n]=this._pathGlobalVertices[a++],s[n+1]=this._pathGlobalVertices[a++]}_computeBezierCurve(t,e,r,s,n){const l=this._armature.armatureData.parent.intArray[t.geometry.offset+0],h=this._positions,u=this._spaces,d=t.closed,c=Array();let f=l*2,p=f/6,y=-1,x=this.position;h.length=e*3+2;let m=0;if(!t.constantSpeed){const B=t.curveLengths;if(p-=d?1:2,m=B[p],s&&(x*=m),n)for(let z=0;z<e;z++)u[z]*=m;c.length=8;for(let z=0,st=0,tt=0;z<e;z++,st+=3){const gt=u[z];if(x+=gt,d)x%=m,x<0&&(x+=m),tt=0;else{if(x<0)continue;if(x>m)continue}let et=0;for(;;tt++){const it=B[tt];if(!(x>it)){if(tt===0)et=x/it;else{const vt=B[tt-1];et=(x-vt)/(it-vt)}break}}tt!==y&&(y=tt,d&&tt===p?(this._computeVertices(f-4,4,0,c),this._computeVertices(0,4,4,c)):this._computeVertices(tt*6+2,8,0,c)),this.addCurvePosition(et,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,st,r)}return}d?(f+=2,c.length=l,this._computeVertices(2,f-4,0,c),this._computeVertices(0,2,f-4,c),c[f-2]=c[0],c[f-1]=c[1]):(p--,f-=4,c.length=f,this._computeVertices(2,f,0,c));let _=new Array(p);m=0;let g=c[0],T=c[1],A=0,S=0,w=0,E=0,C=0,D=0,k,F,b,P,N,H,U,R;for(let B=0,z=2;B<p;B++,z+=6)A=c[z],S=c[z+1],w=c[z+2],E=c[z+3],C=c[z+4],D=c[z+5],k=(g-A*2+w)*.1875,F=(T-S*2+E)*.1875,b=((A-w)*3-g+C)*.09375,P=((S-E)*3-T+D)*.09375,N=k*2+b,H=F*2+P,U=(A-g)*.75+k+b*.16666667,R=(S-T)*.75+F+P*.16666667,m+=Math.sqrt(U*U+R*R),U+=N,R+=H,N+=b,H+=P,m+=Math.sqrt(U*U+R*R),U+=N,R+=H,m+=Math.sqrt(U*U+R*R),U+=N+b,R+=H+P,m+=Math.sqrt(U*U+R*R),_[B]=m,g=C,T=D;if(s&&(x*=m),n)for(let B=0;B<e;B++)u[B]*=m;let V=this._segments,M=0;for(let B=0,z=0,st=0,tt=0;B<e;B++,z+=3){const gt=u[B];x+=gt;let et=x;if(d)et%=m,et<0&&(et+=m),st=0;else{if(et<0)continue;if(et>m)continue}for(;;st++){const it=_[st];if(!(et>it)){if(st===0)et/=it;else{const vt=_[st-1];et=(et-vt)/(it-vt)}break}}if(st!==y){y=st;let it=st*6;for(g=c[it],T=c[it+1],A=c[it+2],S=c[it+3],w=c[it+4],E=c[it+5],C=c[it+6],D=c[it+7],k=(g-A*2+w)*.03,F=(T-S*2+E)*.03,b=((A-w)*3-g+C)*.006,P=((S-E)*3-T+D)*.006,N=k*2+b,H=F*2+P,U=(A-g)*.3+k+b*.16666667,R=(S-T)*.3+F+P*.16666667,M=Math.sqrt(U*U+R*R),V[0]=M,it=1;it<8;it++)U+=N,R+=H,N+=b,H+=P,M+=Math.sqrt(U*U+R*R),V[it]=M;U+=N,R+=H,M+=Math.sqrt(U*U+R*R),V[8]=M,U+=N+b,R+=H+P,M+=Math.sqrt(U*U+R*R),V[9]=M,tt=0}for(et*=M;;tt++){const it=V[tt];if(!(et>it)){if(tt===0)et/=it;else{const vt=V[tt-1];et=tt+(et-vt)/(it-vt)}break}}this.addCurvePosition(et*.1,g,T,A,S,w,E,C,D,h,z,r)}}addCurvePosition(t,e,r,s,n,a,o,l,h,u,d,c){if(t===0){u[d]=e,u[d+1]=r,u[d+2]=0;return}if(t===1){u[d]=l,u[d+1]=h,u[d+2]=0;return}const f=1-t,p=f*f,y=t*t,x=p*f,m=p*t*3,_=f*y*3,g=t*y,T=x*e+m*s+_*a+g*l,A=x*r+m*n+_*o+g*h;u[d]=T,u[d+1]=A,c?u[d+2]=Math.atan2(A-(x*r+m*n+_*o),T-(x*e+m*s+_*a)):u[d+2]=0}init(t,e){this._constraintData=t,this._armature=e;let r=t;this.pathOffset=r.pathDisplayData.geometry.offset,this.position=r.position,this.spacing=r.spacing,this.rotateOffset=r.rotateOffset,this.rotateMix=r.rotateMix,this.translateMix=r.translateMix,this._root=this._armature.getBone(r.root.name),this._target=this._armature.getBone(r.target.name),this._pathSlot=this._armature.getSlot(r.pathSlot.name);for(let s=0,n=r.bones.length;s<n;s++){const a=this._armature.getBone(r.bones[s].name);a!==null&&this._bones.push(a)}r.rotateMode===2&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0}update(){const t=this._pathSlot;if(t._geometryData===null||t._geometryData.offset!==this.pathOffset)return;const e=this._constraintData;let r=!1;if(this._root._childrenTransformDirty?(this._updatePathVertices(t._geometryData),r=!0):(t._verticesDirty||t._isBonesUpdate())&&(this._updatePathVertices(t._geometryData),t._verticesDirty=!1,r=!0),!r&&!this.dirty)return;const s=e.positionMode,n=e.spacingMode,a=e.rotateMode,o=this._bones,l=n===0,h=a===2,u=a===0,d=o.length,c=u?d:d+1,f=this.spacing;let p=this._spaces;if(p.length=c,h||l){p[0]=0;for(let S=0,w=c-1;S<w;S++){const E=o[S];E.updateByConstraint();const C=E._boneData.length,D=E.globalTransformMatrix,k=C*D.a,F=C*D.b,b=Math.sqrt(k*k+F*F);h&&(this._boneLengths[S]=b),p[S+1]=(C+f)*b/C}}else for(let S=0;S<c;S++)p[S]=f;this._computeBezierCurve(t._displayFrame.rawDisplayData,c,u,s===1,n===2);const y=this._positions;let x=this.rotateOffset,m=y[0],_=y[1],g;if(x===0)g=a===1;else{g=!1;const S=t.parent;if(S!==null){const w=S.globalTransformMatrix;x*=w.a*w.d-w.b*w.c>0?rt.DEG_RAD:-rt.DEG_RAD}}const T=this.rotateMix,A=this.translateMix;for(let S=0,w=3;S<d;S++,w+=3){let E=o[S];E.updateByConstraint();let C=E.globalTransformMatrix;C.tx+=(m-C.tx)*A,C.ty+=(_-C.ty)*A;const D=y[w],k=y[w+1],F=D-m,b=k-_;if(h){const P=this._boneLengths[S],N=(Math.sqrt(F*F+b*b)/P-1)*T+1;C.a*=N,C.b*=N}if(m=D,_=k,T>0){let P=C.a,N=C.b,H=C.c,U=C.d,R,V,M;if(u?R=y[w-1]:R=Math.atan2(b,F),R-=Math.atan2(N,P),g){V=Math.cos(R),M=Math.sin(R);const B=E._boneData.length;m+=(B*(V*P-M*N)-F)*T,_+=(B*(M*P+V*N)-b)*T}else R+=x;R>rt.PI?R-=rt.PI_D:R<-rt.PI&&(R+=rt.PI_D),R*=T,V=Math.cos(R),M=Math.sin(R),C.a=V*P-M*N,C.b=M*P+V*N,C.c=V*H-M*U,C.d=M*H+V*U}E.global.fromMatrix(C)}this.dirty=!1}invalidUpdate(){}}class yM extends O{constructor(){super(...arguments),this.deformVertices=[]}static toString(){return"[class dragonBones.DisplayFrame]"}_onClear(){this.rawDisplayData=null,this.displayData=null,this.textureData=null,this.display=null,this.deformVertices.length=0}updateDeformVertices(){if(this.rawDisplayData===null||this.deformVertices.length!==0)return;let t;if(this.rawDisplayData.type===2)t=this.rawDisplayData.geometry;else if(this.rawDisplayData.type===4)t=this.rawDisplayData.geometry;else return;let e=0;t.weight!==null?e=t.weight.count*2:e=t.data.intArray[t.offset+0]*2,this.deformVertices.length=e;for(let r=0,s=this.deformVertices.length;r<s;++r)this.deformVertices[r]=0}getGeometryData(){if(this.displayData!==null){if(this.displayData.type===2)return this.displayData.geometry;if(this.displayData.type===4)return this.displayData.geometry}if(this.rawDisplayData!==null){if(this.rawDisplayData.type===2)return this.rawDisplayData.geometry;if(this.rawDisplayData.type===4)return this.rawDisplayData.geometry}return null}getBoundingBox(){return this.displayData!==null&&this.displayData.type===3?this.displayData.boundingBox:this.rawDisplayData!==null&&this.rawDisplayData.type===3?this.rawDisplayData.boundingBox:null}getTextureData(){if(this.displayData!==null){if(this.displayData.type===0)return this.displayData.texture;if(this.displayData.type===2)return this.displayData.texture}if(this.textureData!==null)return this.textureData;if(this.rawDisplayData!==null){if(this.rawDisplayData.type===0)return this.rawDisplayData.texture;if(this.rawDisplayData.type===2)return this.rawDisplayData.texture}return null}}class dt extends Wa{constructor(){super(...arguments),this._localMatrix=new mn,this._colorTransform=new Ph,this._displayFrames=[],this._geometryBones=[],this._rawDisplay=null,this._meshDisplay=null,this._display=null}_onClear(){super._onClear();const t=[];for(const e of this._displayFrames){const r=e.display;r!==this._rawDisplay&&r!==this._meshDisplay&&t.indexOf(r)<0&&t.push(r),e.returnToPool()}for(const e of t)e instanceof dr?e.dispose():this._disposeDisplay(e,!0);this._meshDisplay!==null&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),this._rawDisplay!==null&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDataDirty=!1,this._displayDirty=!1,this._geometryDirty=!1,this._textureDirty=!1,this._visibleDirty=!1,this._blendModeDirty=!1,this._zOrderDirty=!1,this._colorDirty=!1,this._verticesDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._zIndex=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayFrames.length=0,this._geometryBones.length=0,this._slotData=null,this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null}_hasDisplay(t){for(const e of this._displayFrames)if(e.display===t)return!0;return!1}_isBonesUpdate(){for(const t of this._geometryBones)if(t!==null&&t._childrenTransformDirty)return!0;return!1}_updateAlpha(){const t=this._alpha*this._parent._globalAlpha;this._globalAlpha!==t&&(this._globalAlpha=t,this._colorDirty=!0)}_updateDisplayData(){const t=this._displayFrame,e=this._geometryData,r=this._textureData;let s=null,n=null;if(this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&this._displayIndex<this._displayFrames.length&&(this._displayFrame=this._displayFrames[this._displayIndex],s=this._displayFrame.rawDisplayData,n=this._displayFrame.displayData,this._geometryData=this._displayFrame.getGeometryData(),this._boundingBoxData=this._displayFrame.getBoundingBox(),this._textureData=this._displayFrame.getTextureData()),this._displayFrame!==t||this._geometryData!==e||this._textureData!==r){if(this._geometryData===null&&this._textureData!==null){const a=n!==null&&n.type===0?n:s,o=this._textureData.parent.scale*this._armature._armatureData.scale,l=this._textureData.frame;this._pivotX=a.pivot.x,this._pivotY=a.pivot.y;const h=l!==null?l:this._textureData.region;let u=h.width,d=h.height;this._textureData.rotated&&l===null&&(u=h.height,d=h.width),this._pivotX*=u*o,this._pivotY*=d*o,l!==null&&(this._pivotX+=l.x*o,this._pivotY+=l.y*o),s!==null&&a!==s&&(s.transform.toMatrix(dt._helpMatrix),dt._helpMatrix.invert(),dt._helpMatrix.transformPoint(0,0,dt._helpPoint),this._pivotX-=dt._helpPoint.x,this._pivotY-=dt._helpPoint.y,a.transform.toMatrix(dt._helpMatrix),dt._helpMatrix.invert(),dt._helpMatrix.transformPoint(0,0,dt._helpPoint),this._pivotX+=dt._helpPoint.x,this._pivotY+=dt._helpPoint.y),Be.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*o-this._pivotY)}else this._pivotX=0,this._pivotY=0;if(s!==null?this.origin=s.transform:n!==null?this.origin=n.transform:this.origin=null,this.origin!==null?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix),this._geometryData!==e)if(this._geometryDirty=!0,this._verticesDirty=!0,this._geometryData!==null){if(this._geometryBones.length=0,this._geometryData.weight!==null)for(let a=0,o=this._geometryData.weight.bones.length;a<o;++a){const l=this._armature.getBone(this._geometryData.weight.bones[a].name);this._geometryBones.push(l)}}else this._geometryBones.length=0,this._geometryData=null;this._textureDirty=this._textureData!==r,this._transformDirty=!0}}_updateDisplay(){const t=this._display!==null?this._display:this._rawDisplay,e=this._childArmature;if(this._displayFrame!==null?(this._display=this._displayFrame.display,this._display!==null&&this._display instanceof dr?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null),(this._display!==null?this._display:this._rawDisplay)!==t&&(this._textureDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._transformDirty=!0,this._onUpdateDisplay(),this._replaceDisplay(t)),this._childArmature!==e&&(e!==null&&(e._parent=null,e.clock=null,e.inheritAnimation&&e.animation.reset()),this._childArmature!==null&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(this._childArmature.cacheFrameRate===0){const s=this._armature.cacheFrameRate;s!==0&&(this._childArmature.cacheFrameRate=s)}if(this._displayFrame!==null){let s=null,n=this._displayFrame.displayData!==null?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(n!==null&&n.type===1&&(s=n.actions),s!==null&&s.length>0)for(const a of s){const o=O.borrowObject(lt);lt.actionDataToInstance(a,o,this._armature),o.slot=this,this._armature._bufferAction(o,!1)}else this._childArmature.animation.play()}}}_updateGlobalTransformMatrix(t){const e=this._parent._boneData.type===0?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(e),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0}_setDisplayIndex(t,e=!1){if(e){if(this._animationDisplayIndex===t)return;this._animationDisplayIndex=t}this._displayIndex!==t&&(this._displayIndex=t<this._displayFrames.length?t:this._displayFrames.length-1,this._displayDataDirty=!0,this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display)}_setZOrder(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty}_setColor(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0}init(t,e,r,s){if(this._slotData!==null)return;this._slotData=t,this._colorDirty=!0,this._blendModeDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._zIndex=this._slotData.zIndex,this._alpha=this._slotData.alpha,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=r,this._meshDisplay=s,this._armature=e;const n=this._armature.getBone(this._slotData.parent.name);n!==null&&(this._parent=n),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}update(t){if(this._displayDataDirty&&(this._updateDisplayData(),this._displayDataDirty=!1),this._displayDirty&&(this._updateDisplay(),this._displayDirty=!1),(this._geometryDirty||this._textureDirty)&&((this._display===null||this._display===this._rawDisplay||this._display===this._meshDisplay)&&this._updateFrame(),this._geometryDirty=!1,this._textureDirty=!1),this._display!==null){if(this._visibleDirty&&(this._updateVisible(),this._visibleDirty=!1),this._blendModeDirty&&(this._updateBlendMode(),this._blendModeDirty=!1),this._colorDirty&&(this._updateColor(),this._colorDirty=!1),this._zOrderDirty&&(this._updateZOrder(),this._zOrderDirty=!1),this._geometryData!==null&&this._display===this._meshDisplay){const e=this._geometryData.weight!==null,r=this._parent._boneData.type!==0;if((this._verticesDirty||e&&this._isBonesUpdate()||r&&this._parent._childrenTransformDirty)&&(this._verticesDirty=!1,this._updateMesh()),e||r)return}if(t>=0&&this._cachedFrameIndices!==null){const e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._transformDirty){if(this._cachedFrameIndex<0){const e=t>=0;this._updateGlobalTransformMatrix(e),e&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(),this._transformDirty=!1}}}invalidUpdate(){this._displayDataDirty=!0,this._displayDirty=!0,this._transformDirty=!0}updateTransformAndMatrix(){this._transformDirty&&(this._updateGlobalTransformMatrix(!1),this._transformDirty=!1)}replaceRawDisplayData(t,e=-1){if(e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;const r=this._displayFrames[e];if(r.rawDisplayData!==t){if(r.deformVertices.length=0,r.rawDisplayData=t,r.rawDisplayData===null){const s=this._armature._armatureData.defaultSkin;if(s!==null){const n=s.getDisplays(this._slotData.name);n!==null&&e<n.length&&(r.rawDisplayData=n[e])}}e===this._displayIndex&&(this._displayDataDirty=!0)}}replaceDisplayData(t,e=-1){if(e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;const r=this._displayFrames[e];r.displayData!==t&&r.rawDisplayData!==t&&(r.displayData=t,e===this._displayIndex&&(this._displayDataDirty=!0))}replaceTextureData(t,e=-1){if(e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;const r=this._displayFrames[e];r.textureData!==t&&(r.textureData=t,e===this._displayIndex&&(this._displayDataDirty=!0))}replaceDisplay(t,e=-1){if(e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;const r=this._displayFrames[e];if(r.display!==t){const s=r.display;r.display=t,s!==null&&s!==this._rawDisplay&&s!==this._meshDisplay&&!this._hasDisplay(s)&&(s instanceof dr||this._disposeDisplay(s,!0)),t!==null&&t!==this._rawDisplay&&t!==this._meshDisplay&&!this._hasDisplay(s)&&!(t instanceof dr)&&this._initDisplay(t,!0),e===this._displayIndex&&(this._displayDirty=!0)}}containsPoint(t,e){return this._boundingBoxData===null?!1:(this.updateTransformAndMatrix(),dt._helpMatrix.copyFrom(this.globalTransformMatrix),dt._helpMatrix.invert(),dt._helpMatrix.transformPoint(t,e,dt._helpPoint),this._boundingBoxData.containsPoint(dt._helpPoint.x,dt._helpPoint.y))}intersectsSegment(t,e,r,s,n=null,a=null,o=null){if(this._boundingBoxData===null)return 0;this.updateTransformAndMatrix(),dt._helpMatrix.copyFrom(this.globalTransformMatrix),dt._helpMatrix.invert(),dt._helpMatrix.transformPoint(t,e,dt._helpPoint),t=dt._helpPoint.x,e=dt._helpPoint.y,dt._helpMatrix.transformPoint(r,s,dt._helpPoint),r=dt._helpPoint.x,s=dt._helpPoint.y;const l=this._boundingBoxData.intersectsSegment(t,e,r,s,n,a,o);return l>0&&(l===1||l===2?n!==null?(this.globalTransformMatrix.transformPoint(n.x,n.y,n),a!==null&&(a.x=n.x,a.y=n.y)):a!==null&&this.globalTransformMatrix.transformPoint(a.x,a.y,a):(n!==null&&this.globalTransformMatrix.transformPoint(n.x,n.y,n),a!==null&&this.globalTransformMatrix.transformPoint(a.x,a.y,a)),o!==null&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),dt._helpPoint,!0),o.x=Math.atan2(dt._helpPoint.y,dt._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),dt._helpPoint,!0),o.y=Math.atan2(dt._helpPoint.y,dt._helpPoint.x))),l}getDisplayFrameAt(t){return this._displayFrames[t]}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateVisible())}get displayFrameCount(){return this._displayFrames.length}set displayFrameCount(t){const e=this._displayFrames.length;if(e<t){this._displayFrames.length=t;for(let r=e;r<t;++r)this._displayFrames[r]=O.borrowObject(yM)}else if(e>t){for(let r=e-1;r<t;--r)this.replaceDisplay(null,r),this._displayFrames[r].returnToPool();this._displayFrames.length=t}}get displayIndex(){return this._displayIndex}set displayIndex(t){this._setDisplayIndex(t),this.update(-1)}get name(){return this._slotData.name}get displayList(){const t=new Array;for(const e of this._displayFrames)t.push(e.display);return t}set displayList(t){this.displayFrameCount=t.length;let e=0;for(const r of t)this.replaceDisplay(r,e++)}get slotData(){return this._slotData}get boundingBoxData(){return this._boundingBoxData}get rawDisplay(){return this._rawDisplay}get meshDisplay(){return this._meshDisplay}get display(){return this._display}set display(t){this._display!==t&&(this._displayFrames.length===0&&(this.displayFrameCount=1,this._displayIndex=0),this.replaceDisplay(t,this._displayIndex))}get childArmature(){return this._childArmature}set childArmature(t){this._childArmature!==t&&(this.display=t)}get parent(){return this._parent}getDisplay(){return this._display}setDisplay(t){this.display=t}}class _e extends rT{constructor(){super(...arguments),this._vertices=[],this._deformVertices=[],this._hullCache=[],this._matrixCahce=[]}static toString(){return"[class dragonBones.Surface]"}_onClear(){super._onClear(),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0,this._bone=null}_getAffineTransform(t,e,r,s,n,a,o,l,h,u,d,c,f){const p=o-n,y=l-a,x=h-n,m=u-a;d.rotation=Math.atan2(y,p),d.skew=Math.atan2(m,x)-Math.PI*.5-d.rotation,f&&(d.rotation+=Math.PI),d.scaleX=Math.sqrt(p*p+y*y)/r,d.scaleY=Math.sqrt(x*x+m*m)/s,d.toMatrix(c),d.x=c.tx=n-(c.a*t+c.c*e),d.y=c.ty=a-(c.b*t+c.d*e)}_updateVertices(){const t=this._armature.armatureData.parent,e=this._boneData.geometry,r=t.intArray,s=t.floatArray,n=r[e.offset+0],a=r[e.offset+2],o=this._vertices,l=this._deformVertices;if(this._parent!==null)if(this._parent._boneData.type===1)for(let h=0,u=n;h<u;++h){const d=h*2,c=s[a+d]+l[d],f=s[a+d+1]+l[d+1],p=this._parent._getGlobalTransformMatrix(c,f);o[d]=p.a*c+p.c*f+p.tx,o[d+1]=p.b*c+p.d*f+p.ty}else{const h=this._parent.globalTransformMatrix;for(let u=0,d=n;u<d;++u){const c=u*2,f=s[a+c]+l[c],p=s[a+c+1]+l[c+1];o[c]=h.a*f+h.c*p+h.tx,o[c+1]=h.b*f+h.d*p+h.ty}}else for(let h=0,u=n;h<u;++h){const d=h*2;o[d]=s[a+d]+l[d],o[d+1]=s[a+d+1]+l[d+1]}}_updateGlobalTransformMatrix(t){const e=this._boneData.segmentX*2,r=this._vertices.length-2,s=200,n=this._vertices[0],a=this._vertices[1],o=this._vertices[e],l=this._vertices[e+1],h=this._vertices[r],u=this._vertices[r+1],d=this._vertices[r-e],c=this._vertices[r-e+1],f=n+(h-n)*.5,p=a+(u-a)*.5,y=o+(d-o)*.5,x=l+(c-l)*.5,m=f+(y-f)*.5,_=p+(x-p)*.5,g=o+(h-o)*.5,T=l+(u-l)*.5,A=d+(h-d)*.5,S=c+(u-c)*.5;this._getAffineTransform(0,0,s,s,m,_,g,T,A,S,this.global,this.globalTransformMatrix,!1),this._globalDirty=!1}_getGlobalTransformMatrix(t,e){if(t<-1e3||1e3<t||e<-1e3||1e3<e)return this.globalTransformMatrix;let n=!1;const a=this._boneData,o=a.segmentX,l=a.segmentY,h=a.segmentX*2,u=this._dX,d=this._dY,c=Math.floor((t+200)/u),f=Math.floor((e+200)/d);let p=0,y=c*u-200,x=f*d-200;const m=this._matrixCahce,_=_e._helpMatrix;if(t<-200){if(e<-200||e>=200)return this.globalTransformMatrix;if(n=e>this._kX*(t+200)+x,p=((o*l+o+l+l+f)*2+(n?1:0))*7,m[p]>0)_.copyFromArray(m,p+1);else{const g=f*(h+2),T=this._hullCache[4],A=this._hullCache[5],S=this._hullCache[2]-(l-f)*T,w=this._hullCache[3]-(l-f)*A,E=this._vertices;n?this._getAffineTransform(-200,x+d,800,d,E[g+h+2],E[g+h+3],S+T,w+A,E[g],E[g+1],_e._helpTransform,_,!0):this._getAffineTransform(-1e3,x,800,d,S,w,E[g],E[g+1],S+T,w+A,_e._helpTransform,_,!1),m[p]=1,m[p+1]=_.a,m[p+2]=_.b,m[p+3]=_.c,m[p+4]=_.d,m[p+5]=_.tx,m[p+6]=_.ty}}else if(t>=200){if(e<-200||e>=200)return this.globalTransformMatrix;if(n=e>this._kX*(t-1e3)+x,p=((o*l+o+f)*2+(n?1:0))*7,m[p]>0)_.copyFromArray(m,p+1);else{const g=(f+1)*(h+2)-2,T=this._hullCache[4],A=this._hullCache[5],S=this._hullCache[0]+f*T,w=this._hullCache[1]+f*A,E=this._vertices;n?this._getAffineTransform(1e3,x+d,800,d,S+T,w+A,E[g+h+2],E[g+h+3],S,w,_e._helpTransform,_,!0):this._getAffineTransform(200,x,800,d,E[g],E[g+1],S,w,E[g+h+2],E[g+h+3],_e._helpTransform,_,!1),m[p]=1,m[p+1]=_.a,m[p+2]=_.b,m[p+3]=_.c,m[p+4]=_.d,m[p+5]=_.tx,m[p+6]=_.ty}}else if(e<-200){if(t<-200||t>=200)return this.globalTransformMatrix;if(n=e>this._kY*(t-y-u)-1e3,p=((o*l+c)*2+(n?1:0))*7,m[p]>0)_.copyFromArray(m,p+1);else{const g=c*2,T=this._hullCache[10],A=this._hullCache[11],S=this._hullCache[8]+c*T,w=this._hullCache[9]+c*A,E=this._vertices;n?this._getAffineTransform(y+u,-200,u,800,E[g+2],E[g+3],E[g],E[g+1],S+T,w+A,_e._helpTransform,_,!0):this._getAffineTransform(y,-1e3,u,800,S,w,S+T,w+A,E[g],E[g+1],_e._helpTransform,_,!1),m[p]=1,m[p+1]=_.a,m[p+2]=_.b,m[p+3]=_.c,m[p+4]=_.d,m[p+5]=_.tx,m[p+6]=_.ty}}else if(e>=200){if(t<-200||t>=200)return this.globalTransformMatrix;if(n=e>this._kY*(t-y-u)+200,p=((o*l+o+l+c)*2+(n?1:0))*7,m[p]>0)_.copyFromArray(m,p+1);else{const g=l*(h+2)+c*2,T=this._hullCache[10],A=this._hullCache[11],S=this._hullCache[6]-(o-c)*T,w=this._hullCache[7]-(o-c)*A,E=this._vertices;n?this._getAffineTransform(y+u,1e3,u,800,S+T,w+A,S,w,E[g+2],E[g+3],_e._helpTransform,_,!0):this._getAffineTransform(y,200,u,800,E[g],E[g+1],E[g+2],E[g+3],S,w,_e._helpTransform,_,!1),m[p]=1,m[p+1]=_.a,m[p+2]=_.b,m[p+3]=_.c,m[p+4]=_.d,m[p+5]=_.tx,m[p+6]=_.ty}}else if(n=e>this._k*(t-y-u)+x,p=((o*f+c)*2+(n?1:0))*7,m[p]>0)_.copyFromArray(m,p+1);else{const g=c*2+f*(h+2),T=this._vertices;n?this._getAffineTransform(y+u,x+d,u,d,T[g+h+4],T[g+h+5],T[g+h+2],T[g+h+3],T[g+2],T[g+3],_e._helpTransform,_,!0):this._getAffineTransform(y,x,u,d,T[g],T[g+1],T[g+2],T[g+3],T[g+h+2],T[g+h+3],_e._helpTransform,_,!1),m[p]=1,m[p+1]=_.a,m[p+2]=_.b,m[p+3]=_.c,m[p+4]=_.d,m[p+5]=_.tx,m[p+6]=_.ty}return _}init(t,e){if(this._boneData!==null)return;super.init(t,e);const r=t.segmentX,s=t.segmentY,n=this._armature.armatureData.parent.intArray[t.geometry.offset+0],a=1e3,o=200;this._dX=o*2/r,this._dY=o*2/s,this._k=-this._dY/this._dX,this._kX=-this._dY/(a-o),this._kY=-800/this._dX,this._vertices.length=n*2,this._deformVertices.length=n*2,this._matrixCahce.length=(r*s+r*2+s*2)*2*7,this._hullCache.length=10;for(let l=0;l<n*2;++l)this._deformVertices[l]=0;this._parent!==null&&(this._parent.boneData.type===0?this._bone=this._parent:this._bone=this._parent._bone)}update(t){if(t>=0&&this._cachedFrameIndices!==null){const e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(const r of this._armature._constraints)r._root===this&&r.update();this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(const e of this._armature._constraints)e._root===this&&e.update();(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(let o=0,l=this._matrixCahce.length;o<l;o+=7)this._matrixCahce[o]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){const o=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(o),o&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);const e=1e3,r=200,s=2*this.global.x,n=2*this.global.y,a=_e._helpPoint;this.globalTransformMatrix.transformPoint(e,-200,a),this._hullCache[0]=a.x,this._hullCache[1]=a.y,this._hullCache[2]=s-a.x,this._hullCache[3]=n-a.y,this.globalTransformMatrix.transformPoint(0,this._dY,a,!0),this._hullCache[4]=a.x,this._hullCache[5]=a.y,this.globalTransformMatrix.transformPoint(r,e,a),this._hullCache[6]=a.x,this._hullCache[7]=a.y,this._hullCache[8]=s-a.x,this._hullCache[9]=n-a.y,this.globalTransformMatrix.transformPoint(this._dX,0,a,!0),this._hullCache[10]=a.x,this._hullCache[11]=a.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0}}class v{static _getArmatureType(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}}static _getBoneType(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}}static _getPositionMode(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}}static _getSpacingMode(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}}static _getRotateMode(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}}static _getDisplayType(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}}static _getBoundingBoxType(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}}static _getBlendMode(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}}static _getAnimationBlendType(t){switch(t.toLowerCase()){case"none":return 0;case"1d":return 1;default:return 0}}static _getActionType(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}}}v.DATA_VERSION_2_3="2.3";v.DATA_VERSION_3_0="3.0";v.DATA_VERSION_4_0="4.0";v.DATA_VERSION_4_5="4.5";v.DATA_VERSION_5_0="5.0";v.DATA_VERSION_5_5="5.5";v.DATA_VERSION_5_6="5.6";v.DATA_VERSION=v.DATA_VERSION_5_6;v.DATA_VERSIONS=[v.DATA_VERSION_4_0,v.DATA_VERSION_4_5,v.DATA_VERSION_5_0,v.DATA_VERSION_5_5,v.DATA_VERSION_5_6];v.TEXTURE_ATLAS="textureAtlas";v.SUB_TEXTURE="SubTexture";v.FORMAT="format";v.IMAGE_PATH="imagePath";v.WIDTH="width";v.HEIGHT="height";v.ROTATED="rotated";v.FRAME_X="frameX";v.FRAME_Y="frameY";v.FRAME_WIDTH="frameWidth";v.FRAME_HEIGHT="frameHeight";v.DRADON_BONES="dragonBones";v.USER_DATA="userData";v.ARMATURE="armature";v.CANVAS="canvas";v.BONE="bone";v.SURFACE="surface";v.SLOT="slot";v.CONSTRAINT="constraint";v.SKIN="skin";v.DISPLAY="display";v.FRAME="frame";v.IK="ik";v.PATH_CONSTRAINT="path";v.ANIMATION="animation";v.TIMELINE="timeline";v.FFD="ffd";v.TRANSLATE_FRAME="translateFrame";v.ROTATE_FRAME="rotateFrame";v.SCALE_FRAME="scaleFrame";v.DISPLAY_FRAME="displayFrame";v.COLOR_FRAME="colorFrame";v.DEFAULT_ACTIONS="defaultActions";v.ACTIONS="actions";v.EVENTS="events";v.INTS="ints";v.FLOATS="floats";v.STRINGS="strings";v.TRANSFORM="transform";v.PIVOT="pivot";v.AABB="aabb";v.COLOR="color";v.VERSION="version";v.COMPATIBLE_VERSION="compatibleVersion";v.FRAME_RATE="frameRate";v.TYPE="type";v.SUB_TYPE="subType";v.NAME="name";v.PARENT="parent";v.TARGET="target";v.STAGE="stage";v.SHARE="share";v.PATH="path";v.LENGTH="length";v.DISPLAY_INDEX="displayIndex";v.Z_ORDER="zOrder";v.Z_INDEX="zIndex";v.BLEND_MODE="blendMode";v.INHERIT_TRANSLATION="inheritTranslation";v.INHERIT_ROTATION="inheritRotation";v.INHERIT_SCALE="inheritScale";v.INHERIT_REFLECTION="inheritReflection";v.INHERIT_ANIMATION="inheritAnimation";v.INHERIT_DEFORM="inheritDeform";v.SEGMENT_X="segmentX";v.SEGMENT_Y="segmentY";v.BEND_POSITIVE="bendPositive";v.CHAIN="chain";v.WEIGHT="weight";v.BLEND_TYPE="blendType";v.FADE_IN_TIME="fadeInTime";v.PLAY_TIMES="playTimes";v.SCALE="scale";v.OFFSET="offset";v.POSITION="position";v.DURATION="duration";v.TWEEN_EASING="tweenEasing";v.TWEEN_ROTATE="tweenRotate";v.TWEEN_SCALE="tweenScale";v.CLOCK_WISE="clockwise";v.CURVE="curve";v.SOUND="sound";v.EVENT="event";v.ACTION="action";v.X="x";v.Y="y";v.SKEW_X="skX";v.SKEW_Y="skY";v.SCALE_X="scX";v.SCALE_Y="scY";v.VALUE="value";v.ROTATE="rotate";v.SKEW="skew";v.ALPHA="alpha";v.ALPHA_OFFSET="aO";v.RED_OFFSET="rO";v.GREEN_OFFSET="gO";v.BLUE_OFFSET="bO";v.ALPHA_MULTIPLIER="aM";v.RED_MULTIPLIER="rM";v.GREEN_MULTIPLIER="gM";v.BLUE_MULTIPLIER="bM";v.UVS="uvs";v.VERTICES="vertices";v.TRIANGLES="triangles";v.WEIGHTS="weights";v.SLOT_POSE="slotPose";v.BONE_POSE="bonePose";v.BONES="bones";v.POSITION_MODE="positionMode";v.SPACING_MODE="spacingMode";v.ROTATE_MODE="rotateMode";v.SPACING="spacing";v.ROTATE_OFFSET="rotateOffset";v.ROTATE_MIX="rotateMix";v.TRANSLATE_MIX="translateMix";v.TARGET_DISPLAY="targetDisplay";v.CLOSED="closed";v.CONSTANT_SPEED="constantSpeed";v.VERTEX_COUNT="vertexCount";v.LENGTHS="lengths";v.GOTO_AND_PLAY="gotoAndPlay";v.DEFAULT_NAME="default";class I extends v{constructor(){super(...arguments),this._rawTextureAtlasIndex=0,this._rawBones=[],this._data=null,this._armature=null,this._bone=null,this._geometry=null,this._slot=null,this._skin=null,this._mesh=null,this._animation=null,this._timeline=null,this._rawTextureAtlases=null,this._frameValueType=0,this._defaultColorOffset=-1,this._prevClockwise=0,this._prevRotation=0,this._frameDefaultValue=0,this._frameValueScale=1,this._helpMatrixA=new mn,this._helpMatrixB=new mn,this._helpTransform=new rt,this._helpColorTransform=new Ph,this._helpPoint=new Fh,this._helpArray=[],this._intArray=[],this._floatArray=[],this._frameIntArray=[],this._frameFloatArray=[],this._frameArray=[],this._timelineArray=[],this._colorArray=[],this._cacheRawMeshes=[],this._cacheMeshes=[],this._actionFrames=[],this._weightSlotPose={},this._weightBonePoses={},this._cacheBones={},this._slotChildActions={}}static _getBoolean(t,e,r){if(e in t){const s=t[e],n=typeof s;if(n==="boolean")return s;if(n==="string")switch(s){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}else return!!s}return r}static _getNumber(t,e,r){if(e in t){const s=t[e];return s===null||s==="NaN"?r:+s||0}return r}static _getString(t,e,r){if(e in t){const s=t[e];return typeof s==="string"?s:s.toString()}return r}_getCurvePoint(t,e,r,s,n,a,o,l,h,u){const d=1-h,c=d*d,f=h*h,p=d*c,y=3*h*c,x=3*d*f,m=h*f;u.x=p*t+y*r+x*n+m*o,u.y=p*e+y*s+x*a+m*l}_samplingEasingCurve(t,e){const r=t.length;if(r%3===1){let s=-2;for(let n=0,a=e.length;n<a;++n){let o=(n+1)/(a+1);for(;(s+6<r?t[s+6]:1)<o;)s+=6;const l=s>=0&&s+6<r,h=l?t[s]:0,u=l?t[s+1]:0,d=t[s+2],c=t[s+3],f=t[s+4],p=t[s+5],y=l?t[s+6]:1,x=l?t[s+7]:1;let m=0,_=1;for(;_-m>1e-4;){const g=(_+m)*.5;this._getCurvePoint(h,u,d,c,f,p,y,x,g,this._helpPoint),o-this._helpPoint.x>0?m=g:_=g}e[n]=this._helpPoint.y}return!0}else{let s=0;for(let n=0,a=e.length;n<a;++n){let o=(n+1)/(a+1);for(;t[s+6]<o;)s+=6;const l=t[s],h=t[s+1],u=t[s+2],d=t[s+3],c=t[s+4],f=t[s+5],p=t[s+6],y=t[s+7];let x=0,m=1;for(;m-x>1e-4;){const _=(m+x)*.5;this._getCurvePoint(l,h,u,d,c,f,p,y,_,this._helpPoint),o-this._helpPoint.x>0?x=_:m=_}e[n]=this._helpPoint.y}return!1}}_parseActionDataInFrame(t,e,r,s){v.EVENT in t&&this._mergeActionFrame(t[v.EVENT],e,10,r,s),v.SOUND in t&&this._mergeActionFrame(t[v.SOUND],e,11,r,s),v.ACTION in t&&this._mergeActionFrame(t[v.ACTION],e,0,r,s),v.EVENTS in t&&this._mergeActionFrame(t[v.EVENTS],e,10,r,s),v.ACTIONS in t&&this._mergeActionFrame(t[v.ACTIONS],e,0,r,s)}_mergeActionFrame(t,e,r,s,n){const a=this._armature.actions.length,o=this._parseActionData(t,r,s,n);let l=0,h=null;for(const u of o)this._armature.addAction(u,!1);this._actionFrames.length===0&&(h=new nc,h.frameStart=0,this._actionFrames.push(h),h=null);for(const u of this._actionFrames){if(u.frameStart===e){h=u;break}else if(u.frameStart>e)break;l++}h===null&&(h=new nc,h.frameStart=e,this._actionFrames.splice(l,0,h));for(let u=0;u<o.length;++u)h.actions.push(a+u)}_parseArmature(t,e){const r=O.borrowObject(ZR);if(r.name=I._getString(t,v.NAME,""),r.frameRate=I._getNumber(t,v.FRAME_RATE,this._data.frameRate),r.scale=e,v.TYPE in t&&typeof t[v.TYPE]=="string"?r.type=v._getArmatureType(t[v.TYPE]):r.type=I._getNumber(t,v.TYPE,0),r.frameRate===0&&(r.frameRate=24),this._armature=r,v.CANVAS in t){const s=t[v.CANVAS],n=O.borrowObject(JR);v.COLOR in s?n.hasBackground=!0:n.hasBackground=!1,n.color=I._getNumber(s,v.COLOR,0),n.x=I._getNumber(s,v.X,0)*r.scale,n.y=I._getNumber(s,v.Y,0)*r.scale,n.width=I._getNumber(s,v.WIDTH,0)*r.scale,n.height=I._getNumber(s,v.HEIGHT,0)*r.scale,r.canvas=n}if(v.AABB in t){const s=t[v.AABB];r.aabb.x=I._getNumber(s,v.X,0)*r.scale,r.aabb.y=I._getNumber(s,v.Y,0)*r.scale,r.aabb.width=I._getNumber(s,v.WIDTH,0)*r.scale,r.aabb.height=I._getNumber(s,v.HEIGHT,0)*r.scale}if(v.BONE in t){const s=t[v.BONE];for(const n of s){const a=I._getString(n,v.PARENT,""),o=this._parseBone(n);if(a.length>0){const l=r.getBone(a);l!==null?o.parent=l:(a in this._cacheBones||(this._cacheBones[a]=[]),this._cacheBones[a].push(o))}if(o.name in this._cacheBones){for(const l of this._cacheBones[o.name])l.parent=o;delete this._cacheBones[o.name]}r.addBone(o),this._rawBones.push(o)}}if(v.IK in t){const s=t[v.IK];for(const n of s){const a=this._parseIKConstraint(n);a&&r.addConstraint(a)}}if(r.sortBones(),v.SLOT in t){let s=0;const n=t[v.SLOT];for(const a of n)r.addSlot(this._parseSlot(a,s++))}if(v.SKIN in t){const s=t[v.SKIN];for(const n of s)r.addSkin(this._parseSkin(n))}if(v.PATH_CONSTRAINT in t){const s=t[v.PATH_CONSTRAINT];for(const n of s){const a=this._parsePathConstraint(n);a&&r.addConstraint(a)}}for(let s=0,n=this._cacheRawMeshes.length;s<n;++s){const a=this._cacheRawMeshes[s],o=I._getString(a,v.SHARE,"");if(o.length===0)continue;let l=I._getString(a,v.SKIN,v.DEFAULT_NAME);l.length===0&&(l=v.DEFAULT_NAME);const h=r.getMesh(l,"",o);if(h===null)continue;this._cacheMeshes[s].geometry.shareFrom(h.geometry)}if(v.ANIMATION in t){const s=t[v.ANIMATION];for(const n of s){const a=this._parseAnimation(n);r.addAnimation(a)}}if(v.DEFAULT_ACTIONS in t){const s=this._parseActionData(t[v.DEFAULT_ACTIONS],0,null,null);for(const n of s)if(r.addAction(n,!0),n.type===0){const a=r.getAnimation(n.name);a!==null&&(r.defaultAnimation=a)}}if(v.ACTIONS in t){const s=this._parseActionData(t[v.ACTIONS],0,null,null);for(const n of s)r.addAction(n,!1)}this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null;for(let s in this._weightSlotPose)delete this._weightSlotPose[s];for(let s in this._weightBonePoses)delete this._weightBonePoses[s];for(let s in this._cacheBones)delete this._cacheBones[s];for(let s in this._slotChildActions)delete this._slotChildActions[s];return r}_parseBone(t){let e=0;if(v.TYPE in t&&typeof t[v.TYPE]=="string"?e=v._getBoneType(t[v.TYPE]):e=I._getNumber(t,v.TYPE,0),e===0){const s=this._armature.scale,n=O.borrowObject(eT);return n.inheritTranslation=I._getBoolean(t,v.INHERIT_TRANSLATION,!0),n.inheritRotation=I._getBoolean(t,v.INHERIT_ROTATION,!0),n.inheritScale=I._getBoolean(t,v.INHERIT_SCALE,!0),n.inheritReflection=I._getBoolean(t,v.INHERIT_REFLECTION,!0),n.length=I._getNumber(t,v.LENGTH,0)*s,n.alpha=I._getNumber(t,v.ALPHA,1),n.name=I._getString(t,v.NAME,""),v.TRANSFORM in t&&this._parseTransform(t[v.TRANSFORM],n.transform,s),n}const r=O.borrowObject(QR);return r.alpha=I._getNumber(t,v.ALPHA,1),r.name=I._getString(t,v.NAME,""),r.segmentX=I._getNumber(t,v.SEGMENT_X,0),r.segmentY=I._getNumber(t,v.SEGMENT_Y,0),this._parseGeometry(t,r.geometry),r}_parseIKConstraint(t){const e=this._armature.getBone(I._getString(t,v.BONE,""));if(e===null)return null;const r=this._armature.getBone(I._getString(t,v.TARGET,""));if(r===null)return null;const s=I._getNumber(t,v.CHAIN,0),n=O.borrowObject(tM);return n.scaleEnabled=I._getBoolean(t,v.SCALE,!1),n.bendPositive=I._getBoolean(t,v.BEND_POSITIVE,!0),n.weight=I._getNumber(t,v.WEIGHT,1),n.name=I._getString(t,v.NAME,""),n.type=0,n.target=r,s>0&&e.parent!==null?(n.root=e.parent,n.bone=e):(n.root=e,n.bone=null),n}_parsePathConstraint(t){const e=this._armature.getSlot(I._getString(t,v.TARGET,""));if(e===null)return null;const r=this._armature.defaultSkin;if(r===null)return null;const s=r.getDisplay(e.name,I._getString(t,v.TARGET_DISPLAY,e.name));if(s===null||!(s instanceof wg))return null;const n=t[v.BONES];if(n===null||n.length===0)return null;const a=O.borrowObject(eM);a.name=I._getString(t,v.NAME,""),a.type=1,a.pathSlot=e,a.pathDisplayData=s,a.target=e.parent,a.positionMode=v._getPositionMode(I._getString(t,v.POSITION_MODE,"")),a.spacingMode=v._getSpacingMode(I._getString(t,v.SPACING_MODE,"")),a.rotateMode=v._getRotateMode(I._getString(t,v.ROTATE_MODE,"")),a.position=I._getNumber(t,v.POSITION,0),a.spacing=I._getNumber(t,v.SPACING,0),a.rotateOffset=I._getNumber(t,v.ROTATE_OFFSET,0),a.rotateMix=I._getNumber(t,v.ROTATE_MIX,1),a.translateMix=I._getNumber(t,v.TRANSLATE_MIX,1);for(var o of n){const l=this._armature.getBone(o);l!==null&&(a.AddBone(l),a.root===null&&(a.root=l))}return a}_parseSlot(t,e){const r=O.borrowObject(ll);return r.displayIndex=I._getNumber(t,v.DISPLAY_INDEX,0),r.zOrder=e,r.zIndex=I._getNumber(t,v.Z_INDEX,0),r.alpha=I._getNumber(t,v.ALPHA,1),r.name=I._getString(t,v.NAME,""),r.parent=this._armature.getBone(I._getString(t,v.PARENT,"")),v.BLEND_MODE in t&&typeof t[v.BLEND_MODE]=="string"?r.blendMode=v._getBlendMode(t[v.BLEND_MODE]):r.blendMode=I._getNumber(t,v.BLEND_MODE,0),v.COLOR in t?(r.color=ll.createColor(),this._parseColorTransform(t[v.COLOR],r.color)):r.color=ll.DEFAULT_COLOR,v.ACTIONS in t&&(this._slotChildActions[r.name]=this._parseActionData(t[v.ACTIONS],0,null,null)),r}_parseSkin(t){const e=O.borrowObject(rM);if(e.name=I._getString(t,v.NAME,v.DEFAULT_NAME),e.name.length===0&&(e.name=v.DEFAULT_NAME),v.SLOT in t){const r=t[v.SLOT];this._skin=e;for(const s of r){const n=I._getString(s,v.NAME,""),a=this._armature.getSlot(n);if(a!==null){if(this._slot=a,v.DISPLAY in s){const o=s[v.DISPLAY];for(const l of o)l?e.addDisplay(n,this._parseDisplay(l)):e.addDisplay(n,null)}this._slot=null}}this._skin=null}return e}_parseDisplay(t){const e=I._getString(t,v.NAME,""),r=I._getString(t,v.PATH,"");let s=0,n=null;switch(v.TYPE in t&&typeof t[v.TYPE]=="string"?s=v._getDisplayType(t[v.TYPE]):s=I._getNumber(t,v.TYPE,s),s){case 0:{const a=n=O.borrowObject(YR);a.name=e,a.path=r.length>0?r:e,this._parsePivot(t,a);break}case 1:{const a=n=O.borrowObject(jR);if(a.name=e,a.path=r.length>0?r:e,a.inheritAnimation=!0,v.ACTIONS in t){const o=this._parseActionData(t[v.ACTIONS],0,null,null);for(const l of o)a.addAction(l)}else if(this._slot.name in this._slotChildActions){const o=this._skin.getDisplays(this._slot.name);if(o===null?this._slot.displayIndex===0:this._slot.displayIndex===o.length){for(const l of this._slotChildActions[this._slot.name])a.addAction(l);delete this._slotChildActions[this._slot.name]}}break}case 2:{const a=n=O.borrowObject(qR);a.geometry.inheritDeform=I._getBoolean(t,v.INHERIT_DEFORM,!0),a.name=e,a.path=r.length>0?r:e,v.SHARE in t?(a.geometry.data=this._data,this._cacheRawMeshes.push(t),this._cacheMeshes.push(a)):this._parseMesh(t,a);break}case 3:{const a=this._parseBoundingBox(t);if(a!==null){const o=n=O.borrowObject(KR);o.name=e,o.path=r.length>0?r:e,o.boundingBox=a}break}case 4:{const a=t[v.LENGTHS],o=n=O.borrowObject(wg);o.closed=I._getBoolean(t,v.CLOSED,!1),o.constantSpeed=I._getBoolean(t,v.CONSTANT_SPEED,!1),o.name=e,o.path=r.length>0?r:e,o.curveLengths.length=a.length;for(let l=0,h=a.length;l<h;++l)o.curveLengths[l]=a[l];this._parsePath(t,o);break}}return n!==null&&v.TRANSFORM in t&&this._parseTransform(t[v.TRANSFORM],n.transform,this._armature.scale),n}_parsePath(t,e){this._parseGeometry(t,e.geometry)}_parsePivot(t,e){if(v.PIVOT in t){const r=t[v.PIVOT];e.pivot.x=I._getNumber(r,v.X,0),e.pivot.y=I._getNumber(r,v.Y,0)}else e.pivot.x=.5,e.pivot.y=.5}_parseMesh(t,e){if(this._parseGeometry(t,e.geometry),v.WEIGHTS in t){const r=t[v.SLOT_POSE],s=t[v.BONE_POSE],n=this._skin.name+"_"+this._slot.name+"_"+e.name;this._weightSlotPose[n]=r,this._weightBonePoses[n]=s}}_parseBoundingBox(t){let e=null,r=0;switch(v.SUB_TYPE in t&&typeof t[v.SUB_TYPE]=="string"?r=v._getBoundingBoxType(t[v.SUB_TYPE]):r=I._getNumber(t,v.SUB_TYPE,r),r){case 0:e=O.borrowObject(ar);break;case 1:e=O.borrowObject(Sp);break;case 2:e=this._parsePolygonBoundingBox(t);break}return e!==null&&(e.color=I._getNumber(t,v.COLOR,0),(e.type===0||e.type===1)&&(e.width=I._getNumber(t,v.WIDTH,0),e.height=I._getNumber(t,v.HEIGHT,0))),e}_parsePolygonBoundingBox(t){const e=O.borrowObject(wp);if(v.VERTICES in t){const r=this._armature.scale,s=t[v.VERTICES],n=e.vertices;n.length=s.length;for(let a=0,o=s.length;a<o;a+=2){const l=s[a]*r,h=s[a+1]*r;n[a]=l,n[a+1]=h,a===0?(e.x=l,e.y=h,e.width=l,e.height=h):(l<e.x?e.x=l:l>e.width&&(e.width=l),h<e.y?e.y=h:h>e.height&&(e.height=h))}e.width-=e.x,e.height-=e.y}else console.warn(`Data error.
 Please reexport DragonBones Data to fixed the bug.`);return e}_parseAnimation(t){const e=O.borrowObject(Qx);if(e.blendType=v._getAnimationBlendType(I._getString(t,v.BLEND_TYPE,"")),e.frameCount=I._getNumber(t,v.DURATION,0),e.playTimes=I._getNumber(t,v.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=I._getNumber(t,v.FADE_IN_TIME,0),e.scale=I._getNumber(t,v.SCALE,1),e.name=I._getString(t,v.NAME,v.DEFAULT_NAME),e.name.length===0&&(e.name=v.DEFAULT_NAME),e.frameIntOffset=this._frameIntArray.length,e.frameFloatOffset=this._frameFloatArray.length,e.frameOffset=this._frameArray.length,this._animation=e,v.FRAME in t){const r=t[v.FRAME],s=r.length;if(s>0)for(let n=0,a=0;n<s;++n){const o=r[n];this._parseActionDataInFrame(o,a,null,null),a+=I._getNumber(o,v.DURATION,1)}}if(v.Z_ORDER in t&&(this._animation.zOrderTimeline=this._parseTimeline(t[v.Z_ORDER],null,v.FRAME,1,0,0,this._parseZOrderFrame)),v.BONE in t){const r=t[v.BONE];for(const s of r)this._parseBoneTimeline(s)}if(v.SLOT in t){const r=t[v.SLOT];for(const s of r)this._parseSlotTimeline(s)}if(v.FFD in t){const r=t[v.FFD];for(const s of r){let n=I._getString(s,v.SKIN,v.DEFAULT_NAME);const a=I._getString(s,v.SLOT,""),o=I._getString(s,v.NAME,"");if(n.length===0&&(n=v.DEFAULT_NAME),this._slot=this._armature.getSlot(a),this._mesh=this._armature.getMesh(n,a,o),this._slot===null||this._mesh===null)continue;const l=this._parseTimeline(s,null,v.FRAME,22,2,0,this._parseSlotDeformFrame);l!==null&&this._animation.addSlotTimeline(a,l),this._slot=null,this._mesh=null}}if(v.IK in t){const r=t[v.IK];for(const s of r){const n=I._getString(s,v.NAME,"");if(this._armature.getConstraint(n)===null)continue;const o=this._parseTimeline(s,null,v.FRAME,30,1,2,this._parseIKConstraintFrame);o!==null&&this._animation.addConstraintTimeline(n,o)}}if(this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,0,0,this._parseActionFrame),this._actionFrames.length=0),v.TIMELINE in t){const r=t[v.TIMELINE];for(const s of r){const n=I._getNumber(s,v.TYPE,0),a=I._getString(s,v.NAME,"");let o=null;switch(n){case 0:break;case 20:case 23:case 60:case 24:case 40:case 41:if(n===20?(this._frameValueType=0,this._frameValueScale=1):(this._frameValueType=1,n===23?this._frameValueScale=1:n===40||n===41?this._frameValueScale=1e4:this._frameValueScale=100),n===60||n===24||n===41?this._frameDefaultValue=1:this._frameDefaultValue=0,n===40&&e.blendType!==0){o=O.borrowObject(Jx);const l=o;l.x=I._getNumber(s,v.X,0),l.y=I._getNumber(s,v.Y,0)}o=this._parseTimeline(s,null,v.FRAME,n,this._frameValueType,1,this._parseSingleValueFrame,o);break;case 11:case 12:case 13:case 30:case 42:n===30||n===42?(this._frameValueType=1,n===42?this._frameValueScale=1e4:this._frameValueScale=100):(n===12?this._frameValueScale=rt.DEG_RAD:this._frameValueScale=1,this._frameValueType=2),n===13||n===30?this._frameDefaultValue=1:this._frameDefaultValue=0,o=this._parseTimeline(s,null,v.FRAME,n,this._frameValueType,2,this._parseDoubleValueFrame);break;case 1:break;case 50:{const l=this._armature.getBone(a);if(l===null)continue;this._geometry=l.geometry,o=this._parseTimeline(s,null,v.FRAME,n,2,0,this._parseDeformFrame),this._geometry=null;break}case 22:{this._geometry=null;for(const l in this._armature.skins){const h=this._armature.skins[l];for(const u in h.displays){const d=h.displays[u];for(const c of d)if(c!==null&&c.name===a){this._geometry=c.geometry;break}}}if(this._geometry===null)continue;o=this._parseTimeline(s,null,v.FRAME,n,2,0,this._parseDeformFrame),this._geometry=null;break}case 21:o=this._parseTimeline(s,null,v.FRAME,n,1,1,this._parseSlotColorFrame);break}if(o!==null)switch(n){case 0:break;case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(a,o);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(a,o);break;case 30:this._animation.addConstraintTimeline(a,o);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(a,o);break}}}return this._animation=null,e}_parseTimeline(t,e,r,s,n,a,o,l=null){if(t!==null&&r.length>0&&r in t&&(e=t[r]),e===null)return null;const h=e.length;if(h===0)return null;const u=this._frameIntArray.length,d=this._frameFloatArray.length,c=this._timelineArray.length;switch(l===null&&(l=O.borrowObject(Tp)),l.type=s,l.offset=c,this._frameValueType=n,this._timeline=l,this._timelineArray.length+=5+h,t!==null?(this._timelineArray[c+0]=Math.round(I._getNumber(t,v.SCALE,1)*100),this._timelineArray[c+1]=Math.round(I._getNumber(t,v.OFFSET,0)*100)):(this._timelineArray[c+0]=100,this._timelineArray[c+1]=0),this._timelineArray[c+2]=h,this._timelineArray[c+3]=a,this._frameValueType){case 0:this._timelineArray[c+4]=0;break;case 1:this._timelineArray[c+4]=u-this._animation.frameIntOffset;break;case 2:this._timelineArray[c+4]=d-this._animation.frameFloatOffset;break}if(h===1)l.frameIndicesOffset=-1,this._timelineArray[c+5+0]=o.call(this,e[0],0,0)-this._animation.frameOffset;else{const f=this._animation.frameCount+1,p=this._data.frameIndices,y=p.length;p.length+=f,l.frameIndicesOffset=y;for(let x=0,m=0,_=0,g=0;x<f;++x){if(_+g<=x&&m<h){const T=e[m];_=x,m===h-1?g=this._animation.frameCount-_:T instanceof nc?g=this._actionFrames[m+1].frameStart-_:g=I._getNumber(T,v.DURATION,1),this._timelineArray[c+5+m]=o.call(this,T,_,g)-this._animation.frameOffset,m++}p[y+x]=m-1}}return this._timeline=null,l}_parseBoneTimeline(t){const e=this._armature.getBone(I._getString(t,v.NAME,""));if(e!==null){if(this._bone=e,this._slot=this._armature.getSlot(this._bone.name),v.TRANSLATE_FRAME in t){this._frameDefaultValue=0,this._frameValueScale=1;const r=this._parseTimeline(t,null,v.TRANSLATE_FRAME,11,2,2,this._parseDoubleValueFrame);r!==null&&this._animation.addBoneTimeline(e.name,r)}if(v.ROTATE_FRAME in t){this._frameDefaultValue=0,this._frameValueScale=1;const r=this._parseTimeline(t,null,v.ROTATE_FRAME,12,2,2,this._parseBoneRotateFrame);r!==null&&this._animation.addBoneTimeline(e.name,r)}if(v.SCALE_FRAME in t){this._frameDefaultValue=1,this._frameValueScale=1;const r=this._parseTimeline(t,null,v.SCALE_FRAME,13,2,2,this._parseBoneScaleFrame);r!==null&&this._animation.addBoneTimeline(e.name,r)}if(v.FRAME in t){const r=this._parseTimeline(t,null,v.FRAME,10,2,6,this._parseBoneAllFrame);r!==null&&this._animation.addBoneTimeline(e.name,r)}this._bone=null,this._slot=null}}_parseSlotTimeline(t){const e=this._armature.getSlot(I._getString(t,v.NAME,""));if(e===null)return;let r=null,s=null;this._slot=e,v.DISPLAY_FRAME in t?r=this._parseTimeline(t,null,v.DISPLAY_FRAME,20,0,0,this._parseSlotDisplayFrame):r=this._parseTimeline(t,null,v.FRAME,20,0,0,this._parseSlotDisplayFrame),v.COLOR_FRAME in t?s=this._parseTimeline(t,null,v.COLOR_FRAME,21,1,1,this._parseSlotColorFrame):s=this._parseTimeline(t,null,v.FRAME,21,1,1,this._parseSlotColorFrame),r!==null&&this._animation.addSlotTimeline(e.name,r),s!==null&&this._animation.addSlotTimeline(e.name,s),this._slot=null}_parseFrame(t,e,r){const s=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[s+0]=e,s}_parseTweenFrame(t,e,r){const s=this._parseFrame(t,e,r);if(r>0)if(v.CURVE in t){const n=r+1;this._helpArray.length=n;const a=this._samplingEasingCurve(t[v.CURVE],this._helpArray);this._frameArray.length+=2+this._helpArray.length,this._frameArray[s+1]=2,this._frameArray[s+2]=a?n:-n;for(let o=0;o<n;++o)this._frameArray[s+3+o]=Math.round(this._helpArray[o]*1e4)}else{let a=-2;v.TWEEN_EASING in t&&(a=I._getNumber(t,v.TWEEN_EASING,-2)),a===-2?(this._frameArray.length+=1,this._frameArray[s+1]=0):a===0?(this._frameArray.length+=1,this._frameArray[s+1]=1):a<0?(this._frameArray.length+=2,this._frameArray[s+1]=3,this._frameArray[s+2]=Math.round(-a*100)):a<=1?(this._frameArray.length+=2,this._frameArray[s+1]=4,this._frameArray[s+2]=Math.round(a*100)):(this._frameArray.length+=2,this._frameArray[s+1]=5,this._frameArray[s+2]=Math.round(a*100-100))}else this._frameArray.length+=1,this._frameArray[s+1]=0;return s}_parseSingleValueFrame(t,e,r){let s=0;switch(this._frameValueType){case 0:{s=this._parseFrame(t,e,r),this._frameArray.length+=1,this._frameArray[s+1]=I._getNumber(t,v.VALUE,this._frameDefaultValue);break}case 1:{s=this._parseTweenFrame(t,e,r);const n=this._frameIntArray.length;this._frameIntArray.length+=1,this._frameIntArray[n]=Math.round(I._getNumber(t,v.VALUE,this._frameDefaultValue)*this._frameValueScale);break}case 2:{s=this._parseTweenFrame(t,e,r);const n=this._frameFloatArray.length;this._frameFloatArray.length+=1,this._frameFloatArray[n]=I._getNumber(t,v.VALUE,this._frameDefaultValue)*this._frameValueScale;break}}return s}_parseDoubleValueFrame(t,e,r){let s=0;switch(this._frameValueType){case 0:{s=this._parseFrame(t,e,r),this._frameArray.length+=2,this._frameArray[s+1]=I._getNumber(t,v.X,this._frameDefaultValue),this._frameArray[s+2]=I._getNumber(t,v.Y,this._frameDefaultValue);break}case 1:{s=this._parseTweenFrame(t,e,r);const n=this._frameIntArray.length;this._frameIntArray.length+=2,this._frameIntArray[n]=Math.round(I._getNumber(t,v.X,this._frameDefaultValue)*this._frameValueScale),this._frameIntArray[n+1]=Math.round(I._getNumber(t,v.Y,this._frameDefaultValue)*this._frameValueScale);break}case 2:{s=this._parseTweenFrame(t,e,r);const n=this._frameFloatArray.length;this._frameFloatArray.length+=2,this._frameFloatArray[n]=I._getNumber(t,v.X,this._frameDefaultValue)*this._frameValueScale,this._frameFloatArray[n+1]=I._getNumber(t,v.Y,this._frameDefaultValue)*this._frameValueScale;break}}return s}_parseActionFrame(t,e,r){const s=this._frameArray.length,n=t.actions.length;this._frameArray.length+=2+n,this._frameArray[s+0]=e,this._frameArray[s+0+1]=n;for(let a=0;a<n;++a)this._frameArray[s+0+2+a]=t.actions[a];return s}_parseZOrderFrame(t,e,r){const s=this._parseFrame(t,e,r);if(v.Z_ORDER in t){const n=t[v.Z_ORDER];if(n.length>0){const a=this._armature.sortedSlots.length,o=new Array(a-n.length/2),l=new Array(a);for(let c=0;c<o.length;++c)o[c]=0;for(let c=0;c<a;++c)l[c]=-1;let h=0,u=0;for(let c=0,f=n.length;c<f;c+=2){const p=n[c],y=n[c+1];for(;h!==p;)o[u++]=h++;const x=h+y;l[x]=h++}for(;h<a;)o[u++]=h++;this._frameArray.length+=1+a,this._frameArray[s+1]=a;let d=a;for(;d--;)l[d]===-1?this._frameArray[s+2+d]=o[--u]||0:this._frameArray[s+2+d]=l[d]||0;return s}}return this._frameArray.length+=1,this._frameArray[s+1]=0,s}_parseBoneAllFrame(t,e,r){this._helpTransform.identity(),v.TRANSFORM in t&&this._parseTransform(t[v.TRANSFORM],this._helpTransform,1);let s=this._helpTransform.rotation;e!==0&&(this._prevClockwise===0?s=this._prevRotation+rt.normalizeRadian(s-this._prevRotation):((this._prevClockwise>0?s>=this._prevRotation:s<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),s=this._prevRotation+s-this._prevRotation+rt.PI_D*this._prevClockwise)),this._prevClockwise=I._getNumber(t,v.TWEEN_ROTATE,0),this._prevRotation=s;const n=this._parseTweenFrame(t,e,r);let a=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[a++]=this._helpTransform.x,this._frameFloatArray[a++]=this._helpTransform.y,this._frameFloatArray[a++]=s,this._frameFloatArray[a++]=this._helpTransform.skew,this._frameFloatArray[a++]=this._helpTransform.scaleX,this._frameFloatArray[a++]=this._helpTransform.scaleY,this._parseActionDataInFrame(t,e,this._bone,this._slot),n}_parseBoneTranslateFrame(t,e,r){const s=this._parseTweenFrame(t,e,r);let n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=I._getNumber(t,v.X,0),this._frameFloatArray[n++]=I._getNumber(t,v.Y,0),s}_parseBoneRotateFrame(t,e,r){let s=I._getNumber(t,v.ROTATE,0)*rt.DEG_RAD;e!==0&&(this._prevClockwise===0?s=this._prevRotation+rt.normalizeRadian(s-this._prevRotation):((this._prevClockwise>0?s>=this._prevRotation:s<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),s=this._prevRotation+s-this._prevRotation+rt.PI_D*this._prevClockwise)),this._prevClockwise=I._getNumber(t,v.CLOCK_WISE,0),this._prevRotation=s;const n=this._parseTweenFrame(t,e,r);let a=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[a++]=s,this._frameFloatArray[a++]=I._getNumber(t,v.SKEW,0)*rt.DEG_RAD,n}_parseBoneScaleFrame(t,e,r){const s=this._parseTweenFrame(t,e,r);let n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=I._getNumber(t,v.X,1),this._frameFloatArray[n++]=I._getNumber(t,v.Y,1),s}_parseSlotDisplayFrame(t,e,r){const s=this._parseFrame(t,e,r);return this._frameArray.length+=1,v.VALUE in t?this._frameArray[s+1]=I._getNumber(t,v.VALUE,0):this._frameArray[s+1]=I._getNumber(t,v.DISPLAY_INDEX,0),this._parseActionDataInFrame(t,e,this._slot.parent,this._slot),s}_parseSlotColorFrame(t,e,r){const s=this._parseTweenFrame(t,e,r);let n=-1;if(v.VALUE in t||v.COLOR in t){const o=v.VALUE in t?t[v.VALUE]:t[v.COLOR];for(let l in o){this._parseColorTransform(o,this._helpColorTransform),n=this._colorArray.length,this._colorArray.length+=8,this._colorArray[n++]=Math.round(this._helpColorTransform.alphaMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.redMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.greenMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.blueMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.alphaOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.redOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.greenOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.blueOffset),n-=8;break}}n<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=n=this._colorArray.length,this._colorArray.length+=8,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=0,this._colorArray[n++]=0,this._colorArray[n++]=0,this._colorArray[n++]=0),n=this._defaultColorOffset);const a=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[a]=n,s}_parseSlotDeformFrame(t,e,r){const s=this._frameFloatArray.length,n=this._parseTweenFrame(t,e,r),a=v.VERTICES in t?t[v.VERTICES]:null,o=I._getNumber(t,v.OFFSET,0),l=this._intArray[this._mesh.geometry.offset+0],h=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,u=this._mesh.geometry.weight;let d=0,c=0,f=0,p=0;if(u!==null){const y=this._weightSlotPose[h];this._helpMatrixA.copyFromArray(y,0),this._frameFloatArray.length+=u.count*2,f=u.offset+2+u.bones.length}else this._frameFloatArray.length+=l*2;for(let y=0;y<l*2;y+=2)if(a===null?(d=0,c=0):(y<o||y-o>=a.length?d=0:d=a[y-o],y+1<o||y+1-o>=a.length?c=0:c=a[y+1-o]),u!==null){const x=this._weightBonePoses[h],m=this._intArray[f++];this._helpMatrixA.transformPoint(d,c,this._helpPoint,!0),d=this._helpPoint.x,c=this._helpPoint.y;for(let _=0;_<m;++_){const g=this._intArray[f++];this._helpMatrixB.copyFromArray(x,g*7+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(d,c,this._helpPoint,!0),this._frameFloatArray[s+p++]=this._helpPoint.x,this._frameFloatArray[s+p++]=this._helpPoint.y}}else this._frameFloatArray[s+y]=d,this._frameFloatArray[s+y+1]=c;if(e===0){const y=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[y+0]=this._mesh.geometry.offset,this._frameIntArray[y+1]=this._frameFloatArray.length-s,this._frameIntArray[y+2]=this._frameFloatArray.length-s,this._frameIntArray[y+3]=0,this._frameIntArray[y+4]=s-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=y-this._animation.frameIntOffset}return n}_parseIKConstraintFrame(t,e,r){const s=this._parseTweenFrame(t,e,r);let n=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[n++]=I._getBoolean(t,v.BEND_POSITIVE,!0)?1:0,this._frameIntArray[n++]=Math.round(I._getNumber(t,v.WEIGHT,1)*100),s}_parseActionData(t,e,r,s){const n=new Array;if(typeof t=="string"){const a=O.borrowObject(bg);a.type=e,a.name=t,a.bone=r,a.slot=s,n.push(a)}else if(t instanceof Array)for(const a of t){const o=O.borrowObject(bg);if(v.GOTO_AND_PLAY in a?(o.type=0,o.name=I._getString(a,v.GOTO_AND_PLAY,"")):(v.TYPE in a&&typeof a[v.TYPE]=="string"?o.type=v._getActionType(a[v.TYPE]):o.type=I._getNumber(a,v.TYPE,e),o.name=I._getString(a,v.NAME,"")),v.BONE in a){const h=I._getString(a,v.BONE,"");o.bone=this._armature.getBone(h)}else o.bone=r;if(v.SLOT in a){const h=I._getString(a,v.SLOT,"");o.slot=this._armature.getSlot(h)}else o.slot=s;let l=null;if(v.INTS in a){l===null&&(l=O.borrowObject(sc));const h=a[v.INTS];for(const u of h)l.addInt(u)}if(v.FLOATS in a){l===null&&(l=O.borrowObject(sc));const h=a[v.FLOATS];for(const u of h)l.addFloat(u)}if(v.STRINGS in a){l===null&&(l=O.borrowObject(sc));const h=a[v.STRINGS];for(const u of h)l.addString(u)}o.data=l,n.push(o)}return n}_parseDeformFrame(t,e,r){const s=this._frameFloatArray.length,n=this._parseTweenFrame(t,e,r),a=v.VERTICES in t?t[v.VERTICES]:v.VALUE in t?t[v.VALUE]:null,o=I._getNumber(t,v.OFFSET,0),l=this._intArray[this._geometry.offset+0],h=this._geometry.weight;let u=0,d=0;if(h===null){this._frameFloatArray.length+=l*2;for(let c=0;c<l*2;c+=2)a!==null?(c<o||c-o>=a.length?u=0:u=a[c-o],c+1<o||c+1-o>=a.length?d=0:d=a[c+1-o]):(u=0,d=0),this._frameFloatArray[s+c]=u,this._frameFloatArray[s+c+1]=d}if(e===0){const c=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[c+0]=this._geometry.offset,this._frameIntArray[c+1]=this._frameFloatArray.length-s,this._frameIntArray[c+2]=this._frameFloatArray.length-s,this._frameIntArray[c+3]=0,this._frameIntArray[c+4]=s-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=c-this._animation.frameIntOffset}return n}_parseTransform(t,e,r){e.x=I._getNumber(t,v.X,0)*r,e.y=I._getNumber(t,v.Y,0)*r,v.ROTATE in t||v.SKEW in t?(e.rotation=rt.normalizeRadian(I._getNumber(t,v.ROTATE,0)*rt.DEG_RAD),e.skew=rt.normalizeRadian(I._getNumber(t,v.SKEW,0)*rt.DEG_RAD)):(v.SKEW_X in t||v.SKEW_Y in t)&&(e.rotation=rt.normalizeRadian(I._getNumber(t,v.SKEW_Y,0)*rt.DEG_RAD),e.skew=rt.normalizeRadian(I._getNumber(t,v.SKEW_X,0)*rt.DEG_RAD)-e.rotation),e.scaleX=I._getNumber(t,v.SCALE_X,1),e.scaleY=I._getNumber(t,v.SCALE_Y,1)}_parseColorTransform(t,e){e.alphaMultiplier=I._getNumber(t,v.ALPHA_MULTIPLIER,100)*.01,e.redMultiplier=I._getNumber(t,v.RED_MULTIPLIER,100)*.01,e.greenMultiplier=I._getNumber(t,v.GREEN_MULTIPLIER,100)*.01,e.blueMultiplier=I._getNumber(t,v.BLUE_MULTIPLIER,100)*.01,e.alphaOffset=I._getNumber(t,v.ALPHA_OFFSET,0),e.redOffset=I._getNumber(t,v.RED_OFFSET,0),e.greenOffset=I._getNumber(t,v.GREEN_OFFSET,0),e.blueOffset=I._getNumber(t,v.BLUE_OFFSET,0)}_parseGeometry(t,e){const r=t[v.VERTICES],s=Math.floor(r.length/2);let n=0;const a=this._intArray.length,o=this._floatArray.length;e.offset=a,e.data=this._data,this._intArray.length+=4,this._intArray[a+0]=s,this._intArray[a+2]=o,this._intArray[a+3]=-1,this._floatArray.length+=s*2;for(let l=0,h=s*2;l<h;++l)this._floatArray[o+l]=r[l];if(v.TRIANGLES in t){const l=t[v.TRIANGLES];n=Math.floor(l.length/3),this._intArray.length+=n*3;for(let h=0,u=n*3;h<u;++h)this._intArray[a+4+h]=l[h]}if(this._intArray[a+1]=n,v.UVS in t){const l=t[v.UVS],h=o+s*2;this._floatArray.length+=s*2;for(let u=0,d=s*2;u<d;++u)this._floatArray[h+u]=l[u]}if(v.WEIGHTS in t){const l=t[v.WEIGHTS],h=Math.floor(l.length-s)/2,u=this._intArray.length,d=this._floatArray.length;let c=0;const f=this._armature.sortedBones,p=O.borrowObject(tT);if(p.count=h,p.offset=u,this._intArray.length+=2+c+s+h,this._intArray[u+1]=d,v.BONE_POSE in t){const y=t[v.SLOT_POSE],x=t[v.BONE_POSE],m=new Array;c=Math.floor(x.length/7),m.length=c;for(let _=0;_<c;++_){const g=x[_*7],T=this._rawBones[g];p.addBone(T),m[_]=g,this._intArray[u+2+_]=f.indexOf(T)}this._floatArray.length+=h*3,this._helpMatrixA.copyFromArray(y,0);for(let _=0,g=0,T=u+2+c,A=d;_<s;++_){const S=_*2,w=this._intArray[T++]=l[g++];let E=this._floatArray[o+S],C=this._floatArray[o+S+1];this._helpMatrixA.transformPoint(E,C,this._helpPoint),E=this._helpPoint.x,C=this._helpPoint.y;for(let D=0;D<w;++D){const k=l[g++],F=m.indexOf(k);this._helpMatrixB.copyFromArray(x,F*7+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(E,C,this._helpPoint),this._intArray[T++]=F,this._floatArray[A++]=l[g++],this._floatArray[A++]=this._helpPoint.x,this._floatArray[A++]=this._helpPoint.y}}}else{const y=t[v.BONES];c=y.length;for(let x=0;x<c;x++){const m=y[x],_=this._rawBones[m];p.addBone(_),this._intArray[u+2+x]=f.indexOf(_)}this._floatArray.length+=h*3;for(let x=0,m=0,_=0,g=u+2+c,T=d;x<h;x++){const A=l[m++];this._intArray[g++]=A;for(let S=0;S<A;S++){const w=l[m++],E=l[m++],C=r[_++],D=r[_++];this._intArray[g++]=y.indexOf(w),this._floatArray[T++]=E,this._floatArray[T++]=C,this._floatArray[T++]=D}}}e.weight=p}}_parseArray(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0,this._colorArray.length=0}_modifyArray(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!==0&&this._timelineArray.push(0),this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._colorArray.push(0);const t=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,e=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,r=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,s=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,n=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,a=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,o=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT,l=t+e+r+s+n+a+o,h=new ArrayBuffer(l),u=new Int16Array(h,0,this._intArray.length),d=new Float32Array(h,t,this._floatArray.length),c=new Int16Array(h,t+e,this._frameIntArray.length),f=new Float32Array(h,t+e+r,this._frameFloatArray.length),p=new Int16Array(h,t+e+r+s,this._frameArray.length),y=new Uint16Array(h,t+e+r+s+n,this._timelineArray.length),x=new Int16Array(h,t+e+r+s+n+a,this._colorArray.length);for(let m=0,_=this._intArray.length;m<_;++m)u[m]=this._intArray[m];for(let m=0,_=this._floatArray.length;m<_;++m)d[m]=this._floatArray[m];for(let m=0,_=this._frameIntArray.length;m<_;++m)c[m]=this._frameIntArray[m];for(let m=0,_=this._frameFloatArray.length;m<_;++m)f[m]=this._frameFloatArray[m];for(let m=0,_=this._frameArray.length;m<_;++m)p[m]=this._frameArray[m];for(let m=0,_=this._timelineArray.length;m<_;++m)y[m]=this._timelineArray[m];for(let m=0,_=this._colorArray.length;m<_;++m)x[m]=this._colorArray[m];this._data.binary=h,this._data.intArray=u,this._data.floatArray=d,this._data.frameIntArray=c,this._data.frameFloatArray=f,this._data.frameArray=p,this._data.timelineArray=y,this._data.colorArray=x,this._defaultColorOffset=-1}parseDragonBonesData(t,e=1){console.assert(t!=null,"Data error.");const r=I._getString(t,v.VERSION,""),s=I._getString(t,v.COMPATIBLE_VERSION,"");if(v.DATA_VERSIONS.indexOf(r)>=0||v.DATA_VERSIONS.indexOf(s)>=0){const n=O.borrowObject(iM);if(n.version=r,n.name=I._getString(t,v.NAME,""),n.frameRate=I._getNumber(t,v.FRAME_RATE,24),n.frameRate===0&&(n.frameRate=24),v.ARMATURE in t){this._data=n,this._parseArray(t);const a=t[v.ARMATURE];for(const o of a)n.addArmature(this._parseArmature(o,e));this._data.binary||this._modifyArray(),v.STAGE in t?n.stage=n.getArmature(I._getString(t,v.STAGE,"")):n.armatureNames.length>0&&(n.stage=n.getArmature(n.armatureNames[0])),this._data=null}return v.TEXTURE_ATLAS in t&&(this._rawTextureAtlases=t[v.TEXTURE_ATLAS]),n}else console.assert(!1,"Nonsupport data version: "+r+`
Please convert DragonBones data to support version.
Read more: https://github.com/DragonBones/Tools/`);return null}parseTextureAtlasData(t,e,r=1){if(console.assert(t!==void 0),t===null){if(this._rawTextureAtlases===null||this._rawTextureAtlases.length===0)return!1;const s=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(s,e,r),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(e.width=I._getNumber(t,v.WIDTH,0),e.height=I._getNumber(t,v.HEIGHT,0),e.scale=r===1?1/I._getNumber(t,v.SCALE,1):r,e.name=I._getString(t,v.NAME,""),e.imagePath=I._getString(t,v.IMAGE_PATH,""),v.SUB_TEXTURE in t){const s=t[v.SUB_TEXTURE];for(let n=0,a=s.length;n<a;++n){const o=s[n],l=I._getNumber(o,v.FRAME_WIDTH,-1),h=I._getNumber(o,v.FRAME_HEIGHT,-1),u=e.createTexture();u.rotated=I._getBoolean(o,v.ROTATED,!1),u.name=I._getString(o,v.NAME,""),u.region.x=I._getNumber(o,v.X,0),u.region.y=I._getNumber(o,v.Y,0),u.region.width=I._getNumber(o,v.WIDTH,0),u.region.height=I._getNumber(o,v.HEIGHT,0),l>0&&h>0&&(u.frame=Oh.createRectangle(),u.frame.x=I._getNumber(o,v.FRAME_X,0),u.frame.y=I._getNumber(o,v.FRAME_Y,0),u.frame.width=l,u.frame.height=h),e.addTexture(u)}}return!0}static getInstance(){return I._objectDataParserInstance===null&&(I._objectDataParserInstance=new I),I._objectDataParserInstance}}I._objectDataParserInstance=null;class nc{constructor(){this.frameStart=0,this.actions=[]}}class Yr extends I{_inRange(t,e,r){return e<=t&&t<=r}_decodeUTF8(t){let n=0,a="",o,l=0,h=0,u=0,d=0;for(;t.length>n;){let c=t[n++];if(c===-1)h!==0?o=65533:o=-1;else if(h===0)this._inRange(c,0,127)?o=c:(this._inRange(c,194,223)?(h=1,d=128,l=c-192):this._inRange(c,224,239)?(h=2,d=2048,l=c-224):this._inRange(c,240,244)&&(h=3,d=65536,l=c-240),l=l*Math.pow(64,h),o=null);else if(!this._inRange(c,128,191))l=0,h=0,u=0,d=0,n--,o=c;else if(u+=1,l=l+(c-128)*Math.pow(64,h-u),u!==h)o=null;else{let f=l,p=d;l=0,h=0,u=0,d=0,this._inRange(f,p,1114111)&&!this._inRange(f,55296,57343)?o=f:o=c}o!==null&&o!==-1&&(o<=65535?o>0&&(a+=String.fromCharCode(o)):(o-=65536,a+=String.fromCharCode(55296+(o>>10&1023)),a+=String.fromCharCode(56320+(o&1023))))}return a}_parseBinaryTimeline(t,e,r=null){const s=r!==null?r:O.borrowObject(Tp);s.type=t,s.offset=e,this._timeline=s;const n=this._timelineArrayBuffer[s.offset+2];if(n===1)s.frameIndicesOffset=-1;else{let a=0;const o=this._animation.frameCount+1,l=this._data.frameIndices;a=l.length,l.length+=o,s.frameIndicesOffset=a;for(let h=0,u=0,d=0,c=0;h<o;++h)d+c<=h&&u<n&&(d=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[s.offset+5+u]],u===n-1?c=this._animation.frameCount-d:c=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[s.offset+5+u+1]]-d,u++),l[a+h]=u-1}return this._timeline=null,s}_parseAnimation(t){const e=O.borrowObject(Qx);e.blendType=v._getAnimationBlendType(I._getString(t,v.BLEND_TYPE,"")),e.frameCount=I._getNumber(t,v.DURATION,0),e.playTimes=I._getNumber(t,v.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=I._getNumber(t,v.FADE_IN_TIME,0),e.scale=I._getNumber(t,v.SCALE,1),e.name=I._getString(t,v.NAME,v.DEFAULT_NAME),e.name.length===0&&(e.name=v.DEFAULT_NAME);const r=t[v.OFFSET];if(e.frameIntOffset=r[0],e.frameFloatOffset=r[1],e.frameOffset=r[2],this._animation=e,v.ACTION in t&&(e.actionTimeline=this._parseBinaryTimeline(0,t[v.ACTION])),v.Z_ORDER in t&&(e.zOrderTimeline=this._parseBinaryTimeline(1,t[v.Z_ORDER])),v.BONE in t){const s=t[v.BONE];for(let n in s){const a=s[n],o=this._armature.getBone(n);if(o!==null)for(let l=0,h=a.length;l<h;l+=2){const u=a[l],d=a[l+1],c=this._parseBinaryTimeline(u,d);this._animation.addBoneTimeline(o.name,c)}}}if(v.SLOT in t){const s=t[v.SLOT];for(let n in s){const a=s[n],o=this._armature.getSlot(n);if(o!==null)for(let l=0,h=a.length;l<h;l+=2){const u=a[l],d=a[l+1],c=this._parseBinaryTimeline(u,d);this._animation.addSlotTimeline(o.name,c)}}}if(v.CONSTRAINT in t){const s=t[v.CONSTRAINT];for(let n in s){const a=s[n],o=this._armature.getConstraint(n);if(o!==null)for(let l=0,h=a.length;l<h;l+=2){const u=a[l],d=a[l+1],c=this._parseBinaryTimeline(u,d);this._animation.addConstraintTimeline(o.name,c)}}}if(v.TIMELINE in t){const s=t[v.TIMELINE];for(const n of s){const a=I._getNumber(n,v.OFFSET,0);if(a>=0){const o=I._getNumber(n,v.TYPE,0),l=I._getString(n,v.NAME,"");let h=null;if(o===40&&e.blendType!==0){h=O.borrowObject(Jx);const u=h;u.x=I._getNumber(n,v.X,0),u.y=I._getNumber(n,v.Y,0)}switch(h=this._parseBinaryTimeline(o,a,h),o){case 0:break;case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(l,h);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(l,h);break;case 30:this._animation.addConstraintTimeline(l,h);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(l,h);break}}}}return this._animation=null,e}_parseGeometry(t,e){e.offset=t[v.OFFSET],e.data=this._data;let r=this._intArrayBuffer[e.offset+3];if(r<-1&&(r+=65536),r>=0){const s=O.borrowObject(tT),n=this._intArrayBuffer[e.offset+0],a=this._intArrayBuffer[r+0];s.offset=r;for(let h=0;h<a;++h){const u=this._intArrayBuffer[r+2+h];s.addBone(this._rawBones[u])}let o=r+2+a,l=0;for(let h=0,u=n;h<u;++h){const d=this._intArrayBuffer[o++];l+=d,o+=d}s.count=l,e.weight=s}}_parseArray(t){const e=t[v.OFFSET],r=e[1],s=e[3],n=e[5],a=e[7],o=e[9],l=e[11],h=e.length>12?e[13]:0,u=new Int16Array(this._binary,this._binaryOffset+e[0],r/Int16Array.BYTES_PER_ELEMENT),d=new Float32Array(this._binary,this._binaryOffset+e[2],s/Float32Array.BYTES_PER_ELEMENT),c=new Int16Array(this._binary,this._binaryOffset+e[4],n/Int16Array.BYTES_PER_ELEMENT),f=new Float32Array(this._binary,this._binaryOffset+e[6],a/Float32Array.BYTES_PER_ELEMENT),p=new Int16Array(this._binary,this._binaryOffset+e[8],o/Int16Array.BYTES_PER_ELEMENT),y=new Uint16Array(this._binary,this._binaryOffset+e[10],l/Uint16Array.BYTES_PER_ELEMENT),x=h>0?new Int16Array(this._binary,this._binaryOffset+e[12],h/Uint16Array.BYTES_PER_ELEMENT):u;this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=u,this._data.floatArray=d,this._data.frameIntArray=c,this._data.frameFloatArray=f,this._data.frameArray=this._frameArrayBuffer=p,this._data.timelineArray=this._timelineArrayBuffer=y,this._data.colorArray=x}parseDragonBonesData(t,e=1){console.assert(t!=null&&t instanceof ArrayBuffer,"Data error.");const r=new Uint8Array(t,0,8);if(r[0]!==68||r[1]!==66||r[2]!==68||r[3]!==84)return console.assert(!1,"Nonsupport data."),null;const s=new Uint32Array(t,8,1)[0],n=new Uint8Array(t,12,s),a=this._decodeUTF8(n),o=JSON.parse(a);return this._binaryOffset=12+s,this._binary=t,super.parseDragonBonesData(o,e)}static getInstance(){return Yr._binaryDataParserInstance===null&&(Yr._binaryDataParserInstance=new Yr),Yr._binaryDataParserInstance}}Yr._binaryDataParserInstance=null;class gi{constructor(t=null){this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,gi._objectParser===null&&(gi._objectParser=new I),gi._binaryParser===null&&(gi._binaryParser=new Yr),this._dataParser=t!==null?t:gi._objectParser}_isSupportMesh(){return!0}_getTextureData(t,e){if(t in this._textureAtlasDataMap)for(const r of this._textureAtlasDataMap[t]){const s=r.getTexture(e);if(s!==null)return s}if(this.autoSearch){for(let r in this._textureAtlasDataMap)for(const s of this._textureAtlasDataMap[r])if(s.autoSearch){const n=s.getTexture(e);if(n!==null)return n}}return null}_fillBuildArmaturePackage(t,e,r,s,n){let a=null,o=null;if(e.length>0&&e in this._dragonBonesDataMap&&(a=this._dragonBonesDataMap[e],o=a.getArmature(r)),o===null&&(e.length===0||this.autoSearch)){for(let l in this._dragonBonesDataMap)if(a=this._dragonBonesDataMap[l],(e.length===0||a.autoSearch)&&(o=a.getArmature(r),o!==null)){e=l;break}}if(o!==null){if(t.dataName=e,t.textureAtlasName=n,t.data=a,t.armature=o,t.skin=null,s.length>0&&(t.skin=o.getSkin(s),t.skin===null&&this.autoSearch))for(let l in this._dragonBonesDataMap){const u=this._dragonBonesDataMap[l].getArmature(s);if(u!==null){t.skin=u.defaultSkin;break}}return t.skin===null&&(t.skin=o.defaultSkin),!0}return!1}_buildBones(t,e){for(const r of t.armature.sortedBones)O.borrowObject(r.type===0?rT:_e).init(r,e)}_buildSlots(t,e){const r=t.skin,s=t.armature.defaultSkin;if(r===null||s===null)return;const n={};for(let a in s.displays){const o=s.getDisplays(a);n[a]=o}if(r!==s)for(let a in r.displays){const o=r.getDisplays(a);n[a]=o}for(const a of t.armature.sortedSlots){const o=a.name in n?n[a.name]:null,l=this._buildSlot(t,a,e);if(o!==null){l.displayFrameCount=o.length;for(let h=0,u=l.displayFrameCount;h<u;++h){const d=o[h];if(l.replaceRawDisplayData(d,h),d!==null){if(t.textureAtlasName.length>0){const f=this._getTextureData(t.textureAtlasName,d.path);l.replaceTextureData(f,h)}const c=this._getSlotDisplay(t,d,l);l.replaceDisplay(c,h)}else l.replaceDisplay(null)}}l._setDisplayIndex(a.displayIndex,!0)}}_buildConstraints(t,e){const r=t.armature.constraints;for(let s in r){const n=r[s];switch(n.type){case 0:const a=O.borrowObject(Og);a.init(n,e),e._addConstraint(a);break;case 1:const o=O.borrowObject(gM);o.init(n,e),e._addConstraint(o);break;default:const l=O.borrowObject(Og);l.init(n,e),e._addConstraint(l);break}}}_buildChildArmature(t,e,r){return this.buildArmature(r.path,t!==null?t.dataName:"","",t!==null?t.textureAtlasName:"")}_getSlotDisplay(t,e,r){const s=t!==null?t.dataName:e.parent.parent.parent.name;let n=null;switch(e.type){case 0:{const a=e;a.texture===null&&(a.texture=this._getTextureData(s,e.path)),n=r.rawDisplay;break}case 2:{const a=e;a.texture===null&&(a.texture=this._getTextureData(s,a.path)),this._isSupportMesh()?n=r.meshDisplay:n=r.rawDisplay;break}case 1:{const a=e,o=this._buildChildArmature(t,r,a);if(o!==null){if(o.inheritAnimation=a.inheritAnimation,!o.inheritAnimation){const l=a.actions.length>0?a.actions:o.armatureData.defaultActions;if(l.length>0)for(const h of l){const u=O.borrowObject(lt);lt.actionDataToInstance(h,u,r.armature),u.slot=r,r.armature._bufferAction(u,!1)}else o.animation.play()}a.armature=o.armatureData}n=o;break}}return n}parseDragonBonesData(t,e=null,r=1){const s=t instanceof ArrayBuffer?gi._binaryParser:this._dataParser,n=s.parseDragonBonesData(t,r);for(;;){const a=this._buildTextureAtlasData(null,null);if(s.parseTextureAtlasData(null,a,r))this.addTextureAtlasData(a,e);else{a.returnToPool();break}}return n!==null&&this.addDragonBonesData(n,e),n}parseTextureAtlasData(t,e,r=null,s=1){const n=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,s),this._buildTextureAtlasData(n,e||null),this.addTextureAtlasData(n,r),n}updateTextureAtlases(t,e){const r=this.getTextureAtlasData(e);if(r!==null)for(let s=0,n=r.length;s<n;++s)s<t.length&&this._buildTextureAtlasData(r[s],t[s])}getDragonBonesData(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null}addDragonBonesData(t,e=null){if(e=e!==null?e:t.name,e in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t)return;console.warn("Can not add same name data: "+e);return}this._dragonBonesDataMap[e]=t}removeDragonBonesData(t,e=!0){t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])}getTextureAtlasData(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null}addTextureAtlasData(t,e=null){e=e!==null?e:t.name;const r=e in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];r.indexOf(t)<0&&r.push(t)}removeTextureAtlasData(t,e=!0){if(t in this._textureAtlasDataMap){const r=this._textureAtlasDataMap[t];if(e)for(const s of r)this._dragonBones.bufferObject(s);delete this._textureAtlasDataMap[t]}}getArmatureData(t,e=""){const r=new Bg;return this._fillBuildArmaturePackage(r,e,t,"","")?r.armature:null}clear(t=!0){for(let e in this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(let e in this._textureAtlasDataMap){if(t){const r=this._textureAtlasDataMap[e];for(const s of r)this._dragonBones.bufferObject(s)}delete this._textureAtlasDataMap[e]}}buildArmature(t,e="",r="",s=""){const n=new Bg;if(!this._fillBuildArmaturePackage(n,e||"",t,r||"",s||""))return console.warn("No armature data: "+t+", "+(e!==null?e:"")),null;const a=this._buildArmature(n);return this._buildBones(n,a),this._buildSlots(n,a),this._buildConstraints(n,a),a.invalidUpdate(null,!0),a.advanceTime(0),a}replaceDisplay(t,e,r=-1){if(r<0&&(r=t.displayIndex),r<0&&(r=0),t.replaceDisplayData(e,r),e!==null){let s=this._getSlotDisplay(null,e,t);if(e.type===0){const n=t.getDisplayFrameAt(r).rawDisplayData;n!==null&&n.type===2&&(s=t.meshDisplay)}t.replaceDisplay(s,r)}else t.replaceDisplay(null,r)}replaceSlotDisplay(t,e,r,s,n,a=-1){const o=this.getArmatureData(e,t||"");if(o===null||o.defaultSkin===null)return!1;const l=o.defaultSkin.getDisplay(r,s);return this.replaceDisplay(n,l,a),!0}replaceSlotDisplayList(t,e,r,s){const n=this.getArmatureData(e,t||"");if(!n||!n.defaultSkin)return!1;const a=n.defaultSkin.getDisplays(r);if(!a)return!1;s.displayFrameCount=a.length;for(let o=0,l=s.displayFrameCount;o<l;++o){const h=a[o];this.replaceDisplay(s,h,o)}return!0}replaceSkin(t,e,r=!1,s=null){let n=!1;const a=e.parent.defaultSkin;for(const o of t.getSlots()){if(s!==null&&s.indexOf(o.name)>=0)continue;let l=e.getDisplays(o.name);if(l===null&&(a!==null&&e!==a&&(l=a.getDisplays(o.name)),l===null)){r&&(o.displayFrameCount=0);continue}o.displayFrameCount=l.length;for(let h=0,u=o.displayFrameCount;h<u;++h){const d=l[h];o.replaceRawDisplayData(d,h),d!==null?o.replaceDisplay(this._getSlotDisplay(null,d,o),h):o.replaceDisplay(null,h)}n=!0}return n}replaceAnimation(t,e,r=!0){const s=e.defaultSkin;if(s===null)return!1;if(r)t.animation.animations=e.animations;else{const n=t.animation.animations,a={};for(let o in n)a[o]=n[o];for(let o in e.animations)a[o]=e.animations[o];t.animation.animations=a}for(const n of t.getSlots()){let a=0;for(const o of n.displayList){if(o instanceof dr){const l=s.getDisplays(n.name);if(l!==null&&a<l.length){const h=l[a];if(h!==null&&h.type===1){const u=this.getArmatureData(h.path,h.parent.parent.parent.name);u&&this.replaceAnimation(o,u,r)}}}a++}}return!0}getAllDragonBonesData(){return this._dragonBonesDataMap}getAllTextureAtlasData(){return this._textureAtlasDataMap}get clock(){return this._dragonBones.clock}get dragonBones(){return this._dragonBones}}gi._objectParser=null;gi._binaryParser=null;class Bg{constructor(){this.dataName="",this.textureAtlasName="",this.skin=null}}class kg extends Ft{constructor(){super(...arguments),this.debugDraw=!1,this._debugDraw=!1,this._armature=null,this._debugDrawer=null,this._debugDrawerChildren=new Map}dbInit(t){this._armature=t}dbClear(){this._debugDrawer!==null&&(this._debugDrawerChildren.clear(),this._debugDrawer.destroy()),this._armature=null,this._debugDrawer=null,super.destroy()}dbUpdate(){const t=Be.debugDraw||this.debugDraw;if(t||this._debugDraw)if(this._debugDraw=t,this._debugDraw){if(this._debugDrawer===null){this._debugDrawer=new Ft;const n=new Pa;this._debugDrawer.addChild(n)}this.addChild(this._debugDrawer);const e=this._debugDrawer.getChildAt(0);e.clear();const r=this._armature.getBones();for(let n=0,a=r.length;n<a;++n){const o=r[n],l=o.boneData.length,h=o.globalTransformMatrix.tx,u=o.globalTransformMatrix.ty,d=h+o.globalTransformMatrix.a*l,c=u+o.globalTransformMatrix.b*l;e.lineStyle(2,65535,.7),e.moveTo(h,u),e.lineTo(d,c),e.lineStyle(0,0,0),e.beginFill(65535,.7),e.drawCircle(h,u,3),e.endFill()}const s=this._armature.getSlots();for(let n=0,a=s.length;n<a;++n){const o=s[n],l=o.boundingBoxData;if(l){let h=this._debugDrawerChildren.get(o.name);switch(h||(h=new Pa,this._debugDrawerChildren.set(o.name,h),this._debugDrawer.addChild(h)),h.clear(),h.lineStyle(2,16711935,.7),l.type){case 0:h.drawRect(-l.width*.5,-l.height*.5,l.width,l.height);break;case 1:h.drawEllipse(-l.width*.5,-l.height*.5,l.width,l.height);break;case 2:const d=l.vertices;for(let c=0,f=d.length;c<f;c+=2){const p=d[c],y=d[c+1];c===0?h.moveTo(p,y):h.lineTo(p,y)}h.lineTo(d[0],d[1]);break}h.endFill(),o.updateTransformAndMatrix(),o.updateGlobalTransform();const u=o.global;h.setTransform(u.x,u.y,u.scaleX,u.scaleY,u.rotation,u.skew,0,o._pivotX,o._pivotY)}else{const h=this._debugDrawerChildren.get(o.name);h&&(this._debugDrawerChildren.delete(o.name),this._debugDrawer.removeChild(h))}}}else this._debugDrawer!==null&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer)}dispose(t=!0){this._armature!==null&&(this._armature.dispose(),this._armature=null)}destroy(){this.dispose()}dispatchDBEvent(t,e){this.emit(t,e)}hasDBEventListener(t){return this.listenerCount(t)>0}addDBEventListener(t,e,r){this.addListener(t,e,r)}removeDBEventListener(t,e,r){this.removeListener(t,e,r)}get armature(){return this._armature}get animation(){return this._armature.animation}}class sT extends sM{constructor(){super(...arguments),this._renderTexture=null}static toString(){return"[class dragonBones.PixiTextureAtlasData]"}_onClear(){super._onClear(),this._renderTexture,this._renderTexture=null}createTexture(){return O.borrowObject(vM)}get renderTexture(){return this._renderTexture}set renderTexture(t){if(this._renderTexture!==t)if(this._renderTexture=t,this._renderTexture!==null)for(let e in this.textures){const r=this.textures[e];r.renderTexture=new j(this._renderTexture,new ot(r.region.x,r.region.y,r.region.width,r.region.height),new ot(r.region.x,r.region.y,r.region.width,r.region.height),new ot(0,0,r.region.width,r.region.height),r.rotated?St.S:0)}else for(let e in this.textures){const r=this.textures[e];r.renderTexture=null}}}class vM extends Oh{constructor(){super(...arguments),this.renderTexture=null}static toString(){return"[class dragonBones.PixiTextureData]"}_onClear(){super._onClear(),this.renderTexture!==null&&this.renderTexture.destroy(!1),this.renderTexture=null}}class xM extends dt{static toString(){return"[class dragonBones.PixiSlot]"}_onClear(){super._onClear(),this._textureScale=1,this._renderDisplay=null}_initDisplay(t,e){}_disposeDisplay(t,e){e||t.destroy()}_onUpdateDisplay(){this._renderDisplay=this._display?this._display:this._rawDisplay}_addDisplay(){this._armature.display.addChild(this._renderDisplay)}_replaceDisplay(t){const e=this._armature.display,r=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,r),e.removeChild(r),this._textureScale=1}_removeDisplay(){this._renderDisplay.parent.removeChild(this._renderDisplay)}_updateZOrder(){const t=this._armature.display;t.getChildIndex(this._renderDisplay)!==this._zOrder&&t.addChildAt(this._renderDisplay,this._zOrder)}_updateVisible(){this._renderDisplay.visible=this._parent.visible&&this._visible}_updateBlendMode(){if(this._renderDisplay instanceof fe)switch(this._blendMode){case 0:this._renderDisplay.blendMode=Z.NORMAL;break;case 1:this._renderDisplay.blendMode=Z.ADD;break;case 3:this._renderDisplay.blendMode=Z.DARKEN;break;case 4:this._renderDisplay.blendMode=Z.DIFFERENCE;break;case 6:this._renderDisplay.blendMode=Z.HARD_LIGHT;break;case 9:this._renderDisplay.blendMode=Z.LIGHTEN;break;case 10:this._renderDisplay.blendMode=Z.MULTIPLY;break;case 11:this._renderDisplay.blendMode=Z.OVERLAY;break;case 12:this._renderDisplay.blendMode=Z.SCREEN;break}}_updateColor(){const t=this._colorTransform.alphaMultiplier*this._globalAlpha;if(this._renderDisplay.alpha=t,this._renderDisplay instanceof fe||this._renderDisplay instanceof Ux){const e=(Math.round(this._colorTransform.redMultiplier*255)<<16)+(Math.round(this._colorTransform.greenMultiplier*255)<<8)+Math.round(this._colorTransform.blueMultiplier*255);this._renderDisplay.tint=e}}_updateFrame(){let t=this._textureData;if(this._displayIndex>=0&&this._display!==null&&t!==null){let e=t.parent;this._armature.replacedTexture!==null&&(this._armature._replaceTextureAtlasData===null?(e=O.borrowObject(sT),e.copyFrom(t.parent),e.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=e):e=this._armature._replaceTextureAtlasData,t=e.getTexture(t.name));const r=t.renderTexture;if(r!==null){if(this._geometryData!==null){const s=this._geometryData.data,n=s.intArray,a=s.floatArray,o=n[this._geometryData.offset+0],l=n[this._geometryData.offset+1];let h=n[this._geometryData.offset+2];h<0&&(h+=65536);const u=h+o*2,d=this._armature._armatureData.scale,c=this._renderDisplay,f=new Float32Array(o*2),p=new Float32Array(o*2),y=new Uint16Array(l*3);for(let _=0,g=o*2;_<g;++_)f[_]=a[h+_]*d;for(let _=0;_<l*3;++_)y[_]=n[this._geometryData.offset+4+_];for(let _=0,g=o*2;_<g;_+=2){const T=a[u+_],A=a[u+_+1];t.rotated?(p[_]=1-A,p[_+1]=T):(p[_]=T,p[_+1]=A)}this._textureScale=1,c.texture=r,c.vertices=f,c.uvBuffer.update(p),c.geometry.getIndex().update(y);const x=this._geometryData.weight!==null,m=this._parent._boneData.type!==0;(x||m)&&this._identityTransform()}else{this._textureScale=t.parent.scale*this._armature._armatureData.scale;const s=this._renderDisplay;s.texture=r}this._visibleDirty=!0;return}}if(this._geometryData!==null){const e=this._renderDisplay;e.texture=null,e.x=0,e.y=0,e.visible=!1}else{const e=this._renderDisplay;e.texture=null,e.x=0,e.y=0,e.visible=!1}}_updateMesh(){const t=this._armature._armatureData.scale,e=this._displayFrame.deformVertices,r=this._geometryBones,s=this._geometryData,n=s.weight,a=e.length>0&&s.inheritDeform,o=this._renderDisplay;if(n!==null){const l=s.data,h=l.intArray,u=l.floatArray,d=h[s.offset+0];let c=h[n.offset+1];c<0&&(c+=65536);for(let f=0,p=0,y=n.offset+2+r.length,x=c,m=0;f<d;++f){const _=h[y++];let g=0,T=0;for(let A=0;A<_;++A){const S=h[y++],w=r[S];if(w!==null){const E=w.globalTransformMatrix,C=u[x++];let D=u[x++]*t,k=u[x++]*t;a&&(D+=e[m++],k+=e[m++]),g+=(E.a*D+E.c*k+E.tx)*C,T+=(E.b*D+E.d*k+E.ty)*C}}o.vertices[p++]=g,o.vertices[p++]=T}}else{const l=this._parent._boneData.type!==0,h=s.data,u=h.intArray,d=h.floatArray,c=u[s.offset+0];let f=u[s.offset+2];f<0&&(f+=65536);for(let p=0,y=c*2;p<y;p+=2){let x=d[f+p]*t,m=d[f+p+1]*t;if(a&&(x+=e[p],m+=e[p+1]),l){const _=this._parent._getGlobalTransformMatrix(x,m);o.vertices[p]=_.a*x+_.c*m+_.tx,o.vertices[p+1]=_.b*x+_.d*m+_.ty}else o.vertices[p]=x,o.vertices[p+1]=m}}}_updateTransform(){this.updateGlobalTransform();const t=this.global;if(this._renderDisplay===this._rawDisplay||this._renderDisplay===this._meshDisplay){const e=t.x-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),r=t.y-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);this._renderDisplay.setTransform(e,r,t.scaleX*this._textureScale,t.scaleY*this._textureScale,t.rotation,-t.skew,0)}else this._renderDisplay.position.set(t.x,t.y),this._renderDisplay.rotation=t.rotation,this._renderDisplay.skew.set(-t.skew,0),this._renderDisplay.scale.set(t.scaleX,t.scaleY)}_identityTransform(){this._renderDisplay.setTransform(0,0,1,1,0,0,0)}}class oe extends gi{constructor(t=null){if(super(t),oe._dragonBonesInstance===null){const e=new kg;oe._dragonBonesInstance=new Be(e)}this._dragonBones=oe._dragonBonesInstance}static advanceTime(t){this._dragonBonesInstance&&this._dragonBonesInstance.advanceTime(t)}static get factory(){return oe._factory===null&&(oe._factory=new oe(null)),oe._factory}static newInstance(){return oe._factory===null&&(oe._factory=new oe(null)),oe._factory}_buildTextureAtlasData(t,e){return t?t.renderTexture=e:t=O.borrowObject(sT),t}_buildArmature(t){const e=O.borrowObject(dr),r=new kg;return e.init(t.armature,r,r,this._dragonBones),e}_buildSlot(t,e,r){const s=O.borrowObject(xM);return s.init(e,r,new fe(j.EMPTY),new Ux),s}buildArmatureDisplay(t,e={}){const r=this.buildArmature(t,e.dragonBonesName,e.skinName,e.textureAtlasName);if(r!==null)return e.clock===void 0?this._dragonBones.clock.add(r):e.clock&&(r.clock=e.clock),r.display;if(e.throwOnError)throw new Error(`failed to create armature "${t}"`);return null}getTextureDisplay(t,e=null){const r=this._getTextureData(e!==null?e:"",t);return r!==null&&r.renderTexture!==null?new fe(r.renderTexture):null}get soundEventManager(){return this._dragonBones.eventManager}}oe._dragonBonesInstance=null;oe._factory=null;const yi={backgroundUrl:"/maps/background-hole.png",width:3072,height:2048,walkableArea:{minX:10,maxX:3062,minY:1300,maxY:1720},get spawn(){const{minX:i,maxX:t,minY:e,maxY:r}=this.walkableArea;return{x:(i+t)/2,y:(e+r)/2}}},ts=oe.factory,ih=["Front","Back","Left","Right"],TM=1.2,Ds=1.3;let Ng=!1,ac=!1;ce.shared.add(()=>{ts.clock.advanceTime(ce.shared.deltaMS/1e3)});async function AM(){Ng||ac||(ac=!0,await Promise.all(ih.map(async i=>{if(!ts.getDragonBonesData(i))try{const[t,e]=await Promise.all([fetch(`/dragonbones/${i}_ske.json`).then(s=>s.json()),fetch(`/dragonbones/${i}_tex.json`).then(s=>s.json())]),r=await Wr.load(`/dragonbones/${i}_tex.png`);ts.parseDragonBonesData(t,i),ts.parseTextureAtlasData(e,r,i)}catch(t){console.error(`❌ Échec du chargement ou parsing DragonBones pour "${i}" :`,t)}})),Ng=!0,ac=!1)}async function EM(i=3e3){const t=Date.now();for(;Date.now()-t<i;){if(ih.every(r=>ts.getDragonBonesData(r)))return;await new Promise(r=>setTimeout(r,100))}throw new Error("Timeout waiting for DragonBones data to be loaded.")}function SM(i,t,e,r){let s=!1;for(const n of ih){const a=ts.getDragonBonesData(n),o=a==null?void 0:a.armatureNames[0],l=ts.buildArmatureDisplay(o,n);if(l!=null&&l.animation&&(l.animation.timeScale=TM),!l||!l.animation)continue;const h=l.animation.hasAnimation("SpawnAnim");if(n==="Front")if(h)try{l.animation.fadeIn("SpawnAnim",0,1),s=!0,setTimeout(()=>{const u=e==null?void 0:e.playerData;u&&(u.isSpawning=!1,u.blockInputUntil=Date.now())},2e3),l.once(lt.COMPLETE,u=>{var d;if(((d=u.animationState)==null?void 0:d.name)==="SpawnAnim"){l.animation.play("IdleAnim",0);const c=e==null?void 0:e.playerData;c&&(c.isSpawning=!1,c.blockInputUntil=Date.now(),c.anims=r,ih.forEach(f=>{c.anims[f]&&(c.anims[f].visible=f==="Front")}))}})}catch{l.animation.play("IdleAnim",0)}else l.animation.play("IdleAnim",0);else l.animation.play("IdleAnim",0);l.visible=n==="Front",l.scale.set(.2*Ds),e.addChild(l),r[n]=l}return s}function wM(i,t,e){const r=new Ft;r.sortableChildren=!0;const s=new Pa;s.beginFill(0,.25),s.drawEllipse(0,0,80,20),s.endFill(),s.y=110,s.zIndex=-1,r.addChild(s);const n={},a=SM(t,i,r,n),o=new Jr(i.username,{fontSize:20*Ds,fill:"white",fontWeight:"bold",fontFamily:"Cherry Bomb One",resolution:2});o.anchor.set(.5,-.5),o.y=80;const l=new Ft;[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,-1],[-1,1],[1,1]].forEach(([p,y])=>{const x=new Jr(i.username,{fontSize:20*Ds,fill:"#ffae51",fontWeight:"bold",fontFamily:"Cherry Bomb One",resolution:2});x.anchor.set(.5,-.5),x.x=p,x.y=o.y+y,l.addChild(x)}),l.addChild(o),r.addChild(l);const u=new Jr(`Niv ${i.level||1}`,{fontSize:14*Ds,fill:"#ffae51",fontFamily:"Poppins",fontWeight:"bold"});u.anchor.set(.5,-2.25),u.y=o.y-10,r.addChild(u),(i.x==null||i.y==null)&&(i.x=400,i.y=400),e=Math.max(.01,e);const d=i.x*e,c=i.y*e;r.x=d,r.y=c,r.scale.set(.6*Ds);const f=85*Ds;return r.children.forEach(p=>{p.y-=f}),{container:r,anims:n,nameText:o,levelText:u,isSpawning:a}}async function bM(i,t,e,r,s,n=1){await AM(),await EM();for(const a in i){const o=i[a];if(t[a]){const l=t[a];l.tileX=o.x,l.tileY=o.y,a!==r&&(l.targetX=o.x,l.targetY=o.y);const h=o.level??1;l.level!==h&&(l.levelText.text=`Niv ${h}`,l.level=h),l.container.zIndex=1e3+l.container.y}else{const{container:l,anims:h,nameText:u,levelText:d,isSpawning:c}=wM(o,a,n);t[a]={username:o.username,container:l,anims:h,currentDirection:"Front",nameText:u,levelText:d,justSpawned:!0,isSpawning:c,blockInputUntil:Date.now()+2e3,targetX:o.x,targetY:o.y,tileX:o.x,tileY:o.y,chatBubble:null,level:o.level,xp:o.xp||0,requiredXP:o.requiredXP||100,lastPositionTime:Date.now(),idleTimeout:null,currentAnim:"IdleAnim"},l.playerData=t[a],l.zIndex=1e4,e.addChild(l)}}for(const a in t)i[a]||(e.removeChild(t[a].container),delete t[a])}let nT=new Map;async function CM(){const e=await(await fetch("https://7tv.io/v3/emote-sets/01GE7XNJG0000DAPZVWX8BAQ90")).json();for(const r of e.emotes){const s=`https://cdn.7tv.app/emote/${r.id}/3x.webp`;nT.set(r.name,s)}}function IM(i){return nT.get(i)}const Lg=2,DM=28,RM=280,MM=36,PM="/ui/speech_bubble_organic.svg",FM=40,OM=36;let oc=null;async function BM({player:i,message:t,app:e}){var r;if(!(!i||!t)){if((r=i.chatBubble)!=null&&r.parent&&(i.chatBubble.parent.removeChild(i.chatBubble),i.chatBubble.destroy({children:!0}),i.chatBubble=null),!oc)try{oc=await Wr.load(PM)}catch(s){console.warn("❌ Failed to load SVG texture:",s);return}kM({player:i,message:t,app:e,texture:oc})}}function kM({player:i,message:t,app:e,texture:r}){const s=new Ft,n=new Ft,a=new Ft,o=new ji({fontFamily:"Comic Sans MS",fontSize:16,fill:2894892}),l=t.split(/(\s+)/);let h=new Ft,u=0,d=0,c=0;const f=[];f.push(h),a.addChild(h);for(let A of l){const S=A.trim().replace(/[.,!?;:]+$/,""),w=IM(S);let E=[];if(w)E.push({type:"emote",text:S,url:w});else if(A.length>25)for(let C=0;C<A.length;C+=10)E.push({type:"text",text:A.slice(C,C+10)});else E.push({type:"text",text:A});for(let C of E){let D;if(C.type==="emote")try{const F=j.from(C.url),b=new fe(F);b.width=b.height=DM,D=b}catch{D=new Jr(C.text+" ",o)}else D=new Jr(C.text,o);const k=D.width+4;u+k>RM&&(d+=MM,h=new Ft,f.push(h),a.addChild(h),h.y=d,u=0),D.x=u,h.addChild(D),u+=k,c=Math.max(c,u)}}f.forEach(A=>{const S=A.width;A.x=(c-S)/2});const p=a.height,y=c+FM*2+20,x=p+OM*2+10,m=new fe(r);m.width=y,m.height=x,m.anchor.set(.5,1),a.x=-c/2,a.y=-p/2,n.addChild(a),n.x=0,n.y=-x/2,s.addChild(m),s.addChild(n),s.y=-140,s.alpha=0,s.scale.set(.85*Lg),s.zIndex=999,i.container.sortableChildren=!0,i.container.addChild(s),i.chatBubble=s;let _=0;const g=A=>{_+=A,s.alpha=Math.min(1,s.alpha+.1),s.scale.x=1+.05*Math.sin(_*.3),s.scale.y=1+.05*Math.sin(_*.3),_>10&&(s.scale.set(1*Lg),e.ticker.remove(g))};e.ticker.add(g);const T=Math.min(6e3,2e3+t.length*50);setTimeout(()=>{let A=0;e.ticker.add(function S(){if(!s.parent)return e.ticker.remove(S);A++,s.alpha-=.05,s.scale.x*=.96,s.scale.y*=.96,(A>20||s.alpha<=0)&&(i.container.removeChild(s),s.destroy({children:!0}),i.chatBubble=null,e.ticker.remove(S))})},T)}function Ug(i){let t=1,e=100,r=i;for(;r>=e;)r-=e,t++,e=100+(t-1)*20;return{level:t,currentLevelXP:r,xpRequired:e,percent:r/e*100}}window.addEventListener("rescale-players",()=>{var e;const i=app.stage.children.find(r=>{var s,n,a;return r instanceof fe&&((a=(n=(s=r.texture)==null?void 0:s.baseTexture)==null?void 0:n.resource)==null?void 0:a.url)===yi.backgroundUrl}),t=((e=i==null?void 0:i.scale)==null?void 0:e.x)>0?i.scale.x:1;Object.values(playersRef.current).forEach(r=>{!r.container||!r.tileX||!r.tileY||(r.container.x=r.tileX*t,r.container.y=r.tileY*t,r.container.zIndex=1e3+r.container.y,r.chatBubble&&r.chatBubble.scale.set(t),r.nameText&&r.nameText.scale.set(t),r.levelText&&r.levelText.scale.set(t))})});function NM({socket:i,app:t,playersRef:e,stage:r,user:s,setPlayerCount:n,updateMyXP:a}){function o(l){var f;if(!i.id){console.warn("[socketHandler] ⚠️ socket.id est undefined");return}const h={},u=s.id;console.log("🧠 Mon ID (user.id):",u),u&&e.current[u]&&(h[u]=e.current[u].level);const d=t.stage.children.find(p=>{var y,x,m;return p instanceof fe&&((m=(x=(y=p.texture)==null?void 0:y.baseTexture)==null?void 0:x.resource)==null?void 0:m.url)===yi.backgroundUrl}),c=((f=d==null?void 0:d.scale)==null?void 0:f.x)>0?d.scale.x:1;console.log("📱 serverPlayers reçus:",Object.keys(l)),console.log("🔍 Scale utilisé pour les joueurs:",c),bM(l,e.current,r,s.id,h,c),n(Object.keys(l).length)}window.addEventListener("pixi-ready",()=>{i.on("update-players",o)}),i.on("player-data",l=>{a(l.xp||0)}),i.on("chat-message",({username:l,message:h,xpGained:u,level:d,totalXP:c,currentXP:f,requiredXP:p})=>{const y=Object.values(e.current).find(x=>{var m;return((m=x.username)==null?void 0:m.toLowerCase())===(l==null?void 0:l.toLowerCase())});if(!y){console.warn("[chat-message] Aucun joueur trouvé pour",l,"parmi",Object.values(e.current).map(x=>x.username));return}BM({player:y,message:h,app:t}),l===(s==null?void 0:s.username)?a(c):y.levelText&&(y.level=d,y.levelText.text=`Niv ${d}`)})}const Ci=Object.create(null);Ci.open="0";Ci.close="1";Ci.ping="2";Ci.pong="3";Ci.message="4";Ci.upgrade="5";Ci.noop="6";const hl=Object.create(null);Object.keys(Ci).forEach(i=>{hl[Ci[i]]=i});const nf={type:"error",data:"parser error"},aT=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",oT=typeof ArrayBuffer=="function",lT=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,Cp=({type:i,data:t},e,r)=>aT&&t instanceof Blob?e?r(t):Gg(t,r):oT&&(t instanceof ArrayBuffer||lT(t))?e?r(t):Gg(new Blob([t]),r):r(Ci[i]+(t||"")),Gg=(i,t)=>{const e=new FileReader;return e.onload=function(){const r=e.result.split(",")[1];t("b"+(r||""))},e.readAsDataURL(i)};function Vg(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}let lc;function LM(i,t){if(aT&&i.data instanceof Blob)return i.data.arrayBuffer().then(Vg).then(t);if(oT&&(i.data instanceof ArrayBuffer||lT(i.data)))return t(Vg(i.data));Cp(i,!1,e=>{lc||(lc=new TextEncoder),t(lc.encode(e))})}const Hg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jn=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<Hg.length;i++)jn[Hg.charCodeAt(i)]=i;const UM=i=>{let t=i.length*.75,e=i.length,r,s=0,n,a,o,l;i[i.length-1]==="="&&(t--,i[i.length-2]==="="&&t--);const h=new ArrayBuffer(t),u=new Uint8Array(h);for(r=0;r<e;r+=4)n=jn[i.charCodeAt(r)],a=jn[i.charCodeAt(r+1)],o=jn[i.charCodeAt(r+2)],l=jn[i.charCodeAt(r+3)],u[s++]=n<<2|a>>4,u[s++]=(a&15)<<4|o>>2,u[s++]=(o&3)<<6|l&63;return h},GM=typeof ArrayBuffer=="function",Ip=(i,t)=>{if(typeof i!="string")return{type:"message",data:hT(i,t)};const e=i.charAt(0);return e==="b"?{type:"message",data:VM(i.substring(1),t)}:hl[e]?i.length>1?{type:hl[e],data:i.substring(1)}:{type:hl[e]}:nf},VM=(i,t)=>{if(GM){const e=UM(i);return hT(e,t)}else return{base64:!0,data:i}},hT=(i,t)=>{switch(t){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}},uT="",HM=(i,t)=>{const e=i.length,r=new Array(e);let s=0;i.forEach((n,a)=>{Cp(n,!1,o=>{r[a]=o,++s===e&&t(r.join(uT))})})},zM=(i,t)=>{const e=i.split(uT),r=[];for(let s=0;s<e.length;s++){const n=Ip(e[s],t);if(r.push(n),n.type==="error")break}return r};function XM(){return new TransformStream({transform(i,t){LM(i,e=>{const r=e.length;let s;if(r<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,r);else if(r<65536){s=new Uint8Array(3);const n=new DataView(s.buffer);n.setUint8(0,126),n.setUint16(1,r)}else{s=new Uint8Array(9);const n=new DataView(s.buffer);n.setUint8(0,127),n.setBigUint64(1,BigInt(r))}i.data&&typeof i.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(e)})}})}let hc;function ko(i){return i.reduce((t,e)=>t+e.length,0)}function No(i,t){if(i[0].length===t)return i.shift();const e=new Uint8Array(t);let r=0;for(let s=0;s<t;s++)e[s]=i[0][r++],r===i[0].length&&(i.shift(),r=0);return i.length&&r<i[0].length&&(i[0]=i[0].slice(r)),e}function $M(i,t){hc||(hc=new TextDecoder);const e=[];let r=0,s=-1,n=!1;return new TransformStream({transform(a,o){for(e.push(a);;){if(r===0){if(ko(e)<1)break;const l=No(e,1);n=(l[0]&128)===128,s=l[0]&127,s<126?r=3:s===126?r=1:r=2}else if(r===1){if(ko(e)<2)break;const l=No(e,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(ko(e)<8)break;const l=No(e,8),h=new DataView(l.buffer,l.byteOffset,l.length),u=h.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(nf);break}s=u*Math.pow(2,32)+h.getUint32(4),r=3}else{if(ko(e)<s)break;const l=No(e,s);o.enqueue(Ip(n?l:hc.decode(l),t)),r=0}if(s===0||s>i){o.enqueue(nf);break}}}})}const cT=4;function Gt(i){if(i)return WM(i)}function WM(i){for(var t in Gt.prototype)i[t]=Gt.prototype[t];return i}Gt.prototype.on=Gt.prototype.addEventListener=function(i,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(t),this};Gt.prototype.once=function(i,t){function e(){this.off(i,e),t.apply(this,arguments)}return e.fn=t,this.on(i,e),this};Gt.prototype.off=Gt.prototype.removeListener=Gt.prototype.removeAllListeners=Gt.prototype.removeEventListener=function(i,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+i];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var r,s=0;s<e.length;s++)if(r=e[s],r===t||r.fn===t){e.splice(s,1);break}return e.length===0&&delete this._callbacks["$"+i],this};Gt.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+i],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e){e=e.slice(0);for(var r=0,s=e.length;r<s;++r)e[r].apply(this,t)}return this};Gt.prototype.emitReserved=Gt.prototype.emit;Gt.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};Gt.prototype.hasListeners=function(i){return!!this.listeners(i).length};const Nh=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),Oe=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),YM="arraybuffer";function dT(i,...t){return t.reduce((e,r)=>(i.hasOwnProperty(r)&&(e[r]=i[r]),e),{})}const jM=Oe.setTimeout,qM=Oe.clearTimeout;function Lh(i,t){t.useNativeTimers?(i.setTimeoutFn=jM.bind(Oe),i.clearTimeoutFn=qM.bind(Oe)):(i.setTimeoutFn=Oe.setTimeout.bind(Oe),i.clearTimeoutFn=Oe.clearTimeout.bind(Oe))}const KM=1.33;function ZM(i){return typeof i=="string"?QM(i):Math.ceil((i.byteLength||i.size)*KM)}function QM(i){let t=0,e=0;for(let r=0,s=i.length;r<s;r++)t=i.charCodeAt(r),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(r++,e+=4);return e}function fT(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function JM(i){let t="";for(let e in i)i.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(i[e]));return t}function tP(i){let t={},e=i.split("&");for(let r=0,s=e.length;r<s;r++){let n=e[r].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}class eP extends Error{constructor(t,e,r){super(t),this.description=e,this.context=r,this.type="TransportError"}}class Dp extends Gt{constructor(t){super(),this.writable=!1,Lh(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,r){return super.emitReserved("error",new eP(t,e,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Ip(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=JM(t);return e.length?"?"+e:""}}class iP extends Dp{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||e()})),this.writable||(r++,this.once("drain",function(){--r||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};zM(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,HM(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=fT()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let pT=!1;try{pT=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const rP=pT;function sP(){}class nP extends iP{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let r=location.port;r||(r=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||r!==t.port}}doWrite(t,e){const r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",(s,n)=>{this.onError("xhr post error",s,n)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,r)=>{this.onError("xhr poll error",e,r)}),this.pollXhr=t}}class wi extends Gt{constructor(t,e,r){super(),this.createRequest=t,Lh(this,r),this._opts=r,this._method=r.method||"GET",this._uri=e,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var t;const e=dT(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(e);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&r.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var s;r.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=wi.requestsCount++,wi.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=sP,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete wi.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}wi.requestsCount=0;wi.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",zg);else if(typeof addEventListener=="function"){const i="onpagehide"in Oe?"pagehide":"unload";addEventListener(i,zg,!1)}}function zg(){for(let i in wi.requests)wi.requests.hasOwnProperty(i)&&wi.requests[i].abort()}const aP=function(){const i=mT({xdomain:!1});return i&&i.responseType!==null}();class oP extends nP{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=aP&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new wi(mT,this.uri(),t)}}function mT(i){const t=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||rP))return new XMLHttpRequest}catch{}if(!t)try{return new Oe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const _T=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class lP extends Dp{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,r=_T?{}:dT(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,r)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],s=e===t.length-1;Cp(r,this.supportsBinary,n=>{try{this.doWrite(r,n)}catch{}s&&Nh(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=fT()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const uc=Oe.WebSocket||Oe.MozWebSocket;class hP extends lP{createSocket(t,e,r){return _T?new uc(t,e,r):e?new uc(t,e):new uc(t)}doWrite(t,e){this.ws.send(e)}}class uP extends Dp{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=$M(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=t.readable.pipeThrough(e).getReader(),s=XM();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const n=()=>{r.read().then(({done:o,value:l})=>{o||(this.onPacket(l),n())}).catch(o=>{})};n();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],s=e===t.length-1;this._writer.write(r).then(()=>{s&&Nh(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const cP={websocket:hP,webtransport:uP,polling:oP},dP=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fP=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function af(i){if(i.length>8e3)throw"URI too long";const t=i,e=i.indexOf("["),r=i.indexOf("]");e!=-1&&r!=-1&&(i=i.substring(0,e)+i.substring(e,r).replace(/:/g,";")+i.substring(r,i.length));let s=dP.exec(i||""),n={},a=14;for(;a--;)n[fP[a]]=s[a]||"";return e!=-1&&r!=-1&&(n.source=t,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=pP(n,n.path),n.queryKey=mP(n,n.query),n}function pP(i,t){const e=/\/{2,9}/g,r=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function mP(i,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,s,n){s&&(e[s]=n)}),e}const of=typeof addEventListener=="function"&&typeof removeEventListener=="function",ul=[];of&&addEventListener("offline",()=>{ul.forEach(i=>i())},!1);class Ar extends Gt{constructor(t,e){if(super(),this.binaryType=YM,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const r=af(t);e.hostname=r.host,e.secure=r.protocol==="https"||r.protocol==="wss",e.port=r.port,r.query&&(e.query=r.query)}else e.host&&(e.hostname=af(e.host).host);Lh(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(r=>{const s=r.prototype.name;this.transports.push(s),this._transportsByName[s]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=tP(this.opts.query)),of&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ul.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=cT,e.transport=t,this.id&&(e.sid=this.id);const r=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ar.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",Ar.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const s=this.writeBuffer[r].data;if(s&&(e+=ZM(s)),r>0&&e>this._maxPayload)return this.writeBuffer.slice(0,r);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Nh(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,r){return this._sendPacket("message",t,e,r),this}send(t,e,r){return this._sendPacket("message",t,e,r),this}_sendPacket(t,e,r,s){if(typeof e=="function"&&(s=e,e=void 0),typeof r=="function"&&(s=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const n={type:t,data:e,options:r};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},r=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}_onError(t){if(Ar.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),of&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=ul.indexOf(this._offlineEventListener);r!==-1&&ul.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}Ar.protocol=cT;class _P extends Ar{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),r=!1;Ar.priorWebsocketSuccess=!1;const s=()=>{r||(e.send([{type:"ping",data:"probe"}]),e.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Ar.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const c=new Error("probe error");c.transport=e.name,this.emitReserved("upgradeError",c)}}))};function n(){r||(r=!0,u(),e.close(),e=null)}const a=d=>{const c=new Error("probe error: "+d);c.transport=e.name,n(),this.emitReserved("upgradeError",c)};function o(){a("transport closed")}function l(){a("socket closed")}function h(d){e&&d.name!==e.name&&n()}const u=()=>{e.removeListener("open",s),e.removeListener("error",a),e.removeListener("close",o),this.off("close",l),this.off("upgrading",h)};e.once("open",s),e.once("error",a),e.once("close",o),this.once("close",l),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let r=0;r<t.length;r++)~this.transports.indexOf(t[r])&&e.push(t[r]);return e}}let gP=class extends _P{constructor(t,e={}){const r=typeof t=="object"?t:e;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(s=>cP[s]).filter(s=>!!s)),super(t,r)}};function yP(i,t="",e){let r=i;e=e||typeof location<"u"&&location,i==null&&(i=e.protocol+"//"+e.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=e.protocol+i:i=e.host+i),/^(https?|wss?):\/\//.test(i)||(typeof e<"u"?i=e.protocol+"//"+i:i="https://"+i),r=af(i)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const n=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+n+":"+r.port+t,r.href=r.protocol+"://"+n+(e&&e.port===r.port?"":":"+r.port),r}const vP=typeof ArrayBuffer=="function",xP=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,gT=Object.prototype.toString,TP=typeof Blob=="function"||typeof Blob<"u"&&gT.call(Blob)==="[object BlobConstructor]",AP=typeof File=="function"||typeof File<"u"&&gT.call(File)==="[object FileConstructor]";function Rp(i){return vP&&(i instanceof ArrayBuffer||xP(i))||TP&&i instanceof Blob||AP&&i instanceof File}function cl(i,t){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let e=0,r=i.length;e<r;e++)if(cl(i[e]))return!0;return!1}if(Rp(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return cl(i.toJSON(),!0);for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&cl(i[e]))return!0;return!1}function EP(i){const t=[],e=i.data,r=i;return r.data=lf(e,t),r.attachments=t.length,{packet:r,buffers:t}}function lf(i,t){if(!i)return i;if(Rp(i)){const e={_placeholder:!0,num:t.length};return t.push(i),e}else if(Array.isArray(i)){const e=new Array(i.length);for(let r=0;r<i.length;r++)e[r]=lf(i[r],t);return e}else if(typeof i=="object"&&!(i instanceof Date)){const e={};for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=lf(i[r],t));return e}return i}function SP(i,t){return i.data=hf(i.data,t),delete i.attachments,i}function hf(i,t){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<t.length)return t[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=hf(i[e],t);else if(typeof i=="object")for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=hf(i[e],t));return i}const wP=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],bP=5;var ft;(function(i){i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK"})(ft||(ft={}));class CP{constructor(t){this.replacer=t}encode(t){return(t.type===ft.EVENT||t.type===ft.ACK)&&cl(t)?this.encodeAsBinary({type:t.type===ft.EVENT?ft.BINARY_EVENT:ft.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===ft.BINARY_EVENT||t.type===ft.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=EP(t),r=this.encodeAsString(e.packet),s=e.buffers;return s.unshift(r),s}}function Xg(i){return Object.prototype.toString.call(i)==="[object Object]"}class Mp extends Gt{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const r=e.type===ft.BINARY_EVENT;r||e.type===ft.BINARY_ACK?(e.type=r?ft.EVENT:ft.ACK,this.reconstructor=new IP(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Rp(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const r={type:Number(t.charAt(0))};if(ft[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===ft.BINARY_EVENT||r.type===ft.BINARY_ACK){const n=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const a=t.substring(n,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");r.attachments=Number(a)}if(t.charAt(e+1)==="/"){const n=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););r.nsp=t.substring(n,e)}else r.nsp="/";const s=t.charAt(e+1);if(s!==""&&Number(s)==s){const n=e+1;for(;++e;){const a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}r.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(Mp.isPayloadValid(r.type,n))r.data=n;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case ft.CONNECT:return Xg(e);case ft.DISCONNECT:return e===void 0;case ft.CONNECT_ERROR:return typeof e=="string"||Xg(e);case ft.EVENT:case ft.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&wP.indexOf(e[0])===-1);case ft.ACK:case ft.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class IP{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=SP(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const DP=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Mp,Encoder:CP,get PacketType(){return ft},protocol:bP},Symbol.toStringTag,{value:"Module"}));function qe(i,t,e){return i.on(t,e),function(){i.off(t,e)}}const RP=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class yT extends Gt{constructor(t,e,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[qe(t,"open",this.onopen.bind(this)),qe(t,"packet",this.onpacket.bind(this)),qe(t,"error",this.onerror.bind(this)),qe(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var r,s,n;if(RP.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const a={type:ft.EVENT,data:e};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const u=this.ids++,d=e.pop();this._registerAckCallback(u,d),a.id=u}const o=(s=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((n=this.io.engine)===null||n===void 0)&&n._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(t,e){var r;const s=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(s===void 0){this.acks[t]=e;return}const n=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},s),a=(...o)=>{this.io.clearTimeoutFn(n),e.apply(this,o)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...e){return new Promise((r,s)=>{const n=(a,o)=>a?s(a):r(o);n.withError=!0,e.push(n),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...n)=>r!==this._queue[0]?void 0:(s!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(s)):(this._queue.shift(),e&&e(null,...n)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ft.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(r=>String(r.id)===t)){const r=this.acks[t];delete this.acks[t],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ft.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ft.EVENT:case ft.BINARY_EVENT:this.onevent(t);break;case ft.ACK:case ft.BINARY_ACK:this.onack(t);break;case ft.DISCONNECT:this.ondisconnect();break;case ft.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const r of e)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let r=!1;return function(...s){r||(r=!0,e.packet({type:ft.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ft.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const r of e)r.apply(this,t.data)}}}function Tn(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}Tn.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*i);i=Math.floor(t*10)&1?i+e:i-e}return Math.min(i,this.max)|0};Tn.prototype.reset=function(){this.attempts=0};Tn.prototype.setMin=function(i){this.ms=i};Tn.prototype.setMax=function(i){this.max=i};Tn.prototype.setJitter=function(i){this.jitter=i};class uf extends Gt{constructor(t,e){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,Lh(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((r=e.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Tn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||DP;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new gP(this.uri,this.opts);const e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const s=qe(e,"open",function(){r.onopen(),t&&t()}),n=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},a=qe(e,"error",n);if(this._timeout!==!1){const o=this._timeout,l=this.setTimeoutFn(()=>{s(),n(new Error("timeout")),e.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(qe(t,"ping",this.onping.bind(this)),qe(t,"data",this.ondata.bind(this)),qe(t,"error",this.onerror.bind(this)),qe(t,"close",this.onclose.bind(this)),qe(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Nh(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new yT(this,t,e),this.nsps[t]=r),r}_destroy(t){const e=Object.keys(this.nsps);for(const r of e)if(this.nsps[r].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let r=0;r<e.length;r++)this.engine.write(e[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const kn={};function dl(i,t){typeof i=="object"&&(t=i,i=void 0),t=t||{};const e=yP(i,t.path||"/socket.io"),r=e.source,s=e.id,n=e.path,a=kn[s]&&n in kn[s].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let l;return o?l=new uf(r,t):(kn[s]||(kn[s]=new uf(r,t)),l=kn[s]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(dl,{Manager:uf,Socket:yT,io:dl,connect:dl});const vT=nt.createContext(null);function MP({children:i,user:t}){const e=nt.useRef(null),r=nt.useRef({}),[s,n]=nt.useState(null),[a,o]=nt.useState(0),[l,h]=nt.useState(1),[u,d]=nt.useState(0),[c,f]=nt.useState(120),p=x=>{const{level:m,currentLevelXP:_,xpRequired:g}=Ug(x);o(x),h(m),f(g),d(_),r.current[t.id]&&(r.current[t.id].level=m,r.current[t.id].levelText&&(r.current[t.id].levelText.text=`Niv ${m}`))};nt.useEffect(()=>(e.current=dl("http://localhost:4000"),e.current.on("connect",()=>{n(e.current.id),e.current.emit("new-player",{avatar:t.avatar,username:t.username,id:t.id,x:yi.spawn.x,y:yi.spawn.y})}),e.current.on("player-data",x=>{const m=x.xp||0,{level:_,currentLevelXP:g,xpRequired:T}=Ug(m);o(m),h(_),f(T),d(g)}),()=>{e.current.disconnect()}),[t]);const y=()=>{var x;(x=e.current)!=null&&x.connected&&e.current.emit("remove-player"),localStorage.removeItem("offspot-user"),window.location.reload()};return Q.createElement(vT.Provider,{value:{user:t,socket:e,socketId:s,playersRef:r,myXP:a,myLevel:l,currentXP:u,xpRequired:c,setMyXP:o,setMyLevel:h,setCurrentXP:d,setXPRequired:f,updateMyXP:p,logout:y,isMe:x=>x===s}},i)}function Uh(){const i=nt.useContext(vT);if(!i)throw new Error("usePlayer must be used within a PlayerProvider");return i}function PP({avatar:i,username:t,playerCount:e,onLogout:r}){const{myXP:s,myLevel:n,currentXP:a,xpRequired:o}=Uh(),l=n,h=a,u=o,d=nt.useRef(null),c=nt.useRef(null),[f,p]=nt.useState(l);return nt.useEffect(()=>{if(f!==null&&l>f){d.current&&(d.current.classList.remove("flash"),d.current.offsetWidth,d.current.classList.add("flash")),c.current&&(c.current.classList.remove("rainbow"),c.current.offsetWidth,c.current.classList.add("rainbow"));const y=document.createElement("div");y.className="level-up-popup",y.innerText=`Niveau ${l} !`,document.body.appendChild(y),setTimeout(()=>y.remove(),1500)}p(l)},[l]),nt.useEffect(()=>{c.current&&(c.current.style.transition="width 0.5s ease",c.current.style.width=`${h/u*100}%`)},[h,u]),Q.createElement("div",{className:"game-ui"},Q.createElement("div",{className:"user-info"},Q.createElement("img",{src:i,alt:"avatar",className:"avatar"}),Q.createElement("div",{className:"username-block"},Q.createElement("div",{className:"username"},t),Q.createElement("div",{className:"level"},"Niveau ",l),Q.createElement("div",{className:"xp-bar-container"},Q.createElement("div",{className:"xp-bar",ref:d},Q.createElement("div",{className:"xp-fill",ref:c})),Q.createElement("div",{className:"xp-labels"},Q.createElement("span",null,h," / ",u," XP"))))),Q.createElement("div",{className:"spacer"}),Q.createElement("div",{className:"stats"},Q.createElement("span",{className:"player-count"},e," en ligne"),Q.createElement("button",{className:"logout-button",onClick:r},"Déconnexion")))}const FP=i=>/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)[\w-]{11}/.test(i);function OP({player:i}){const{socket:t,user:e}=Uh(),[r,s]=nt.useState(!1),[n,a]=nt.useState(""),[o,l]=nt.useState(!1),[h,u]=nt.useState(null),[d,c]=nt.useState(()=>{const m=localStorage.getItem("preferredVolume");return m?parseInt(m,10):0}),[f,p]=nt.useState([]);nt.useEffect(()=>{const m=t.current;if(m)return m.on("video-queue",p),m.emit("get-video-queue"),()=>m.off("video-queue")},[t.current]);const y=m=>{if(m.preventDefault(),!(!n||!t.current)){if(!FP(n)){u("URL invalide. Assure-toi qu'elle vient bien de YouTube.");return}t.current.emit("submit-video",{url:n,username:(e==null?void 0:e.username)||"Inconnu"}),l(!0),u(null),a(""),setTimeout(()=>l(!1),3e3)}},x=m=>{const _=parseInt(m.target.value,10);c(_),localStorage.setItem("preferredVolume",_),i&&(i.unMute(),i.setVolume(_))};return Q.createElement("div",{style:{position:"absolute",bottom:"30px",right:"30px",background:"rgba(20, 15, 25, 0.85)",backdropFilter:"blur(6px)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 0 12px rgba(0, 0, 0, 0.3)",borderRadius:"12px",padding:"10px",color:"#fff",fontFamily:"'Poppins', sans-serif",width:r?"380px":"60px",transition:"width 0.3s ease",overflow:"hidden",zIndex:9999}},Q.createElement("button",{onClick:()=>s(!r),style:{background:"linear-gradient(45deg, #ffdc73, #ffa94d)",color:"#1a1a1a",border:"none",borderRadius:"8px",width:"100%",padding:"10px",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",marginBottom:r?"14px":"0",transition:"all 0.3s ease"}},r?"🎬 Fermer":"🎬"),r&&Q.createElement(Q.Fragment,null,Q.createElement("div",{style:{marginBottom:"12px"}},"🔊 Volume",Q.createElement("input",{type:"range",min:"0",max:"100",value:d,onChange:x,style:{width:"100%"}})),Q.createElement("button",{onClick:()=>{var m;return(m=t.current)==null?void 0:m.emit("skip-video")},style:{width:"100%",background:"linear-gradient(45deg, #ff6f61, #e74c3c)",color:"#fff",border:"none",borderRadius:"8px",padding:"8px",fontWeight:"bold",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",marginBottom:"12px"}},"⏭ Skip"),Q.createElement("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"12px"}},Q.createElement("input",{type:"text",value:n,onChange:m=>a(m.target.value),placeholder:"URL YouTube...",style:{padding:"6px",borderRadius:"6px",border:"1px solid #888",background:"#1d1b20",color:"#fff"}}),Q.createElement("button",{type:"submit",style:{background:"linear-gradient(45deg, #ffc857, #ffb347)",border:"none",borderRadius:"6px",padding:"6px",fontWeight:"bold"}},"➕ Ajouter"),o&&Q.createElement("span",{style:{color:"#0f0"}},"✔️ Ajoutée !"),h&&Q.createElement("span",{style:{color:"red"}},h)),Q.createElement("div",null,Q.createElement("h4",{style:{color:"#ffd166",marginBottom:"10px"}},"🎥 Playlist ",Q.createElement("span",{style:{fontWeight:"normal",color:"#aaa"}},"(",f.length,")")),f.length===0&&Q.createElement("p",{style:{color:"#888"}},"Aucune vidéo en attente."),Q.createElement("ul",{style:{paddingLeft:"18px",fontSize:"13px",lineHeight:"1.4",maxHeight:"180px",overflowY:"auto"}},f.map((m,_)=>Q.createElement("li",{key:_,style:{marginBottom:"10px"}},Q.createElement("span",{style:{color:"#ffcc00"}},m.username),Q.createElement("br",null),Q.createElement("span",{style:{color:"#fff"}},m.url)))))))}function BP({cameraRef:i}){const{socket:t}=Uh(),[e,r]=nt.useState(null),[s,n]=nt.useState(null),[a,o]=nt.useState(null),[l,h]=nt.useState({}),[u,d]=nt.useState(null),c=nt.useRef(null);return nt.useEffect(()=>{function f(){if(!i.current)return;const y=i.current.scale.x||1,x=i.current.toGlobal({x:1010,y:680}),m=930*y,_=440*y;h({position:"absolute",top:`${x.y}px`,left:`${x.x}px`,width:`${m}px`,height:`${_}px`,zIndex:0,pointerEvents:"none"})}const p=setInterval(f,16);return window.addEventListener("resize",f),window.addEventListener("pixi-ready",f),()=>{clearInterval(p),window.removeEventListener("resize",f),window.removeEventListener("pixi-ready",f)}},[i]),nt.useEffect(()=>{const f=t.current;if(!f)return;const p=x=>{console.log("[📡 play-video]",x);const m=x==null?void 0:x.url,_=x==null?void 0:x.startTime,g=typeof m=="string"?m:m==null?void 0:m.url;if(console.log("[🧪 URL parsing]",{raw:m,rawUrl:g,startTime:_}),!(!g||!_))try{const T=g.match(/(?:v=|youtu\.be\/)([\w-]{11})/),A=T?T[1]:null;if(!A)return;const S=Date.now(),w=Math.floor((S-_)/1e3),E=`https://www.youtube.com/embed/${A}?autoplay=1&start=${w}&controls=0&modestbranding=1&playsinline=1&rel=0&disablekb=1&fs=0&enablejsapi=1&cc_load_policy=0&origin=${window.location.origin}`;r(g),n(_),o(E),console.log("[✅ embed URL built]",E)}catch(T){console.error("[❌] Erreur lors du parsing de l'URL:",g,T)}},y=()=>{r(null),n(null),o(null)};return f.emit("get-current-video"),f.on("play-video",p),f.on("clear-video",y),()=>{f.off("play-video",p),f.off("clear-video",y)}},[t.current]),nt.useEffect(()=>{if(!a||!c.current)return;const f=()=>{console.log("[🎬 tryInitYT] YouTube Player init..."),window.YT&&window.YT.Player&&new window.YT.Player(c.current,{events:{onReady:p=>{console.log("[🔇 Mute]",p),p.target.mute(),p.target.playVideo(),d(p.target)},onStateChange:p=>{var y;if(console.log("[⏯ YouTube state]",p.data),p.data===window.YT.PlayerState.ENDED&&((y=t.current)==null||y.emit("skip-video")),p.data===window.YT.PlayerState.PLAYING){const x=localStorage.getItem("preferredVolume"),m=x?parseInt(x,10):0;m>0&&setTimeout(()=>{p.target.getPlayerState()===window.YT.PlayerState.PLAYING&&(p.target.setVolume(m),p.target.unMute(),console.log(`[🔊] Volume appliqué : ${m}`))},3e3)}}}})};if(window.YT)f();else{const p=document.createElement("script");p.src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=f,document.body.appendChild(p)}},[a]),Q.createElement(Q.Fragment,null,a&&Q.createElement("div",{style:l},Q.createElement("iframe",{ref:c,width:"100%",height:"100%",src:a,title:"Cinema Screen",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})),Q.createElement(OP,{player:u}))}const cc=3;function kP(){const i=nt.useRef(null),t=nt.useRef(null),e=nt.useRef(null),r=nt.useRef(null),s=nt.useRef({});window.playersRef=s;const n=nt.useRef(null),[a,o]=nt.useState(0),{user:l,socket:h,myXP:u,myLevel:d,currentXP:c,xpRequired:f,setMyXP:p,setMyLevel:y,setCurrentXP:x,setXPRequired:m,playersRef:_,logout:g}=Uh();return nt.useEffect(()=>{const T=()=>{_.current=s.current,requestAnimationFrame(T)};return T(),()=>cancelAnimationFrame(T)},[]),nt.useEffect(()=>{if(!i.current)return;t.current=new Cx({backgroundAlpha:0,transparent:!0,antialias:!0,autoDensity:!0,resolution:window.devicePixelRatio||1,resizeTo:window}),i.current.innerHTML="",i.current.appendChild(t.current.view),r.current=new Ft,r.current.sortableChildren=!0,t.current.stage.addChild(r.current),e.current=new Ft,r.current.addChild(e.current);const T={current:!1},A={current:!1},S={current:{x:0,y:0}};function w(){const C=e.current.scale.x,D=window.innerWidth,k=window.innerHeight,F=yi.width*C,b=yi.height*C,P=D-F,N=k-b;e.current.x=Math.min(0,Math.max(P,e.current.x)),e.current.y=Math.min(0,Math.max(N,e.current.y))}function E(C){const D=window.innerWidth,k=window.innerHeight,F=D/yi.width,b=k/yi.height,N=Math.min(F,b)*1.2;e.current.scale.set(N),Object.values(s.current).forEach(H=>{!H.container||H.tileX==null||H.tileY==null||(H.container.x=H.tileX,H.container.y=H.tileY,H.container.zIndex=1e3+H.container.y)}),t.current.renderer.resize(window.innerWidth,window.innerHeight),w()}return Wr.load(yi.backgroundUrl).then(C=>{const D=new fe(C);D.anchor.set(0),D.x=0,D.y=0,D.zIndex=-20,n.current=D,e.current.addChild(D),window.addEventListener("resize",()=>E()),E(),window.dispatchEvent(new Event("pixi-ready"))}).catch(C=>{console.error("[PIXI] ❌ Erreur chargement background.png",C)}),t.current.stage.eventMode="static",t.current.stage.hitArea=t.current.screen,t.current.stage.on("pointerup",C=>{var z;if(A.current){A.current=!1,T.current=!1,document.body.classList.remove("dragging");return}const{x:D,y:k}=C.data.global,F=s.current[l==null?void 0:l.id];if(!F||!n.current)return;if(F.blockInputUntil&&Date.now()<F.blockInputUntil){console.log("⏳ Mouvement bloqué pendant le spawn");return}const b=e.current.scale.x,P=(D-e.current.x)/b,N=(k-e.current.y)/b,{minX:H,maxX:U,minY:R,maxY:V}=yi.walkableArea,M=Math.max(H,Math.min(U,P)),B=Math.max(R,Math.min(V,N));F.targetX=M,F.targetY=B,F.tileX=M,F.tileY=B,(z=h.current)==null||z.emit("move",{x:M,y:B})}),t.current.view.addEventListener("pointerdown",C=>{T.current=!0,A.current=!1,S.current={x:C.clientX,y:C.clientY},document.body.classList.add("dragging")}),t.current.view.addEventListener("pointermove",C=>{if(!T.current)return;const D=C.clientX-S.current.x,k=C.clientY-S.current.y;(Math.abs(D)>2||Math.abs(k)>2)&&(A.current=!0),e.current.x+=D,e.current.y+=k,w(),S.current={x:C.clientX,y:C.clientY}}),t.current.view.addEventListener("pointerup",()=>{T.current=!1,document.body.classList.remove("dragging")}),t.current.view.addEventListener("pointerleave",()=>{T.current=!1,document.body.classList.remove("dragging")}),t.current.view.addEventListener("wheel",C=>{C.preventDefault();const D=e.current.scale.x,k=C.deltaY>0?-1:1;let F=D+k*.1;F=Math.min(2,Math.max(.5,F));const b=t.current.view.getBoundingClientRect(),P=(C.clientX-b.left-e.current.x)/D,N=(C.clientY-b.top-e.current.y)/D;e.current.scale.set(F),e.current.x=C.clientX-P*F,e.current.y=C.clientY-N*F,w()},{passive:!1}),t.current.ticker.add(()=>{var C;e.current.scale.x;for(const D in s.current){const k=s.current[D];if(!k||!k.container||!k.anims)return;const F=k.targetX,b=k.targetY,P=F-k.container.x,N=b-k.container.y,H=Math.sqrt(P*P+N*N);if(k.isSpawning)continue;k.justSpawned?(k.container.x=F,k.container.y=b,k.justSpawned=!1):H>cc?(k.container.x+=P/H*cc,k.container.y+=N/H*cc):(k.container.x=F,k.container.y=b);const U=H>1;let R=k.currentDirection;U&&(R=Math.abs(P)>Math.abs(N)?P>0?"Left":"Right":N>0?"Front":"Back",k.currentDirection=R);const V=U?"WalkAnim":"IdleAnim";for(const z of["Front","Back","Left","Right"])k.anims[z]&&(k.anims[z].visible=z===k.currentDirection);const M=k.anims[k.currentDirection],B=M==null?void 0:M.animation;B&&B.hasAnimation(V)&&((C=B.lastAnimationState)==null?void 0:C.name)!==V&&B.fadeIn(V,0,0),k.currentAnim=V}}),()=>t.current.destroy(!0,{children:!0})},[]),nt.useEffect(()=>{!h.current||!t.current||!e.current||!l||NM({socket:h.current,app:t.current,playersRef:s,stage:e.current,user:l,setPlayerCount:o,updateMyXP:p})},[h.current,t.current,e.current,l]),nt.useEffect(()=>{CM()},[]),l?Q.createElement(Q.Fragment,null,Q.createElement("div",{ref:i,style:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:10}}),Q.createElement(PP,{key:`ui-${u}-${d}`,avatar:l.avatar,username:l.username,playerCount:a,onLogout:g}),Q.createElement(BP,{cameraRef:e})):null}function NP(){return Q.createElement("div",{className:"login-screen"},Q.createElement("img",{src:"/favicon.png",alt:"OffSpot Logo",className:"login-logo"}),Q.createElement("h1",{className:"login-title"},"Bienvenue sur OffSpot"),Q.createElement("p",{className:"login-subtitle"},"Rejoins le monde sous les étoiles 🌙"),Q.createElement("a",{href:"https://id.twitch.tv/oauth2/authorize?client_id=fojvopd0f2faz1c8cr5tkiutqixpv1&redirect_uri=http://localhost:4000/auth/twitch/callback&response_type=code&scope=user:read:email",className:"login-button"},"🎬 Se connecter avec Twitch"))}function LP(){const{user:i}=HA();return i?Q.createElement(MP,{user:i},Q.createElement(kP,null)):Q.createElement(NP,null)}dc.createRoot(document.getElementById("root")).render(Q.createElement(Q.StrictMode,null,Q.createElement(LP,null)));
